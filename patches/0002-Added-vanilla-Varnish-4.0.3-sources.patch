From 830be95d1fcd8733ccf7509145641ccd0d7943f5 Mon Sep 17 00:00:00 2001
From: sorinrevsw <sorin@revsw.com>
Date: Mon, 25 May 2015 13:22:10 +0300
Subject: [PATCH 02/63] Added vanilla Varnish 4.0.3 sources.

---
 bin/varnishd/Makefile.am                           |   6 +-
 bin/varnishd/cache/cache.h                         |  23 +-
 bin/varnishd/cache/cache_acceptor.c                |   5 +-
 bin/varnishd/cache/cache_backend.c                 |  19 +-
 bin/varnishd/cache/cache_backend_cfg.c             | 106 ++----
 bin/varnishd/cache/cache_backend_poll.c            |   2 +-
 bin/varnishd/cache/cache_cli.c                     |   4 +-
 bin/varnishd/cache/cache_esi_fetch.c               |   7 +-
 bin/varnishd/cache/cache_fetch.c                   |  98 +++--
 bin/varnishd/cache/cache_fetch_proc.c              |   2 +-
 bin/varnishd/cache/cache_hash.c                    |  34 +-
 bin/varnishd/cache/cache_http.c                    |  14 +-
 bin/varnishd/cache/cache_http1_deliver.c           | 139 +++----
 bin/varnishd/cache/cache_http1_fsm.c               |  20 +-
 bin/varnishd/cache/cache_main.c                    |   4 +-
 bin/varnishd/cache/cache_panic.c                   |  15 +-
 bin/varnishd/cache/cache_req_fsm.c                 |  15 +-
 bin/varnishd/cache/cache_rfc2616.c                 |   2 +-
 bin/varnishd/cache/cache_session.c                 |   9 +-
 bin/varnishd/cache/cache_vcl.c                     |  15 +-
 bin/varnishd/cache/cache_vrt.c                     |  38 +-
 bin/varnishd/cache/cache_vrt_re.c                  |  14 +-
 bin/varnishd/cache/cache_vrt_var.c                 |  97 ++---
 bin/varnishd/cache/cache_vrt_vmod.c                |   2 +-
 bin/varnishd/hash/hash_critbit.c                   |   2 +-
 bin/varnishd/hash/hash_slinger.h                   |   2 -
 bin/varnishd/mgt/mgt_cli.c                         |   2 +-
 bin/varnishd/mgt/mgt_main.c                        |   2 +-
 bin/varnishd/mgt/mgt_param_tbl.c                   |  38 +-
 bin/varnishd/mgt/mgt_pool.c                        |   2 +-
 bin/varnishd/storage/stevedore_mgt.c               |   2 +-
 bin/varnishd/storage/stevedore_utils.c             |  14 +-
 bin/varnishd/storage/storage_file.c                |   4 +-
 bin/varnishd/storage/storage_persistent.c          |   9 +-
 bin/varnishhist/varnishhist.c                      |  21 +-
 bin/varnishhist/varnishhist_options.h              |   2 +-
 bin/varnishlog/varnishlog_options.h                |   2 +-
 bin/varnishncsa/varnishncsa.c                      | 102 +++--
 bin/varnishstat/varnishstat.c                      |  27 +-
 bin/varnishstat/varnishstat_curses.c               |   9 +-
 bin/varnishtest/tests/c00016.vtc                   |   6 +
 bin/varnishtest/tests/c00034.vtc                   |  74 ++--
 bin/varnishtest/tests/c00044.vtc                   |   3 +-
 bin/varnishtest/tests/c00045.vtc                   |   3 +-
 bin/varnishtest/tests/c00055.vtc                   |   4 +-
 bin/varnishtest/tests/c00058.vtc                   |   7 +
 bin/varnishtest/tests/c00067.vtc                   |   4 +-
 bin/varnishtest/tests/m00009.vtc                   |   1 -
 bin/varnishtest/tests/m00018.vtc                   |  24 +-
 bin/varnishtest/tests/r00730.vtc                   |   2 +-
 bin/varnishtest/tests/r00801.vtc                   |   1 +
 bin/varnishtest/tests/r01140.vtc                   |   1 +
 bin/varnishtest/tests/r01284.vtc                   |   3 +-
 bin/varnishtest/tests/v00013.vtc                   |   2 +-
 bin/varnishtest/tests/v00020.vtc                   |   1 +
 bin/varnishtest/tests/v00025.vtc                   |   3 +-
 bin/varnishtest/tests/v00026.vtc                   |   4 -
 bin/varnishtest/tests/v00036.vtc                   |   1 -
 bin/varnishtest/tests/v00039.vtc                   |   8 +-
 bin/varnishtest/vtc_http.c                         | 111 ++++--
 bin/varnishtest/vtc_varnish.c                      |   2 +-
 build-aux/missing                                  | 414 +++++++++++++--------
 configure.ac                                       |   4 +-
 doc/changes.html                                   | 317 ++++++++++------
 doc/changes.rst                                    | 239 ++++++++++--
 doc/sphinx/Makefile.am                             |  20 +-
 doc/sphinx/build/html/.buildinfo                   |   2 +-
 doc/sphinx/build/html/_sources/index.txt           |   2 +-
 doc/sphinx/build/html/_sources/phk/dough.txt       |   2 +-
 doc/sphinx/build/html/_sources/phk/persistent.txt  |   2 +-
 doc/sphinx/build/html/_sources/reference/index.txt |   1 -
 .../build/html/_sources/reference/varnish-cli.txt  |  16 +-
 .../build/html/_sources/reference/varnishlog.txt   |   2 +-
 .../build/html/_sources/reference/varnishstat.txt  |  47 ++-
 doc/sphinx/build/html/_sources/reference/vcl.txt   |  15 +
 doc/sphinx/build/html/_sources/reference/vmod.txt  |   2 +-
 .../html/_sources/reference/vmod_std.generated.txt | 144 ++++---
 .../build/html/_sources/tutorial/introduction.txt  |  10 +-
 .../users-guide/increasing-your-hitrate.txt        |  21 +-
 .../_sources/users-guide/operation-logging.txt     |  45 +--
 .../_sources/users-guide/operation-statistics.txt  |   9 +-
 .../build/html/_sources/users-guide/purging.txt    |   2 +-
 .../html/_sources/users-guide/troubleshooting.txt  |   9 +-
 .../_sources/users-guide/vcl-built-in-subs.txt     | 260 +++++++++----
 .../html/_sources/users-guide/vcl-inline-c.txt     |  10 +-
 .../html/_sources/users-guide/vcl-variables.txt    |   2 +-
 .../build/html/_sources/whats-new/upgrading.txt    |  30 +-
 doc/sphinx/build/html/genindex.html                |  10 +-
 doc/sphinx/build/html/glossary/index.html          |  10 +-
 doc/sphinx/build/html/index.html                   |  12 +-
 doc/sphinx/build/html/installation/bugs.html       |  10 +-
 doc/sphinx/build/html/installation/help.html       |  10 +-
 doc/sphinx/build/html/installation/index.html      |  10 +-
 doc/sphinx/build/html/installation/install.html    |  10 +-
 .../build/html/installation/platformnotes.html     |  10 +-
 .../build/html/installation/prerequisites.html     |  10 +-
 doc/sphinx/build/html/objects.inv                  | Bin 4369 -> 4595 bytes
 doc/sphinx/build/html/phk/autocrap.html            |  10 +-
 doc/sphinx/build/html/phk/backends.html            |  10 +-
 doc/sphinx/build/html/phk/barriers.html            |  10 +-
 doc/sphinx/build/html/phk/dough.html               |  12 +-
 doc/sphinx/build/html/phk/gzip.html                |  10 +-
 doc/sphinx/build/html/phk/http20.html              |  10 +-
 doc/sphinx/build/html/phk/index.html               |  10 +-
 doc/sphinx/build/html/phk/ipv6suckage.html         |  10 +-
 doc/sphinx/build/html/phk/persistent.html          |  12 +-
 doc/sphinx/build/html/phk/platforms.html           |  10 +-
 doc/sphinx/build/html/phk/spdy.html                |  10 +-
 doc/sphinx/build/html/phk/sphinx.html              |  10 +-
 doc/sphinx/build/html/phk/ssl.html                 |  10 +-
 doc/sphinx/build/html/phk/thetoolsweworkwith.html  |  10 +-
 doc/sphinx/build/html/phk/thoughts.html            |  10 +-
 doc/sphinx/build/html/phk/three-zero.html          |  10 +-
 .../build/html/phk/varnish_does_not_hash.html      |  10 +-
 doc/sphinx/build/html/phk/vcl_expr.html            |  10 +-
 doc/sphinx/build/html/phk/wanton_destruction.html  |  10 +-
 doc/sphinx/build/html/reference/index.html         |  14 +-
 doc/sphinx/build/html/reference/varnish-cli.html   |  27 +-
 doc/sphinx/build/html/reference/varnishadm.html    |  10 +-
 doc/sphinx/build/html/reference/varnishd.html      |  52 +--
 doc/sphinx/build/html/reference/varnishhist.html   |  12 +-
 doc/sphinx/build/html/reference/varnishlog.html    |  18 +-
 doc/sphinx/build/html/reference/varnishncsa.html   |  10 +-
 doc/sphinx/build/html/reference/varnishreplay.html |  20 +-
 doc/sphinx/build/html/reference/varnishstat.html   |  65 ++--
 doc/sphinx/build/html/reference/varnishtest.html   |  10 +-
 doc/sphinx/build/html/reference/varnishtop.html    |  10 +-
 doc/sphinx/build/html/reference/vcl.html           |  53 ++-
 doc/sphinx/build/html/reference/vmod.html          |  12 +-
 .../html/reference/vmod_directors.generated.html   |  10 +-
 .../build/html/reference/vmod_std.generated.html   | 180 ++++++---
 doc/sphinx/build/html/reference/vsl-query.html     |  10 +-
 doc/sphinx/build/html/reference/vsl.html           |  30 +-
 doc/sphinx/build/html/reference/vsm.html           |  10 +-
 doc/sphinx/build/html/search.html                  |  10 +-
 doc/sphinx/build/html/searchindex.js               |   2 +-
 .../build/html/tutorial/backend_servers.html       |  10 +-
 doc/sphinx/build/html/tutorial/index.html          |  10 +-
 doc/sphinx/build/html/tutorial/introduction.html   |  20 +-
 doc/sphinx/build/html/tutorial/now_what.html       |  10 +-
 doc/sphinx/build/html/tutorial/peculiarities.html  |  10 +-
 .../html/tutorial/putting_varnish_on_port_80.html  |  10 +-
 .../build/html/tutorial/starting_varnish.html      |  10 +-
 .../build/html/users-guide/command-line.html       |  10 +-
 doc/sphinx/build/html/users-guide/compression.html |  10 +-
 .../build/html/users-guide/devicedetection.html    |  10 +-
 doc/sphinx/build/html/users-guide/esi.html         |  10 +-
 .../html/users-guide/increasing-your-hitrate.html  |  30 +-
 doc/sphinx/build/html/users-guide/index.html       |  12 +-
 doc/sphinx/build/html/users-guide/intro.html       |  10 +-
 .../build/html/users-guide/operation-logging.html  |  54 +--
 .../html/users-guide/operation-statistics.html     |  19 +-
 doc/sphinx/build/html/users-guide/params.html      |  10 +-
 doc/sphinx/build/html/users-guide/performance.html |  10 +-
 doc/sphinx/build/html/users-guide/purging.html     |  12 +-
 doc/sphinx/build/html/users-guide/report.html      |  10 +-
 doc/sphinx/build/html/users-guide/run_cli.html     |  10 +-
 .../build/html/users-guide/run_security.html       |  10 +-
 doc/sphinx/build/html/users-guide/running.html     |  10 +-
 .../build/html/users-guide/sizing-your-cache.html  |  10 +-
 .../build/html/users-guide/storage-backends.html   |  10 +-
 .../build/html/users-guide/troubleshooting.html    |  19 +-
 doc/sphinx/build/html/users-guide/vcl-actions.html |  10 +-
 .../build/html/users-guide/vcl-backends.html       |  10 +-
 .../build/html/users-guide/vcl-built-in-subs.html  | 259 ++++++++-----
 .../build/html/users-guide/vcl-example-acls.html   |  10 +-
 .../vcl-example-manipulating-headers.html          |  10 +-
 .../vcl-example-manipulating-responses.html        |  10 +-
 .../html/users-guide/vcl-example-websockets.html   |  10 +-
 .../build/html/users-guide/vcl-examples.html       |  18 +-
 doc/sphinx/build/html/users-guide/vcl-grace.html   |  18 +-
 doc/sphinx/build/html/users-guide/vcl-hashing.html |  10 +-
 .../build/html/users-guide/vcl-inline-c.html       |  20 +-
 doc/sphinx/build/html/users-guide/vcl-syntax.html  |  10 +-
 .../build/html/users-guide/vcl-variables.html      |  12 +-
 doc/sphinx/build/html/users-guide/vcl.html         |  12 +-
 doc/sphinx/build/html/whats-new/changes.html       |  10 +-
 doc/sphinx/build/html/whats-new/index.html         |  10 +-
 doc/sphinx/build/html/whats-new/upgrading.html     |  37 +-
 doc/sphinx/conf.py                                 |   6 +-
 doc/sphinx/include/varnishhist_options.rst         |   2 +-
 doc/sphinx/include/varnishlog_options.rst          |   8 +-
 doc/sphinx/include/varnishlog_synopsis.rst         |   2 +-
 doc/sphinx/include/vcl_var.rst                     |  33 +-
 doc/sphinx/index.rst                               |   2 +-
 doc/sphinx/phk/dough.rst                           |   2 +-
 doc/sphinx/phk/persistent.rst                      |   2 +-
 doc/sphinx/reference/index.rst                     |   1 -
 doc/sphinx/reference/varnish-cli.rst               |  16 +-
 doc/sphinx/reference/varnishlog.rst                |   2 +-
 doc/sphinx/reference/varnishstat.rst               |  47 ++-
 doc/sphinx/reference/vcl.rst                       |  15 +
 doc/sphinx/reference/vmod.rst                      |   2 +-
 doc/sphinx/reference/vmod_directors.generated.rst  |  67 ----
 doc/sphinx/reference/vmod_std.generated.rst        | 144 ++++---
 doc/sphinx/tutorial/introduction.rst               |  10 +-
 doc/sphinx/users-guide/increasing-your-hitrate.rst |  21 +-
 doc/sphinx/users-guide/operation-logging.rst       |  45 +--
 doc/sphinx/users-guide/operation-statistics.rst    |   9 +-
 doc/sphinx/users-guide/purging.rst                 |   2 +-
 doc/sphinx/users-guide/troubleshooting.rst         |   9 +-
 doc/sphinx/users-guide/vcl-built-in-subs.rst       | 260 +++++++++----
 doc/sphinx/users-guide/vcl-inline-c.rst            |  10 +-
 doc/sphinx/users-guide/vcl-variables.rst           |   2 +-
 doc/sphinx/whats-new/upgrading.rst                 |  30 +-
 etc/example.vcl                                    |   6 +-
 include/Makefile.am                                |  37 +-
 include/tbl/debug_bits.h                           |   1 +
 include/tbl/http_headers.h                         | 125 ++++---
 include/tbl/locks.h                                |   1 -
 include/tbl/sess_close.h                           |  25 +-
 include/tbl/vsc_f_main.h                           | 105 +++---
 include/tbl/vsc_fields.h                           |   2 +-
 include/tbl/vsl_tags.h                             |  20 +-
 include/vcl.h                                      |   3 +-
 include/vcli.h                                     |  16 +-
 include/vcs_version.h                              |   6 +-
 include/vmod_abi.h                                 |   2 +-
 include/vrt.h                                      |  47 ++-
 include/vrt_obj.h                                  | 177 +++++----
 lib/libvarnish/vtim.c                              |   3 +-
 lib/libvarnishapi/vsl-tags.rst                     |  20 +-
 lib/libvcc/generate.py                             |  42 ++-
 lib/libvcc/vcc_acl.c                               |   2 +-
 lib/libvcc/vcc_backend.c                           |  87 ++---
 lib/libvcc/vcc_compile.c                           |   5 +-
 lib/libvcc/vcc_compile.h                           |   4 +-
 lib/libvcc/vcc_expr.c                              |  35 +-
 lib/libvcc/vcc_fixed_token.c                       | 291 +++++++--------
 lib/libvcc/vcc_obj.c                               |   7 +-
 lib/libvcc/vcc_parse.c                             |   6 +-
 lib/libvcc/vcc_utils.c                             |  45 ---
 lib/libvcc/vmodtool.py                             |  13 +-
 lib/libvmod_debug/vmod_debug.c                     |  16 +-
 lib/libvmod_debug/vmod_debug_obj.c                 |   8 +-
 lib/libvmod_directors/Makefile.am                  |   5 +-
 lib/libvmod_directors/fall_back.c                  |   6 +-
 lib/libvmod_directors/hash.c                       |   6 +-
 lib/libvmod_directors/random.c                     |  10 +-
 lib/libvmod_directors/round_robin.c                |   6 +-
 lib/libvmod_directors/vmod.vcc                     |  41 --
 lib/libvmod_std/vmod.vcc                           | 130 ++++---
 lib/libvmod_std/vmod_std.c                         |  36 +-
 lib/libvmod_std/vmod_std_conversions.c             |  30 +-
 lib/libvmod_std/vmod_std_fileread.c                |   2 +-
 lib/libvmod_std/vmod_std_querysort.c               |   2 +-
 man/Makefile.am                                    |   4 +-
 man/varnish-cli.7                                  |  15 +-
 man/varnishstat.1                                  |  47 ++-
 man/vcl.7                                          |  54 ++-
 man/vsc2rst.c                                      |   5 -
 redhat/find-provides                               |   7 +-
 redhat/varnish.params                              |  18 +-
 redhat/varnish.service                             |   1 +
 redhat/varnish.spec                                |  10 +-
 redhat/varnishlog.service                          |   2 +-
 redhat/varnishncsa.service                         |   4 +-
 varnish.m4                                         |  12 +-
 varnishapi-uninstalled.pc.in                       |   1 -
 varnishapi.pc.in                                   |   2 -
 260 files changed, 3894 insertions(+), 2973 deletions(-)

diff --git a/bin/varnishd/Makefile.am b/bin/varnishd/Makefile.am
index 402cd0d..8cf16de 100644
--- a/bin/varnishd/Makefile.am
+++ b/bin/varnishd/Makefile.am
@@ -87,10 +87,9 @@ varnishd_SOURCES = \
 	waiter/cache_waiter_ports.c 
 
 noinst_HEADERS = \
-	cache/cache_backend.h \
+	builtin_vcl.h \
 	cache/cache_esi.h \
 	common/heritage.h \
-	builtin_vcl.h \
 	hash/hash_slinger.h \
 	mgt/mgt.h \
 	mgt/mgt_cli.h \
@@ -100,8 +99,7 @@ noinst_HEADERS = \
 	waiter/waiter.h
 
 # Headers for use with vmods
-pkgdataincludedir = $(pkgdatadir)/include
-nobase_pkgdatainclude_HEADERS = \
+nobase_pkginclude_HEADERS = \
 	cache/cache.h \
 	cache/cache_backend.h \
 	common/common.h \
diff --git a/bin/varnishd/cache/cache.h b/bin/varnishd/cache/cache.h
index 20b5d40..660d6b7 100644
--- a/bin/varnishd/cache/cache.h
+++ b/bin/varnishd/cache/cache.h
@@ -125,7 +125,6 @@ struct waitinglist;
 struct worker;
 struct wrw;
 struct objiter;
-struct rev_vmod;
 
 #define DIGEST_LEN		32
 
@@ -174,19 +173,6 @@ struct ws {
 };
 
 /*--------------------------------------------------------------------
- * RevSW: Per VMOD data. It is copied between req and bereq.
- */
-
-typedef void* (*rev_vmod_dup_data_func)(struct ws *ws, void *data);
-
-struct rev_vmod {
-    unsigned		        magic;
-#define REV_VMOD_MAGIC		0x631cb1c3
-    void                    *data;
-    rev_vmod_dup_data_func  dup_data_func;
-};
-
-/*--------------------------------------------------------------------
  * Ban info event types
  */
 
@@ -439,6 +425,7 @@ struct objcore {
 	struct objhead		*objhead;
 	struct busyobj		*busyobj;
 	double			timer_when;
+	long			hits;
 
 	uint16_t		flags;
 #define OC_F_BUSY		(1<<1)
@@ -602,9 +589,6 @@ struct busyobj {
 	struct ws		ws_o[1];
 
 	struct vsb		*synth_body;
-
-    /* RevSW: revvar VMOD data, copied from req->vmod_revvar */
-    struct rev_vmod vmod_revvar;
 };
 
 /* Object structure --------------------------------------------------*/
@@ -751,9 +735,6 @@ struct req {
 
 	/* Synth content in vcl_synth */
 	struct vsb		*synth_body;
-
-    /* RevSW: revvar VMOD data */
-    struct rev_vmod vmod_revvar;
 };
 
 /*--------------------------------------------------------------------
@@ -1038,7 +1019,7 @@ void http_SetStatus(struct http *to, uint16_t status);
 const char *http_GetReq(const struct http *hp);
 int http_HdrIs(const struct http *hp, const char *hdr, const char *val);
 int http_IsHdr(const txt *hh, const char *hdr);
-enum sess_close http_DoConnection(const struct http *);
+enum sess_close http_DoConnection(struct http *);
 void http_CopyHome(struct http *hp);
 void http_Unset(struct http *hp, const char *hdr);
 void http_CollectHdr(struct http *hp, const char *hdr);
diff --git a/bin/varnishd/cache/cache_acceptor.c b/bin/varnishd/cache/cache_acceptor.c
index 7afcef6..58e884e 100644
--- a/bin/varnishd/cache/cache_acceptor.c
+++ b/bin/varnishd/cache/cache_acceptor.c
@@ -460,9 +460,8 @@ ccf_listen_address(struct cli *cli, const char * const *av, void *priv)
 
 static struct cli_proto vca_cmds[] = {
 	{ CLI_SERVER_START,	"i", ccf_start },
-	{ "debug.listen_address",
-	    "debug.listen_address",
-	    "Report the actual listen address\n", 0, 0,
+	{ "debug.listen_address", "debug.listen_address",
+	    "\tReport the actual listen address.", 0, 0,
 	    "d", ccf_listen_address, NULL },
 	{ NULL }
 };
diff --git a/bin/varnishd/cache/cache_backend.c b/bin/varnishd/cache/cache_backend.c
index 31490e4..6622f4b 100644
--- a/bin/varnishd/cache/cache_backend.c
+++ b/bin/varnishd/cache/cache_backend.c
@@ -403,8 +403,7 @@ VRT_fini_dir(struct cli *cli, struct director *d)
 	struct vdi_simple *vs;
 
 	(void)cli;
-    /* RevSW: This can be called from the rev_dns director, from the recv thread */
-    //ASSERT_CLI();
+	ASSERT_CLI();
 	CHECK_OBJ_NOTNULL(d, DIRECTOR_MAGIC);
 	CAST_OBJ_NOTNULL(vs, d->priv, VDI_SIMPLE_MAGIC);
 
@@ -421,8 +420,7 @@ VRT_init_dir(struct cli *cli, struct director **bp, int idx, const void *priv)
 	const struct vrt_backend *t;
 	struct vdi_simple *vs;
 
-    /* RevSW: This can be called from the rev_dns director, from the recv thread */
-	//ASSERT_CLI();
+	ASSERT_CLI();
 	(void)cli;
 	t = priv;
 
@@ -444,19 +442,6 @@ VRT_init_dir(struct cli *cli, struct director **bp, int idx, const void *priv)
 	bp[idx] = &vs->dir;
 }
 
-/* RevSW extension */
-const struct vrt_backend *
-VRT_get_backend(struct cli *cli, struct director *d)
-{
-    struct vdi_simple *vs;
-
-    (void)cli;
-    CHECK_OBJ_NOTNULL(d, DIRECTOR_MAGIC);
-    CAST_OBJ_NOTNULL(vs, d->priv, VDI_SIMPLE_MAGIC);
-
-    return vs->vrt;
-}
-
 void
 VDI_Init(void)
 {
diff --git a/bin/varnishd/cache/cache_backend_cfg.c b/bin/varnishd/cache/cache_backend_cfg.c
index f7d7e86..b7f6a8d 100644
--- a/bin/varnishd/cache/cache_backend_cfg.c
+++ b/bin/varnishd/cache/cache_backend_cfg.c
@@ -48,24 +48,8 @@
 /*
  * The list of backends is not locked, it is only ever accessed from
  * the CLI thread, so there is no need.
- *
- * RevSW: That is no longer correct, we access this from the rev_dns
- * director. Backends can be added from another thread too, while they are
- * nuked only from the client thread.
  */
 static VTAILQ_HEAD(, backend) backends = VTAILQ_HEAD_INITIALIZER(backends);
-static struct lock backends_mtx;
-
-static void VBE_Lock(void)
-{
-    Lck_Lock(&backends_mtx);
-}
-
-static void VBE_Unlock(void)
-{
-    Lck_Unlock(&backends_mtx);
-}
-
 
 /*--------------------------------------------------------------------
  */
@@ -74,9 +58,7 @@ static void
 VBE_Nuke(struct backend *b)
 {
 
-    /* RevSW: This can be called indirectly from the rev_dns director,
-       from the recv thread */
-    //ASSERT_CLI();
+	ASSERT_CLI();
 	VTAILQ_REMOVE(&backends, b, list);
 	free(b->ipv4);
 	free(b->ipv4_addr);
@@ -97,8 +79,6 @@ VBE_Poll(void)
 	struct backend *b, *b2;
 
 	ASSERT_CLI();
-
-    VBE_Lock();
 	VTAILQ_FOREACH_SAFE(b, &backends, list, b2) {
 		assert(
 			b->admin_health == ah_healthy ||
@@ -108,7 +88,6 @@ VBE_Poll(void)
 		if (b->refcount == 0 && b->probe == NULL)
 			VBE_Nuke(b);
 	}
-    VBE_Unlock();
 }
 
 /*--------------------------------------------------------------------
@@ -138,9 +117,7 @@ VBE_DropRefLocked(struct backend *b, const struct acct_bereq *acct_bereq)
 	if (i > 0)
 		return;
 
-    /* RevSW: This can be called indirectly from the rev_dns director,
-       from the recv thread */
-    //ASSERT_CLI();
+	ASSERT_CLI();
 	VTAILQ_FOREACH_SAFE(vbe, &b->connlist, list, vbe2) {
 		VTAILQ_REMOVE(&b->connlist, vbe, list);
 		if (vbe->fd >= 0) {
@@ -150,9 +127,7 @@ VBE_DropRefLocked(struct backend *b, const struct acct_bereq *acct_bereq)
 		vbe->backend = NULL;
 		VBE_ReleaseConn(vbe);
 	}
-    VBE_Lock();
 	VBE_Nuke(b);
-    VBE_Unlock();
 }
 
 void
@@ -205,29 +180,24 @@ VBE_AddBackend(struct cli *cli, const struct vrt_backend *vb)
 	struct backend *b;
 	char buf[128];
 
-    AN(vb->vcl_name);
+	AN(vb->vcl_name);
 	assert(vb->ipv4_suckaddr != NULL || vb->ipv6_suckaddr != NULL);
 	(void)cli;
+	ASSERT_CLI();
 
-    /* RevSW: Can also add backends through the rev_dns director in the recv thread */
-    //ASSERT_CLI();
-
-    VBE_Lock();
-
-    /* Run through the list and see if we already have this backend */
+	/* Run through the list and see if we already have this backend */
 	VTAILQ_FOREACH(b, &backends, list) {
 		CHECK_OBJ_NOTNULL(b, BACKEND_MAGIC);
 		if (strcmp(b->vcl_name, vb->vcl_name))
 			continue;
-		if (b->ipv4 != NULL && vb->ipv4_suckaddr != NULL &&
+		if (vb->ipv4_suckaddr != NULL &&
 		    VSA_Compare(b->ipv4, vb->ipv4_suckaddr))
 			continue;
-		if (b->ipv6 != NULL && vb->ipv6_suckaddr != NULL &&
+		if (vb->ipv6_suckaddr != NULL &&
 		    VSA_Compare(b->ipv6, vb->ipv6_suckaddr))
 			continue;
 		b->refcount++;
 		b->vsc->vcls++;
-        VBE_Unlock();
 		return (b);
 	}
 
@@ -273,7 +243,6 @@ VBE_AddBackend(struct cli *cli, const struct vrt_backend *vb)
 
 	VTAILQ_INSERT_TAIL(&backends, b, list);
 	VSC_C_main->n_backend++;
-    VBE_Unlock();
 	return (b);
 }
 
@@ -286,11 +255,11 @@ vbe_str2adminhealth(const char *wstate)
 {
 
 	if (strcasecmp(wstate, "healthy") == 0)
-		return(ah_healthy);
+		return (ah_healthy);
 	if (strcasecmp(wstate, "sick") == 0)
-		return(ah_sick);
+		return (ah_sick);
 	if (strcmp(wstate, "auto") == 0)
-		return(ah_probe);
+		return (ah_probe);
 	return (ah_invalid);
 }
 
@@ -318,7 +287,7 @@ backend_find(struct cli *cli, const char *matcher, bf_func *func, void *priv)
 	ssize_t ip_l = 0;
 	const char *port_b = NULL;
 	ssize_t port_l = 0;
-	int found = 0;
+	int all, found = 0;
 	int i;
 
 	name_b = matcher;
@@ -373,27 +342,32 @@ backend_find(struct cli *cli, const char *matcher, bf_func *func, void *priv)
 			}
 		}
 	}
-    VBE_Lock();
-	VTAILQ_FOREACH(b, &backends, list) {
-		CHECK_OBJ_NOTNULL(b, BACKEND_MAGIC);
-		if (port_b != NULL && strncmp(b->port, port_b, port_l) != 0)
-			continue;
-		if (name_b != NULL && strncmp(b->vcl_name, name_b, name_l) != 0)
-			continue;
-		if (ip_b != NULL &&
-		    (b->ipv4_addr == NULL ||
-		      strncmp(b->ipv4_addr, ip_b, ip_l)) &&
-		    (b->ipv6_addr == NULL ||
-		      strncmp(b->ipv6_addr, ip_b, ip_l)))
+
+	for (all = 0; all < 2 && found == 0; all++) {
+		if (all == 0 && name_b == NULL)
 			continue;
-		found++;
-		i = func(cli, b, priv);
-		if (i) {
-            VBE_Unlock();
-            return(i);
-        }
+		VTAILQ_FOREACH(b, &backends, list) {
+			CHECK_OBJ_NOTNULL(b, BACKEND_MAGIC);
+			if (port_b != NULL &&
+			    strncmp(b->port, port_b, port_l) != 0)
+				continue;
+			if (name_b != NULL &&
+			    strncmp(b->vcl_name, name_b, name_l) != 0)
+				continue;
+			if (all == 0 && b->vcl_name[name_l] != '\0')
+				continue;
+			if (ip_b != NULL &&
+			    (b->ipv4_addr == NULL ||
+				strncmp(b->ipv4_addr, ip_b, ip_l)) &&
+			    (b->ipv6_addr == NULL ||
+				strncmp(b->ipv6_addr, ip_b, ip_l)))
+				continue;
+			found++;
+			i = func(cli, b, priv);
+			if (i)
+				return (i);
+		}
 	}
-    VBE_Unlock();
 	return (found);
 }
 
@@ -496,11 +470,12 @@ cli_backend_set_health(struct cli *cli, const char * const *av, void *priv)
 /*---------------------------------------------------------------------*/
 
 static struct cli_proto backend_cmds[] = {
-	{ "backend.list", "backend.list",
-	    "\tList all backends\n",
+	{ "backend.list", "backend.list [<backend_expression>]",
+	    "\tList backends.",
 	    0, 1, "", cli_backend_list },
-	{ "backend.set_health", "backend.set_health matcher state",
-	    "\tSet health status on a backend\n",
+	{ "backend.set_health",
+	    "backend.set_health <backend_expression> <state>",
+	    "\tSet health status on the backends.",
 	    2, 2, "", cli_backend_set_health },
 	{ NULL }
 };
@@ -510,7 +485,6 @@ static struct cli_proto backend_cmds[] = {
 void
 VBE_InitCfg(void)
 {
-    Lck_New(&backends_mtx , lck_cache_backends);
 
 	CLI_AddFuncs(backend_cmds);
 }
diff --git a/bin/varnishd/cache/cache_backend_poll.c b/bin/varnishd/cache/cache_backend_poll.c
index 4773785..479872b 100644
--- a/bin/varnishd/cache/cache_backend_poll.c
+++ b/bin/varnishd/cache/cache_backend_poll.c
@@ -430,7 +430,7 @@ vbp_health(struct cli *cli, const char * const *av, void *priv)
 
 static struct cli_proto debug_cmds[] = {
 	{ "debug.health", "debug.health",
-		"\tDump backend health stuff\n",
+		"\tDump backend health information.",
 		0, 0, "d", vbp_health },
 	{ NULL }
 };
diff --git a/bin/varnishd/cache/cache_cli.c b/bin/varnishd/cache/cache_cli.c
index 99b781c..0b67551 100644
--- a/bin/varnishd/cache/cache_cli.c
+++ b/bin/varnishd/cache/cache_cli.c
@@ -223,10 +223,10 @@ static struct cli_proto master_cmds[] = {
 	{ CLI_PING,		"i", VCLS_func_ping },
 	{ CLI_HELP,             "i", VCLS_func_help },
 	{ "debug.sizeof", "debug.sizeof",
-		"\tDump sizeof various data structures\n",
+		"\tDump sizeof various data structures.",
 		0, 0, "d", cli_debug_sizeof },
 	{ "debug.panic.worker", "debug.panic.worker",
-		"\tPanic the worker process.\n",
+		"\tPanic the worker process.",
 		0, 0, "d", ccf_panic },
 	{ NULL }
 };
diff --git a/bin/varnishd/cache/cache_esi_fetch.c b/bin/varnishd/cache/cache_esi_fetch.c
index 41bea3b..cc93194 100644
--- a/bin/varnishd/cache/cache_esi_fetch.c
+++ b/bin/varnishd/cache/cache_esi_fetch.c
@@ -137,6 +137,8 @@ vfp_esi_end(struct busyobj *bo, struct vef_priv *vef, enum vfp_status retval)
 	}
 	if (vef->ibuf != NULL)
 		free(vef->ibuf);
+	if (vef->error)
+		retval = VFP_ERROR;
 	FREE_OBJ(vef);
 	return (retval);
 }
@@ -160,7 +162,10 @@ vfp_esi_gzip_pull(struct busyobj *bo, void *p, ssize_t *lp, intptr_t *priv)
 		vef->ibuf_i = vef->ibuf;
 		vef->ibuf_o = vef->ibuf;
 		*priv = (uintptr_t)vef;
-		return (VFP_OK);
+		if (vef->error)
+			return (VFP_ERROR);
+		else
+			return (VFP_OK);
 	}
 	if (p == vfp_fini) {
 		if (*priv)
diff --git a/bin/varnishd/cache/cache_fetch.c b/bin/varnishd/cache/cache_fetch.c
index 32c4c85..3308ae6 100644
--- a/bin/varnishd/cache/cache_fetch.c
+++ b/bin/varnishd/cache/cache_fetch.c
@@ -187,22 +187,11 @@ vbf_stp_mkbereq(const struct worker *wrk, struct busyobj *bo)
 	AZ(bo->vbc);
 	AZ(bo->should_close);
 	AZ(bo->storage_hint);
-    AZ(bo->vmod_revvar.data);
-    AZ(bo->vmod_revvar.dup_data_func);
 
 	HTTP_Setup(bo->bereq0, bo->ws, bo->vsl, SLT_BereqMethod);
 	http_FilterReq(bo->bereq0, bo->req->http,
 	    bo->do_pass ? HTTPH_R_PASS : HTTPH_R_FETCH);
 
-    /* RevSW: copy 'revvar' VMOD data from 'req' to 'bo', to be able to
-       access it in 'vcl_backend_response'. */
-    if (bo->req->vmod_revvar.data && bo->req->vmod_revvar.dup_data_func) {
-        bo->vmod_revvar = bo->req->vmod_revvar;
-        /* Copy 'data' to our own ws.*/
-        bo->vmod_revvar.data =
-            bo->vmod_revvar.dup_data_func(bo->ws, bo->vmod_revvar.data);
-    }
-
 	if (!bo->do_pass) {
 		http_ForceField(bo->bereq0, HTTP_HDR_METHOD, "GET");
 		http_ForceField(bo->bereq0, HTTP_HDR_PROTO, "HTTP/1.1");
@@ -234,6 +223,7 @@ vbf_stp_mkbereq(const struct worker *wrk, struct busyobj *bo)
 
 /*--------------------------------------------------------------------
  * Start a new VSL transaction and try again
+ * Prepare the busyobj and fetch processors
  */
 
 static enum fetch_step
@@ -244,8 +234,27 @@ vbf_stp_retry(struct worker *wrk, struct busyobj *bo)
 	CHECK_OBJ_NOTNULL(wrk, WORKER_MAGIC);
 	CHECK_OBJ_NOTNULL(bo, BUSYOBJ_MAGIC);
 
+	assert(bo->state == BOS_REQ_DONE);
+
 	VSLb_ts_busyobj(bo, "Retry", W_TIM_real(wrk));
 
+	/* VDI_CloseFd must have been called before */
+	AZ(bo->vbc);
+	bo->should_close = 0;
+
+	/* reset other bo attributes - See VBO_GetBusyObj */
+	bo->storage_hint = NULL;
+	bo->do_esi = 0;
+	bo->do_gzip = 0;
+	bo->do_gunzip = 0;
+	bo->do_stream = 1;
+	bo->uncacheable = 0;
+	bo->abandon = 0;
+
+	/* reset fetch processors */
+	bo->failed = 0;
+	bo->vfp_nxt = 0;
+
 	// XXX: BereqEnd + BereqAcct ?
 	wid = VXID_Get(&wrk->vxid_pool);
 	VSLb(bo->vsl, SLT_Link, "bereq %u retry", wid);
@@ -283,7 +292,7 @@ vbf_stp_startfetch(struct worker *wrk, struct busyobj *bo)
 		AZ(bo->req);
 
 	http_PrintfHeader(bo->bereq,
-	    "X-Rev-Id: %u", bo->vsl->wid & VSL_IDENTMASK);
+	    "X-Varnish: %u", bo->vsl->wid & VSL_IDENTMASK);
 
 
 	VCL_backend_fetch_method(bo->vcl, wrk, NULL, bo, bo->bereq->ws);
@@ -370,7 +379,11 @@ vbf_stp_startfetch(struct worker *wrk, struct busyobj *bo)
 
 	AZ(bo->do_esi);
 
-	if (bo->ims_obj != NULL && bo->beresp->status == 304) {
+	if (bo->ims_obj != NULL && bo->ims_obj->http->status == 200 &&
+	    (http_GetHdr(bo->ims_obj->http, H_Last_Modified, NULL) ||
+	     http_GetHdr(bo->ims_obj->http, H_ETag, NULL)) &&
+	    bo->beresp->status == 304) {
+		http_Unset(bo->beresp, H_Content_Length);
 		http_Merge(bo->ims_obj->http, bo->beresp,
 		    bo->ims_obj->changed_gzip);
 		assert(bo->beresp->status == 200);
@@ -390,6 +403,7 @@ vbf_stp_startfetch(struct worker *wrk, struct busyobj *bo)
 		bo->retries++;
 		if (bo->retries <= cache_param->max_retries)
 			return (F_STP_RETRY);
+
 		VSLb(bo->vsl, SLT_VCL_Error,
 		    "Too many retries, delivering 503");
 		return (F_STP_ERROR);
@@ -479,19 +493,23 @@ vbf_stp_fetch(struct worker *wrk, struct busyobj *bo)
 
 	if (bo->do_gunzip || (bo->is_gzip && bo->do_esi)) {
 		RFC2616_Weaken_Etag(bo->beresp);
+		http_Unset(bo->beresp, H_Content_Length);
 		VFP_Push(bo, vfp_gunzip_pull, 0);
 	}
 
 	if (bo->do_esi && bo->do_gzip) {
 		VFP_Push(bo, vfp_esi_gzip_pull, 0);
+		http_Unset(bo->beresp, H_Content_Length);
 		RFC2616_Weaken_Etag(bo->beresp);
 	} else if (bo->do_esi && bo->is_gzip && !bo->do_gunzip) {
 		VFP_Push(bo, vfp_esi_gzip_pull, 0);
+		http_Unset(bo->beresp, H_Content_Length);
 		RFC2616_Weaken_Etag(bo->beresp);
 	} else if (bo->do_esi) {
 		VFP_Push(bo, vfp_esi_pull, 0);
 	} else if (bo->do_gzip) {
 		VFP_Push(bo, vfp_gzip_pull, 0);
+		http_Unset(bo->beresp, H_Content_Length);
 		RFC2616_Weaken_Etag(bo->beresp);
 	} else if (bo->is_gzip && !bo->do_gunzip) {
 		VFP_Push(bo, vfp_testgunzip_pull, 0);
@@ -544,6 +562,11 @@ vbf_stp_fetch(struct worker *wrk, struct busyobj *bo)
 		VFP_Fetch_Body(bo, est);
 	}
 
+	if (bo->failed) {
+		AN(bo->vbc);
+		VDI_CloseFd(&bo->vbc, &bo->acct);
+	}
+
 	if (bo->failed && !bo->do_stream) {
 		assert(bo->state < BOS_STREAM);
 		if (bo->fetch_obj != NULL) {
@@ -638,6 +661,8 @@ vbf_stp_condfetch(struct worker *wrk, struct busyobj *bo)
 	oi = ObjIterBegin(wrk, bo->ims_obj);
 	do {
 		ois = ObjIter(oi, &sp, &sl);
+		if (ois == OIS_ERROR)
+			VFP_Error(bo, "Template object failed");
 		while (sl > 0) {
 			if (st == NULL)
 				st = VFP_GetStorage(bo, bo->ims_obj->len - al);
@@ -656,6 +681,8 @@ vbf_stp_condfetch(struct worker *wrk, struct busyobj *bo)
 		}
 	} while (!bo->failed && (ois == OIS_DATA || ois == OIS_STREAM));
 	ObjIterEnd(&oi);
+	if (bo->ims_obj->objcore->flags & OC_F_FAILED)
+		VFP_Error(bo, "Template object failed");
 	if (bo->failed)
 		return (F_STP_FAIL);
 
@@ -696,6 +723,7 @@ vbf_stp_error(struct worker *wrk, struct busyobj *bo)
 	now = W_TIM_real(wrk);
 	VSLb_ts_busyobj(bo, "Error", now);
 
+	AZ(bo->vbc);		/* VDI_CloseFd must have been called before */
 	AN(bo->fetch_objcore->flags & OC_F_BUSY);
 
 	AZ(bo->synth_body);
@@ -722,8 +750,10 @@ vbf_stp_error(struct worker *wrk, struct busyobj *bo)
 	if (wrk->handling == VCL_RET_RETRY) {
 		VSB_delete(bo->synth_body);
 		bo->synth_body = NULL;
+
 		if (bo->retries++ < cache_param->max_retries)
 			return (F_STP_RETRY);
+
 		return (F_STP_FAIL);
 	}
 
@@ -835,7 +865,6 @@ vbf_fetch_thread(struct worker *wrk, void *priv)
 
 	if (bo->state == BOS_FINISHED) {
 		AZ(bo->fetch_objcore->flags & OC_F_FAILED);
-		HSH_Complete(bo->fetch_objcore);
 		VSLb(bo->vsl, SLT_Length, "%zd", bo->fetch_obj->len);
 		{
 		/* Sanity check fetch methods accounting */
@@ -852,6 +881,7 @@ vbf_fetch_thread(struct worker *wrk, void *priv)
 			else
 				assert(uu == bo->fetch_obj->len);
 		}
+		HSH_Complete(bo->fetch_objcore);
 	}
 	AZ(bo->fetch_objcore->busyobj);
 
@@ -869,7 +899,7 @@ void
 VBF_Fetch(struct worker *wrk, struct req *req, struct objcore *oc,
     struct object *oldobj, enum vbf_fetch_mode_e mode)
 {
-	struct busyobj *bo;
+	struct busyobj *bo, *bo_fetch;
 	const char *how;
 
 	CHECK_OBJ_NOTNULL(wrk, WORKER_MAGIC);
@@ -893,6 +923,7 @@ VBF_Fetch(struct worker *wrk, struct req *req, struct objcore *oc,
 	VSLb(req->vsl, SLT_Link, "bereq %u %s",
 	    bo->vsl->wid & VSL_IDENTMASK, how);
 
+	bo_fetch = bo;
 	bo->refcount = 2;
 
 	oc->busyobj = bo;
@@ -911,33 +942,38 @@ VBF_Fetch(struct worker *wrk, struct req *req, struct objcore *oc,
 
 	AZ(bo->ims_obj);
 	if (oldobj != NULL) {
-		if (http_GetHdr(oldobj->http, H_Last_Modified, NULL) ||
-		   http_GetHdr(oldobj->http, H_ETag, NULL)) {
-			assert(oldobj->objcore->refcnt > 0);
-			HSH_Ref(oldobj->objcore);
-			bo->ims_obj = oldobj;
-		}
+		assert(oldobj->objcore->refcnt > 0);
+		HSH_Ref(oldobj->objcore);
+		bo->ims_obj = oldobj;
 	}
 
 	AZ(bo->req);
 	bo->req = req;
 
-	bo->fetch_task.priv = bo;
+	bo->fetch_task.priv = bo_fetch;
 	bo->fetch_task.func = vbf_fetch_thread;
 
-	if (Pool_Task(wrk->pool, &bo->fetch_task, POOL_QUEUE_FRONT))
-		vbf_fetch_thread(wrk, bo);
-	if (mode == VBF_BACKGROUND) {
-		VBO_waitstate(bo, BOS_REQ_DONE);
+	if (Pool_Task(wrk->pool, &bo->fetch_task, POOL_QUEUE_FRONT)) {
+		wrk->stats.fetch_no_thread++;
+		(void)vbf_stp_fail(req->wrk, bo);
+		if (bo->ims_obj != NULL)
+			(void)HSH_DerefObj(&wrk->stats, &bo->ims_obj);
+		VBO_DerefBusyObj(wrk, &bo_fetch);
 	} else {
-		VBO_waitstate(bo, BOS_STREAM);
-		if (bo->state == BOS_FAILED) {
-			AN((oc->flags & OC_F_FAILED));
+		bo_fetch = NULL; /* ref transferred to fetch thread */
+		if (mode == VBF_BACKGROUND) {
+			VBO_waitstate(bo, BOS_REQ_DONE);
 		} else {
-			AZ(bo->fetch_objcore->flags & OC_F_BUSY);
+			VBO_waitstate(bo, BOS_STREAM);
+			if (bo->state == BOS_FAILED) {
+				AN((oc->flags & OC_F_FAILED));
+			} else {
+				AZ(bo->fetch_objcore->flags & OC_F_BUSY);
+			}
 		}
 	}
+	AZ(bo_fetch);
 	VSLb_ts_req(req, "Fetch", W_TIM_real(wrk));
-	THR_SetBusyobj(NULL);
 	VBO_DerefBusyObj(wrk, &bo);
+	THR_SetBusyobj(NULL);
 }
diff --git a/bin/varnishd/cache/cache_fetch_proc.c b/bin/varnishd/cache/cache_fetch_proc.c
index 429052d..3bec04e 100644
--- a/bin/varnishd/cache/cache_fetch_proc.c
+++ b/bin/varnishd/cache/cache_fetch_proc.c
@@ -286,7 +286,7 @@ debug_fragfetch(struct cli *cli, const char * const *av, void *priv)
 
 static struct cli_proto debug_cmds[] = {
 	{ "debug.fragfetch", "debug.fragfetch",
-		"\tEnable fetch fragmentation\n", 1, 1, "d", debug_fragfetch },
+		"\tEnable fetch fragmentation.", 1, 1, "d", debug_fragfetch },
 	{ NULL }
 };
 
diff --git a/bin/varnishd/cache/cache_hash.c b/bin/varnishd/cache/cache_hash.c
index 6d70f55..b666d07 100644
--- a/bin/varnishd/cache/cache_hash.c
+++ b/bin/varnishd/cache/cache_hash.c
@@ -435,8 +435,8 @@ HSH_Lookup(struct req *req, struct objcore **ocp, struct objcore **bocp,
 			assert(oh->refcnt > 1);
 			assert(oc->objhead == oh);
 			oc->refcnt++;
-			if (oh->hits < LONG_MAX)
-				oh->hits++;
+			if (oc->hits < LONG_MAX)
+				oc->hits++;
 			Lck_Unlock(&oh->mtx);
 			assert(HSH_DerefObjHead(&wrk->stats, &oh));
 			*ocp = oc;
@@ -464,8 +464,8 @@ HSH_Lookup(struct req *req, struct objcore **ocp, struct objcore **bocp,
 			AZ(req->hash_ignore_busy);
 			retval = HSH_EXP;
 		}
-		if (oh->hits < LONG_MAX)
-			oh->hits++;
+		if (exp_oc->hits < LONG_MAX)
+			exp_oc->hits++;
 		Lck_Unlock(&oh->mtx);
 		if (retval == HSH_EXP)
 			assert(HSH_DerefObjHead(&wrk->stats, &oh));
@@ -520,6 +520,7 @@ hsh_rush(struct dstat *ds, struct objhead *oh)
 {
 	unsigned u;
 	struct req *req;
+	struct sess *sp;
 	struct waitinglist *wl;
 
 	CHECK_OBJ_NOTNULL(oh, OBJHEAD_MAGIC);
@@ -535,8 +536,29 @@ hsh_rush(struct dstat *ds, struct objhead *oh)
 		AZ(req->wrk);
 		VTAILQ_REMOVE(&wl->list, req, w_list);
 		DSL(DBG_WAITINGLIST, req->vsl->wid, "off waiting list");
-		if (SES_ScheduleReq(req))
-            break;
+		if (SES_ScheduleReq(req)) {
+			/*
+			 * In case of overloads, we ditch the entire
+			 * waiting list.
+			 */
+			while (1) {
+				AN (req->vcl);
+				VCL_Rel(&req->vcl);
+				sp = req->sp;
+				CHECK_OBJ_NOTNULL(sp, SESS_MAGIC);
+				CNT_AcctLogCharge(ds, req);
+				SES_ReleaseReq(req);
+				SES_Delete(sp, SC_OVERLOAD, NAN);
+				req = VTAILQ_FIRST(&wl->list);
+				if (req == NULL)
+					break;
+				CHECK_OBJ_NOTNULL(req, REQ_MAGIC);
+				VTAILQ_REMOVE(&wl->list, req, w_list);
+				DSL(DBG_WAITINGLIST, req->vsl->wid,
+				    "kill from waiting list");
+			}
+			break;
+		}
 	}
 	if (VTAILQ_EMPTY(&wl->list)) {
 		oh->waitinglist = NULL;
diff --git a/bin/varnishd/cache/cache_http.c b/bin/varnishd/cache/cache_http.c
index 159751b..c00f330 100644
--- a/bin/varnishd/cache/cache_http.c
+++ b/bin/varnishd/cache/cache_http.c
@@ -493,12 +493,13 @@ http_GetHdrField(const struct http *hp, const char *hdr,
  */
 
 enum sess_close
-http_DoConnection(const struct http *hp)
+http_DoConnection(struct http *hp)
 {
 	char *p, *q;
 	enum sess_close ret;
 	unsigned u;
 
+	http_CollectHdr(hp, H_Connection);
 	if (!http_GetHdr(hp, H_Connection, &p)) {
 		if (hp->protover < 11)
 			return (SC_REQ_HTTP10);
@@ -517,6 +518,17 @@ http_DoConnection(const struct http *hp)
 		u = pdiff(p, q);
 		if (u == 5 && !strncasecmp(p, "close", u))
 			ret = SC_REQ_CLOSE;
+
+		/* Refuse removal of well-known-headers if they would pass. */
+/*lint -save -e506 */
+#define HTTPH(a, x, c)						\
+		if (!((c) & HTTPH_R_PASS) &&			\
+		    strlen(a) == u && !strncasecmp(a, p, u))	\
+				return (SC_RX_BAD);
+#include "tbl/http_headers.h"
+#undef HTTPH
+/*lint -restore */
+
 		u = http_findhdr(hp, u, p);
 		if (u != 0)
 			hp->hdf[u] |= HDF_FILTER;
diff --git a/bin/varnishd/cache/cache_http1_deliver.c b/bin/varnishd/cache/cache_http1_deliver.c
index 73aea69..e0a9618 100644
--- a/bin/varnishd/cache/cache_http1_deliver.c
+++ b/bin/varnishd/cache/cache_http1_deliver.c
@@ -101,14 +101,12 @@ v1d_dorange(struct req *req, struct busyobj *bo, const char *r)
 	else
 		len = req->obj->len;
 
-	if (strncmp(r, "bytes=", 6))
+	if (strncasecmp(r, "bytes=", 6))
 		return;
 	r += 6;
 
 	/* The low end of range */
 	has_low = low = 0;
-	if (!vct_isdigit(*r) && *r != '-')
-		return;
 	while (vct_isdigit(*r)) {
 		has_low = 1;
 		low *= 10;
@@ -116,9 +114,6 @@ v1d_dorange(struct req *req, struct busyobj *bo, const char *r)
 		r++;
 	}
 
-	if (low >= len)
-		return;
-
 	if (*r != '-')
 		return;
 	r++;
@@ -131,22 +126,31 @@ v1d_dorange(struct req *req, struct busyobj *bo, const char *r)
 			high += *r - '0';
 			r++;
 		}
+		if (high < low)
+			return;
 		if (!has_low) {
 			low = len - high;
 			if (low < 0)
 				low = 0;
 			high = len - 1;
-		}
-	} else
+		} else if (high >= len)
+			high = len - 1;
+	} else if (has_low)
 		high = len - 1;
-	if (*r != '\0')
+	else
 		return;
 
-	if (high >= len)
-		high = len - 1;
+	if (*r != '\0')
+		return;
 
-	if (low > high)
+	if (low >= len) {
+		http_PrintfHeader(req->resp, "Content-Range: bytes */%jd",
+		    (intmax_t)len);
+		http_Unset(req->resp, H_Content_Length);
+		http_PutResponse(req->resp, "HTTP/1.1", 416, NULL);
+		req->wantbody = 0;
 		return;
+	}
 
 	http_PrintfHeader(req->resp, "Content-Range: bytes %jd-%jd/%jd",
 	    (intmax_t)low, (intmax_t)high, (intmax_t)len);
@@ -240,29 +244,23 @@ V1D_Deliver(struct req *req, struct busyobj *bo)
 
 	req->res_mode = 0;
 
-	if (!req->disable_esi && req->obj->esidata != NULL) {
-		/* In ESI mode, we can't know the aggregate length */
-		req->res_mode &= ~RES_LEN;
+	if (!req->disable_esi && req->obj->esidata != NULL)
 		req->res_mode |= RES_ESI;
+
+	if (req->esi_level > 0)
+		req->res_mode |= RES_ESI_CHILD;
+
+	if (req->res_mode & (RES_ESI_CHILD|RES_ESI)) {
+		/* In ESI mode, we can't know the aggregate length */
+		http_Unset(req->resp, H_Content_Length);
+		RFC2616_Weaken_Etag(req->resp);
 	} else if (req->resp->status == 304) {
-		req->res_mode &= ~RES_LEN;
 		http_Unset(req->resp, H_Content_Length);
 		req->wantbody = 0;
-	} else if (bo == NULL) {
-		/* XXX: Not happy with this convoluted test */
-		req->res_mode |= RES_LEN;
-		if (!(req->obj->objcore->flags & OC_F_PASS) ||
-		    req->obj->len != 0) {
-			http_Unset(req->resp, H_Content_Length);
-			http_PrintfHeader(req->resp,
-			    "Content-Length: %zd", req->obj->len);
-		}
-	}
-
-	if (req->esi_level > 0) {
-		/* Included ESI object, always CHUNKED or EOF */
-		req->res_mode &= ~RES_LEN;
-		req->res_mode |= RES_ESI_CHILD;
+	} else if (bo == NULL &&
+	    !http_GetHdr(req->resp, H_Content_Length, NULL)) {
+		http_PrintfHeader(req->resp, "Content-Length: %zd",
+		    req->obj->len);
 	}
 
 	if (cache_param->http_gzip_support && req->obj->gziped &&
@@ -272,31 +270,25 @@ V1D_Deliver(struct req *req, struct busyobj *bo)
 		 * XXX: we could cache that, but would still deliver
 		 * XXX: with multiple writes because of the gunzip buffer
 		 */
-		req->res_mode &= ~RES_LEN;
 		req->res_mode |= RES_GUNZIP;
+		http_Unset(req->resp, H_Content_Encoding);
+		http_Unset(req->resp, H_Content_Length);
 	}
 
-	if (!(req->res_mode & (RES_LEN|RES_CHUNKED|RES_EOF))) {
-		/* We havn't chosen yet, do so */
-		if (!req->wantbody) {
-			/* Nothing */
-		} else if (req->http->protover >= 11) {
+	if (http_GetHdr(req->resp, H_Content_Length, NULL))
+		req->res_mode |= RES_LEN;
+
+	if (req->wantbody && !(req->res_mode & RES_LEN)) {
+		if (req->http->protover >= 11) {
+			http_SetHeader(req->resp, "Transfer-Encoding: chunked");
 			req->res_mode |= RES_CHUNKED;
 		} else {
 			req->res_mode |= RES_EOF;
 			req->doclose = SC_TX_EOF;
 		}
 	}
-	VSLb(req->vsl, SLT_Debug, "RES_MODE %x", req->res_mode);
-
-	if (!(req->res_mode & RES_LEN))
-		http_Unset(req->resp, H_Content_Length);
-
-	if (req->res_mode & RES_GUNZIP)
-		http_Unset(req->resp, H_Content_Encoding);
 
-	if (req->res_mode & RES_CHUNKED)
-		http_SetHeader(req->resp, "Transfer-Encoding: chunked");
+	VSLb(req->vsl, SLT_Debug, "RES_MODE %x", req->res_mode);
 
 	http_SetHeader(req->resp,
 	    req->doclose ? "Connection: close" : "Connection: keep-alive");
@@ -314,9 +306,6 @@ V1D_Deliver(struct req *req, struct busyobj *bo)
 			v1d_dorange(req, bo, r);
 	}
 
-	if (req->res_mode & RES_ESI)
-		RFC2616_Weaken_Etag(req->resp);
-
 	WRW_Reserve(req->wrk, &req->sp->fd, req->vsl, req->t_prev);
 
 	/*
@@ -325,6 +314,9 @@ V1D_Deliver(struct req *req, struct busyobj *bo)
 	if (!(req->res_mode & RES_ESI_CHILD))
 		req->resp_hdrbytes +=
 		    HTTP1_Write(req->wrk, req->resp, HTTP1_Resp);
+	if (DO_DEBUG(DBG_FLUSH_HEAD)) {
+		(void)WRW_Flush(req->wrk);
+	}
 
 	if (req->res_mode & RES_CHUNKED)
 		WRW_Chunked(req->wrk);
@@ -366,51 +358,35 @@ V1D_Deliver(struct req *req, struct busyobj *bo)
 void
 V1D_Deliver_Synth(struct req *req)
 {
-	char *r;
 
 	CHECK_OBJ_NOTNULL(req, REQ_MAGIC);
 	AZ(req->obj);
 	AN(req->synth_body);
 
 	req->res_mode = 0;
-	if (req->resp->status == 304) {
-		req->res_mode &= ~RES_LEN;
-		http_Unset(req->resp, H_Content_Length);
+
+	http_Unset(req->resp, H_Content_Length);
+	if (req->esi_level > 0) {
+		req->res_mode |= RES_ESI_CHILD;
+	} else if (req->resp->status == 304) {
 		req->wantbody = 0;
 	} else {
-		req->res_mode |= RES_LEN;
-		http_Unset(req->resp, H_Content_Length);
 		http_PrintfHeader(req->resp, "Content-Length: %zd",
 		    VSB_len(req->synth_body));
+		req->res_mode |= RES_LEN;
 	}
 
-	if (req->esi_level > 0) {
-		/* Included ESI object, always CHUNKED or EOF */
-		req->res_mode &= ~RES_LEN;
-		req->res_mode |= RES_ESI_CHILD;
-	}
-
-	if (!(req->res_mode & (RES_LEN|RES_CHUNKED|RES_EOF))) {
-		/* We havn't chosen yet, do so */
-		if (!req->wantbody) {
-			/* Nothing */
-		} else if (req->http->protover >= 11) {
+	if (req->wantbody && !(req->res_mode & RES_LEN)) {
+		if (req->http->protover >= 11) {
+			http_SetHeader(req->resp, "Transfer-Encoding: chunked");
 			req->res_mode |= RES_CHUNKED;
 		} else {
 			req->res_mode |= RES_EOF;
 			req->doclose = SC_TX_EOF;
 		}
 	}
-	VSLb(req->vsl, SLT_Debug, "RES_MODE %x", req->res_mode);
-
-	if (!(req->res_mode & RES_LEN))
-		http_Unset(req->resp, H_Content_Length);
 
-	if (req->res_mode & RES_GUNZIP)
-		http_Unset(req->resp, H_Content_Encoding);
-
-	if (req->res_mode & RES_CHUNKED)
-		http_SetHeader(req->resp, "Transfer-Encoding: chunked");
+	VSLb(req->vsl, SLT_Debug, "RES_MODE %x", req->res_mode);
 
 	http_SetHeader(req->resp,
 	    req->doclose ? "Connection: close" : "Connection: keep-alive");
@@ -418,16 +394,6 @@ V1D_Deliver_Synth(struct req *req)
 	req->vdps[0] = v1d_bytes;
 	req->vdp_nxt = 0;
 
-	if (
-	    req->wantbody &&
-	    !(req->res_mode & RES_ESI_CHILD) &&
-	    cache_param->http_range_support &&
-	    http_GetStatus(req->resp) == 200) {
-		http_SetHeader(req->resp, "Accept-Ranges: bytes");
-		if (http_GetHdr(req->http, H_Range, &r))
-			v1d_dorange(req, NULL, r);
-	}
-
 	WRW_Reserve(req->wrk, &req->sp->fd, req->vsl, req->t_prev);
 
 	/*
@@ -436,6 +402,9 @@ V1D_Deliver_Synth(struct req *req)
 	if (!(req->res_mode & RES_ESI_CHILD))
 		req->resp_hdrbytes +=
 		    HTTP1_Write(req->wrk, req->resp, HTTP1_Resp);
+	if (DO_DEBUG(DBG_FLUSH_HEAD)) {
+		(void)WRW_Flush(req->wrk);
+	}
 
 	if (req->res_mode & RES_CHUNKED)
 		WRW_Chunked(req->wrk);
diff --git a/bin/varnishd/cache/cache_http1_fsm.c b/bin/varnishd/cache/cache_http1_fsm.c
index a75dfa6..b398dc2 100644
--- a/bin/varnishd/cache/cache_http1_fsm.c
+++ b/bin/varnishd/cache/cache_http1_fsm.c
@@ -151,20 +151,9 @@ http1_wait(struct sess *sp, struct worker *wrk, struct req *req)
 			}
 		} else {
 			/* Working on it */
-			if (isnan(req->t_first)) {
-				/* Let's see if we were already too late before getting these bytes */
-				when = sp->t_idle + cache_param->timeout_idle;
-				if (when < now) {
-					why = SC_RX_TIMEOUT;
-					break;
-				}
-
+			if (isnan(req->t_first))
 				/* Record first byte received time stamp */
 				req->t_first = now;
-			}
-
-			/* We have to receive the full request header in timeout_req from the
-			   first non-whitespace byte */
 			when = req->t_first + cache_param->timeout_req;
 			tmo = (int)(1e3 * (when - now));
 			if (when < now || tmo == 0) {
@@ -387,6 +376,13 @@ http1_dissect(struct worker *wrk, struct req *req)
 	AZ(req->err_code);
 	req->ws_req = WS_Snapshot(req->ws);
 	req->doclose = http_DoConnection(req->http);
+	if (req->doclose == SC_RX_BAD) {
+		r = write(req->sp->fd, r_400, strlen(r_400));
+		if (r > 0)
+			req->acct.resp_hdrbytes += r;
+		SES_Close(req->sp, req->doclose);
+		return (REQ_FSM_DONE);
+	}
 
 	http_Unset(req->http, H_Expect);
 
diff --git a/bin/varnishd/cache/cache_main.c b/bin/varnishd/cache/cache_main.c
index 31d167d..bfa2619 100644
--- a/bin/varnishd/cache/cache_main.c
+++ b/bin/varnishd/cache/cache_main.c
@@ -170,9 +170,9 @@ cli_debug_srandom(struct cli *cli, const char * const *av, void *priv)
 
 static struct cli_proto debug_cmds[] = {
 	{ "debug.xid", "debug.xid",
-		"\tExamine or set XID\n", 0, 1, "d", cli_debug_xid },
+		"\tExamine or set XID.", 0, 1, "d", cli_debug_xid },
 	{ "debug.srandom", "debug.srandom",
-		"\tSeed the random(3) function\n", 0, 1, "d",
+		"\tSeed the random(3) function.", 0, 1, "d",
 		cli_debug_srandom },
 	{ NULL }
 };
diff --git a/bin/varnishd/cache/cache_panic.c b/bin/varnishd/cache/cache_panic.c
index 575d049..6d97386 100644
--- a/bin/varnishd/cache/cache_panic.c
+++ b/bin/varnishd/cache/cache_panic.c
@@ -37,6 +37,7 @@
 
 #include <stdio.h>
 #include <stdlib.h>
+#include <signal.h>
 
 #include "cache.h"
 #include "common/heritage.h"
@@ -340,7 +341,7 @@ pan_req(const struct req *req)
 		    "  err_code = %d, err_reason = %s,\n", req->err_code,
 		    req->err_reason ? req->err_reason : "(null)");
 
-	VSB_printf(pan_vsp, "  restarts = %d, esi_level = %d\n",
+	VSB_printf(pan_vsp, "  restarts = %d, esi_level = %d,\n",
 	    req->restarts, req->esi_level);
 
 	if (req->sp != NULL)
@@ -429,10 +430,21 @@ pan_ic(const char *func, const char *file, int line, const char *cond,
 	const char *q;
 	struct req *req;
 	struct busyobj *bo;
+	struct sigaction sa;
 
 	AZ(pthread_mutex_lock(&panicstr_mtx)); /* Won't be released,
 						  we're going to die
 						  anyway */
+
+	/*
+	 * should we trigger a SIGSEGV while handling a panic, our sigsegv
+	 * handler would hide the panic, so we need to reset the handler to
+	 * default
+	 */
+	memset(&sa, 0, sizeof sa);
+	sa.sa_handler = SIG_DFL;
+	(void)sigaction(SIGSEGV, &sa, NULL);
+
 	switch(kind) {
 	case VAS_WRONG:
 		VSB_printf(pan_vsp,
@@ -468,6 +480,7 @@ pan_ic(const char *func, const char *file, int line, const char *cond,
 	if (q != NULL)
 		VSB_printf(pan_vsp, "thread = (%s)\n", q);
 
+	VSB_printf(pan_vsp, "version = %s\n", VCS_version);
 	VSB_printf(pan_vsp, "ident = %s,%s\n",
 	    VSB_data(vident) + 1, WAIT_GetName());
 
diff --git a/bin/varnishd/cache/cache_req_fsm.c b/bin/varnishd/cache/cache_req_fsm.c
index 9d07f46..40551f7 100644
--- a/bin/varnishd/cache/cache_req_fsm.c
+++ b/bin/varnishd/cache/cache_req_fsm.c
@@ -108,11 +108,11 @@ cnt_deliver(struct worker *wrk, struct req *req)
 
 	if (req->wrk->stats.cache_hit)
 		http_PrintfHeader(req->resp,
-		    "X-Rev-Id: %u %u", req->vsl->wid & VSL_IDENTMASK,
+		    "X-Varnish: %u %u", req->vsl->wid & VSL_IDENTMASK,
 		    req->obj->vxid & VSL_IDENTMASK);
 	else
 		http_PrintfHeader(req->resp,
-		    "X-Rev-Id: %u", req->vsl->wid & VSL_IDENTMASK);
+		    "X-Varnish: %u", req->vsl->wid & VSL_IDENTMASK);
 
 	/* We base Age calculation upon the last timestamp taken during
 	   client request processing. This gives some inaccuracy, but
@@ -124,7 +124,7 @@ cnt_deliver(struct worker *wrk, struct req *req)
 	http_PrintfHeader(req->resp, "Age: %.0f",
 	    fmax(0., req->t_prev - req->obj->exp.t_origin));
 
-	http_SetHeader(req->resp, "Via: 1.1 rev-cache");
+	http_SetHeader(req->resp, "Via: 1.1 varnish-v4");
 
 	if (cache_param->http_gzip_support && req->obj->gziped &&
 	    !RFC2616_Req_Gzip(req->http))
@@ -232,7 +232,7 @@ cnt_synth(struct worker *wrk, struct req *req)
 	http_PrintfHeader(h, "Date: %s", date);
 	http_SetHeader(h, "Server: Varnish");
 	http_PrintfHeader(req->resp,
-	    "X-Rev-Id: %u", req->vsl->wid & VSL_IDENTMASK);
+	    "X-Varnish: %u", req->vsl->wid & VSL_IDENTMASK);
 	http_PutResponse(h, "HTTP/1.1", req->err_code, req->err_reason);
 
 	AZ(req->synth_body);
@@ -426,8 +426,7 @@ cnt_lookup(struct worker *wrk, struct req *req)
 	switch (wrk->handling) {
 	case VCL_RET_DELIVER:
 		if (boc != NULL) {
-			AZ(oc->flags & (OC_F_FAILED|OC_F_PASS));
-			AZ(oc->exp_flags & OC_EF_DYING);
+			AZ(oc->flags & OC_F_PASS);
 			AZ(boc->busyobj);
 			VBF_Fetch(wrk, req, boc, o, VBF_BACKGROUND);
 		} else {
@@ -614,7 +613,7 @@ cnt_pipe(struct worker *wrk, struct req *req)
 	VSLb(bo->vsl, SLT_Begin, "bereq %u pipe", req->vsl->wid & VSL_IDENTMASK);
 	http_FilterReq(bo->bereq, req->http, 0);	// XXX: 0 ?
 	http_PrintfHeader(bo->bereq,
-	    "X-Rev-Id: %u", req->vsl->wid & VSL_IDENTMASK);
+	    "X-Varnish: %u", req->vsl->wid & VSL_IDENTMASK);
 	http_SetHeader(bo->bereq, "Connection: close");
 
 	VCL_pipe_method(req->vcl, wrk, req, bo, req->http->ws);
@@ -628,6 +627,7 @@ cnt_pipe(struct worker *wrk, struct req *req)
 	assert(WRW_IsReleased(wrk));
 	http_Teardown(bo->bereq);
 	VBO_DerefBusyObj(wrk, &bo);
+	THR_SetBusyobj(NULL);
 	return (REQ_FSM_DONE);
 }
 
@@ -723,6 +723,7 @@ cnt_recv(struct worker *wrk, struct req *req)
 		 * This really should be done earlier, but we want to capture
 		 * it in the VSL log.
 		 */
+		http_CollectHdr(req->http, H_X_Forwarded_For);
 		if (http_GetHdr(req->http, H_X_Forwarded_For, &xff)) {
 			http_Unset(req->http, H_X_Forwarded_For);
 			http_PrintfHeader(req->http, "X-Forwarded-For: %s, %s",
diff --git a/bin/varnishd/cache/cache_rfc2616.c b/bin/varnishd/cache/cache_rfc2616.c
index b0ebaf3..f03d32e 100644
--- a/bin/varnishd/cache/cache_rfc2616.c
+++ b/bin/varnishd/cache/cache_rfc2616.c
@@ -89,7 +89,7 @@ RFC2616_Ttl(struct busyobj *bo, double now)
 
 	/*
 	 * Initial cacheability determination per [RFC2616, 13.4]
-	 * We do not support ranges yet, so 206 is out.
+	 * We do not support ranges to the backend yet, so 206 is out.
 	 */
 
 	if (http_GetHdr(hp, H_Age, &p)) {
diff --git a/bin/varnishd/cache/cache_session.c b/bin/varnishd/cache/cache_session.c
index ee7f296..f162e8e 100644
--- a/bin/varnishd/cache/cache_session.c
+++ b/bin/varnishd/cache/cache_session.c
@@ -234,14 +234,7 @@ SES_ScheduleReq(struct req *req)
 	sp->task.func = ses_req_pool_task;
 	sp->task.priv = req;
 
-	if (Pool_Task(pp->pool, &sp->task, POOL_QUEUE_FRONT)) {
-		AN (req->vcl);
-		VCL_Rel(&req->vcl);
-        SES_ReleaseReq(req);
-		SES_Delete(sp, SC_OVERLOAD, NAN);
-		return (1);
-	}
-	return (0);
+	return (Pool_Task(pp->pool, &sp->task, POOL_QUEUE_FRONT));
 }
 
 /*--------------------------------------------------------------------
diff --git a/bin/varnishd/cache/cache_vcl.c b/bin/varnishd/cache/cache_vcl.c
index 2f7c1b9..7a6ac7d 100644
--- a/bin/varnishd/cache/cache_vcl.c
+++ b/bin/varnishd/cache/cache_vcl.c
@@ -381,18 +381,23 @@ ccf_config_show(struct cli *cli, const char * const *av, void *priv)
 	int i;
 
 	(void)priv;
-	if (!strcmp(av[2], "-v")) {
-		verbose = 1;
-		vcl = vcl_find(av[3]);
-	} else if (av[3] != NULL) {
+	if (!strcmp(av[2], "-v") && av[3] == NULL) {
+		VCLI_Out(cli, "Too few parameters");
+		VCLI_SetResult(cli, CLIS_TOOFEW);
+		return;
+	} else if (strcmp(av[2], "-v") && av[3] != NULL) {
 		VCLI_Out(cli, "Unknown options '%s'", av[2]);
 		VCLI_SetResult(cli, CLIS_PARAM);
 		return;
+	} else if (av[3] != NULL) {
+		verbose = 1;
+		vcl = vcl_find(av[3]);
 	} else
 		vcl = vcl_find(av[2]);
 
 	if (vcl == NULL) {
-		VCLI_Out(cli, "No VCL named '%s'", av[2]);
+		VCLI_Out(cli, "No VCL named '%s'",
+		    av[3] == NULL ? av[2] : av[3]);
 		VCLI_SetResult(cli, CLIS_PARAM);
 		return;
 	}
diff --git a/bin/varnishd/cache/cache_vrt.c b/bin/varnishd/cache/cache_vrt.c
index 4ffb51a..cdeba66 100644
--- a/bin/varnishd/cache/cache_vrt.c
+++ b/bin/varnishd/cache/cache_vrt.c
@@ -52,7 +52,7 @@ const void * const vrt_magic_string_unset = &vrt_magic_string_unset;
 /*--------------------------------------------------------------------*/
 
 void
-VRT_error(const struct vrt_ctx *ctx, unsigned code, const char *reason)
+VRT_error(VRT_CTX, unsigned code, const char *reason)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -69,7 +69,7 @@ VRT_error(const struct vrt_ctx *ctx, unsigned code, const char *reason)
 /*--------------------------------------------------------------------*/
 
 void
-VRT_count(const struct vrt_ctx *ctx, unsigned u)
+VRT_count(VRT_CTX, unsigned u)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -81,7 +81,7 @@ VRT_count(const struct vrt_ctx *ctx, unsigned u)
 /*--------------------------------------------------------------------*/
 
 void
-VRT_acl_log(const struct vrt_ctx *ctx, const char *msg)
+VRT_acl_log(VRT_CTX, const char *msg)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -91,7 +91,7 @@ VRT_acl_log(const struct vrt_ctx *ctx, const char *msg)
 /*--------------------------------------------------------------------*/
 
 static struct http *
-vrt_selecthttp(const struct vrt_ctx *ctx, enum gethdr_e where)
+vrt_selecthttp(VRT_CTX, enum gethdr_e where)
 {
 	struct http *hp;
 
@@ -121,7 +121,7 @@ vrt_selecthttp(const struct vrt_ctx *ctx, enum gethdr_e where)
 /*--------------------------------------------------------------------*/
 
 char *
-VRT_GetHdr(const struct vrt_ctx *ctx, const struct gethdr_s *hs)
+VRT_GetHdr(VRT_CTX, const struct gethdr_s *hs)
 {
 	char *p;
 	struct http *hp;
@@ -199,7 +199,7 @@ VRT_String(struct ws *ws, const char *h, const char *p, va_list ap)
  */
 
 const char *
-VRT_CollectString(const struct vrt_ctx *ctx, const char *p, ...)
+VRT_CollectString(VRT_CTX, const char *p, ...)
 {
 	va_list ap;
 	const char *b;
@@ -215,7 +215,7 @@ VRT_CollectString(const struct vrt_ctx *ctx, const char *p, ...)
 /*--------------------------------------------------------------------*/
 
 void
-VRT_SetHdr(const struct vrt_ctx *ctx , const struct gethdr_s *hs,
+VRT_SetHdr(VRT_CTX , const struct gethdr_s *hs,
     const char *p, ...)
 {
 	struct http *hp;
@@ -245,7 +245,7 @@ VRT_SetHdr(const struct vrt_ctx *ctx , const struct gethdr_s *hs,
 /*--------------------------------------------------------------------*/
 
 void
-VRT_handling(const struct vrt_ctx *ctx, unsigned hand)
+VRT_handling(VRT_CTX, unsigned hand)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -258,7 +258,7 @@ VRT_handling(const struct vrt_ctx *ctx, unsigned hand)
  */
 
 void
-VRT_hashdata(const struct vrt_ctx *ctx, const char *str, ...)
+VRT_hashdata(VRT_CTX, const char *str, ...)
 {
 	va_list ap;
 	const char *p;
@@ -285,7 +285,7 @@ VRT_hashdata(const struct vrt_ctx *ctx, const char *str, ...)
 /*--------------------------------------------------------------------*/
 
 double
-VRT_r_now(const struct vrt_ctx *ctx)
+VRT_r_now(VRT_CTX)
 {
 
 	(void)ctx;
@@ -295,7 +295,7 @@ VRT_r_now(const struct vrt_ctx *ctx)
 /*--------------------------------------------------------------------*/
 
 char *
-VRT_IP_string(const struct vrt_ctx *ctx, VCL_IP ip)
+VRT_IP_string(VRT_CTX, VCL_IP ip)
 {
 	char *p;
 	unsigned len;
@@ -315,7 +315,7 @@ VRT_IP_string(const struct vrt_ctx *ctx, VCL_IP ip)
 }
 
 char *
-VRT_INT_string(const struct vrt_ctx *ctx, long num)
+VRT_INT_string(VRT_CTX, long num)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -323,7 +323,7 @@ VRT_INT_string(const struct vrt_ctx *ctx, long num)
 }
 
 char *
-VRT_REAL_string(const struct vrt_ctx *ctx, double num)
+VRT_REAL_string(VRT_CTX, double num)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -331,7 +331,7 @@ VRT_REAL_string(const struct vrt_ctx *ctx, double num)
 }
 
 char *
-VRT_TIME_string(const struct vrt_ctx *ctx, double t)
+VRT_TIME_string(VRT_CTX, double t)
 {
 	char *p;
 
@@ -361,7 +361,7 @@ VRT_BOOL_string(unsigned val)
 /*--------------------------------------------------------------------*/
 
 void
-VRT_Rollback(const struct vrt_ctx *ctx, const struct http *hp)
+VRT_Rollback(VRT_CTX, const struct http *hp)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -382,7 +382,7 @@ VRT_Rollback(const struct vrt_ctx *ctx, const struct http *hp)
 /*--------------------------------------------------------------------*/
 
 void
-VRT_synth_page(const struct vrt_ctx *ctx, const char *str, ...)
+VRT_synth_page(VRT_CTX, const char *str, ...)
 {
 	va_list ap;
 	const char *p;
@@ -412,7 +412,7 @@ VRT_synth_page(const struct vrt_ctx *ctx, const char *str, ...)
 /*--------------------------------------------------------------------*/
 
 void
-VRT_ban_string(const struct vrt_ctx *ctx, const char *str)
+VRT_ban_string(VRT_CTX, const char *str)
 {
 	char *a1, *a2, *a3;
 	char **av;
@@ -479,7 +479,7 @@ VRT_ban_string(const struct vrt_ctx *ctx, const char *str)
  */
 
 int
-VRT_CacheReqBody(const struct vrt_ctx *ctx, long long maxsize)
+VRT_CacheReqBody(VRT_CTX, long long maxsize)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -497,7 +497,7 @@ VRT_CacheReqBody(const struct vrt_ctx *ctx, long long maxsize)
  */
 
 void
-VRT_purge(const struct vrt_ctx *ctx, double ttl, double grace, double keep)
+VRT_purge(VRT_CTX, double ttl, double grace, double keep)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
diff --git a/bin/varnishd/cache/cache_vrt_re.c b/bin/varnishd/cache/cache_vrt_re.c
index d0ecb78..0695633 100644
--- a/bin/varnishd/cache/cache_vrt_re.c
+++ b/bin/varnishd/cache/cache_vrt_re.c
@@ -62,7 +62,7 @@ VRT_re_fini(void *rep)
 }
 
 int
-VRT_re_match(const struct vrt_ctx *ctx, const char *s, void *re)
+VRT_re_match(VRT_CTX, const char *s, void *re)
 {
 	vre_t *t;
 	int i;
@@ -81,7 +81,7 @@ VRT_re_match(const struct vrt_ctx *ctx, const char *s, void *re)
 }
 
 const char *
-VRT_regsub(const struct vrt_ctx *ctx, int all, const char *str, void *re,
+VRT_regsub(VRT_CTX, int all, const char *str, void *re,
     const char *sub)
 {
 	int ovector[30];
@@ -92,6 +92,7 @@ VRT_regsub(const struct vrt_ctx *ctx, int all, const char *str, void *re,
 	const char *s;
 	unsigned u, x;
 	int options = 0;
+	int offset = 0;
 	size_t len;
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -120,7 +121,7 @@ VRT_regsub(const struct vrt_ctx *ctx, int all, const char *str, void *re,
 
 	do {
 		/* Copy prefix to match */
-		Tadd(&res, str, ovector[0]);
+		Tadd(&res, str + offset, ovector[0] - offset);
 		for (s = sub ; *s != '\0'; s++ ) {
 			if (*s != '\\' || s[1] == '\0') {
 				if (res.b < res.e)
@@ -138,13 +139,12 @@ VRT_regsub(const struct vrt_ctx *ctx, int all, const char *str, void *re,
 					*res.b++ = *s;
 			}
 		}
-		str += ovector[1];
-		len -= ovector[1];
+		offset = ovector[1];
 		if (!all)
 			break;
 		memset(&ovector, 0, sizeof(ovector));
 		options |= VRE_NOTEMPTY;
-		i = VRE_exec(t, str, len, 0, options, ovector, 30,
+		i = VRE_exec(t, str, len, offset, options, ovector, 30,
 		    &cache_param->vre_limits);
 		if (i < VRE_ERROR_NOMATCH ) {
 			WS_Release(ctx->ws, 0);
@@ -155,7 +155,7 @@ VRT_regsub(const struct vrt_ctx *ctx, int all, const char *str, void *re,
 	} while (i != VRE_ERROR_NOMATCH);
 
 	/* Copy suffix to match */
-	Tadd(&res, str, len+1);
+	Tadd(&res, str + offset, len - offset + 1);
 	if (res.b >= res.e) {
 		WS_Release(ctx->ws, 0);
 		return (str);
diff --git a/bin/varnishd/cache/cache_vrt_var.c b/bin/varnishd/cache/cache_vrt_var.c
index 47897e1..45614c8 100644
--- a/bin/varnishd/cache/cache_vrt_var.c
+++ b/bin/varnishd/cache/cache_vrt_var.c
@@ -68,7 +68,7 @@ vrt_do_string(struct http *hp, int fld,
 
 #define VRT_HDR_L(obj, hdr, fld)					\
 void									\
-VRT_l_##obj##_##hdr(const struct vrt_ctx *ctx, const char *p, ...)	\
+VRT_l_##obj##_##hdr(VRT_CTX, const char *p, ...)	\
 {									\
 	va_list ap;							\
 									\
@@ -80,7 +80,7 @@ VRT_l_##obj##_##hdr(const struct vrt_ctx *ctx, const char *p, ...)	\
 
 #define VRT_HDR_R(obj, hdr, fld)					\
 const char *								\
-VRT_r_##obj##_##hdr(const struct vrt_ctx *ctx)				\
+VRT_r_##obj##_##hdr(VRT_CTX)				\
 {									\
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);				\
 	CHECK_OBJ_NOTNULL(ctx->http_##obj, HTTP_MAGIC);			\
@@ -93,7 +93,7 @@ VRT_r_##obj##_##hdr(const struct vrt_ctx *ctx)				\
 
 #define VRT_STATUS_L(obj)						\
 void									\
-VRT_l_##obj##_status(const struct vrt_ctx *ctx, long num)		\
+VRT_l_##obj##_status(VRT_CTX, long num)		\
 {									\
 									\
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);				\
@@ -112,7 +112,7 @@ VRT_l_##obj##_status(const struct vrt_ctx *ctx, long num)		\
 
 #define VRT_STATUS_R(obj)						\
 long									\
-VRT_r_##obj##_status(const struct vrt_ctx *ctx)				\
+VRT_r_##obj##_status(VRT_CTX)				\
 {									\
 									\
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);				\
@@ -148,7 +148,7 @@ VRT_STATUS_R(beresp)
 #define VBERESPW0(field)
 #define VBERESPW1(field)						\
 void									\
-VRT_l_beresp_##field(const struct vrt_ctx *ctx, unsigned a)		\
+VRT_l_beresp_##field(VRT_CTX, unsigned a)		\
 {									\
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);				\
 	CHECK_OBJ_NOTNULL(ctx->bo, BUSYOBJ_MAGIC);			\
@@ -158,7 +158,7 @@ VRT_l_beresp_##field(const struct vrt_ctx *ctx, unsigned a)		\
 #define VBERESPR0(field)
 #define VBERESPR1(field)						\
 unsigned								\
-VRT_r_beresp_##field(const struct vrt_ctx *ctx)				\
+VRT_r_beresp_##field(VRT_CTX)				\
 {									\
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);				\
 	CHECK_OBJ_NOTNULL(ctx->bo, BUSYOBJ_MAGIC);			\
@@ -173,22 +173,8 @@ VRT_r_beresp_##field(const struct vrt_ctx *ctx)				\
 
 /*--------------------------------------------------------------------*/
 
-void
-VRT_l_bereq_uncacheable(const struct vrt_ctx *ctx, unsigned a)
-{
-	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
-	CHECK_OBJ_NOTNULL(ctx->bo, BUSYOBJ_MAGIC);
-
-	if (ctx->bo->do_pass && !a) {
-		VSLb(ctx->vsl, SLT_VCL_Error,
-		    "Ignoring attempt to reset bereq.uncacheable");
-	} else if (a) {
-		ctx->bo->do_pass = 1;
-	}
-}
-
 unsigned
-VRT_r_bereq_uncacheable(const struct vrt_ctx *ctx)
+VRT_r_bereq_uncacheable(VRT_CTX)
 {
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
 	CHECK_OBJ_NOTNULL(ctx->bo, BUSYOBJ_MAGIC);
@@ -196,7 +182,7 @@ VRT_r_bereq_uncacheable(const struct vrt_ctx *ctx)
 }
 
 void
-VRT_l_beresp_uncacheable(const struct vrt_ctx *ctx, unsigned a)
+VRT_l_beresp_uncacheable(VRT_CTX, unsigned a)
 {
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
 	CHECK_OBJ_NOTNULL(ctx->bo, BUSYOBJ_MAGIC);
@@ -210,7 +196,7 @@ VRT_l_beresp_uncacheable(const struct vrt_ctx *ctx, unsigned a)
 }
 
 unsigned
-VRT_r_beresp_uncacheable(const struct vrt_ctx *ctx)
+VRT_r_beresp_uncacheable(VRT_CTX)
 {
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
 	CHECK_OBJ_NOTNULL(ctx->bo, BUSYOBJ_MAGIC);
@@ -220,7 +206,7 @@ VRT_r_beresp_uncacheable(const struct vrt_ctx *ctx)
 /*--------------------------------------------------------------------*/
 
 const char *
-VRT_r_client_identity(const struct vrt_ctx *ctx)
+VRT_r_client_identity(VRT_CTX)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -232,7 +218,7 @@ VRT_r_client_identity(const struct vrt_ctx *ctx)
 }
 
 void
-VRT_l_client_identity(const struct vrt_ctx *ctx, const char *str, ...)
+VRT_l_client_identity(VRT_CTX, const char *str, ...)
 {
 	va_list ap;
 	const char *b;
@@ -254,7 +240,7 @@ VRT_l_client_identity(const struct vrt_ctx *ctx, const char *str, ...)
 
 #define BEREQ_TIMEOUT(which)					\
 void								\
-VRT_l_bereq_##which(const struct vrt_ctx *ctx, double num)	\
+VRT_l_bereq_##which(VRT_CTX, double num)	\
 {								\
 								\
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);			\
@@ -263,7 +249,7 @@ VRT_l_bereq_##which(const struct vrt_ctx *ctx, double num)	\
 }								\
 								\
 double								\
-VRT_r_bereq_##which(const struct vrt_ctx *ctx)			\
+VRT_r_bereq_##which(VRT_CTX)			\
 {								\
 								\
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);			\
@@ -278,7 +264,7 @@ BEREQ_TIMEOUT(between_bytes_timeout)
 /*--------------------------------------------------------------------*/
 
 const char *
-VRT_r_beresp_backend_name(const struct vrt_ctx *ctx)
+VRT_r_beresp_backend_name(VRT_CTX)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -293,7 +279,7 @@ VRT_r_beresp_backend_name(const struct vrt_ctx *ctx)
 }
 
 VCL_IP
-VRT_r_beresp_backend_ip(const struct vrt_ctx *ctx)
+VRT_r_beresp_backend_ip(VRT_CTX)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -308,7 +294,7 @@ VRT_r_beresp_backend_ip(const struct vrt_ctx *ctx)
 /*--------------------------------------------------------------------*/
 
 const char *
-VRT_r_beresp_storage_hint(const struct vrt_ctx *ctx)
+VRT_r_beresp_storage_hint(VRT_CTX)
 {
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
 	CHECK_OBJ_NOTNULL(ctx->bo, BUSYOBJ_MAGIC);
@@ -319,7 +305,7 @@ VRT_r_beresp_storage_hint(const struct vrt_ctx *ctx)
 }
 
 void
-VRT_l_beresp_storage_hint(const struct vrt_ctx *ctx, const char *str, ...)
+VRT_l_beresp_storage_hint(VRT_CTX, const char *str, ...)
 {
 	va_list ap;
 	const char *b;
@@ -342,7 +328,7 @@ VRT_l_beresp_storage_hint(const struct vrt_ctx *ctx, const char *str, ...)
 #define REQ_VAR_L(nm, elem, type,extra)					\
 									\
 void									\
-VRT_l_req_##nm(const struct vrt_ctx *ctx, type arg)			\
+VRT_l_req_##nm(VRT_CTX, type arg)			\
 {									\
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);				\
 	CHECK_OBJ_NOTNULL(ctx->req, REQ_MAGIC);				\
@@ -353,7 +339,7 @@ VRT_l_req_##nm(const struct vrt_ctx *ctx, type arg)			\
 #define REQ_VAR_R(nm, elem, type)					\
 									\
 type									\
-VRT_r_req_##nm(const struct vrt_ctx *ctx)				\
+VRT_r_req_##nm(VRT_CTX)				\
 {									\
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);				\
 	CHECK_OBJ_NOTNULL(ctx->req, REQ_MAGIC);				\
@@ -368,7 +354,7 @@ REQ_VAR_R(ttl, d_ttl, double)
 /*--------------------------------------------------------------------*/
 
 void
-VRT_l_bereq_backend(const struct vrt_ctx *ctx, struct director *be)
+VRT_l_bereq_backend(VRT_CTX, struct director *be)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -377,7 +363,7 @@ VRT_l_bereq_backend(const struct vrt_ctx *ctx, struct director *be)
 }
 
 struct director *
-VRT_r_bereq_backend(const struct vrt_ctx *ctx)
+VRT_r_bereq_backend(VRT_CTX)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -388,7 +374,7 @@ VRT_r_bereq_backend(const struct vrt_ctx *ctx)
 /*--------------------------------------------------------------------*/
 
 void
-VRT_l_req_esi(const struct vrt_ctx *ctx, unsigned process_esi)
+VRT_l_req_esi(VRT_CTX, unsigned process_esi)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -402,7 +388,7 @@ VRT_l_req_esi(const struct vrt_ctx *ctx, unsigned process_esi)
 }
 
 unsigned
-VRT_r_req_esi(const struct vrt_ctx *ctx)
+VRT_r_req_esi(VRT_CTX)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -411,7 +397,7 @@ VRT_r_req_esi(const struct vrt_ctx *ctx)
 }
 
 long
-VRT_r_req_esi_level(const struct vrt_ctx *ctx)
+VRT_r_req_esi_level(VRT_CTX)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -422,7 +408,7 @@ VRT_r_req_esi_level(const struct vrt_ctx *ctx)
 /*--------------------------------------------------------------------*/
 
 unsigned
-VRT_r_req_can_gzip(const struct vrt_ctx *ctx)
+VRT_r_req_can_gzip(VRT_CTX)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -433,7 +419,7 @@ VRT_r_req_can_gzip(const struct vrt_ctx *ctx)
 /*--------------------------------------------------------------------*/
 
 long
-VRT_r_req_restarts(const struct vrt_ctx *ctx)
+VRT_r_req_restarts(VRT_CTX)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -442,7 +428,7 @@ VRT_r_req_restarts(const struct vrt_ctx *ctx)
 }
 
 long
-VRT_r_bereq_retries(const struct vrt_ctx *ctx)
+VRT_r_bereq_retries(VRT_CTX)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -458,7 +444,7 @@ VRT_r_bereq_retries(const struct vrt_ctx *ctx)
 #define VRT_DO_EXP_L(which, sexp, fld)				\
 								\
 void								\
-VRT_l_##which##_##fld(const struct vrt_ctx *ctx, double a)	\
+VRT_l_##which##_##fld(VRT_CTX, double a)	\
 {								\
 								\
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);			\
@@ -472,7 +458,7 @@ VRT_l_##which##_##fld(const struct vrt_ctx *ctx, double a)	\
 #define VRT_DO_EXP_R(which, sexp, fld, offset)			\
 								\
 double								\
-VRT_r_##which##_##fld(const struct vrt_ctx *ctx)		\
+VRT_r_##which##_##fld(VRT_CTX)		\
 {								\
 								\
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);			\
@@ -498,7 +484,7 @@ VRT_DO_EXP_R(beresp, ctx->bo->exp, keep, 0)
  */
 
 const char *
-VRT_r_req_xid(const struct vrt_ctx *ctx)
+VRT_r_req_xid(VRT_CTX)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -509,7 +495,7 @@ VRT_r_req_xid(const struct vrt_ctx *ctx)
 }
 
 const char *
-VRT_r_bereq_xid(const struct vrt_ctx *ctx)
+VRT_r_bereq_xid(VRT_CTX)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -523,7 +509,7 @@ VRT_r_bereq_xid(const struct vrt_ctx *ctx)
 
 #define REQ_BOOL(hash_var)					\
 void								\
-VRT_l_req_##hash_var(const struct vrt_ctx *ctx, unsigned val)	\
+VRT_l_req_##hash_var(VRT_CTX, unsigned val)	\
 {								\
 								\
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);			\
@@ -532,7 +518,7 @@ VRT_l_req_##hash_var(const struct vrt_ctx *ctx, unsigned val)	\
 }								\
 								\
 unsigned							\
-VRT_r_req_##hash_var(const struct vrt_ctx *ctx)			\
+VRT_r_req_##hash_var(VRT_CTX)			\
 {								\
 								\
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);			\
@@ -546,7 +532,7 @@ REQ_BOOL(hash_always_miss)
 /*--------------------------------------------------------------------*/
 
 VCL_IP
-VRT_r_client_ip(const struct vrt_ctx *ctx)
+VRT_r_client_ip(VRT_CTX)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -556,7 +542,7 @@ VRT_r_client_ip(const struct vrt_ctx *ctx)
 }
 
 VCL_IP
-VRT_r_server_ip(const struct vrt_ctx *ctx)
+VRT_r_server_ip(VRT_CTX)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -566,7 +552,7 @@ VRT_r_server_ip(const struct vrt_ctx *ctx)
 }
 
 const char*
-VRT_r_server_identity(const struct vrt_ctx *ctx)
+VRT_r_server_identity(VRT_CTX)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -577,7 +563,7 @@ VRT_r_server_identity(const struct vrt_ctx *ctx)
 }
 
 const char*
-VRT_r_server_hostname(const struct vrt_ctx *ctx)
+VRT_r_server_hostname(VRT_CTX)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -589,18 +575,17 @@ VRT_r_server_hostname(const struct vrt_ctx *ctx)
 /*--------------------------------------------------------------------*/
 
 long
-VRT_r_obj_hits(const struct vrt_ctx *ctx)
+VRT_r_obj_hits(VRT_CTX)
 {
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
 	CHECK_OBJ_NOTNULL(ctx->req, REQ_MAGIC);
 	CHECK_OBJ_NOTNULL(ctx->req->obj, OBJECT_MAGIC);
 	CHECK_OBJ_NOTNULL(ctx->req->obj->objcore, OBJCORE_MAGIC);
-	CHECK_OBJ_NOTNULL(ctx->req->obj->objcore->objhead, OBJHEAD_MAGIC);
-	return (ctx->req->obj->objcore->objhead->hits);
+	return (ctx->req->obj->objcore->hits);
 }
 
 unsigned
-VRT_r_obj_uncacheable(const struct vrt_ctx *ctx)
+VRT_r_obj_uncacheable(VRT_CTX)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -613,7 +598,7 @@ VRT_r_obj_uncacheable(const struct vrt_ctx *ctx)
 
 #define HTTP_VAR(x)						\
 struct http *							\
-VRT_r_##x(const struct vrt_ctx *ctx)				\
+VRT_r_##x(VRT_CTX)				\
 {								\
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);			\
 	CHECK_OBJ_NOTNULL(ctx->http_##x, HTTP_MAGIC);		\
diff --git a/bin/varnishd/cache/cache_vrt_vmod.c b/bin/varnishd/cache/cache_vrt_vmod.c
index a2dc7c0..232bdd4 100644
--- a/bin/varnishd/cache/cache_vrt_vmod.c
+++ b/bin/varnishd/cache/cache_vrt_vmod.c
@@ -179,7 +179,7 @@ ccf_debug_vmod(struct cli *cli, const char * const *av, void *priv)
 }
 
 static struct cli_proto vcl_cmds[] = {
-	{ "debug.vmod", "debug.vmod", "show loaded vmods", 0, 0,
+	{ "debug.vmod", "debug.vmod", "\tShow loaded vmods.", 0, 0,
 		"d", ccf_debug_vmod },
 	{ NULL }
 };
diff --git a/bin/varnishd/hash/hash_critbit.c b/bin/varnishd/hash/hash_critbit.c
index 4c7e4b5..ff148ba 100644
--- a/bin/varnishd/hash/hash_critbit.c
+++ b/bin/varnishd/hash/hash_critbit.c
@@ -343,7 +343,7 @@ hcb_dump(struct cli *cli, const char * const *av, void *priv)
 }
 
 static struct cli_proto hcb_cmds[] = {
-	{ "hcb.dump", "hcb.dump", "dump HCB tree\n", 0, 0, "d", hcb_dump },
+	{ "hcb.dump", "hcb.dump", "\tDump HCB tree.", 0, 0, "d", hcb_dump },
 	{ NULL }
 };
 
diff --git a/bin/varnishd/hash/hash_slinger.h b/bin/varnishd/hash/hash_slinger.h
index 3c6f815..0afdb93 100644
--- a/bin/varnishd/hash/hash_slinger.h
+++ b/bin/varnishd/hash/hash_slinger.h
@@ -95,8 +95,6 @@ struct objhead {
 	uint8_t			digest[DIGEST_LEN];
 	struct waitinglist	*waitinglist;
 
-	long			hits;
-
 	/*----------------------------------------------------
 	 * The fields below are for the sole private use of
 	 * the hash implementation(s).
diff --git a/bin/varnishd/mgt/mgt_cli.c b/bin/varnishd/mgt/mgt_cli.c
index 21fecfb..8c16692 100644
--- a/bin/varnishd/mgt/mgt_cli.c
+++ b/bin/varnishd/mgt/mgt_cli.c
@@ -120,7 +120,7 @@ mcf_panic(struct cli *cli, const char * const *av, void *priv)
 
 static struct cli_proto cli_debug[] = {
 	{ "debug.panic.master", "debug.panic.master",
-		"\tPanic the master process.\n",
+		"\tPanic the master process.",
 		0, 0, "d", mcf_panic, NULL},
 	{ NULL }
 };
diff --git a/bin/varnishd/mgt/mgt_main.c b/bin/varnishd/mgt/mgt_main.c
index 28b4823..ae90fe0 100644
--- a/bin/varnishd/mgt/mgt_main.c
+++ b/bin/varnishd/mgt/mgt_main.c
@@ -174,9 +174,9 @@ usage(void)
 	fprintf(stderr, FMT, "", "  -s file  [default: use /tmp]");
 	fprintf(stderr, FMT, "", "  -s file,<dir_or_file>");
 	fprintf(stderr, FMT, "", "  -s file,<dir_or_file>,<size>");
-	fprintf(stderr, FMT, "", "  -s persist{experimenta}");
 	fprintf(stderr, FMT, "",
 	    "  -s file,<dir_or_file>,<size>,<granularity>");
+	fprintf(stderr, FMT, "", "  -s persist{experimental}");
 	fprintf(stderr, FMT, "-S secret-file",
 	    "Secret file for CLI authentication");
 	fprintf(stderr, FMT, "-T address:port",
diff --git a/bin/varnishd/mgt/mgt_param_tbl.c b/bin/varnishd/mgt/mgt_param_tbl.c
index 62aff53..345a94a 100644
--- a/bin/varnishd/mgt/mgt_param_tbl.c
+++ b/bin/varnishd/mgt/mgt_param_tbl.c
@@ -107,7 +107,7 @@ struct parspec mgt_parspec[] = {
 	{ "workspace_thread",
 		tweak_bytes_u, &mgt_param.workspace_thread,
 		"256", "8192",
-		"Bytes of auxillary workspace per thread.\n"
+		"Bytes of auxiliary workspace per thread.\n"
 		"This workspace is used for certain temporary data structures"
 		" during the operation of a worker thread.\n"
 		"One use is for the io-vectors for writing requests and"
@@ -144,7 +144,7 @@ struct parspec mgt_parspec[] = {
 	{ "http_resp_size",
 		tweak_bytes_u, &mgt_param.http_resp_size,
 		"256", NULL,
-		"Maximum number of bytes of HTTP backend resonse we will deal "
+		"Maximum number of bytes of HTTP backend response we will deal "
 		"with.  This is a limit on all bytes up to the double blank "
 		"line which ends the HTTP request.\n"
 		"The memory for the request is allocated from the worker "
@@ -194,7 +194,7 @@ struct parspec mgt_parspec[] = {
 		"5", "seconds" },
 	{ "timeout_req", tweak_timeout, &mgt_param.timeout_req,
 		"0", NULL,
-		"Max time to receive clients request header, measured"
+		"Max time to receive clients request headers, measured"
 		" from first non-white-space character to double CRNL.",
 		0,
 		"2", "seconds" },
@@ -242,7 +242,7 @@ struct parspec mgt_parspec[] = {
 		"Internal limits in the storage_file module makes increases "
 		"above 128kb a dubious idea.",
 		EXPERIMENTAL,
-		"128k", "bytes" },
+		"16k", "bytes" },
 	{ "fetch_maxchunksize",
 		tweak_bytes, &mgt_param.fetch_maxchunksize,
 		"65536", NULL,
@@ -283,7 +283,7 @@ struct parspec mgt_parspec[] = {
 		tweak_bytes_u, &mgt_param.cli_limit,
 		"128", "99999999",
 		"Maximum size of CLI response.  If the response exceeds"
-		" this limit, the reponse code will be 201 instead of"
+		" this limit, the response code will be 201 instead of"
 		" 200 and the last line will indicate the truncation.",
 		0,
 		"48k", "bytes" },
@@ -342,7 +342,7 @@ struct parspec mgt_parspec[] = {
 		"VCL can override this default value for each backend and "
 		"backend request.",
 		0,
-		"3.5", "s" },
+		"3.5", "seconds" },
 	{ "first_byte_timeout", tweak_timeout,
 		&mgt_param.first_byte_timeout,
 		"0", NULL,
@@ -353,7 +353,7 @@ struct parspec mgt_parspec[] = {
 		"VCL can override this default value for each backend and "
 		"backend request. This parameter does not apply to pipe.",
 		0,
-		"60", "s" },
+		"60", "seconds" },
 	{ "between_bytes_timeout", tweak_timeout,
 		&mgt_param.between_bytes_timeout,
 		"0", NULL,
@@ -364,7 +364,7 @@ struct parspec mgt_parspec[] = {
 		"VCL can override this default value for each backend request "
 		"and backend request. This parameter does not apply to pipe.",
 		0,
-		"60", "s" },
+		"60", "seconds" },
 	{ "acceptor_sleep_max", tweak_timeout,
 		&mgt_param.acceptor_sleep_max,
 		"0", "10",
@@ -373,7 +373,7 @@ struct parspec mgt_parspec[] = {
 		"This parameter limits how long it can sleep between "
 		"attempts to accept new connections.",
 		EXPERIMENTAL,
-		"0.050", "s" },
+		"0.050", "seconds" },
 	{ "acceptor_sleep_incr", tweak_timeout,
 		&mgt_param.acceptor_sleep_incr,
 		"0", "1",
@@ -382,14 +382,14 @@ struct parspec mgt_parspec[] = {
 		"This parameter control how much longer we sleep, each time "
 		"we fail to accept a new connection.",
 		EXPERIMENTAL,
-		"0.001", "s" },
+		"0.001", "seconds" },
 	{ "acceptor_sleep_decay", tweak_double,
 		&mgt_param.acceptor_sleep_decay,
 		"0", "1",
 		"If we run out of resources, such as file descriptors or "
 		"worker threads, the acceptor will sleep between accepts.\n"
 		"This parameter (multiplicatively) reduce the sleep duration "
-		"for each succesfull accept. (ie: 0.9 = reduce by 10%)",
+		"for each successful accept. (ie: 0.9 = reduce by 10%)",
 		EXPERIMENTAL,
 		"0.900", "" },
 	{ "clock_skew", tweak_uint, &mgt_param.clock_skew,
@@ -397,7 +397,7 @@ struct parspec mgt_parspec[] = {
 		"How much clockskew we are willing to accept between the "
 		"backend and our own clock.",
 		0,
-		"10", "s" },
+		"10", "seconds" },
 	{ "prefer_ipv6", tweak_bool, &mgt_param.prefer_ipv6,
 		NULL, NULL,
 		"Prefer IPv6 address when connecting to backends which "
@@ -416,7 +416,7 @@ struct parspec mgt_parspec[] = {
 		"100000", "sessions" },
 	{ "timeout_linger", tweak_timeout, &mgt_param.timeout_linger,
 		"0", NULL,
-		"How long time the workerthread lingers on an idle session "
+		"How long the worker thread lingers on an idle session "
 		"before handing it over to the waiter.\n"
 		"When sessions are reused, as much as half of all reuses "
 		"happen within the first 100 msec of the previous request "
@@ -433,7 +433,7 @@ struct parspec mgt_parspec[] = {
 		WAITER_DEFAULT, NULL },
 	{ "ban_dups", tweak_bool, &mgt_param.ban_dups,
 		NULL, NULL,
-		"Elimited older identical bans when new bans are created."
+		"Eliminate older identical bans when new bans are created."
 		"  This test is CPU intensive and scales with the number and"
 		" complexity of active (non-Gone) bans.  If identical bans"
 		" are frequent, the amount of CPU needed to actually test "
@@ -454,7 +454,7 @@ struct parspec mgt_parspec[] = {
 		" lookup.  This parameter prevents the ban-lurker from"
 		" kicking in, until the rush is over.",
 		0,
-		"60", "s" },
+		"60", "seconds" },
 	{ "ban_lurker_sleep", tweak_timeout,
 		&mgt_param.ban_lurker_sleep,
 		"0", NULL,
@@ -464,7 +464,7 @@ struct parspec mgt_parspec[] = {
 		" before looking for new work to do.\n"
 		"A value of zero disables the ban lurker.",
 		0,
-		"0.01", "s" },
+		"0.01", "seconds" },
 	{ "ban_lurker_batch", tweak_uint,
 		&mgt_param.ban_lurker_batch,
 		"1", NULL,
@@ -521,14 +521,14 @@ struct parspec mgt_parspec[] = {
 		"Objects created with (ttl+grace+keep) shorter than this"
 		" are always put in transient storage.",
 		0,
-		"10.0", "s" },
+		"10", "seconds" },
 	{ "critbit_cooloff", tweak_timeout,
 		&mgt_param.critbit_cooloff,
 		"60", "254",
-		"How long time the critbit hasher keeps deleted objheads "
+		"How long the critbit hasher keeps deleted objheads "
 		"on the cooloff list.",
 		WIZARD,
-		"180.0", "s" },
+		"180", "seconds" },
 	{ "sigsegv_handler", tweak_bool, &mgt_param.sigsegv_handler,
 		NULL, NULL,
 		"Install a signal handler which tries to dump debug "
diff --git a/bin/varnishd/mgt/mgt_pool.c b/bin/varnishd/mgt/mgt_pool.c
index f43f019..96d61bd 100644
--- a/bin/varnishd/mgt/mgt_pool.c
+++ b/bin/varnishd/mgt/mgt_pool.c
@@ -143,7 +143,7 @@ struct parspec WRK_parspec[] = {
 		"\n"
 		"This controls the decay of thread pools when idle(-ish).\n"
 		"\n"
-		"Minimum is 0.01 second.",
+		"Minimum is 0.01 seconds.",
 		EXPERIMENTAL | DELAYED_EFFECT,
 		"1", "seconds" },
 	{ "thread_pool_add_delay",
diff --git a/bin/varnishd/storage/stevedore_mgt.c b/bin/varnishd/storage/stevedore_mgt.c
index 7a38171..109290f 100644
--- a/bin/varnishd/storage/stevedore_mgt.c
+++ b/bin/varnishd/storage/stevedore_mgt.c
@@ -70,7 +70,7 @@ stv_cli_list(struct cli *cli, const char * const *av, void *priv)
 /*--------------------------------------------------------------------*/
 
 struct cli_proto cli_stv[] = {
-	{ "storage.list", "storage.list", "List storage devices\n",
+	{ "storage.list", "storage.list", "\tList storage devices.",
 	    0, 0, "", stv_cli_list },
 	{ NULL}
 };
diff --git a/bin/varnishd/storage/stevedore_utils.c b/bin/varnishd/storage/stevedore_utils.c
index a86d57e..9ce647f 100644
--- a/bin/varnishd/storage/stevedore_utils.c
+++ b/bin/varnishd/storage/stevedore_utils.c
@@ -196,9 +196,12 @@ STV_FileSize(int fd, const char *size, unsigned *granularity, const char *ctx)
 		 * use its existing size.
 		 */
 		l = st.st_size;
+	} else if (size == NULL || *size == '\0') {
+		ARGV_ERR("(%s) no size specified\n",
+		    ctx);
 	} else {
 		AN(size);
-		q = VNUM_2bytes(size, &l, fssize);
+		q = VNUM_2bytes(size, &l, 0);
 
 		if (q != NULL)
 			ARGV_ERR("(%s) size \"%s\": %s\n", ctx, size, q);
@@ -206,6 +209,10 @@ STV_FileSize(int fd, const char *size, unsigned *granularity, const char *ctx)
 		if (l < 1024*1024)
 			ARGV_ERR("(%s) size \"%s\": too small, "
 			    "did you forget to specify M or G?\n", ctx, size);
+
+		if (l > fssize)
+			ARGV_ERR("(%s) size \"%s\": larger than file system\n",
+			    ctx, size);
 	}
 
 	/*
@@ -223,11 +230,6 @@ STV_FileSize(int fd, const char *size, unsigned *granularity, const char *ctx)
 	if (i)
 		fprintf(stderr, "WARNING: (%s) file size reduced"
 		    " to %ju due to system \"off_t\" limitations\n", ctx, l);
-	else if (l - st.st_size > fssize) {
-		l = fssize * 80 / 100;
-		fprintf(stderr, "WARNING: (%s) file size reduced"
-		    " to %ju (80%% of available disk space)\n", ctx, l);
-	}
 
 	if (sizeof(void *) == 4 && l > INT32_MAX) { /*lint !e506 !e774 !e845 */
 		fprintf(stderr,
diff --git a/bin/varnishd/storage/storage_file.c b/bin/varnishd/storage/storage_file.c
index 876e444..da67ef3 100644
--- a/bin/varnishd/storage/storage_file.c
+++ b/bin/varnishd/storage/storage_file.c
@@ -108,7 +108,6 @@ smf_initfile(struct smf_sc *sc, const char *size)
 	/* XXX: force block allocation here or in open ? */
 }
 
-static const char default_size[] = "100M";
 static const char default_filename[] = ".";
 
 static void
@@ -122,7 +121,7 @@ smf_init(struct stevedore *parent, int ac, char * const *av)
 	AZ(av[ac]);
 
 	fn = default_filename;
-	size = default_size;
+	size = NULL;
 	page_size = getpagesize();
 
 	if (ac > 3)
@@ -139,7 +138,6 @@ smf_init(struct stevedore *parent, int ac, char * const *av)
 	}
 
 	AN(fn);
-	AN(size);
 
 	ALLOC_OBJ(sc, SMF_SC_MAGIC);
 	XXXAN(sc);
diff --git a/bin/varnishd/storage/storage_persistent.c b/bin/varnishd/storage/storage_persistent.c
index 6633799..1f9737f 100644
--- a/bin/varnishd/storage/storage_persistent.c
+++ b/bin/varnishd/storage/storage_persistent.c
@@ -670,14 +670,13 @@ debug_persistent(struct cli *cli, const char * const * av, void *priv)
 }
 
 static struct cli_proto debug_cmds[] = {
-        { "debug.persistent", "debug.persistent",
-                "Persistent debugging magic:\n"
-		"\tdebug.persistent [stevedore [cmd]]\n"
+	{ "debug.persistent", "debug.persistent",
+		"Persistent debugging magic:\n"
+		"\tdebug.persistent [<stevedore> [<cmd>]]\n"
 		"With no cmd arg, a summary of the silo is returned.\n"
 		"Possible commands:\n"
 		"\tsync\tClose current segment, open a new one\n"
-		"\tdump\tinclude objcores in silo summary\n"
-		"",
+		"\tdump\tinclude objcores in silo summary",
 		0, 2, "d", debug_persistent },
         { NULL }
 };
diff --git a/bin/varnishhist/varnishhist.c b/bin/varnishhist/varnishhist.c
index d01595c..c364ad3 100644
--- a/bin/varnishhist/varnishhist.c
+++ b/bin/varnishhist/varnishhist.c
@@ -193,7 +193,8 @@ static int /*__match_proto__ (VSLQ_dispatch_f)*/
 accumulate(struct VSL_data *vsl, struct VSL_transaction * const pt[],
 	void *priv)
 {
-	int i, j, tag, skip, match, hit;
+	int i, tag, skip, match, hit;
+	unsigned u;
 	double value;
 	struct VSL_transaction *tr;
 
@@ -259,13 +260,15 @@ accumulate(struct VSL_data *vsl, struct VSL_transaction * const pt[],
 
 		/* phase out old data */
 		if (nhist == HIST_N) {
-			j = rr_hist[next_hist];
-			if (j < 0) {
-				assert(bucket_miss[-j] > 0);
-				bucket_miss[-j]--;
+			u = rr_hist[next_hist];
+			if (u >= hist_buckets) {
+				u -= hist_buckets;
+				assert(u < hist_buckets);
+				assert(bucket_hit[u] > 0);
+				bucket_hit[u]--;
 			} else {
-				assert(bucket_hit[j] > 0);
-				bucket_hit[j]--;
+				assert(bucket_miss[u] > 0);
+				bucket_miss[u]--;
 			}
 		} else {
 			++nhist;
@@ -274,10 +277,10 @@ accumulate(struct VSL_data *vsl, struct VSL_transaction * const pt[],
 		/* phase in new data */
 		if (hit) {
 			bucket_hit[i]++;
-			rr_hist[next_hist] = i;
+			rr_hist[next_hist] = i + hist_buckets;
 		} else {
 			bucket_miss[i]++;
-			rr_hist[next_hist] = -i;
+			rr_hist[next_hist] = i;
 		}
 		if (++next_hist == HIST_N) {
 			next_hist = 0;
diff --git a/bin/varnishhist/varnishhist_options.h b/bin/varnishhist/varnishhist_options.h
index fdd217e..f3223f3 100644
--- a/bin/varnishhist/varnishhist_options.h
+++ b/bin/varnishhist/varnishhist_options.h
@@ -47,7 +47,7 @@
 #define HIS_OPT_P							\
 	VOPT("P:", "[-P <size|responsetime|tag:field_num:min:max>]",	\
 	    "Profile definition",					\
-	    "Either specify \"size\" or \"responstime\" profile or"	\
+	    "Either specify \"size\" or \"responsetime\" profile or"	\
 	    " create a new one. Define the tag we'll look for, and the"	\
 	    " field number of the value we are interested in. min and"	\
 	    " max are the boundaries of the graph (these are power of"	\
diff --git a/bin/varnishlog/varnishlog_options.h b/bin/varnishlog/varnishlog_options.h
index fae84a4..55b30c7 100644
--- a/bin/varnishlog/varnishlog_options.h
+++ b/bin/varnishlog/varnishlog_options.h
@@ -59,8 +59,8 @@ VUT_OPT_D
 VUT_OPT_g
 VUT_OPT_h
 VSL_OPT_i
-VUT_OPT_k
 VSL_OPT_I
+VUT_OPT_k
 VSL_OPT_L
 VUT_OPT_n
 VUT_OPT_N
diff --git a/bin/varnishncsa/varnishncsa.c b/bin/varnishncsa/varnishncsa.c
index 162829d..9cbbd50 100644
--- a/bin/varnishncsa/varnishncsa.c
+++ b/bin/varnishncsa/varnishncsa.c
@@ -182,16 +182,61 @@ flushout(void)
 	return (0);
 }
 
+static int
+vsb_esc_cat(struct vsb *sb, const char *b, const char *e)
+{
+	AN(b);
+
+	for (; b < e; b++) {
+		if (isspace(*b)) {
+			switch (*b) {
+			case '\n':
+				VSB_cat(sb, "\\n");
+				break;
+			case '\t':
+				VSB_cat(sb, "\\t");
+				break;
+			case '\f':
+				VSB_cat(sb, "\\f");
+				break;
+			case '\r':
+				VSB_cat(sb, "\\r");
+				break;
+			case '\v':
+				VSB_cat(sb, "\\v");
+				break;
+			default:
+				VSB_putc(sb, *b);
+				break;
+			}
+		} else if (isprint(*b)) {
+			switch (*b) {
+			case '"':
+				VSB_cat(sb, "\\\"");
+				break;
+			case '\\':
+				 VSB_cat(sb, "\\\\");
+				 break;
+			default:
+				VSB_putc(sb, *b);
+				break;
+			}
+		} else
+			VSB_printf(sb, "\\x%02hhx", *b);
+	}
+
+	return (VSB_error(sb));
+}
+
 static inline int
 vsb_fcat(struct vsb *vsb, const struct fragment *f, const char *dflt)
 {
-
 	if (f->gen == CTX.gen) {
 		assert(f->b <= f->e);
-		return (VSB_bcat(vsb, f->b, f->e - f->b));
+		return (vsb_esc_cat(vsb, f->b, f->e));
 	}
 	if (dflt)
-		return (VSB_cat(vsb, dflt));
+		return (vsb_esc_cat(vsb, dflt, dflt + strlen(dflt)));
 	return (-1);
 }
 
@@ -226,10 +271,10 @@ format_fragment(const struct format *format)
 	if (format->frag->gen != CTX.gen) {
 		if (format->string == NULL)
 			return (-1);
-		AZ(VSB_cat(CTX.vsb, format->string));
+		AZ(vsb_esc_cat(CTX.vsb, format->string,
+		       format->string + strlen(format->string)));
 		return (0);
 	}
-
 	AZ(vsb_fcat(CTX.vsb, format->frag, NULL));
 	return (1);
 }
@@ -318,13 +363,14 @@ format_auth(const struct format *format)
 		CTX.frag[F_auth].e)) {
 		if (format->string == NULL)
 			return (-1);
-		AZ(VSB_cat(CTX.vsb, format->string));
+		AZ(vsb_esc_cat(CTX.vsb, format->string,
+			format->string + strlen(format->string)));
 		return (0);
 	}
 	q = strchr(buf, ':');
 	if (q != NULL)
 		*q = '\0';
-	AZ(VSB_cat(CTX.vsb, buf));
+	AZ(vsb_esc_cat(CTX.vsb, buf, buf + strlen(buf)));
 	return (1);
 }
 
@@ -653,7 +699,7 @@ isprefix(const char *str, const char *prefix, const char *end,
 }
 
 static void
-frag_fields(const char *b, const char *e, ...)
+frag_fields(int force, const char *b, const char *e, ...)
 {
 	va_list ap;
 	const char *p, *q;
@@ -680,7 +726,7 @@ frag_fields(const char *b, const char *e, ...)
 			q++;
 
 		if (field == n) {
-			if (frag->gen != CTX.gen) {
+			if (frag->gen != CTX.gen || force) {
 				/* We only grab the same matching field once */
 				frag->gen = CTX.gen;
 				frag->b = p;
@@ -696,10 +742,10 @@ frag_fields(const char *b, const char *e, ...)
 }
 
 static void
-frag_line(const char *b, const char *e, struct fragment *f)
+frag_line(int force, const char *b, const char *e, struct fragment *f)
 {
 
-	if (f->gen == CTX.gen)
+	if (f->gen == CTX.gen && !force)
 		/* We only grab the same matching record once */
 		return;
 
@@ -724,7 +770,7 @@ process_hdr(const struct watch_head *head, const char *b, const char *e)
 	VTAILQ_FOREACH(w, head, list) {
 		if (strncasecmp(b, w->key, w->keylen))
 			continue;
-		frag_line(b + w->keylen, e, &w->frag);
+		frag_line(0, b + w->keylen, e, &w->frag);
 	}
 }
 
@@ -737,7 +783,6 @@ dispatch_f(struct VSL_data *vsl, struct VSL_transaction * const pt[],
 	const char *b, *e, *p;
 	struct watch *w;
 	int i, skip;
-
 	(void)vsl;
 	(void)priv;
 
@@ -764,32 +809,34 @@ dispatch_f(struct VSL_data *vsl, struct VSL_transaction * const pt[],
 				skip = 1;
 				break;
 			case SLT_PipeAcct:
-				frag_fields(b, e,
+				frag_fields(0, b, e,
 				    3, &CTX.frag[F_I],
 				    4, &CTX.frag[F_O],
 				    0, NULL);
 				break;
 			case SLT_ReqStart:
-				frag_fields(b, e, 1, &CTX.frag[F_h], 0, NULL);
+				frag_fields(0, b, e,
+				    1, &CTX.frag[F_h],
+				    0, NULL);
 				break;
 			case SLT_ReqMethod:
-				frag_line(b, e, &CTX.frag[F_m]);
+				frag_line(0, b, e, &CTX.frag[F_m]);
 				break;
 			case SLT_ReqURL:
 				p = memchr(b, '?', e - b);
 				if (p == NULL)
 					p = e;
-				frag_line(b, p, &CTX.frag[F_U]);
-				frag_line(p, e, &CTX.frag[F_q]);
+				frag_line(0, b, p, &CTX.frag[F_U]);
+				frag_line(0, p, e, &CTX.frag[F_q]);
 				break;
 			case SLT_ReqProtocol:
-				frag_line(b, e, &CTX.frag[F_H]);
+				frag_line(0, b, e, &CTX.frag[F_H]);
 				break;
 			case SLT_RespStatus:
-				frag_line(b, e, &CTX.frag[F_s]);
+				frag_line(1, b, e, &CTX.frag[F_s]);
 				break;
 			case SLT_ReqAcct:
-				frag_fields(b, e,
+				frag_fields(0, b, e,
 				    3, &CTX.frag[F_I],
 				    5, &CTX.frag[F_b],
 				    6, &CTX.frag[F_O],
@@ -797,26 +844,26 @@ dispatch_f(struct VSL_data *vsl, struct VSL_transaction * const pt[],
 				break;
 			case SLT_Timestamp:
 				if (isprefix(b, "Start:", e, &p)) {
-					frag_fields(p, e, 1,
+					frag_fields(0, p, e, 1,
 					    &CTX.frag[F_tstart], 0, NULL);
 
 				} else if (isprefix(b, "Resp:", e, &p) ||
 					isprefix(b, "PipeSess:", e, &p)) {
-					frag_fields(p, e, 1,
+					frag_fields(0, p, e, 1,
 					    &CTX.frag[F_tend], 0, NULL);
 
 				} else if (isprefix(b, "Process:", e, &p) ||
 					isprefix(b, "Pipe:", e, &p)) {
-					frag_fields(p, e, 2,
+					frag_fields(0, p, e, 2,
 					    &CTX.frag[F_ttfb], 0, NULL);
 				}
 				break;
 			case SLT_ReqHeader:
 				if (isprefix(b, "Host:", e, &p))
-					frag_line(p, e, &CTX.frag[F_host]);
+					frag_line(0, p, e, &CTX.frag[F_host]);
 				else if (isprefix(b, "Authorization:", e, &p) &&
 				    isprefix(p, "basic", e, &p))
-					frag_line(p, e, &CTX.frag[F_auth]);
+					frag_line(0, p, e, &CTX.frag[F_auth]);
 				break;
 			case SLT_VCL_call:
 				if (!strcasecmp(b, "recv")) {
@@ -850,7 +897,6 @@ dispatch_f(struct VSL_data *vsl, struct VSL_transaction * const pt[],
 			default:
 				break;
 			}
-
 			if (tag == SLT_VCL_Log) {
 				VTAILQ_FOREACH(w, &CTX.watch_vcl_log, list) {
 					CHECK_OBJ_NOTNULL(w, WATCH_MAGIC);
@@ -862,7 +908,7 @@ dispatch_f(struct VSL_data *vsl, struct VSL_transaction * const pt[],
 					p++;
 					if (p > e)
 						continue;
-					frag_line(p, e, &w->frag);
+					frag_line(0, p, e, &w->frag);
 				}
 			}
 			if (tag == SLT_ReqHeader)
diff --git a/bin/varnishstat/varnishstat.c b/bin/varnishstat/varnishstat.c
index f5153b4..7f00317 100644
--- a/bin/varnishstat/varnishstat.c
+++ b/bin/varnishstat/varnishstat.c
@@ -104,7 +104,10 @@ do_json_cb(void *priv, const struct VSC_point * const pt)
 	val = *(const volatile uint64_t*)pt->ptr;
 	sec = pt->section;
 
-	if (*jp) *jp = 0; else printf(",\n");
+	if (*jp)
+		*jp = 0;
+	else
+		printf(",\n");
 
 	printf("\t\"");
 	/* build the JSON key name.  */
@@ -113,19 +116,17 @@ do_json_cb(void *priv, const struct VSC_point * const pt)
 	if (sec->fantom->ident[0])
 		printf("%s.", sec->fantom->ident);
 	printf("%s\": {", pt->desc->name);
-
-	if (strcmp(sec->fantom->type, "")) printf("\"type\": \"%s\", ",
-	    sec->fantom->type);
-	if (strcmp(sec->fantom->ident, "")) printf("\"ident\": \"%s\", ",
-	    sec->fantom->ident);
-
+	if (strcmp(sec->fantom->type, ""))
+		printf("\"type\": \"%s\", ", sec->fantom->type);
+	if (strcmp(sec->fantom->ident, ""))
+		printf("\"ident\": \"%s\", ", sec->fantom->ident);
 	printf("\"value\": %ju, ", (uintmax_t)val);
-
 	printf("\"flag\": \"%c\", ", pt->desc->flag);
 	printf("\"description\": \"%s\"", pt->desc->sdesc);
 	printf("}");
 
-	if (*jp) printf("\n");
+	if (*jp)
+		printf("\n");
 	return (0);
 }
 
@@ -325,12 +326,12 @@ main(int argc, char * const *argv)
 			do_once(vd, VSC_Main(vd, NULL));
 		else if (f_list)
 			list_fields(vd);
-		else {
+		else
 			assert(0);
-		}
-		if (!do_repeat) break;
+		if (!do_repeat)
+			break;
 
-		// end of output block marker.
+		/* end of output block marker. */
 		printf("\n");
 
 		(void)usleep(delay * 1e6);
diff --git a/bin/varnishstat/varnishstat_curses.c b/bin/varnishstat/varnishstat_curses.c
index 00c4dac..bea41e2 100644
--- a/bin/varnishstat/varnishstat_curses.c
+++ b/bin/varnishstat/varnishstat_curses.c
@@ -867,6 +867,10 @@ handle_keypress(int ch)
 		if (page_start + l_points < n_ptarray - 1)
 			page_start += l_points;
 		break;
+	case 'd':
+		hide_unseen = 1 - hide_unseen;
+		rebuild = 1;
+		break;
 	case 'g':
 		current = 0;
 		page_start = 0;
@@ -875,10 +879,6 @@ handle_keypress(int ch)
 		current = n_ptarray - 1;
 		page_start = current - l_points + 1;
 		break;
-	case 'd':
-		hide_unseen = 1 - hide_unseen;
-		rebuild = 1;
-		break;
 	case 'v':
 		verbosity++;
 		if (VSC_LevelDesc(verbosity) == NULL)
@@ -886,7 +886,6 @@ handle_keypress(int ch)
 		rebuild = 1;
 		break;
 	case 'q':
-	case 'Q':
 		keep_running = 0;
 		return;
 	case '\003':		/* Ctrl-C */
diff --git a/bin/varnishtest/tests/c00016.vtc b/bin/varnishtest/tests/c00016.vtc
index 83c9527..3e0b2be 100644
--- a/bin/varnishtest/tests/c00016.vtc
+++ b/bin/varnishtest/tests/c00016.vtc
@@ -23,3 +23,9 @@ client c1 {
 	rxresp
 	expect req.http.Bar == <undef>
 } -run
+
+client c1 {
+	txreq -hdr "foo: 1" -hdr "Age: 200" -hdr "Connection: Age"
+	rxresp
+	expect resp.status == 400
+} -run
diff --git a/bin/varnishtest/tests/c00034.vtc b/bin/varnishtest/tests/c00034.vtc
index 23910de..9eeee15 100644
--- a/bin/varnishtest/tests/c00034.vtc
+++ b/bin/varnishtest/tests/c00034.vtc
@@ -5,13 +5,11 @@ server s1 {
 	txresp -bodylen 100
 } -start
 
-varnish v1 -vcl+backend {
-
+varnish v1 -arg "-p http_range_support=off" -vcl+backend {
 	sub vcl_backend_response {
 		set beresp.do_stream = false;
 	}
 } -start
-varnish v1 -cliok "param.set http_range_support off"
 
 client c1 {
 	txreq -hdr "Range: bytes=0-9"
@@ -45,61 +43,71 @@ client c1 {
 	expect resp.status == 200
 	expect resp.bodylen == 100
 
+	txreq -hdr "Range: bytes=-"
+	rxresp
+	expect resp.status == 200
+	expect resp.bodylen == 100
+
+	txreq -hdr "Range: bytes=5-2"
+	rxresp
+	expect resp.status == 200
+	expect resp.bodylen == 100
 } -run
 
-varnish v1 -expect s_resp_bodybytes == 500
+varnish v1 -expect s_resp_bodybytes == 700
 
 client c1 {
-
-	txreq -hdr "Range: bytes=0-9"
+	txreq -hdr "Range: bytes=-0"
 	rxresp
-	expect resp.status == 206
-	expect resp.bodylen == 10
+	expect resp.status == 416
+	expect resp.bodylen == 0
+	expect resp.http.content-range == "bytes */100"
 
-	txreq -hdr "Range: bytes=10-19"
+	txreq -hdr "Range: bytes=100-"
 	rxresp
-	expect resp.status == 206
-	expect resp.bodylen == 10
+	expect resp.status == 416
+	expect resp.bodylen == 0
+	expect resp.http.content-range == "bytes */100"
+} -run
 
-	txreq -hdr "Range: bytes=90-"
-	rxresp
-	expect resp.status == 206
-	expect resp.bodylen == 10
+varnish v1 -expect s_resp_bodybytes == 700
 
-	txreq -hdr "Range: bytes=-9"
+client c1 {
+	txreq -hdr "Range: bytes=0-49"
 	rxresp
 	expect resp.status == 206
-	expect resp.bodylen == 9
+	expect resp.bodylen == 50
+	expect resp.http.content-range == "bytes 0-49/100"
 
-	txreq -hdr "Range: bytes=-"
+	txreq -hdr "Range: bytes=50-99"
 	rxresp
 	expect resp.status == 206
-	expect resp.bodylen == 100
-
-	txreq -hdr "Range: bytes=102-102"
-	rxresp
-	expect resp.status == 200
-	expect resp.bodylen == 100
+	expect resp.bodylen == 50
+	expect resp.http.content-range == "bytes 50-99/100"
 
-	txreq -hdr "Range: bytes=99-"
+	txreq -hdr "Range: bytes=-50"
 	rxresp
 	expect resp.status == 206
-	expect resp.bodylen == 1
+	expect resp.bodylen == 50
+	expect resp.http.content-range == "bytes 50-99/100"
 
-	txreq -hdr "Range: bytes=99-70"
+	txreq -hdr "Range: bytes=50-"
 	rxresp
-	expect resp.status == 200
-	expect resp.bodylen == 100
+	expect resp.status == 206
+	expect resp.bodylen == 50
+	expect resp.http.content-range == "bytes 50-99/100"
 
-	txreq -hdr "Range: bytes=-"
+	txreq -hdr "Range: bytes=0-0"
 	rxresp
 	expect resp.status == 206
-	expect resp.bodylen == 100
+	expect resp.bodylen == 1
+	expect resp.http.content-range == "bytes 0-0/100"
 
-	txreq -hdr "Range: bytes=-101"
+	txreq -hdr "Range: bytes=-2000"
 	rxresp
 	expect resp.status == 206
 	expect resp.bodylen == 100
+	expect resp.http.content-range == "bytes 0-99/100"
 } -run
 
-varnish v1 -expect s_resp_bodybytes == 1040
+varnish v1 -expect s_resp_bodybytes == 1001
diff --git a/bin/varnishtest/tests/c00044.vtc b/bin/varnishtest/tests/c00044.vtc
index 587bf38..4df8ccd 100644
--- a/bin/varnishtest/tests/c00044.vtc
+++ b/bin/varnishtest/tests/c00044.vtc
@@ -25,8 +25,9 @@ varnish v1 \
 	sub vcl_backend_response {
 		set beresp.do_stream = false;
 		set beresp.storage_hint = "invalid";
-		# Unset Date header to not change the object sizes
+		# Unset Date and CL header to not change the object sizes
 		unset beresp.http.Date;
+		unset beresp.http.Content-Length;
 	}
 } -start
 
diff --git a/bin/varnishtest/tests/c00045.vtc b/bin/varnishtest/tests/c00045.vtc
index 77425cb..4d715fa 100644
--- a/bin/varnishtest/tests/c00045.vtc
+++ b/bin/varnishtest/tests/c00045.vtc
@@ -17,8 +17,9 @@ varnish v1 \
 	sub vcl_backend_response {
 		set beresp.do_stream = false;
 		set beresp.storage_hint = "s0";
-		# Unset Date header to not change the object sizes
+		# Unset Date and CL header to not change the object sizes
 		unset beresp.http.Date;
+		unset beresp.http.Content-Length;
 	}
 } -start
 
diff --git a/bin/varnishtest/tests/c00055.vtc b/bin/varnishtest/tests/c00055.vtc
index 0344d02..ef568ea 100644
--- a/bin/varnishtest/tests/c00055.vtc
+++ b/bin/varnishtest/tests/c00055.vtc
@@ -11,8 +11,10 @@ server s1 {
 } -start
 
 varnish v1 -cliok "param.set vcc_allow_inline_c true" -vcl+backend {
+	import ${vmod_std};
+
 	sub vcl_recv {
-		C{ VRT_CacheReqBody(ctx, 1000); }C
+		std.cache_req_body(1KB);
 		return (pass);
 	}
 	sub vcl_deliver {
diff --git a/bin/varnishtest/tests/c00058.vtc b/bin/varnishtest/tests/c00058.vtc
index 440bbf3..8c9940b 100644
--- a/bin/varnishtest/tests/c00058.vtc
+++ b/bin/varnishtest/tests/c00058.vtc
@@ -22,7 +22,11 @@ client c1 {
 	expect resp.bodylen == 3
 
 	delay 1
+} -run
+
+varnish v1 -expect n_object == 1
 
+client c1 {
 	# We still get old object
 	txreq
 	rxresp
@@ -37,3 +41,6 @@ client c1 {
 	rxresp
 	expect resp.bodylen == 6
 } -run
+
+# and the old one has got superseded
+varnish v1 -expect n_object == 1
diff --git a/bin/varnishtest/tests/c00067.vtc b/bin/varnishtest/tests/c00067.vtc
index d6d4c02..3c77433 100644
--- a/bin/varnishtest/tests/c00067.vtc
+++ b/bin/varnishtest/tests/c00067.vtc
@@ -31,8 +31,10 @@ client c1 {
 delay .2
 
 varnish v1 -cliok "param.set vcc_allow_inline_c true" -vcl+backend {
+	import ${vmod_std};
+
 	sub vcl_recv {
-		C{ VRT_CacheReqBody(ctx, 1000); }C
+		std.cache_req_body(1000B);
 	}
 }
 
diff --git a/bin/varnishtest/tests/m00009.vtc b/bin/varnishtest/tests/m00009.vtc
index 7fbeec1..3313395 100644
--- a/bin/varnishtest/tests/m00009.vtc
+++ b/bin/varnishtest/tests/m00009.vtc
@@ -11,7 +11,6 @@ server s2 {
 	txresp -body "22"
 } -start
 
-
 server s3 {
 	rxreq
 	txresp -body "333"
diff --git a/bin/varnishtest/tests/m00018.vtc b/bin/varnishtest/tests/m00018.vtc
index b51ed18..35000ce 100644
--- a/bin/varnishtest/tests/m00018.vtc
+++ b/bin/varnishtest/tests/m00018.vtc
@@ -1,34 +1,24 @@
-varnishtest "Test substring matching in std"
+varnishtest "Test std.substr"
 
-server s1 {
-       rxreq
-       txresp
-
-       rxreq
-       txresp
+server s1 -repeat 2 {
+	rxreq
+	txresp
 } -start
 
 varnish v1 -vcl+backend {
 	import ${vmod_std};
 
 	sub vcl_deliver {
-	    if (std.strstr(req.url, "foo")) {
-		set resp.http.sub = "found";	
-	    } else {
-		set resp.http.sub = "not found";	
-	    }
-		
+		set resp.http.sub = std.strstr(req.url, "b");
 	}
 } -start
 
 client c1 {
 	txreq -url "/foobar"
 	rxresp
-	expect resp.http.sub == "found"
-
+	expect resp.http.sub == "bar"
 
 	txreq -url "/quux"
 	rxresp
-	expect resp.http.sub == "not found"
+	expect resp.http.sub == ""
 } -run
-
diff --git a/bin/varnishtest/tests/r00730.vtc b/bin/varnishtest/tests/r00730.vtc
index bb416e8..67b9598 100644
--- a/bin/varnishtest/tests/r00730.vtc
+++ b/bin/varnishtest/tests/r00730.vtc
@@ -4,7 +4,7 @@ server s1 {
 	rxreq
 	txresp -bodylen 5
 	rxreq
-	txresp -bodylen 6
+	txresp -nolen -hdr "Content-Length: 6"
 } -start
 
 varnish v1 -vcl+backend {
diff --git a/bin/varnishtest/tests/r00801.vtc b/bin/varnishtest/tests/r00801.vtc
index f538d7f..ca1a567 100644
--- a/bin/varnishtest/tests/r00801.vtc
+++ b/bin/varnishtest/tests/r00801.vtc
@@ -13,6 +13,7 @@ varnish v1 -vcl+backend {
 	sub vcl_recv { return (pass); }
 	sub vcl_backend_response {
 		set beresp.do_stream = false;
+		unset beresp.http.content-length;
 	}
 } -start
 
diff --git a/bin/varnishtest/tests/r01140.vtc b/bin/varnishtest/tests/r01140.vtc
index 11e2a72..dc4728d 100644
--- a/bin/varnishtest/tests/r01140.vtc
+++ b/bin/varnishtest/tests/r01140.vtc
@@ -24,6 +24,7 @@ varnish v1 -arg "-p nuke_limit=0 -p shortlived=0" \
 		set beresp.do_stream = false;
 		# Unset Date header to not change the object sizes
 		unset beresp.http.Date;
+		unset beresp.http.Content-Length;
 	}
 } -start
 
diff --git a/bin/varnishtest/tests/r01284.vtc b/bin/varnishtest/tests/r01284.vtc
index dc6336f..194de2d 100644
--- a/bin/varnishtest/tests/r01284.vtc
+++ b/bin/varnishtest/tests/r01284.vtc
@@ -16,8 +16,9 @@ varnish v1 \
 	sub vcl_backend_response {
 		set beresp.do_stream = false;
 		set beresp.storage_hint = "Transient";
-		# Unset Date header to not change the object sizes
+		# Unset Date and CL header to not change the object sizes
 		unset beresp.http.Date;
+		unset beresp.http.Content-Length;
 	}
 } -start
 
diff --git a/bin/varnishtest/tests/v00013.vtc b/bin/varnishtest/tests/v00013.vtc
index c428add..5a87dcf 100644
--- a/bin/varnishtest/tests/v00013.vtc
+++ b/bin/varnishtest/tests/v00013.vtc
@@ -37,5 +37,5 @@ client c1 {
 	rxresp
 	expect resp.status == 200
 	expect resp.http.foo == 2
-	expect resp.http.bar >= 0.100
+
 } -run
diff --git a/bin/varnishtest/tests/v00020.vtc b/bin/varnishtest/tests/v00020.vtc
index f9be7ec..a9e9d3b 100644
--- a/bin/varnishtest/tests/v00020.vtc
+++ b/bin/varnishtest/tests/v00020.vtc
@@ -97,6 +97,7 @@ varnish v1 -vcl {
 	sub vcl_recv {
 		set req.http.foo = "foo" + "bar";
 		set req.http.foo = "foo" + 1;
+		set req.http.foo = "foo" + 1.5;
 		set req.http.foo = "foo" + now;
 
 		set req.http.foo = now + 1s;
diff --git a/bin/varnishtest/tests/v00025.vtc b/bin/varnishtest/tests/v00025.vtc
index 2ac4b9d..ffd622b 100644
--- a/bin/varnishtest/tests/v00025.vtc
+++ b/bin/varnishtest/tests/v00025.vtc
@@ -22,6 +22,7 @@ varnish v1 -arg "-i J.F.Nobody" -vcl+backend {
 		set resp.http.esi = req.esi;
 		set resp.http.be = req.backend_hint;
 		set resp.http.c_id = client.identity;
+		if (obj.uncacheable) { }
 	}
 
 	sub vcl_backend_response {
@@ -41,7 +42,6 @@ varnish v1 -arg "-i J.F.Nobody" -vcl+backend {
 	sub vcl_hit {
 		if (obj.proto) { }
 		if (obj.reason) { }
-		if (obj.uncacheable) { }
 		if (obj.keep > 1m) { }
 		if (obj.grace < 3m) {
 			return (deliver);
@@ -52,7 +52,6 @@ varnish v1 -arg "-i J.F.Nobody" -vcl+backend {
 	}
 
 	sub vcl_backend_fetch {
-		set bereq.uncacheable = false;
 		if (bereq.between_bytes_timeout < 10s) {
 			set bereq.http.quick = "please";
 		}
diff --git a/bin/varnishtest/tests/v00026.vtc b/bin/varnishtest/tests/v00026.vtc
index 2b52238..28d6552 100644
--- a/bin/varnishtest/tests/v00026.vtc
+++ b/bin/varnishtest/tests/v00026.vtc
@@ -42,10 +42,8 @@ varnish v1 -vcl+backend {
 			set bereq.backend = h1.backend(bereq.url);
 		}
 	}
-
 } -start
 
-
 client c1 {
 	txreq -url /1
 	rxresp
@@ -70,6 +68,4 @@ client c1 {
 	txreq -url /nohdr
 	rxresp
 	expect resp.http.foo == "8"
-
-
 } -run
diff --git a/bin/varnishtest/tests/v00036.vtc b/bin/varnishtest/tests/v00036.vtc
index 2a7009c..01db68f 100644
--- a/bin/varnishtest/tests/v00036.vtc
+++ b/bin/varnishtest/tests/v00036.vtc
@@ -31,7 +31,6 @@ varnish v1 -vcl+backend {
 	sub vcl_backend_fetch {
 		set bereq.backend = fb1.backend();
 	}
-
 } -start
 
 varnish v1 -cliok "backend.set_health s1 sick"
diff --git a/bin/varnishtest/tests/v00039.vtc b/bin/varnishtest/tests/v00039.vtc
index 90bc865..029e114 100644
--- a/bin/varnishtest/tests/v00039.vtc
+++ b/bin/varnishtest/tests/v00039.vtc
@@ -31,19 +31,19 @@ client c1 {
 	expect resp.bodylen == 6
 	expect resp.http.hits == 1
 
-	# This is a miss on different vary -> hits still == 1
+	# This is a miss on different vary -> hits == 0
 	txreq -url "/" -hdr "Bar: 2"
 	rxresp
 	expect resp.status == 200
 	expect resp.bodylen == 4
-	expect resp.http.hits == 1
+	expect resp.http.hits == 0
 
-	# This is a hit -> hits == 2
+	# This is a hit -> hits == 1
 	txreq -url "/" -hdr "Bar: 2"
 	rxresp
 	expect resp.status == 200
 	expect resp.bodylen == 4
-	expect resp.http.hits == 2
+	expect resp.http.hits == 1
 
 } -run
 
diff --git a/bin/varnishtest/vtc_http.c b/bin/varnishtest/vtc_http.c
index f2998d4..8283c68 100644
--- a/bin/varnishtest/vtc_http.c
+++ b/bin/varnishtest/vtc_http.c
@@ -168,6 +168,25 @@ http_find_header(char * const *hh, const char *hdr)
 }
 
 /**********************************************************************
+ * count header
+ */
+
+static int
+http_count_header(char * const *hh, const char *hdr)
+{
+	int n, l, r = 0;
+
+	l = strlen(hdr);
+
+	for (n = 3; hh[n] != NULL; n++) {
+		if (strncasecmp(hdr, hh[n], l) || hh[n][l] != ':')
+			continue;
+		r++;
+	}
+	return (r);
+}
+
+/**********************************************************************
  * Expect
  */
 
@@ -205,18 +224,16 @@ cmd_var_resolve(struct http *hp, char *spec)
 	} else
 		return (spec);
 	hdr = http_find_header(hh, hdr);
-	if (hdr != NULL)
-		return (hdr);
-	return ("<undef>");
+	return (hdr);
 }
 
 static void
 cmd_http_expect(CMD_ARGS)
 {
 	struct http *hp;
-	const char *lhs;
+	const char *lhs, *clhs;
 	char *cmp;
-	const char *rhs;
+	const char *rhs, *crhs;
 	vre_t *vre;
 	const char *error;
 	int erroroffset;
@@ -233,14 +250,27 @@ cmd_http_expect(CMD_ARGS)
 	AN(av[2]);
 	AZ(av[3]);
 	lhs = cmd_var_resolve(hp, av[0]);
-	if (lhs == NULL)
-		lhs = "<missing>";
 	cmp = av[1];
 	rhs = cmd_var_resolve(hp, av[2]);
-	if (rhs == NULL)
-		rhs = "<missing>";
-	if (!strcmp(cmp, "==")) {
-		retval = strcmp(lhs, rhs) == 0;
+
+	clhs = lhs ? lhs : "<undef>";
+	crhs = rhs ? rhs : "<undef>";
+
+	if (!strcmp(cmp, "~") || !strcmp(cmp, "!~")) {
+		vre = VRE_compile(crhs, 0, &error, &erroroffset);
+		if (vre == NULL)
+			vtc_log(hp->vl, 0, "REGEXP error: %s (@%d) (%s)",
+			    error, erroroffset, crhs);
+		i = VRE_exec(vre, clhs, strlen(clhs), 0, 0, NULL, 0, 0);
+		retval = (i >= 0 && *cmp == '~') || (i < 0 && *cmp == '!');
+		VRE_free(&vre);
+	} else if (!strcmp(cmp, "==")) {
+		retval = strcmp(clhs, crhs) == 0;
+	} else if (!strcmp(cmp, "!=")) {
+		retval = strcmp(clhs, crhs) != 0;
+	} else if (lhs == NULL || rhs == NULL) {
+		// fail inequality comparisons if either side is undef'ed
+		retval = 0;
 	} else if (!strcmp(cmp, "<")) {
 		retval = strcmp(lhs, rhs) < 0;
 	} else if (!strcmp(cmp, "<=")) {
@@ -249,24 +279,15 @@ cmd_http_expect(CMD_ARGS)
 		retval = strcmp(lhs, rhs) >= 0;
 	} else if (!strcmp(cmp, ">")) {
 		retval = strcmp(lhs, rhs) > 0;
-	} else if (!strcmp(cmp, "!=")) {
-		retval = strcmp(lhs, rhs) != 0;
-	} else if (!strcmp(cmp, "~") || !strcmp(cmp, "!~")) {
-		vre = VRE_compile(rhs, 0, &error, &erroroffset);
-		if (vre == NULL)
-			vtc_log(hp->vl, 0, "REGEXP error: %s (@%d) (%s)",
-			    error, erroroffset, rhs);
-		i = VRE_exec(vre, lhs, strlen(lhs), 0, 0, NULL, 0, 0);
-		retval = (i >= 0 && *cmp == '~') || (i < 0 && *cmp == '!');
-		VRE_free(&vre);
 	}
+
 	if (retval == -1)
 		vtc_log(hp->vl, 0,
 		    "EXPECT %s (%s) %s %s (%s) test not implemented",
-		    av[0], lhs, av[1], av[2], rhs);
+		    av[0], clhs, av[1], av[2], crhs);
 	else
 		vtc_log(hp->vl, retval ? 4 : 0, "EXPECT %s (%s) %s \"%s\" %s",
-		    av[0], lhs, cmp, rhs, retval ? "match" : "failed");
+		    av[0], clhs, cmp, crhs, retval ? "match" : "failed");
 }
 
 /**********************************************************************
@@ -446,11 +467,11 @@ http_swallow_body(struct http *hp, char * const *hh, int body)
 	char *p;
 	int i, l, ll;
 
+	hp->body = hp->rxbuf + hp->prxbuf;
 	ll = 0;
 	p = http_find_header(hh, "content-length");
 	if (p != NULL) {
-		hp->body = hp->rxbuf + hp->prxbuf;
-		l = strtoul(p, NULL, 0);
+		l = strtoul(p, NULL, 10);
 		(void)http_rxchar(hp, l, 0);
 		vtc_dump(hp->vl, 4, "body", hp->body, l);
 		hp->bodyl = l;
@@ -468,7 +489,6 @@ http_swallow_body(struct http *hp, char * const *hh, int body)
 		return;
 	}
 	if (body) {
-		hp->body = hp->rxbuf + hp->prxbuf;
 		do  {
 			i = http_rxchar(hp, 1, 1);
 			ll += i;
@@ -535,7 +555,9 @@ cmd_http_rxresp(CMD_ARGS)
 			    "Unknown http rxresp spec: %s\n", *av);
 	http_rxhdr(hp);
 	http_splitheader(hp, 0);
-	hp->body = hp->rxbuf + hp->prxbuf;
+	if (http_count_header(hp->resp, "Content-Length") > 1)
+		vtc_log(hp->vl, 0,
+		    "Multiple Content-Length headers.\n");
 	if (!has_obj)
 		return;
 	else if (!strcmp(hp->resp[1], "200"))
@@ -561,6 +583,9 @@ cmd_http_rxresphdrs(CMD_ARGS)
 		vtc_log(hp->vl, 0, "Unknown http rxreq spec: %s\n", *av);
 	http_rxhdr(hp);
 	http_splitheader(hp, 0);
+	if (http_count_header(hp->resp, "Content-Length") > 1)
+		vtc_log(hp->vl, 0,
+		    "Multiple Content-Length headers.\n");
 }
 
 
@@ -819,7 +844,9 @@ cmd_http_rxreq(CMD_ARGS)
 		vtc_log(hp->vl, 0, "Unknown http rxreq spec: %s\n", *av);
 	http_rxhdr(hp);
 	http_splitheader(hp, 1);
-	hp->body = hp->rxbuf + hp->prxbuf;
+	if (http_count_header(hp->req, "Content-Length") > 1)
+		vtc_log(hp->vl, 0,
+		    "Multiple Content-Length headers.\n");
 	http_swallow_body(hp, hp->req, 0);
 	vtc_log(hp->vl, 4, "bodylen = %s", hp->bodylen);
 }
@@ -839,10 +866,13 @@ cmd_http_rxreqhdrs(CMD_ARGS)
 		vtc_log(hp->vl, 0, "Unknown http rxreq spec: %s\n", *av);
 	http_rxhdr(hp);
 	http_splitheader(hp, 1);
+	if (http_count_header(hp->req, "Content-Length") > 1)
+		vtc_log(hp->vl, 0,
+		    "Multiple Content-Length headers.\n");
 }
 
 static void
-cmd_http_rxbody(CMD_ARGS)
+cmd_http_rxreqbody(CMD_ARGS)
 {
 	struct http *hp;
 
@@ -850,7 +880,7 @@ cmd_http_rxbody(CMD_ARGS)
 	(void)vl;
 	CAST_OBJ_NOTNULL(hp, priv, HTTP_MAGIC);
 	ONLY_SERVER(hp, av);
-	AZ(strcmp(av[0], "rxbody"));
+	AZ(strcmp(av[0], "rxreqbody"));
 	av++;
 
 	for(; *av != NULL; av++)
@@ -860,6 +890,24 @@ cmd_http_rxbody(CMD_ARGS)
 }
 
 static void
+cmd_http_rxrespbody(CMD_ARGS)
+{
+	struct http *hp;
+
+	(void)cmd;
+	(void)vl;
+	CAST_OBJ_NOTNULL(hp, priv, HTTP_MAGIC);
+	ONLY_CLIENT(hp, av);
+	AZ(strcmp(av[0], "rxrespbody"));
+	av++;
+
+	for(; *av != NULL; av++)
+		vtc_log(hp->vl, 0, "Unknown http rxreq spec: %s\n", *av);
+	http_swallow_body(hp, hp->resp, 0);
+	vtc_log(hp->vl, 4, "bodylen = %s", hp->bodylen);
+}
+
+static void
 cmd_http_rxchunk(CMD_ARGS)
 {
 	struct http *hp;
@@ -1193,12 +1241,13 @@ static const struct cmds http_cmds[] = {
 
 	{ "rxreq",		cmd_http_rxreq },
 	{ "rxreqhdrs",		cmd_http_rxreqhdrs },
+	{ "rxreqbody",		cmd_http_rxreqbody },
 	{ "rxchunk",		cmd_http_rxchunk },
-	{ "rxbody",		cmd_http_rxbody },
 
 	{ "txresp",		cmd_http_txresp },
 	{ "rxresp",		cmd_http_rxresp },
 	{ "rxresphdrs",		cmd_http_rxresphdrs },
+	{ "rxrespbody",		cmd_http_rxrespbody },
 	{ "gunzip",		cmd_http_gunzip_body },
 	{ "expect",		cmd_http_expect },
 	{ "send",		cmd_http_send },
diff --git a/bin/varnishtest/vtc_varnish.c b/bin/varnishtest/vtc_varnish.c
index 92027ba..5ebac71 100644
--- a/bin/varnishtest/vtc_varnish.c
+++ b/bin/varnishtest/vtc_varnish.c
@@ -98,7 +98,7 @@ varnish_ask_cli(const struct varnish *v, const char *cmd, char **repl)
 		i = write(v->cli_fd, "\n", 1);
 		assert(i == 1);
 	}
-	i = VCLI_ReadResult(v->cli_fd, &retval, &r, 20.0);
+	i = VCLI_ReadResult(v->cli_fd, &retval, &r, 30.0);
 	if (i != 0) {
 		vtc_log(v->vl, 0, "CLI failed (%s) = %d %u %s",
 		    cmd, i, retval, r);
diff --git a/build-aux/missing b/build-aux/missing
index cdea514..86a8fc3 100755
--- a/build-aux/missing
+++ b/build-aux/missing
@@ -1,10 +1,11 @@
 #! /bin/sh
-# Common wrapper for a few potentially missing GNU programs.
+# Common stub for a few missing GNU programs while installing.
 
-scriptversion=2012-06-26.16; # UTC
+scriptversion=2012-01-06.13; # UTC
 
-# Copyright (C) 1996-2013 Free Software Foundation, Inc.
-# Originally written by Fran,cois Pinard <pinard@iro.umontreal.ca>, 1996.
+# Copyright (C) 1996, 1997, 1999, 2000, 2002, 2003, 2004, 2005, 2006,
+# 2008, 2009, 2010, 2011, 2012 Free Software Foundation, Inc.
+# Originally by Fran,cois Pinard <pinard@iro.umontreal.ca>, 1996.
 
 # This program is free software; you can redistribute it and/or modify
 # it under the terms of the GNU General Public License as published by
@@ -25,40 +26,68 @@ scriptversion=2012-06-26.16; # UTC
 # the same distribution terms that you use for the rest of that program.
 
 if test $# -eq 0; then
-  echo 1>&2 "Try '$0 --help' for more information"
+  echo 1>&2 "Try \`$0 --help' for more information"
   exit 1
 fi
 
-case $1 in
+run=:
+sed_output='s/.* --output[ =]\([^ ]*\).*/\1/p'
+sed_minuso='s/.* -o \([^ ]*\).*/\1/p'
 
-  --is-lightweight)
-    # Used by our autoconf macros to check whether the available missing
-    # script is modern enough.
-    exit 0
-    ;;
+# In the cases where this matters, `missing' is being run in the
+# srcdir already.
+if test -f configure.ac; then
+  configure_ac=configure.ac
+else
+  configure_ac=configure.in
+fi
 
-  --run)
-    # Back-compat with the calling convention used by older automake.
-    shift
-    ;;
+msg="missing on your system"
+
+case $1 in
+--run)
+  # Try to run requested program, and just exit if it succeeds.
+  run=
+  shift
+  "$@" && exit 0
+  # Exit code 63 means version mismatch.  This often happens
+  # when the user try to use an ancient version of a tool on
+  # a file that requires a minimum version.  In this case we
+  # we should proceed has if the program had been absent, or
+  # if --run hadn't been passed.
+  if test $? = 63; then
+    run=:
+    msg="probably too old"
+  fi
+  ;;
 
   -h|--h|--he|--hel|--help)
     echo "\
 $0 [OPTION]... PROGRAM [ARGUMENT]...
 
-Run 'PROGRAM [ARGUMENT]...', returning a proper advice when this fails due
-to PROGRAM being missing or too old.
+Handle \`PROGRAM [ARGUMENT]...' for when PROGRAM is missing, or return an
+error status if there is no known handling for PROGRAM.
 
 Options:
   -h, --help      display this help and exit
   -v, --version   output version information and exit
+  --run           try to run the given command, and emulate it if it fails
 
 Supported PROGRAM values:
-  aclocal   autoconf  autoheader   autom4te  automake  makeinfo
-  bison     yacc      flex         lex       help2man
+  aclocal      touch file \`aclocal.m4'
+  autoconf     touch file \`configure'
+  autoheader   touch file \`config.h.in'
+  autom4te     touch the output file, or create a stub one
+  automake     touch all \`Makefile.in' files
+  bison        create \`y.tab.[ch]', if possible, from existing .[ch]
+  flex         create \`lex.yy.c', if possible, from existing .c
+  help2man     touch the output file
+  lex          create \`lex.yy.c', if possible, from existing .c
+  makeinfo     touch the output file
+  yacc         create \`y.tab.[ch]', if possible, from existing .[ch]
 
-Version suffixes to PROGRAM as well as the prefixes 'gnu-', 'gnu', and
-'g' are ignored when checking the name.
+Version suffixes to PROGRAM as well as the prefixes \`gnu-', \`gnu', and
+\`g' are ignored when checking the name.
 
 Send bug reports to <bug-automake@gnu.org>."
     exit $?
@@ -70,141 +99,228 @@ Send bug reports to <bug-automake@gnu.org>."
     ;;
 
   -*)
-    echo 1>&2 "$0: unknown '$1' option"
-    echo 1>&2 "Try '$0 --help' for more information"
+    echo 1>&2 "$0: Unknown \`$1' option"
+    echo 1>&2 "Try \`$0 --help' for more information"
     exit 1
     ;;
 
 esac
 
-# Run the given program, remember its exit status.
-"$@"; st=$?
-
-# If it succeeded, we are done.
-test $st -eq 0 && exit 0
-
-# Also exit now if we it failed (or wasn't found), and '--version' was
-# passed; such an option is passed most likely to detect whether the
-# program is present and works.
-case $2 in --version|--help) exit $st;; esac
-
-# Exit code 63 means version mismatch.  This often happens when the user
-# tries to use an ancient version of a tool on a file that requires a
-# minimum version.
-if test $st -eq 63; then
-  msg="probably too old"
-elif test $st -eq 127; then
-  # Program was missing.
-  msg="missing on your system"
-else
-  # Program was found and executed, but failed.  Give up.
-  exit $st
-fi
+# normalize program name to check for.
+program=`echo "$1" | sed '
+  s/^gnu-//; t
+  s/^gnu//; t
+  s/^g//; t'`
+
+# Now exit if we have it, but it failed.  Also exit now if we
+# don't have it and --version was passed (most likely to detect
+# the program).  This is about non-GNU programs, so use $1 not
+# $program.
+case $1 in
+  lex*|yacc*)
+    # Not GNU programs, they don't have --version.
+    ;;
+
+  *)
+    if test -z "$run" && ($1 --version) > /dev/null 2>&1; then
+       # We have it, but it failed.
+       exit 1
+    elif test "x$2" = "x--version" || test "x$2" = "x--help"; then
+       # Could not run --version or --help.  This is probably someone
+       # running `$TOOL --version' or `$TOOL --help' to check whether
+       # $TOOL exists and not knowing $TOOL uses missing.
+       exit 1
+    fi
+    ;;
+esac
+
+# If it does not exist, or fails to run (possibly an outdated version),
+# try to emulate it.
+case $program in
+  aclocal*)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified \`acinclude.m4' or \`${configure_ac}'.  You might want
+         to install the \`Automake' and \`Perl' packages.  Grab them from
+         any GNU archive site."
+    touch aclocal.m4
+    ;;
+
+  autoconf*)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified \`${configure_ac}'.  You might want to install the
+         \`Autoconf' and \`GNU m4' packages.  Grab them from any GNU
+         archive site."
+    touch configure
+    ;;
 
-perl_URL=http://www.perl.org/
-flex_URL=http://flex.sourceforge.net/
-gnu_software_URL=http://www.gnu.org/software
-
-program_details ()
-{
-  case $1 in
-    aclocal|automake)
-      echo "The '$1' program is part of the GNU Automake package:"
-      echo "<$gnu_software_URL/automake>"
-      echo "It also requires GNU Autoconf, GNU m4 and Perl in order to run:"
-      echo "<$gnu_software_URL/autoconf>"
-      echo "<$gnu_software_URL/m4/>"
-      echo "<$perl_URL>"
-      ;;
-    autoconf|autom4te|autoheader)
-      echo "The '$1' program is part of the GNU Autoconf package:"
-      echo "<$gnu_software_URL/autoconf/>"
-      echo "It also requires GNU m4 and Perl in order to run:"
-      echo "<$gnu_software_URL/m4/>"
-      echo "<$perl_URL>"
-      ;;
-  esac
-}
-
-give_advice ()
-{
-  # Normalize program name to check for.
-  normalized_program=`echo "$1" | sed '
-    s/^gnu-//; t
-    s/^gnu//; t
-    s/^g//; t'`
-
-  printf '%s\n' "'$1' is $msg."
-
-  configure_deps="'configure.ac' or m4 files included by 'configure.ac'"
-  case $normalized_program in
-    autoconf*)
-      echo "You should only need it if you modified 'configure.ac',"
-      echo "or m4 files included by it."
-      program_details 'autoconf'
-      ;;
-    autoheader*)
-      echo "You should only need it if you modified 'acconfig.h' or"
-      echo "$configure_deps."
-      program_details 'autoheader'
-      ;;
-    automake*)
-      echo "You should only need it if you modified 'Makefile.am' or"
-      echo "$configure_deps."
-      program_details 'automake'
-      ;;
-    aclocal*)
-      echo "You should only need it if you modified 'acinclude.m4' or"
-      echo "$configure_deps."
-      program_details 'aclocal'
-      ;;
-   autom4te*)
-      echo "You might have modified some maintainer files that require"
-      echo "the 'automa4te' program to be rebuilt."
-      program_details 'autom4te'
-      ;;
-    bison*|yacc*)
-      echo "You should only need it if you modified a '.y' file."
-      echo "You may want to install the GNU Bison package:"
-      echo "<$gnu_software_URL/bison/>"
-      ;;
-    lex*|flex*)
-      echo "You should only need it if you modified a '.l' file."
-      echo "You may want to install the Fast Lexical Analyzer package:"
-      echo "<$flex_URL>"
-      ;;
-    help2man*)
-      echo "You should only need it if you modified a dependency" \
-           "of a man page."
-      echo "You may want to install the GNU Help2man package:"
-      echo "<$gnu_software_URL/help2man/>"
+  autoheader*)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified \`acconfig.h' or \`${configure_ac}'.  You might want
+         to install the \`Autoconf' and \`GNU m4' packages.  Grab them
+         from any GNU archive site."
+    files=`sed -n 's/^[ ]*A[CM]_CONFIG_HEADER(\([^)]*\)).*/\1/p' ${configure_ac}`
+    test -z "$files" && files="config.h"
+    touch_files=
+    for f in $files; do
+      case $f in
+      *:*) touch_files="$touch_files "`echo "$f" |
+				       sed -e 's/^[^:]*://' -e 's/:.*//'`;;
+      *) touch_files="$touch_files $f.in";;
+      esac
+    done
+    touch $touch_files
     ;;
-    makeinfo*)
-      echo "You should only need it if you modified a '.texi' file, or"
-      echo "any other file indirectly affecting the aspect of the manual."
-      echo "You might want to install the Texinfo package:"
-      echo "<$gnu_software_URL/texinfo/>"
-      echo "The spurious makeinfo call might also be the consequence of"
-      echo "using a buggy 'make' (AIX, DU, IRIX), in which case you might"
-      echo "want to install GNU make:"
-      echo "<$gnu_software_URL/make/>"
-      ;;
-    *)
-      echo "You might have modified some files without having the proper"
-      echo "tools for further handling them.  Check the 'README' file, it"
-      echo "often tells you about the needed prerequisites for installing"
-      echo "this package.  You may also peek at any GNU archive site, in"
-      echo "case some other package contains this missing '$1' program."
-      ;;
-  esac
-}
-
-give_advice "$1" | sed -e '1s/^/WARNING: /' \
-                       -e '2,$s/^/         /' >&2
-
-# Propagate the correct exit status (expected to be 127 for a program
-# not found, 63 for a program that failed due to version mismatch).
-exit $st
+
+  automake*)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified \`Makefile.am', \`acinclude.m4' or \`${configure_ac}'.
+         You might want to install the \`Automake' and \`Perl' packages.
+         Grab them from any GNU archive site."
+    find . -type f -name Makefile.am -print |
+	   sed 's/\.am$/.in/' |
+	   while read f; do touch "$f"; done
+    ;;
+
+  autom4te*)
+    echo 1>&2 "\
+WARNING: \`$1' is needed, but is $msg.
+         You might have modified some files without having the
+         proper tools for further handling them.
+         You can get \`$1' as part of \`Autoconf' from any GNU
+         archive site."
+
+    file=`echo "$*" | sed -n "$sed_output"`
+    test -z "$file" && file=`echo "$*" | sed -n "$sed_minuso"`
+    if test -f "$file"; then
+	touch $file
+    else
+	test -z "$file" || exec >$file
+	echo "#! /bin/sh"
+	echo "# Created by GNU Automake missing as a replacement of"
+	echo "#  $ $@"
+	echo "exit 0"
+	chmod +x $file
+	exit 1
+    fi
+    ;;
+
+  bison*|yacc*)
+    echo 1>&2 "\
+WARNING: \`$1' $msg.  You should only need it if
+         you modified a \`.y' file.  You may need the \`Bison' package
+         in order for those modifications to take effect.  You can get
+         \`Bison' from any GNU archive site."
+    rm -f y.tab.c y.tab.h
+    if test $# -ne 1; then
+        eval LASTARG=\${$#}
+	case $LASTARG in
+	*.y)
+	    SRCFILE=`echo "$LASTARG" | sed 's/y$/c/'`
+	    if test -f "$SRCFILE"; then
+	         cp "$SRCFILE" y.tab.c
+	    fi
+	    SRCFILE=`echo "$LASTARG" | sed 's/y$/h/'`
+	    if test -f "$SRCFILE"; then
+	         cp "$SRCFILE" y.tab.h
+	    fi
+	  ;;
+	esac
+    fi
+    if test ! -f y.tab.h; then
+	echo >y.tab.h
+    fi
+    if test ! -f y.tab.c; then
+	echo 'main() { return 0; }' >y.tab.c
+    fi
+    ;;
+
+  lex*|flex*)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified a \`.l' file.  You may need the \`Flex' package
+         in order for those modifications to take effect.  You can get
+         \`Flex' from any GNU archive site."
+    rm -f lex.yy.c
+    if test $# -ne 1; then
+        eval LASTARG=\${$#}
+	case $LASTARG in
+	*.l)
+	    SRCFILE=`echo "$LASTARG" | sed 's/l$/c/'`
+	    if test -f "$SRCFILE"; then
+	         cp "$SRCFILE" lex.yy.c
+	    fi
+	  ;;
+	esac
+    fi
+    if test ! -f lex.yy.c; then
+	echo 'main() { return 0; }' >lex.yy.c
+    fi
+    ;;
+
+  help2man*)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+	 you modified a dependency of a manual page.  You may need the
+	 \`Help2man' package in order for those modifications to take
+	 effect.  You can get \`Help2man' from any GNU archive site."
+
+    file=`echo "$*" | sed -n "$sed_output"`
+    test -z "$file" && file=`echo "$*" | sed -n "$sed_minuso"`
+    if test -f "$file"; then
+	touch $file
+    else
+	test -z "$file" || exec >$file
+	echo ".ab help2man is required to generate this page"
+	exit $?
+    fi
+    ;;
+
+  makeinfo*)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified a \`.texi' or \`.texinfo' file, or any other file
+         indirectly affecting the aspect of the manual.  The spurious
+         call might also be the consequence of using a buggy \`make' (AIX,
+         DU, IRIX).  You might want to install the \`Texinfo' package or
+         the \`GNU make' package.  Grab either from any GNU archive site."
+    # The file to touch is that specified with -o ...
+    file=`echo "$*" | sed -n "$sed_output"`
+    test -z "$file" && file=`echo "$*" | sed -n "$sed_minuso"`
+    if test -z "$file"; then
+      # ... or it is the one specified with @setfilename ...
+      infile=`echo "$*" | sed 's/.* \([^ ]*\) *$/\1/'`
+      file=`sed -n '
+	/^@setfilename/{
+	  s/.* \([^ ]*\) *$/\1/
+	  p
+	  q
+	}' $infile`
+      # ... or it is derived from the source name (dir/f.texi becomes f.info)
+      test -z "$file" && file=`echo "$infile" | sed 's,.*/,,;s,.[^.]*$,,'`.info
+    fi
+    # If the file does not exist, the user really needs makeinfo;
+    # let's fail without touching anything.
+    test -f $file || exit 1
+    touch $file
+    ;;
+
+  *)
+    echo 1>&2 "\
+WARNING: \`$1' is needed, and is $msg.
+         You might have modified some files without having the
+         proper tools for further handling them.  Check the \`README' file,
+         it often tells you about the needed prerequisites for installing
+         this package.  You may also peek at any GNU archive site, in case
+         some other package would contain this missing \`$1' program."
+    exit 1
+    ;;
+esac
+
+exit 0
 
 # Local variables:
 # eval: (add-hook 'write-file-hooks 'time-stamp)
diff --git a/configure.ac b/configure.ac
index fe379b4..bbe9da2 100644
--- a/configure.ac
+++ b/configure.ac
@@ -1,8 +1,8 @@
 AC_PREREQ(2.59)
 AC_COPYRIGHT([Copyright (c) 2006 Verdens Gang AS
-Copyright (c) 2006-2014 Varnish Software AS])
+Copyright (c) 2006-2015 Varnish Software AS])
 AC_REVISION([$Id$])
-AC_INIT([Varnish], [4.0.2], [varnish-dev@varnish-cache.org])
+AC_INIT([Varnish], [4.0.3], [varnish-dev@varnish-cache.org])
 AC_CONFIG_SRCDIR(include/miniobj.h)
 AC_CONFIG_HEADERS([config.h])
 AC_CONFIG_MACRO_DIR([m4])
diff --git a/doc/changes.html b/doc/changes.html
index 28ecd1c..6112ab2 100644
--- a/doc/changes.html
+++ b/doc/changes.html
@@ -317,6 +317,82 @@ ul.auto-toc {
 <div class="document">
 
 
+<div class="section" id="changes-from-4-0-3-rc3-to-4-0-3-2015-02-17">
+<h1>Changes from 4.0.3-rc3 to 4.0.3 (2015-02-17)</h1>
+<ul class="simple">
+<li>No changes.</li>
+</ul>
+</div>
+<div class="section" id="changes-from-4-0-3-rc2-to-4-0-3-rc3-2015-02-11">
+<h1>Changes from 4.0.3-rc2 to 4.0.3-rc3 (2015-02-11)</h1>
+<ul class="simple">
+<li>Superseded objects are now expired immediately.</li>
+</ul>
+<div class="section" id="bugs-fixed">
+<h2>Bugs fixed</h2>
+<ul class="simple">
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1462">1462</a> - Use first/last log entry in varnishncsa.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1539">1539</a> - Avoid panic when expiry thread modifies a candidate object.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1637">1637</a> - Fail the fetch processing if the vep callback failed.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1665">1665</a> - Be more accurate when computing client RX_TIMEOUT.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1672">1672</a> - Do not panic on unsolicited 304 response to non-200 bereq.</li>
+</ul>
+</div>
+</div>
+<div class="section" id="changes-from-4-0-3-rc1-to-4-0-3-rc2-2015-01-28">
+<h1>Changes from 4.0.3-rc1 to 4.0.3-rc2 (2015-01-28)</h1>
+<p>Changes since 4.0.3-rc1:</p>
+<ul class="simple">
+<li>Assorted documentation updates.</li>
+</ul>
+<div class="section" id="id6">
+<h2>Bugs fixed</h2>
+<ul class="simple">
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1479">1479</a> - Fix out-of-tree builds.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1578">1566</a> - Escape VCL string question marks.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1616">1616</a> - Correct header file placement.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1620">1620</a> - Fail miss properly if out of backend threads. (Also <a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1621">1621</a>)</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1628">1628</a> - Avoid dereferencing null in VBO_DerefBusyObj().</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1629">1629</a> - Ditch rest of waiting list on failure to reschedule.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1660">1660</a> - Don't attempt range delivery on a synth response</li>
+</ul>
+</div>
+</div>
+<div class="section" id="changes-from-4-0-2-to-4-0-3-rc1-2015-01-15">
+<h1>Changes from 4.0.2 to 4.0.3-rc1 (2015-01-15)</h1>
+<p>Changes since 4.0.2:</p>
+<ul class="simple">
+<li>Support older autoconf (&lt; 2.63b) (el5)</li>
+<li>A lot of minor documentation fixes.</li>
+<li>bereq.uncacheable is now read-only.</li>
+<li>obj.uncacheable is now readable in vcl_deliver.</li>
+<li>[varnishadm] Prefer exact matches for backend.set_healthy. Bug <a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1349">1349</a>.</li>
+<li>Hard-coded -sfile default size is removed.</li>
+<li>[packaging] EL6 packages are once again built with -O2.</li>
+<li>[parameter] fetch_chunksize default is reduced to 16KB. (from 128KB)</li>
+<li>Added std.time() which converts strings to VCL_TIME.</li>
+<li>[packaging] packages now Provide strictABI (gitref) and ABI (VRT major/minor) for VMOD use.</li>
+</ul>
+<div class="section" id="id15">
+<h2>Bugs fixed</h2>
+<ul class="simple">
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1378">1378</a> - Properly escape non-printable characters in varnishncsa.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1596">1596</a> - Delay HSH_Complete() until the storage sanity functions has finished.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1506">1506</a> - Keep Content-Length from backend if we can.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1602">1602</a> - Fix a cornercase related to empty pass objects.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1607">1607</a> - Don't leak reqs on failure to revive from waitinglist.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1610">1610</a> - Update forgotten varnishlog example to 4.0 syntax.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1612">1612</a> - Fix a cornercase related to empty pass objects.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1623">1623</a> - Fix varnishhist -d segfault.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1636">1636</a> - Outdated paragraph in Vary: documentation</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1638">1638</a> - Fix panic when retrying a failed backend fetch.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1639">1639</a> - Restore the default SIGSEGV handler during pan_ic</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1647">1647</a> - Relax an assertion for the IMS update candidate object.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1648">1648</a> - Avoid partial IMS updates to replace old object.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1650">1650</a> - Collapse multiple X-Forwarded-For headers</li>
+</ul>
+</div>
+</div>
 <div class="section" id="changes-from-4-0-2-rc1-to-4-0-2-2014-10-08">
 <h1>Changes from 4.0.2-rc1 to 4.0.2 (2014-10-08)</h1>
 <p>New since 4.0.2-rc1:</p>
@@ -350,7 +426,7 @@ complete set of VCL and included VCL files.</li>
 <li>Fix small memory leak in ESI parser.</li>
 <li>Fix unreported race/assert in V1D_Deliver().</li>
 </ul>
-<div class="section" id="bugs-fixed">
+<div class="section" id="id31">
 <h2>Bugs fixed</h2>
 <ul class="simple">
 <li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1553">1553</a> - Fully reset workspace (incl. Vary state) before reusing it.</li>
@@ -374,6 +450,7 @@ complete set of VCL and included VCL files.</li>
 <li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1567">1567</a> - Compile on systems without SO_SNDTIMEO/SO_RCVTIMEO.</li>
 <li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1512">1512</a> - Changes to bereq are lost between v_b_r and v_b_f.</li>
 <li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1563">1563</a> - Increase varnishtest read timeout.</li>
+<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1561">1561</a> - Never call a VDP with zero length unless done.</li>
 <li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1562">1562</a> - Fail correctly when rereading a failed client request body.</li>
 <li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1521">1521</a> - VCL compilation fails on OSX x86_64.</li>
 <li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1547">1547</a> - Panic when increasing shm_reclen.</li>
@@ -412,7 +489,7 @@ varnishncsa.</li>
 <li>VMOD ABI requirements are relaxed, a VMOD no longer have to be run on the
 same git revision as it was compiled for. Replaced by a major/minor ABI counter.</li>
 </ul>
-<div class="section" id="id32">
+<div class="section" id="id64">
 <h2>Bugs fixed</h2>
 <ul class="simple">
 <li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1269">1269</a> - Use correct byte counters in varnishncsa when piping a request.</li>
@@ -439,7 +516,7 @@ same git revision as it was compiled for. Replaced by a major/minor ABI counter.
 <li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1501">1501</a> - Handle that a director couldn't pick a backend.</li>
 <li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1495">1495</a> - Reduce WRK_SumStat contention.</li>
 <li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1510">1510</a> - Complain on symbol reuse in VCL.</li>
-<li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1514">1514</a> - Document storage.NAME.free_space and .used_space [docs]</li>
+<li><a class="reference external" href="http://varnish-cache.org/trac/ticket/1514">1514</a> - Document storage.NAME.free_space and .used_space [docs]</li>
 <li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1518">1518</a> - Suppress body on 304 response when using ESI.</li>
 <li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1519">1519</a> - Round-robin director does not support weight. [docs]</li>
 </ul>
@@ -453,7 +530,7 @@ same git revision as it was compiled for. Replaced by a major/minor ABI counter.
 <li>In VCL, req.backend_hint is available in vcl_hit</li>
 <li>ncurses is now a dependency.</li>
 </ul>
-<div class="section" id="id60">
+<div class="section" id="id91">
 <h2>Bugs fixed</h2>
 <ul class="simple">
 <li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1469">1469</a> - Fix build error on PPC</li>
@@ -463,8 +540,8 @@ same git revision as it was compiled for. Replaced by a major/minor ABI counter.
 </ul>
 </div>
 </div>
-<div class="section" id="changes-from-4-0-0-tp2-to-4-0-0-beta1">
-<h1>Changes from 4.0.0 TP2 to 4.0.0 beta1</h1>
+<div class="section" id="changes-from-4-0-0-tp2-to-4-0-0-beta1-2014-03-27">
+<h1>Changes from 4.0.0 TP2 to 4.0.0 beta1 (2014-03-27)</h1>
 <p>New since TP2:</p>
 <ul class="simple">
 <li>Previous always-appended code called default.vcl is now called builtin.vcl.
@@ -486,7 +563,7 @@ times of high IO load/scheduling latency.</li>
 <li>return(hash) is now the default return action from vcl_recv.</li>
 <li>req.backend is now req.backend_hint. beresp.storage is beresp.storage_hint.</li>
 </ul>
-<div class="section" id="id65">
+<div class="section" id="id96">
 <h2>Bugs fixed</h2>
 <ul class="simple">
 <li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1460">1460</a> - tools now use the new timestamp format.</li>
@@ -505,8 +582,8 @@ times of high IO load/scheduling latency.</li>
 </ul>
 </div>
 </div>
-<div class="section" id="changes-from-4-0-0-tp1-to-4-0-0-tp2">
-<h1>Changes from 4.0.0 TP1 to 4.0.0 TP2</h1>
+<div class="section" id="changes-from-4-0-0-tp1-to-4-0-0-tp2-2014-01-23">
+<h1>Changes from 4.0.0 TP1 to 4.0.0 TP2 (2014-01-23)</h1>
 <div class="section" id="new-since-from-4-0-0-tp1">
 <h2>New since from 4.0.0 TP1</h2>
 <ul class="simple">
@@ -514,7 +591,7 @@ times of high IO load/scheduling latency.</li>
 <li>New format for VMOD description files. (.vcc)</li>
 </ul>
 </div>
-<div class="section" id="id79">
+<div class="section" id="id110">
 <h2>Bugs fixed</h2>
 <ul class="simple">
 <li><a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1404">1404</a> - Don't send Content-Length on 304 Not Modified responses.</li>
@@ -543,8 +620,30 @@ times of high IO load/scheduling latency.</li>
 </ul>
 </div>
 </div>
-<div class="section" id="changes-from-3-0-5-rc-1-to-3-0-5">
-<h1>Changes from 3.0.5 rc 1 to 3.0.5</h1>
+<div class="section" id="changes-from-3-0-6rc1-to-3-0-6-2014-10-16">
+<h1>Changes from 3.0.6rc1 to 3.0.6 (2014-10-16)</h1>
+<ul class="simple">
+<li>Minor changes to documentation.</li>
+<li>[varnishadm] Add termcap workaround for libedit. Bug <a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1531">1531</a>.</li>
+</ul>
+</div>
+<div class="section" id="changes-from-3-0-5-to-3-0-6rc1-2014-06-24">
+<h1>Changes from 3.0.5 to 3.0.6rc1 (2014-06-24)</h1>
+<ul class="simple">
+<li>Document storage.&lt;name&gt;.* VCL variables. Bug <a class="reference external" href="http://varnish-cache.org/trac/ticket/1514">1514</a>.</li>
+<li>Fix memory alignment panic when http_max_hdr is not a multiple of 4. Bug <a class="reference external" href="http://varnish-cache.org/trac/ticket/1327">1327</a>.</li>
+<li>Avoid negative ReqEnd timestamps with ESI. Bug <a class="reference external" href="http://varnish-cache.org/trac/ticket/1297">1297</a>.</li>
+<li>%D format for varnishncsa is now an integer (as documented)</li>
+<li>Fix compile errors with clang.</li>
+<li>Clear objectcore flags earlier in ban lurker to avoid spinning thread. Bug <a class="reference external" href="http://varnish-cache.org/trac/ticket/1470">1470</a>.</li>
+<li>Patch embedded jemalloc to avoid segfault. Bug <a class="reference external" href="http://varnish-cache.org/trac/ticket/1448">1448</a>.</li>
+<li>Allow backend names to start with if, include or else. Bug <a class="reference external" href="http://varnish-cache.org/trac/ticket/1439">1439</a>.</li>
+<li>Stop handling gzip after gzip body end. Bug <a class="reference external" href="http://varnish-cache.org/trac/ticket/1086">1086</a>.</li>
+<li>Document %D and %T for varnishncsa.</li>
+</ul>
+</div>
+<div class="section" id="changes-from-3-0-5-rc-1-to-3-0-5-2013-12-02">
+<h1>Changes from 3.0.5 rc 1 to 3.0.5 (2013-12-02)</h1>
 <div class="section" id="varnishd">
 <h2>varnishd</h2>
 <ul class="simple">
@@ -555,7 +654,7 @@ server.ip is accessed after a client has closed the connection. <cite>Bug #1376<
 </div>
 <div class="section" id="changes-from-3-0-4-to-3-0-5-rc-1">
 <h1>Changes from 3.0.4 to 3.0.5 rc 1</h1>
-<div class="section" id="id96">
+<div class="section" id="id134">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>Stop printing error messages on ESI parse errors</li>
@@ -584,9 +683,9 @@ transaction. <cite>Bug #1325</cite></li>
 </ul>
 </div>
 </div>
-<div class="section" id="changes-from-3-0-4-rc-1-to-3-0-4">
-<h1>Changes from 3.0.4 rc 1 to 3.0.4</h1>
-<div class="section" id="id97">
+<div class="section" id="changes-from-3-0-4-rc-1-to-3-0-4-2013-06-14">
+<h1>Changes from 3.0.4 rc 1 to 3.0.4 (2013-06-14)</h1>
+<div class="section" id="id135">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>Set the waiter pipe as non-blocking and record overflows.  <cite>Bug
@@ -599,7 +698,7 @@ negatives.  CVE-2013-4090.    <cite>Bug #1312</cite></li>
 </div>
 <div class="section" id="changes-from-3-0-3-to-3-0-4-rc-1">
 <h1>Changes from 3.0.3 to 3.0.4 rc 1</h1>
-<div class="section" id="id98">
+<div class="section" id="id136">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>Fix error handling when uncompressing fetched objects for ESI
@@ -613,14 +712,14 @@ processing. <cite>Bug #1184</cite></li>
 <li>Make hit-for-pass correctly prefer the transient storage.</li>
 </ul>
 </div>
-<div class="section" id="id99">
+<div class="section" id="id137">
 <h2>varnishlog</h2>
 <ul class="simple">
 <li>If -m, but neither -b or -c is given, assume both.  This filters out
 a lot of noise when -m is used to filter.  <cite>Bug #1071</cite></li>
 </ul>
 </div>
-<div class="section" id="id100">
+<div class="section" id="id138">
 <h2>varnishadm</h2>
 <ul class="simple">
 <li>Improve tab completion and require libedit/readline to build.</li>
@@ -651,9 +750,9 @@ least on i386.</li>
 </ul>
 </div>
 </div>
-<div class="section" id="changes-from-3-0-2-to-3-0-3">
-<h1>Changes from 3.0.2 to 3.0.3</h1>
-<div class="section" id="id101">
+<div class="section" id="changes-from-3-0-2-to-3-0-3-2012-08-20">
+<h1>Changes from 3.0.2 to 3.0.3 (2012-08-20)</h1>
+<div class="section" id="id139">
 <h2>Varnishd</h2>
 <ul class="simple">
 <li>Fix a race on the n_sess counter. This race made varnish do excessive
@@ -709,7 +808,7 @@ many ESI includes on an object. <a class="reference external" href="http://varni
 <li>Small performance optimizations.</li>
 </ul>
 </div>
-<div class="section" id="id103">
+<div class="section" id="id141">
 <h2>varnishncsa</h2>
 <ul class="simple">
 <li>Support for tn in varnishncsa format strings.</li>
@@ -732,7 +831,7 @@ VCL.</li>
 <li>Add json output (-j).</li>
 </ul>
 </div>
-<div class="section" id="id104">
+<div class="section" id="id142">
 <h2>Other</h2>
 <ul class="simple">
 <li>Documentation updates.</li>
@@ -745,9 +844,9 @@ VCL.</li>
 </ul>
 </div>
 </div>
-<div class="section" id="changes-from-3-0-2-rc-1-to-3-0-2">
-<h1>Changes from 3.0.2 rc 1 to 3.0.2</h1>
-<div class="section" id="id105">
+<div class="section" id="changes-from-3-0-2-rc-1-to-3-0-2-2011-10-26">
+<h1>Changes from 3.0.2 rc 1 to 3.0.2 (2011-10-26)</h1>
+<div class="section" id="id143">
 <h2>Varnishd</h2>
 <ul class="simple">
 <li>Make the size of the synthetic object workspace equal to
@@ -759,14 +858,14 @@ does not have anything to do.</li>
 it will now give a syntax error.</li>
 </ul>
 </div>
-<div class="section" id="id106">
+<div class="section" id="id144">
 <h2>varnishncsa</h2>
 <ul class="simple">
 <li>Add default values for some fields when logging incomplete records
 and document the default values.</li>
 </ul>
 </div>
-<div class="section" id="id107">
+<div class="section" id="id145">
 <h2>Other</h2>
 <ul class="simple">
 <li>Documentation updates</li>
@@ -774,9 +873,9 @@ and document the default values.</li>
 </ul>
 </div>
 </div>
-<div class="section" id="changes-from-3-0-1-to-3-0-2-rc-1">
-<h1>Changes from 3.0.1 to 3.0.2 rc 1</h1>
-<div class="section" id="id108">
+<div class="section" id="changes-from-3-0-1-to-3-0-2-rc-1-2011-10-06">
+<h1>Changes from 3.0.1 to 3.0.2 rc 1 (2011-10-06)</h1>
+<div class="section" id="id146">
 <h2>Varnishd</h2>
 <ul class="simple">
 <li>Only log the first 20 bytes of extra headers to prevent overflows.</li>
@@ -804,7 +903,7 @@ bytes.  This better matches what other HTTPds have.   <a class="reference extern
 loading to fail.</li>
 </ul>
 </div>
-<div class="section" id="id109">
+<div class="section" id="id147">
 <h2>varnishncsa</h2>
 <ul class="simple">
 <li>Fixed crash when client was sending illegal HTTP headers.</li>
@@ -812,7 +911,7 @@ loading to fail.</li>
 fixed.</li>
 </ul>
 </div>
-<div class="section" id="id110">
+<div class="section" id="id148">
 <h2>Other</h2>
 <ul class="simple">
 <li>Documentation updates</li>
@@ -820,9 +919,9 @@ fixed.</li>
 </ul>
 </div>
 </div>
-<div class="section" id="changes-from-3-0-1-rc-1-to-3-0-1">
-<h1>Changes from 3.0.1 rc 1 to 3.0.1</h1>
-<div class="section" id="id111">
+<div class="section" id="changes-from-3-0-1-rc-1-to-3-0-1-2011-08-30">
+<h1>Changes from 3.0.1 rc 1 to 3.0.1 (2011-08-30)</h1>
+<div class="section" id="id149">
 <h2>Varnishd</h2>
 <ul class="simple">
 <li>Fix crash in streaming code.</li>
@@ -831,29 +930,29 @@ director.</li>
 <li>The parameter <cite>http_req_size</cite> has been reduced on 32 bit machines.</li>
 </ul>
 </div>
-<div class="section" id="id112">
+<div class="section" id="id150">
 <h2>VCL</h2>
 <ul class="simple">
 <li>Disallow error in the <cite>vcl_init</cite> and <cite>vcl_fini</cite> VCL functions.</li>
 </ul>
 </div>
-<div class="section" id="id113">
+<div class="section" id="id151">
 <h2>varnishncsa</h2>
 <ul class="simple">
 <li>Fixed crash when using <cite>-X</cite>.</li>
 <li>Fix error when the time to first byte was in the format string.</li>
 </ul>
 </div>
-<div class="section" id="id114">
+<div class="section" id="id152">
 <h2>Other</h2>
 <ul class="simple">
 <li>Documentation updates</li>
 </ul>
 </div>
 </div>
-<div class="section" id="changes-from-3-0-0-to-3-0-1-rc-1">
-<h1>Changes from 3.0.0 to 3.0.1 rc 1</h1>
-<div class="section" id="id115">
+<div class="section" id="changes-from-3-0-0-to-3-0-1-rc-1-2011-08-24">
+<h1>Changes from 3.0.0 to 3.0.1 rc 1 (2011-08-24)</h1>
+<div class="section" id="id153">
 <h2>Varnishd</h2>
 <ul class="simple">
 <li>Avoid sending an empty end-chunk when sending bodyless responsed.</li>
@@ -874,7 +973,7 @@ object from the same backend unless health probes were enabled.
 This has been fixed and it will now retry a different backend.</li>
 </ul>
 </div>
-<div class="section" id="id116">
+<div class="section" id="id154">
 <h2>VCL</h2>
 <ul class="simple">
 <li>Request specific variables such as <cite>client.*</cite> and <cite>server.*</cite> are now
@@ -883,7 +982,7 @@ correctly marked as not available in <cite>vcl_init</cite> and <cite>vcl_fini</c
 same line.  This now works correctly.  <a class="reference external" href="http://varnish-cache.org/trac/ticket/948">Bug #948</a>.</li>
 </ul>
 </div>
-<div class="section" id="id117">
+<div class="section" id="id155">
 <h2>varnishncsa</h2>
 <ul class="simple">
 <li>Add support for logging arbitrary request and response headers.</li>
@@ -893,14 +992,14 @@ string.</li>
 <li>Report user specified format string errors better.</li>
 </ul>
 </div>
-<div class="section" id="id118">
+<div class="section" id="id156">
 <h2>varnishlog</h2>
 <ul class="simple">
 <li><cite>varnishlog -r</cite> now works correctly again and no longer opens the
 shared log file of the running Varnish.</li>
 </ul>
 </div>
-<div class="section" id="id119">
+<div class="section" id="id157">
 <h2>Other</h2>
 <ul class="simple">
 <li>Various documentation updates.</li>
@@ -912,22 +1011,22 @@ all vmods against the new version of Varnish.</li>
 </ul>
 </div>
 </div>
-<div class="section" id="changes-from-3-0-beta-2-to-3-0-0">
-<h1>Changes from 3.0 beta 2 to 3.0.0</h1>
-<div class="section" id="id120">
+<div class="section" id="changes-from-3-0-beta-2-to-3-0-0-2011-06-16">
+<h1>Changes from 3.0 beta 2 to 3.0.0 (2011-06-16)</h1>
+<div class="section" id="id158">
 <h2>Varnishd</h2>
 <ul class="simple">
 <li>Avoid sending an empty end-chunk when sending bodyless responsed.</li>
 </ul>
 </div>
-<div class="section" id="id121">
+<div class="section" id="id159">
 <h2>VCL</h2>
 <ul class="simple">
 <li>The <cite>synthetic</cite> keyword has now been properly marked as only
 available in <cite>vcl_deliver</cite>.  <a class="reference external" href="http://varnish-cache.org/trac/ticket/936">Bug #936</a>.</li>
 </ul>
 </div>
-<div class="section" id="id122">
+<div class="section" id="id160">
 <h2>varnishadm</h2>
 <ul class="simple">
 <li>Fix crash if the secret file was unreadable.  <a class="reference external" href="http://varnish-cache.org/trac/ticket/935">Bug #935</a>.</li>
@@ -938,7 +1037,7 @@ reason.</li>
 </div>
 <div class="section" id="changes-from-3-0-beta-1-to-3-0-beta-2">
 <h1>Changes from 3.0 beta 1 to 3.0 beta 2</h1>
-<div class="section" id="id123">
+<div class="section" id="id161">
 <h2>Varnishd</h2>
 <ul class="simple">
 <li>thread_pool_min and thread_pool_max now each refer to the number of
@@ -952,7 +1051,7 @@ single-threaded so we do not want to do this work there in the first
 place.  Use varnishstat instead.</li>
 </ul>
 </div>
-<div class="section" id="id124">
+<div class="section" id="id162">
 <h2>VCL</h2>
 <ul class="simple">
 <li>VCL now treats null arguments (unset headers for instance) as empty
@@ -967,7 +1066,7 @@ appropriate.</li>
 backends and ACLs.</li>
 </ul>
 </div>
-<div class="section" id="id125">
+<div class="section" id="id163">
 <h2>varnishncsa</h2>
 <ul class="simple">
 <li>varnishncsa now ignores piped requests, since we have no way of
@@ -994,7 +1093,7 @@ to do <tt class="docutils literal"><span class="pre">ban(&quot;req.url</span> ==
 works and is recommended.</li>
 </ul>
 </div>
-<div class="section" id="id126">
+<div class="section" id="id164">
 <h2>Varnishd</h2>
 <ul class="simple">
 <li>Add streaming on <tt class="docutils literal">pass</tt> and <tt class="docutils literal">miss</tt>.  This is controlled by the
@@ -1080,7 +1179,7 @@ transactions.  The parameter can be repeated, in which case it is
 logically and-ed together.</li>
 </ul>
 </div>
-<div class="section" id="id128">
+<div class="section" id="id166">
 <h3>varnishadm</h3>
 <ul class="simple">
 <li>varnishadm will now pick up the -S and -T arguments from the shared
@@ -1091,7 +1190,7 @@ shared memory log file</li>
 <li>add libedit support</li>
 </ul>
 </div>
-<div class="section" id="id129">
+<div class="section" id="id167">
 <h3>varnishstat</h3>
 <ul class="simple">
 <li>reopen shared memory log if the varnishd process is restarted.</li>
@@ -1101,7 +1200,7 @@ the use of <tt class="docutils literal"><span class="pre">-f</span></tt>.</li>
 <li>display per-backend health information</li>
 </ul>
 </div>
-<div class="section" id="id130">
+<div class="section" id="id168">
 <h3>varnishncsa</h3>
 <ul class="simple">
 <li>Report error if called with <tt class="docutils literal"><span class="pre">-i</span></tt> and <tt class="docutils literal"><span class="pre">-I</span></tt> as they do not make
@@ -1111,7 +1210,7 @@ log formats are supported, as well as some Varnish-specific ones.
 See the documentation for further information.  <a class="reference external" href="http://varnish-cache.org/trac/ticket/712">Bug #712</a> and <a class="reference external" href="http://varnish-cache.org/trac/ticket/485">bug #485</a></li>
 </ul>
 </div>
-<div class="section" id="id131">
+<div class="section" id="id169">
 <h3>varnishtest</h3>
 <ul class="simple">
 <li>add <tt class="docutils literal"><span class="pre">-l</span></tt> and <tt class="docutils literal"><span class="pre">-L</span></tt> switches which leave <tt class="docutils literal">/tmp/vtc.*</tt> behind on
@@ -1120,7 +1219,7 @@ error and unconditionally respectively.</li>
 default.</li>
 </ul>
 </div>
-<div class="section" id="id132">
+<div class="section" id="id170">
 <h3>varnishtop</h3>
 <ul class="simple">
 <li>add <tt class="docutils literal"><span class="pre">-p</span> $period</tt> parameter.  The units in varnishtop were
@@ -1128,7 +1227,7 @@ previously undefined, they are now in requests/period.  The default
 period is 60 seconds.</li>
 </ul>
 </div>
-<div class="section" id="id133">
+<div class="section" id="id171">
 <h3>varnishlog</h3>
 <ul class="simple">
 <li>group requests by default.  This can be turned off by using <tt class="docutils literal"><span class="pre">-O</span></tt></li>
@@ -1136,14 +1235,14 @@ period is 60 seconds.</li>
 </ul>
 </div>
 </div>
-<div class="section" id="id134">
+<div class="section" id="id172">
 <h2>VMODs</h2>
 <ul class="simple">
 <li>Add a std vmod which includes a random function, log, syslog,
 fileread, collect,</li>
 </ul>
 </div>
-<div class="section" id="id135">
+<div class="section" id="id173">
 <h2>VCL</h2>
 <ul class="simple">
 <li>Change string concatenation to be done using <tt class="docutils literal">+</tt> rather than
@@ -1206,7 +1305,7 @@ directory as they are not for public consumption and have no ABI/API
 guarantees.</li>
 </ul>
 </div>
-<div class="section" id="id136">
+<div class="section" id="id174">
 <h2>Other</h2>
 <ul class="simple">
 <li>Python is now required to build</li>
@@ -1219,9 +1318,9 @@ much better shape than before</li>
 </ul>
 </div>
 </div>
-<div class="section" id="changes-from-2-1-4-to-2-1-5">
-<h1>Changes from 2.1.4 to 2.1.5</h1>
-<div class="section" id="id137">
+<div class="section" id="changes-from-2-1-4-to-2-1-5-2011-01-25">
+<h1>Changes from 2.1.4 to 2.1.5 (2011-01-25)</h1>
+<div class="section" id="id175">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>On pass from vcl_recv, we did not remove the backends Content-Length
@@ -1268,7 +1367,7 @@ here-documents.</li>
 <li>Fix a problem with the expiry thread slacking off during high load.</li>
 </ul>
 </div>
-<div class="section" id="id138">
+<div class="section" id="id176">
 <h2>varnishtest</h2>
 <ul class="simple">
 <li>Remove no longer existing -L option.</li>
@@ -1277,7 +1376,7 @@ here-documents.</li>
 </div>
 <div class="section" id="changes-from-2-1-3-to-2-1-4">
 <h1>Changes from 2.1.3 to 2.1.4</h1>
-<div class="section" id="id139">
+<div class="section" id="id177">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>An embarrasing typo in the new binary heap layout caused inflated
@@ -1335,20 +1434,20 @@ colon.</li>
 make preloading or periodically refreshing content work better.</li>
 </ul>
 </div>
-<div class="section" id="id140">
+<div class="section" id="id178">
 <h2>varnishncsa</h2>
 <ul class="simple">
 <li>varnishncsa would in some cases be confused by ESI requests and
 output invalid lines. This has now been fixed.</li>
 </ul>
 </div>
-<div class="section" id="id141">
+<div class="section" id="id179">
 <h2>varnishlog</h2>
 <ul class="simple">
 <li>varnishlog now allows -o and -u together.</li>
 </ul>
 </div>
-<div class="section" id="id142">
+<div class="section" id="id180">
 <h2>varnishtop</h2>
 <ul class="simple">
 <li>varnishtop would crash on 32 bit architectures. This has been fixed.</li>
@@ -1364,7 +1463,7 @@ parts of the string being matched. This has been fixed.</li>
 </div>
 <div class="section" id="changes-from-2-1-2-to-2-1-3">
 <h1>Changes from 2.1.2 to 2.1.3</h1>
-<div class="section" id="id143">
+<div class="section" id="id181">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>Improve scalability of critbit.</li>
@@ -1390,7 +1489,7 @@ HTTP requests</li>
 related to that socket will return EINVAL. We now handle this better.</li>
 </ul>
 </div>
-<div class="section" id="id144">
+<div class="section" id="id182">
 <h2>libvarnishapi</h2>
 <ul class="simple">
 <li>The -X parameter didn't work correctly. This has been fixed.</li>
@@ -1399,7 +1498,7 @@ related to that socket will return EINVAL. We now handle this better.</li>
 </div>
 <div class="section" id="changes-from-2-1-1-to-2-1-2">
 <h1>Changes from 2.1.1 to 2.1.2</h1>
-<div class="section" id="id145">
+<div class="section" id="id183">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>When adding Range support for 2.1.1, we accidentially introduced a
@@ -1411,7 +1510,7 @@ Content-Length, but some load balancers would get very confused.</li>
 </div>
 <div class="section" id="changes-from-2-1-1-to-2-1-1">
 <h1>Changes from 2.1.1 to 2.1.1</h1>
-<div class="section" id="id146">
+<div class="section" id="id184">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>The changelog in 2.1.0 included syntax errors, causing the generated
@@ -1453,7 +1552,7 @@ objects, has been added..</li>
 </div>
 <div class="section" id="changes-from-2-0-6-to-2-1-0">
 <h1>Changes from 2.0.6 to 2.1.0</h1>
-<div class="section" id="id147">
+<div class="section" id="id185">
 <h2>varnishd</h2>
 <ul>
 <li><p class="first">Persistent storage is now experimentally supported using the
@@ -1606,20 +1705,20 @@ sessions.</p>
 </li>
 </ul>
 </div>
-<div class="section" id="id148">
+<div class="section" id="id186">
 <h2>varnishstat</h2>
 <ul class="simple">
 <li>Make use of the new uptime field in the shared memory log rather than
 synthesizing it from the start time.</li>
 </ul>
 </div>
-<div class="section" id="id149">
+<div class="section" id="id187">
 <h2>varnishlog</h2>
 <ul class="simple">
 <li>Exit at the end of the file when started with -d.</li>
 </ul>
 </div>
-<div class="section" id="id150">
+<div class="section" id="id188">
 <h2>varnishadm</h2>
 <ul class="simple">
 <li>varnishadm can now have a timeout when trying to connect to the
@@ -1631,7 +1730,7 @@ varnishd</li>
 </div>
 <div class="section" id="changes-from-2-0-5-to-2-0-6">
 <h1>Changes from 2.0.5 to 2.0.6</h1>
-<div class="section" id="id151">
+<div class="section" id="id189">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>2.0.5 had an off-by-one error in the ESI handling causing includes to
@@ -1654,7 +1753,7 @@ useful on 32 bit systems with their limited address space.</li>
 </div>
 <div class="section" id="changes-from-2-0-4-to-2-0-5">
 <h1>Changes from 2.0.4 to 2.0.5</h1>
-<div class="section" id="id152">
+<div class="section" id="id190">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>Handle object workspace overruns better.</li>
@@ -1717,7 +1816,7 @@ has been removed in the development version. This will increase
 performance somewhat.</li>
 </ul>
 </div>
-<div class="section" id="id153">
+<div class="section" id="id191">
 <h2>varnishtop</h2>
 <ul class="simple">
 <li>varnishtop did not handle variable-length log fields correctly. This
@@ -1729,7 +1828,7 @@ it very hard to understand. We now print out the tag name.</li>
 </div>
 <div class="section" id="changes-from-2-0-3-to-2-0-4">
 <h1>Changes from 2.0.3 to 2.0.4</h1>
-<div class="section" id="id154">
+<div class="section" id="id192">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>Make Varnish more portable by pulling in fixes for Solaris and
@@ -1762,7 +1861,7 @@ but stopped at the first NULL byte. We no longer do that, enabling
 ESI processing of binary data.</li>
 </ul>
 </div>
-<div class="section" id="id155">
+<div class="section" id="id193">
 <h2>varnishtest</h2>
 <ul class="simple">
 <li>Make sure system &quot;...&quot; returns successfully to ensure test failures
@@ -1773,7 +1872,7 @@ do not go unnoticed.</li>
 </div>
 <div class="section" id="changes-from-2-0-2-to-2-0-3">
 <h1>Changes from 2.0.2 to 2.0.3</h1>
-<div class="section" id="id156">
+<div class="section" id="id194">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>Handle If-Modified-Since and ESI sub-objects better, fixing a problem
@@ -1877,14 +1976,14 @@ stack. This has now been fixed.</li>
 </div>
 <div class="section" id="changes-from-2-0-1-to-2-0-2">
 <h1>Changes from 2.0.1 to 2.0.2</h1>
-<div class="section" id="id157">
+<div class="section" id="id195">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>In high-load situations, when using ESI, varnishd would sometimes
 mishandle objects and crash. This has been worked around.</li>
 </ul>
 </div>
-<div class="section" id="id158">
+<div class="section" id="id196">
 <h2>varnishreplay</h2>
 <ul class="simple">
 <li>varnishreplay did not work correctly on Linux, due to a too small
@@ -1894,7 +1993,7 @@ stack. This has now been fixed.</li>
 </div>
 <div class="section" id="changes-from-2-0-to-2-0-1">
 <h1>Changes from 2.0 to 2.0.1</h1>
-<div class="section" id="id159">
+<div class="section" id="id197">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>When receiving a garbled HTTP request, varnishd would sometimes
@@ -1910,7 +2009,7 @@ crash. This has been fixed.</li>
 </div>
 <div class="section" id="changes-from-1-1-2-to-2-0">
 <h1>Changes from 1.1.2 to 2.0</h1>
-<div class="section" id="id160">
+<div class="section" id="id198">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>Only look for sendfile on platforms where we know how to use it,
@@ -1966,27 +2065,27 @@ this problem.</li>
 workspace. Now, vcl_error is called when we reach max_restarts.</li>
 </ul>
 </div>
-<div class="section" id="id161">
+<div class="section" id="id199">
 <h2>varnishtest</h2>
 <ul class="simple">
 <li>varnishtest is a tool to do correctness tests of varnishd. The test
 suite is run by using make check.</li>
 </ul>
 </div>
-<div class="section" id="id162">
+<div class="section" id="id200">
 <h2>varnishtop</h2>
 <ul class="simple">
 <li>We now set the field widths dynamically based on the size of the
 terminal and the name of the longest field.</li>
 </ul>
 </div>
-<div class="section" id="id163">
+<div class="section" id="id201">
 <h2>varnishstat</h2>
 <ul class="simple">
 <li>varnishstat -1 now displays the uptime too.</li>
 </ul>
 </div>
-<div class="section" id="id164">
+<div class="section" id="id202">
 <h2>varnishncsa</h2>
 <ul class="simple">
 <li>varnishncsa now does fflush after each write. This makes tail -f work
@@ -2008,7 +2107,7 @@ now be overridden by passing VCC_CC when running configure.</li>
 </div>
 <div class="section" id="changes-from-1-1-1-to-1-1-2">
 <h1>Changes from 1.1.1 to 1.1.2</h1>
-<div class="section" id="id165">
+<div class="section" id="id203">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>When switching to a new VCL configuration, a race condition exists
@@ -2070,7 +2169,7 @@ failures, but are now recognized as harmless conditions.</li>
 refresh interval to the corresponding power of two, in seconds.</li>
 </ul>
 </div>
-<div class="section" id="id167">
+<div class="section" id="id205">
 <h2>varnishncsa</h2>
 <ul class="simple">
 <li>The varnishncsa tool can now daemonize and write a PID file like
@@ -2078,7 +2177,7 @@ varnishlog, using the same command-line options. It will also reopen
 its output upon receipt of a SIGHUP if invoked with -w.</li>
 </ul>
 </div>
-<div class="section" id="id168">
+<div class="section" id="id206">
 <h2>varnishstat</h2>
 <ul class="simple">
 <li>Pressing 0 though 9 while varnishstat is running will change the
@@ -2100,7 +2199,7 @@ would have to be specified manually with -n. This has been corrected.</li>
 </div>
 <div class="section" id="changes-from-1-1-to-1-1-1">
 <h1>Changes from 1.1 to 1.1.1</h1>
-<div class="section" id="id169">
+<div class="section" id="id207">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>The code required to allow VCL to read obj.status, which had
@@ -2167,7 +2266,7 @@ resolves an issue with the Mac OS X linker.</li>
 </div>
 <div class="section" id="changes-from-1-0-4-to-1-1">
 <h1>Changes from 1.0.4 to 1.1</h1>
-<div class="section" id="id170">
+<div class="section" id="id208">
 <h2>varnishd</h2>
 <ul class="simple">
 <li>Readability of the C source code generated from VCL code has been
@@ -2247,7 +2346,7 @@ variables using the regsub function.</li>
 <li>Varnish will now build and run on Mac OS X.</li>
 </ul>
 </div>
-<div class="section" id="id171">
+<div class="section" id="id209">
 <h2>varnishadm</h2>
 <ul class="simple">
 <li>This is a new utility which sends a single command to a Varnish
@@ -2255,7 +2354,7 @@ server's management port and prints the result to stdout, greatly
 simplifying the use of the management port from scripts.</li>
 </ul>
 </div>
-<div class="section" id="id172">
+<div class="section" id="id210">
 <h2>varnishhist</h2>
 <ul class="simple">
 <li>The user interface has been greatly improved; the histogram will be
@@ -2265,7 +2364,7 @@ of log data gathered. In addition, the name of the Varnish instance
 being watched is displayed in the upper right corner.</li>
 </ul>
 </div>
-<div class="section" id="id173">
+<div class="section" id="id211">
 <h2>varnishncsa</h2>
 <ul class="simple">
 <li>In addition to client traffic, varnishncsa can now also process log
@@ -2274,14 +2373,14 @@ data from backend traffic.</li>
 empty HTTP header in the log file has been fixed.</li>
 </ul>
 </div>
-<div class="section" id="id174">
+<div class="section" id="id212">
 <h2>varnishreplay</h2>
 <ul class="simple">
 <li>This new utility will attempt to recreate the HTTP traffic which
 resulted in the raw Varnish log data which it is fed.</li>
 </ul>
 </div>
-<div class="section" id="id175">
+<div class="section" id="id213">
 <h2>varnishstat</h2>
 <ul class="simple">
 <li>Don't print lifetime averages when it doesn't make any sense—for
@@ -2295,7 +2394,7 @@ addition, the name of the Varnish instance being watched is displayed
 in the upper right corner in curses mode.</li>
 </ul>
 </div>
-<div class="section" id="id176">
+<div class="section" id="id214">
 <h2>varnishtop</h2>
 <ul class="simple">
 <li>The user interface has been greatly improved; varnishtop will now
@@ -2307,7 +2406,7 @@ watched is displayed in the upper right corner in curses mode.</li>
 </div>
 <div class="section" id="changes-from-1-0-3-to-1-0-4">
 <h1>Changes from 1.0.3 to 1.0.4</h1>
-<div class="section" id="id177">
+<div class="section" id="id215">
 <h2>varnishd</h2>
 <ul>
 <li><p class="first">The request workflow has been redesigned to simplify request
@@ -2384,7 +2483,7 @@ discovered on several platforms.</p>
 </li>
 </ul>
 </div>
-<div class="section" id="id178">
+<div class="section" id="id216">
 <h2>varnishlog</h2>
 <ul class="simple">
 <li>When grouping log entries by request, varnishlog attempts to collapse
@@ -2399,7 +2498,7 @@ create a pidfile, respectively.</li>
 volatile so it will not be optimized away by the compiler.</li>
 </ul>
 </div>
-<div class="section" id="id179">
+<div class="section" id="id217">
 <h2>varnishncsa</h2>
 <ul>
 <li><p class="first">The formatting callback has been largely rewritten for clarity,
diff --git a/doc/changes.rst b/doc/changes.rst
index 536f603..bedf36a 100644
--- a/doc/changes.rst
+++ b/doc/changes.rst
@@ -1,4 +1,114 @@
 ============================================
+Changes from 4.0.3-rc3 to 4.0.3 (2015-02-17)
+============================================
+
+* No changes.
+
+================================================
+Changes from 4.0.3-rc2 to 4.0.3-rc3 (2015-02-11)
+================================================
+
+- Superseded objects are now expired immediately.
+
+Bugs fixed
+----------
+
+- 1462_ - Use first/last log entry in varnishncsa.
+- 1539_ - Avoid panic when expiry thread modifies a candidate object.
+- 1637_ - Fail the fetch processing if the vep callback failed.
+- 1665_ - Be more accurate when computing client RX_TIMEOUT.
+- 1672_ - Do not panic on unsolicited 304 response to non-200 bereq.
+
+.. _1462: https://www.varnish-cache.org/trac/ticket/1462
+.. _1539: https://www.varnish-cache.org/trac/ticket/1539
+.. _1637: https://www.varnish-cache.org/trac/ticket/1637
+.. _1665: https://www.varnish-cache.org/trac/ticket/1665
+.. _1672: https://www.varnish-cache.org/trac/ticket/1672
+
+
+================================================
+Changes from 4.0.3-rc1 to 4.0.3-rc2 (2015-01-28)
+================================================
+
+Changes since 4.0.3-rc1:
+
+- Assorted documentation updates.
+
+Bugs fixed
+----------
+
+- 1479_ - Fix out-of-tree builds.
+- 1566_ - Escape VCL string question marks.
+- 1616_ - Correct header file placement.
+- 1620_ - Fail miss properly if out of backend threads. (Also 1621_)
+- 1628_ - Avoid dereferencing null in VBO_DerefBusyObj().
+- 1629_ - Ditch rest of waiting list on failure to reschedule.
+- 1660_ - Don't attempt range delivery on a synth response
+
+.. _1479: https://www.varnish-cache.org/trac/ticket/1479
+.. _1566: https://www.varnish-cache.org/trac/ticket/1578
+.. _1616: https://www.varnish-cache.org/trac/ticket/1616
+.. _1620: https://www.varnish-cache.org/trac/ticket/1620
+.. _1621: https://www.varnish-cache.org/trac/ticket/1621
+.. _1628: https://www.varnish-cache.org/trac/ticket/1628
+.. _1629: https://www.varnish-cache.org/trac/ticket/1629
+.. _1660: https://www.varnish-cache.org/trac/ticket/1660
+
+
+============================================
+Changes from 4.0.2 to 4.0.3-rc1 (2015-01-15)
+============================================
+
+Changes since 4.0.2:
+
+- Support older autoconf (< 2.63b) (el5)
+- A lot of minor documentation fixes.
+- bereq.uncacheable is now read-only.
+- obj.uncacheable is now readable in vcl_deliver.
+- [varnishadm] Prefer exact matches for backend.set_healthy. Bug 1349_.
+- Hard-coded -sfile default size is removed.
+- [packaging] EL6 packages are once again built with -O2.
+- [parameter] fetch_chunksize default is reduced to 16KB. (from 128KB)
+- Added std.time() which converts strings to VCL_TIME.
+- [packaging] packages now Provide strictABI (gitref) and ABI (VRT major/minor) for VMOD use.
+
+Bugs fixed
+----------
+
+* 1378_ - Properly escape non-printable characters in varnishncsa.
+* 1596_ - Delay HSH_Complete() until the storage sanity functions has finished.
+* 1506_ - Keep Content-Length from backend if we can.
+* 1602_ - Fix a cornercase related to empty pass objects.
+* 1607_ - Don't leak reqs on failure to revive from waitinglist.
+* 1610_ - Update forgotten varnishlog example to 4.0 syntax.
+* 1612_ - Fix a cornercase related to empty pass objects.
+* 1623_ - Fix varnishhist -d segfault.
+* 1636_ - Outdated paragraph in Vary: documentation
+* 1638_ - Fix panic when retrying a failed backend fetch.
+* 1639_ - Restore the default SIGSEGV handler during pan_ic
+* 1647_ - Relax an assertion for the IMS update candidate object.
+* 1648_ - Avoid partial IMS updates to replace old object.
+* 1650_ - Collapse multiple X-Forwarded-For headers
+
+.. _1349: https://www.varnish-cache.org/trac/ticket/1349
+.. _1378: https://www.varnish-cache.org/trac/ticket/1378
+.. _1596: https://www.varnish-cache.org/trac/ticket/1596
+.. _1506: https://www.varnish-cache.org/trac/ticket/1506
+.. _1602: https://www.varnish-cache.org/trac/ticket/1602
+.. _1607: https://www.varnish-cache.org/trac/ticket/1607
+.. _1610: https://www.varnish-cache.org/trac/ticket/1610
+.. _1612: https://www.varnish-cache.org/trac/ticket/1612
+.. _1623: https://www.varnish-cache.org/trac/ticket/1623
+.. _1636: https://www.varnish-cache.org/trac/ticket/1636
+.. _1638: https://www.varnish-cache.org/trac/ticket/1638
+.. _1639: https://www.varnish-cache.org/trac/ticket/1639
+.. _1647: https://www.varnish-cache.org/trac/ticket/1647
+.. _1648: https://www.varnish-cache.org/trac/ticket/1648
+.. _1650: https://www.varnish-cache.org/trac/ticket/1650
+
+
+
+============================================
 Changes from 4.0.2-rc1 to 4.0.2 (2014-10-08)
 ============================================
 
@@ -7,6 +117,7 @@ New since 4.0.2-rc1:
 - [varnishlog] -k argument is back. (exit after n records)
 - [varnishadm] vcl.show is now listed in help.
 
+
 ============================================
 Changes from 4.0.1 to 4.0.2-rc1 (2014-09-23)
 ============================================
@@ -58,6 +169,7 @@ Bugs fixed
 * 1567_ - Compile on systems without SO_SNDTIMEO/SO_RCVTIMEO.
 * 1512_ - Changes to bereq are lost between v_b_r and v_b_f.
 * 1563_ - Increase varnishtest read timeout.
+* 1561_ - Never call a VDP with zero length unless done.
 * 1562_ - Fail correctly when rereading a failed client request body.
 * 1521_ - VCL compilation fails on OSX x86_64.
 * 1547_ - Panic when increasing shm_reclen.
@@ -90,6 +202,7 @@ Bugs fixed
 .. _1567: https://www.varnish-cache.org/trac/ticket/1567
 .. _1512: https://www.varnish-cache.org/trac/ticket/1512
 .. _1563: https://www.varnish-cache.org/trac/ticket/1563
+.. _1561: https://www.varnish-cache.org/trac/ticket/1561
 .. _1562: https://www.varnish-cache.org/trac/ticket/1562
 .. _1521: https://www.varnish-cache.org/trac/ticket/1521
 .. _1547: https://www.varnish-cache.org/trac/ticket/1547
@@ -186,12 +299,10 @@ Bugs fixed
 .. _1501: https://www.varnish-cache.org/trac/ticket/1501
 .. _1495: https://www.varnish-cache.org/trac/ticket/1495
 .. _1510: https://www.varnish-cache.org/trac/ticket/1510
-.. _1514: https://www.varnish-cache.org/trac/ticket/1514
 .. _1518: https://www.varnish-cache.org/trac/ticket/1518
 .. _1519: https://www.varnish-cache.org/trac/ticket/1519
 
 
-
 ==============================================
 Changes from 4.0.0 beta1 to 4.0.0 (2014-04-10)
 ==============================================
@@ -218,9 +329,9 @@ Bugs fixed
 .. _1467: https://www.varnish-cache.org/trac/ticket/1467
 
 
-=====================================
-Changes from 4.0.0 TP2 to 4.0.0 beta1
-=====================================
+==================================================
+Changes from 4.0.0 TP2 to 4.0.0 beta1 (2014-03-27)
+==================================================
 
 New since TP2:
 
@@ -276,10 +387,9 @@ Bugs fixed
 .. _1405: https://www.varnish-cache.org/trac/ticket/1405
 
 
-
-===================================
-Changes from 4.0.0 TP1 to 4.0.0 TP2
-===================================
+================================================
+Changes from 4.0.0 TP1 to 4.0.0 TP2 (2014-01-23)
+================================================
 
 New since from 4.0.0 TP1
 ------------------------
@@ -332,9 +442,41 @@ Open issues
 .. _1268: https://www.varnish-cache.org/trac/ticket/1268
 
 
-================================
-Changes from 3.0.5 rc 1 to 3.0.5
-================================
+===========================================
+Changes from 3.0.6rc1 to 3.0.6 (2014-10-16)
+===========================================
+
+- Minor changes to documentation.
+- [varnishadm] Add termcap workaround for libedit. Bug 1531_.
+
+
+===========================================
+Changes from 3.0.5 to 3.0.6rc1 (2014-06-24)
+===========================================
+
+- Document storage.<name>.* VCL variables. Bug 1514_.
+- Fix memory alignment panic when http_max_hdr is not a multiple of 4. Bug 1327_.
+- Avoid negative ReqEnd timestamps with ESI. Bug 1297_.
+- %D format for varnishncsa is now an integer (as documented)
+- Fix compile errors with clang.
+- Clear objectcore flags earlier in ban lurker to avoid spinning thread. Bug 1470_.
+- Patch embedded jemalloc to avoid segfault. Bug 1448_.
+- Allow backend names to start with if, include or else. Bug 1439_.
+- Stop handling gzip after gzip body end. Bug 1086_.
+- Document %D and %T for varnishncsa.
+
+.. _1514: http://varnish-cache.org/trac/ticket/1514
+.. _1327: http://varnish-cache.org/trac/ticket/1327
+.. _1297: http://varnish-cache.org/trac/ticket/1297
+.. _1470: http://varnish-cache.org/trac/ticket/1470
+.. _1448: http://varnish-cache.org/trac/ticket/1448
+.. _1439: http://varnish-cache.org/trac/ticket/1439
+.. _1086: http://varnish-cache.org/trac/ticket/1086
+
+
+=============================================
+Changes from 3.0.5 rc 1 to 3.0.5 (2013-12-02)
+=============================================
 
 varnishd
 --------
@@ -344,6 +486,7 @@ varnishd
 
 .. _bug #1376: http://varnish-cache.org/trac/ticket/1376
 
+
 ================================
 Changes from 3.0.4 to 3.0.5 rc 1
 ================================
@@ -381,9 +524,10 @@ varnishadm
 
 .. _bug #1314: http://varnish-cache.org/trac/ticket/1314
 
-================================
-Changes from 3.0.4 rc 1 to 3.0.4
-================================
+
+=============================================
+Changes from 3.0.4 rc 1 to 3.0.4 (2013-06-14)
+=============================================
 
 varnishd
 --------
@@ -397,6 +541,7 @@ varnishd
 .. _bug #1285: http://varnish-cache.org/trac/ticket/1285
 .. _bug #1312: http://varnish-cache.org/trac/ticket/1312
 
+
 ================================
 Changes from 3.0.3 to 3.0.4 rc 1
 ================================
@@ -455,9 +600,10 @@ Other
   least on i386.
 - Make libvarnish prefer exact hits when looking for VSL tags.
 
-===========================
-Changes from 3.0.2 to 3.0.3
-===========================
+
+========================================
+Changes from 3.0.2 to 3.0.3 (2012-08-20)
+========================================
 
 Varnishd
 --------
@@ -571,9 +717,10 @@ Other
 
 .. _bug #1003: http://varnish-cache.org/trac/ticket/1003
 
-================================
-Changes from 3.0.2 rc 1 to 3.0.2
-================================
+
+=============================================
+Changes from 3.0.2 rc 1 to 3.0.2 (2011-10-26)
+=============================================
 
 Varnishd
 --------
@@ -601,9 +748,10 @@ Other
 
 - Some Solaris portability updates.
 
-================================
-Changes from 3.0.1 to 3.0.2 rc 1
-================================
+
+=============================================
+Changes from 3.0.1 to 3.0.2 rc 1 (2011-10-06)
+=============================================
 
 Varnishd
 --------
@@ -662,9 +810,10 @@ Other
 
 - Some Solaris portability updates.
 
-================================
-Changes from 3.0.1 rc 1 to 3.0.1
-================================
+
+=============================================
+Changes from 3.0.1 rc 1 to 3.0.1 (2011-08-30)
+=============================================
 
 Varnishd
 --------
@@ -693,9 +842,10 @@ Other
 
 - Documentation updates
 
-================================
-Changes from 3.0.0 to 3.0.1 rc 1
-================================
+
+=============================================
+Changes from 3.0.0 to 3.0.1 rc 1 (2011-08-24)
+=============================================
 
 Varnishd
 --------
@@ -769,9 +919,10 @@ Other
 
 .. _bug #961: http://varnish-cache.org/trac/ticket/961
 
-================================
-Changes from 3.0 beta 2 to 3.0.0
-================================
+
+=============================================
+Changes from 3.0 beta 2 to 3.0.0 (2011-06-16)
+=============================================
 
 Varnishd
 --------
@@ -796,6 +947,7 @@ varnishadm
 
 .. _bug #935: http://varnish-cache.org/trac/ticket/935
 
+
 =====================================
 Changes from 3.0 beta 1 to 3.0 beta 2
 =====================================
@@ -847,6 +999,7 @@ VMODs
 
 - The std module now has proper documentation, including a manual page
 
+
 ================================
 Changes from 2.1.5 to 3.0 beta 1
 ================================
@@ -1090,9 +1243,10 @@ Other
 - The documentation has been improved all over and should now be in
   much better shape than before
 
-===========================
-Changes from 2.1.4 to 2.1.5
-===========================
+
+========================================
+Changes from 2.1.4 to 2.1.5 (2011-01-25)
+========================================
 
 varnishd
 --------
@@ -1164,6 +1318,7 @@ varnishtest
 
 -  Remove no longer existing -L option.
 
+
 ===========================
 Changes from 2.1.3 to 2.1.4
 ===========================
@@ -1313,6 +1468,7 @@ libvarnishapi
 
 -  The -X parameter didn't work correctly. This has been fixed.
 
+
 ===========================
 Changes from 2.1.1 to 2.1.2
 ===========================
@@ -1325,6 +1481,7 @@ varnishd
    by default 128k. Browsers would do the right thing due to
    Content-Length, but some load balancers would get very confused.
 
+
 ===========================
 Changes from 2.1.1 to 2.1.1
 ===========================
@@ -1556,6 +1713,7 @@ varnishadm
 -  varnishadm now knows how to respond to the secret from a secured
    varnishd
 
+
 ===========================
 Changes from 2.0.5 to 2.0.6
 ===========================
@@ -1585,6 +1743,7 @@ varnishd
 
 -  Document the -C option to varnishd.
 
+
 ===========================
 Changes from 2.0.4 to 2.0.5
 ===========================
@@ -1682,6 +1841,7 @@ varnishtop
 -  varnishtop previously did not print the name of the tag, which made
    it very hard to understand. We now print out the tag name.
 
+
 ===========================
 Changes from 2.0.3 to 2.0.4
 ===========================
@@ -1739,6 +1899,7 @@ varnishtest
 
 -  Make it possible to send NULL bytes through the testing framework.
 
+
 ===========================
 Changes from 2.0.2 to 2.0.3
 ===========================
@@ -1873,6 +2034,7 @@ varnishreplay
 -  varnishreplay did not work correctly on Linux, due to a too small
    stack. This has now been fixed.
 
+
 ===========================
 Changes from 2.0.1 to 2.0.2
 ===========================
@@ -1907,6 +2069,7 @@ Red Hat spec file
 
 -  A typo in the spec file made the .rpm file names wrong.
 
+
 =========================
 Changes from 1.1.2 to 2.0
 =========================
@@ -2026,6 +2189,7 @@ Build system
 -  The C compiler invocation is decided by the configure script and can
    now be overridden by passing VCC\_CC when running configure.
 
+
 ===========================
 Changes from 1.1.1 to 1.1.2
 ===========================
@@ -2129,6 +2293,7 @@ Build system
    the default state directory would be garbage and a state directory
    would have to be specified manually with -n. This has been corrected.
 
+
 =========================
 Changes from 1.1 to 1.1.1
 =========================
@@ -2213,6 +2378,7 @@ Build system
    dynamic rather than static. This simplifies the build process and
    resolves an issue with the Mac OS X linker.
 
+
 =========================
 Changes from 1.0.4 to 1.1
 =========================
@@ -2373,6 +2539,7 @@ varnishtop
    actually works. In addition, the name of the Varnish instance being
    watched is displayed in the upper right corner in curses mode.
 
+
 ===========================
 Changes from 1.0.3 to 1.0.4
 ===========================
diff --git a/doc/sphinx/Makefile.am b/doc/sphinx/Makefile.am
index 3d49d43..31eed38 100644
--- a/doc/sphinx/Makefile.am
+++ b/doc/sphinx/Makefile.am
@@ -10,7 +10,7 @@ BUILDDIR      = build
 # Internal variables.
 PAPEROPT_a4     = -D latex_paper_size=a4
 PAPEROPT_letter = -D latex_paper_size=letter
-ALLSPHINXOPTS   = -d $(BUILDDIR)/doctrees $(PAPEROPT_$(PAPER)) $(SPHINXOPTS) $(srcdir)
+ALLSPHINXOPTS   = -d $(BUILDDIR)/doctrees $(PAPEROPT_$(PAPER)) $(SPHINXOPTS) $(distdir)
 
 .PHONY: help clean html dirhtml pickle json htmlhelp qthelp latex changes linkcheck doctest
 
@@ -28,7 +28,7 @@ help:
 	@echo "  doctest   to run all doctests embedded in the documentation (if enabled)"
 
 clean:
-#	-rm -rf $(BUILDDIR)/*
+	-rm -rf $(BUILDDIR)/*
 
 html:
 	$(SPHINXBUILD) -b html $(ALLSPHINXOPTS) $(BUILDDIR)/html
@@ -95,7 +95,6 @@ EXTRA_DIST = \
 	glossary \
 	installation \
 	phk \
-	reference \
 	tutorial \
 	users-guide \
 	whats-new
@@ -108,7 +107,7 @@ dist-hook:
 	find $(distdir) -mindepth 2 -type f ! -name \*.rst | grep -v '/build/' | xargs rm -f
 
 distclean-local:
-#	rm -rf $(BUILDDIR)
+	rm -rf $(BUILDDIR)
 
 include/params.rst: $(top_builddir)/bin/varnishd/varnishd
 	$(top_builddir)/bin/varnishd/varnishd -x dumprstparam > include/params.rst
@@ -144,12 +143,17 @@ include/varnishhist_synopsis.rst: $(top_builddir)/bin/varnishhist/varnishhist_op
 BUILT_SOURCES += include/varnishhist_options.rst \
 	 include/varnishhist_synopsis.rst
 
-reference/vmod_std.generated.rst: $(top_srcdir)/lib/libvmod_std/vmod_std.rst
-	cp $? $@
+.PHONY: reference
+reference:
+	test -d $@ || mkdir $@
+BUILT_SOURCES += reference
+
+reference/vmod_std.generated.rst: reference $(top_builddir)/lib/libvmod_std/vmod_std.rst
+	cp $(top_builddir)/lib/libvmod_std/vmod_std.rst $@
 BUILT_SOURCES += reference/vmod_std.generated.rst
 
-reference/vmod_directors.generated.rst: $(top_srcdir)/lib/libvmod_directors/vmod_directors.rst
-	cp $? $@
+reference/vmod_directors.generated.rst: reference $(top_builddir)/lib/libvmod_directors/vmod_directors.rst
+	cp $(top_builddir)/lib/libvmod_directors/vmod_directors.rst $@
 BUILT_SOURCES += reference/vmod_directors.generated.rst
 
 EXTRA_DIST += $(BUILT_SOURCES)
diff --git a/doc/sphinx/build/html/.buildinfo b/doc/sphinx/build/html/.buildinfo
index 06df163..4c88784 100644
--- a/doc/sphinx/build/html/.buildinfo
+++ b/doc/sphinx/build/html/.buildinfo
@@ -1,4 +1,4 @@
 # Sphinx build info version 1
 # This file hashes the configuration used when building these files. When it is not found, a full rebuild will be done.
-config: 1f6b4d04360eced55d15e70e577cf6bc
+config: 5eebb515c2c420ff1371f19f5073e0a9
 tags: fbb0d17656682115ca4d033fb2f83ba1
diff --git a/doc/sphinx/build/html/_sources/index.txt b/doc/sphinx/build/html/_sources/index.txt
index b87a1a6..1adb5fe 100644
--- a/doc/sphinx/build/html/_sources/index.txt
+++ b/doc/sphinx/build/html/_sources/index.txt
@@ -32,7 +32,7 @@ Conventions used in this manual include:
   http://www.varnish-cache.org/
     A hyperlink.
 
-Longer listings like example command output and VCL will look like this::
+Longer listings like example command output and VCL look like this::
 
     $ /opt/varnish/sbin/varnishd -V
     varnishd (varnish-4.0.0-tp1 revision ddd00e1)
diff --git a/doc/sphinx/build/html/_sources/phk/dough.txt b/doc/sphinx/build/html/_sources/phk/dough.txt
index 3e71fe6..65b53f8 100644
--- a/doc/sphinx/build/html/_sources/phk/dough.txt
+++ b/doc/sphinx/build/html/_sources/phk/dough.txt
@@ -42,7 +42,7 @@ But in 2004 crowd-funding was not yet "in", and I had to figure
 out how to do it myself.
 
 My parents brought me up to think that finances is a private matter
-but I concluded that the only way you could ask strangers to trow
+but I concluded that the only way you could ask strangers to throw
 money at you, would be to run an open book, where they could see
 what happened to them, so I did open books.
 
diff --git a/doc/sphinx/build/html/_sources/phk/persistent.txt b/doc/sphinx/build/html/_sources/phk/persistent.txt
index 33af07c..6c1d29c 100644
--- a/doc/sphinx/build/html/_sources/phk/persistent.txt
+++ b/doc/sphinx/build/html/_sources/phk/persistent.txt
@@ -41,7 +41,7 @@ all the banned objects.
 With persistent storage, we not only have to store the still live
 bans with the cached objects, and keep the two painfully in sync,
 so the bans gets revived with the objects, we also have to worry
-about missing bans duing the downtime, since those might ban objects
+about missing bans during the downtime, since those might ban objects
 we will recover on startup.
 
 Ouch:  Straight into database/filesystem consistency territory.
diff --git a/doc/sphinx/build/html/_sources/reference/index.txt b/doc/sphinx/build/html/_sources/reference/index.txt
index 32458a6..b59beb5 100644
--- a/doc/sphinx/build/html/_sources/reference/index.txt
+++ b/doc/sphinx/build/html/_sources/reference/index.txt
@@ -15,7 +15,6 @@ The Varnish Reference Manual
 	varnishlog.rst
 	varnishncsa.rst
 	varnishreplay.rst
-	varnishsizes.rst
 	varnishstat.rst
 	varnishtest.rst
 	varnishtop.rst
diff --git a/doc/sphinx/build/html/_sources/reference/varnish-cli.txt b/doc/sphinx/build/html/_sources/reference/varnish-cli.txt
index 2e17c2e..7f419ff 100644
--- a/doc/sphinx/build/html/_sources/reference/varnish-cli.txt
+++ b/doc/sphinx/build/html/_sources/reference/varnish-cli.txt
@@ -128,11 +128,12 @@ panic.clear
 storage.list
   List storage devices
 
-backend.list
-  List all backends
+backend.list [<backend_expression>]
+  List backends.
 
-backend.set_health matcher state
-  Set health status on a backend
+backend.set_health <backend_expression> <state>
+  Set health status on the backends.
+  State is any of auto, healthy or sick values.
 
 ban <field> <operator> <arg> [&& <field> <oper> <arg>]...
   All objects where the all the conditions match will be marked obsolete.
@@ -140,6 +141,13 @@ ban <field> <operator> <arg> [&& <field> <oper> <arg>]...
 ban.list
   List the active bans.
 
+Backend Expression
+------------------
+
+A backend expression can be a backend name or a combination of backend
+name, IP address and port in "name(IP address:port)" format. All fields
+are optional. If no exact matching backend is found, partial matching
+will be attempted based on the provided name, IP address and port fields.
 
 Ban Expressions
 ---------------
diff --git a/doc/sphinx/build/html/_sources/reference/varnishlog.txt b/doc/sphinx/build/html/_sources/reference/varnishlog.txt
index 54247fd..15a1446 100644
--- a/doc/sphinx/build/html/_sources/reference/varnishlog.txt
+++ b/doc/sphinx/build/html/_sources/reference/varnishlog.txt
@@ -12,7 +12,7 @@ SYNOPSIS
 ========
 
 .. include:: ../include/varnishlog_synopsis.rst
-varnishlog |synopsis| <query expression>
+varnishlog |synopsis|
 
 OPTIONS
 =======
diff --git a/doc/sphinx/build/html/_sources/reference/varnishstat.txt b/doc/sphinx/build/html/_sources/reference/varnishstat.txt
index 8940d80..b8b5ef8 100644
--- a/doc/sphinx/build/html/_sources/reference/varnishstat.txt
+++ b/doc/sphinx/build/html/_sources/reference/varnishstat.txt
@@ -65,7 +65,7 @@ CURSES MODE
 ===========
 
 When neither -1, -j or -x options are given, the application starts up
-in curses mode. This shows a continously updated view of the counter
+in curses mode. This shows a continuously updated view of the counter
 values, along with their description.
 
 The top area shows process uptime information.
@@ -119,17 +119,17 @@ The following keys control the interactive display:
 <PAGEDOWN> or <SPACE>
 	Navigate the counter list one page down.
 
+<d>
+	Toggle between showing and hiding unseen counters. Unseen
+	counters are those that has been zero for the entire runtime
+	of varnishstat. Defaults to hide unseen counters.
+
 <g>
 	Go to the top of the counter list.
 
 <G>
 	Go to the bottom of the counter list.
 
-<d>
-	Toggle between showing and hiding unseen counters. Unseen
-	counters are those that has been zero for the entire runtime
-	of varnishstat. Defaults to hide unseen counters.
-
 <v>
 	Cycle through the verbosity levels. Defaults to only showing
 	informational counters.
@@ -145,11 +145,17 @@ XML Output
 
 When using the -x option, the output is::
 
-  <stat>
-    <name>FIELD NAME</name>
-    <value>FIELD VALUE</value>
-    <description>FIELD DESCRIPTION</description>
-  </stat>
+  <varnishstat timestamp="YYYY-MM-DDTHH:mm:SS">
+    <stat>
+      <type>FIELD TYPE</type>
+      <ident>FIELD IDENT</ident>
+      <name>FIELD NAME</name>
+      <value>FIELD VALUE</value>
+      <flag>FIELD FORMAT</flag>
+      <description>FIELD DESCRIPTION</description>
+    </stat>
+    [..]
+  </varnishstat>
 
 JSON OUTPUT
 ===========
@@ -158,24 +164,15 @@ With -j the output format is::
 
   {
     "timestamp": "YYYY-MM-DDTHH:mm:SS",
-    "client_conn": {
-	"value": 0, "flag": "a",
-	"description": "Client connections accepted"
-    },
-    "client_drop": {
-	"value": 0, "flag": "a",
-	"description": "Connection dropped, no sess/wrk"
-    },
-    "LCK.backend.creat": {
-	"type": "LCK", "ident": "backend", "value": 1,
-	"flag": "a", "description": "Created locks"
-    },
+    "FIELD NAME": {"type": "FIELD TYPE", "ident": "FIELD IDENT", "value": FIELD VALUE, "flag": "FIELD FORMAT", "description": "FIELD DESCRIPTION"},
     [..]
   }
 
-Timestamp is the time when the report was generated by varnishstat.
+Type and ident are optional.  Timestamp is the time when the report was
+generated by varnishstat.
 
-Repeated output with -1, -x or -j will have a single empty line (\\n) between each block of output.
+Repeated output with -1, -x or -j will have a single empty line (\\n)
+between each block of output.
 
 
 SEE ALSO
diff --git a/doc/sphinx/build/html/_sources/reference/vcl.txt b/doc/sphinx/build/html/_sources/reference/vcl.txt
index 90ac019..a621e4f 100644
--- a/doc/sphinx/build/html/_sources/reference/vcl.txt
+++ b/doc/sphinx/build/html/_sources/reference/vcl.txt
@@ -166,6 +166,21 @@ Example::
         std.log("foo");
     }
 
+Comments
+--------
+
+Single lines of VCL can be commented out using // or #. Multi-line blocks can
+be commented out with \/\* block \/\*.
+
+Example::
+
+    sub vcl_recv {
+        // Single line of out-commented VCL.
+        # Another way of commenting out a single line.
+        /*
+            Multi-line block of commented-out VCL.
+        */
+    }
 
 
 Backend definition
diff --git a/doc/sphinx/build/html/_sources/reference/vmod.txt b/doc/sphinx/build/html/_sources/reference/vmod.txt
index 5ad685f..c4d741b 100644
--- a/doc/sphinx/build/html/_sources/reference/vmod.txt
+++ b/doc/sphinx/build/html/_sources/reference/vmod.txt
@@ -273,7 +273,7 @@ malloc would look like this::
 	if (priv->priv == NULL) {
 		priv->priv = calloc(sizeof(struct myfoo), 1);
 		AN(priv->priv);
-		priv->priv = free;	/* free(3) */
+		priv->free = free;	/* free(3) */
 		mystate = priv->priv;
 		mystate->foo = 21;
 		...
diff --git a/doc/sphinx/build/html/_sources/reference/vmod_std.generated.txt b/doc/sphinx/build/html/_sources/reference/vmod_std.generated.txt
index 9ade690..6df1069 100644
--- a/doc/sphinx/build/html/_sources/reference/vmod_std.generated.txt
+++ b/doc/sphinx/build/html/_sources/reference/vmod_std.generated.txt
@@ -37,6 +37,7 @@ they return the second argument, which must have the given TYPE.
 CONTENTS
 ========
 
+* :ref:`func_cache_req_body`
 * :ref:`func_collect`
 * :ref:`func_duration`
 * :ref:`func_fileread`
@@ -53,6 +54,7 @@ CONTENTS
 * :ref:`func_set_ip_tos`
 * :ref:`func_strstr`
 * :ref:`func_syslog`
+* :ref:`func_time`
 * :ref:`func_time2integer`
 * :ref:`func_time2real`
 * :ref:`func_timestamp`
@@ -65,10 +67,10 @@ STRING toupper(STRING_LIST)
 ---------------------------
 
 Prototype
-	STRING toupper(STRING_LIST)
+	STRING toupper(STRING_LIST s)
 
 Description
-	Converts the string *s* to upper case.
+	Converts the string *s* to uppercase.
 Example
 	set beresp.http.x-scream = std.toupper("yes!");
 
@@ -78,10 +80,10 @@ STRING tolower(STRING_LIST)
 ---------------------------
 
 Prototype
-	STRING tolower(STRING_LIST)
+	STRING tolower(STRING_LIST s)
 
 Description
-	Converts the string *s* to lower case.
+	Converts the string *s* to lowercase.
 Example
 	set beresp.http.x-nice = std.tolower("VerY");
 
@@ -91,11 +93,11 @@ VOID set_ip_tos(INT)
 --------------------
 
 Prototype
-	VOID set_ip_tos(INT)
+	VOID set_ip_tos(INT tos)
 
 Description
-	Sets the Type-of-Service flag for the current session. Please
-	note that the TOS flag is not removed by the end of the
+	Sets the IP type-of-service (TOS) field for the current session to *tos*.
+	Please note that the TOS field is not removed by the end of the
 	request so probably want to set it on every request should you
 	utilize it.
 Example
@@ -109,10 +111,10 @@ REAL random(REAL, REAL)
 -----------------------
 
 Prototype
-	REAL random(REAL, REAL)
+	REAL random(REAL lo, REAL hi)
 
 Description
-	Returns a random REAL number between *a* and *b*.
+	Returns a random real number between *lo* and *hi*.
 Example
 	set beresp.http.x-random-number = std.random(1, 100);
 
@@ -122,10 +124,10 @@ VOID log(STRING_LIST)
 ---------------------
 
 Prototype
-	VOID log(STRING_LIST)
+	VOID log(STRING_LIST s)
 
 Description
-	Logs *string* to the shared memory log, using VSL tag *SLT_VCL_Log*.
+	Logs the string *s* to the shared memory log, using VSL tag *SLT_VCL_Log*.
 Example
 	std.log("Something fishy is going on with the vhost " + req.host);
 
@@ -135,10 +137,10 @@ VOID syslog(INT, STRING_LIST)
 -----------------------------
 
 Prototype
-	VOID syslog(INT, STRING_LIST)
+	VOID syslog(INT priority, STRING_LIST s)
 
 Description
-	Logs *string* to syslog marked with *priority*.  See your
+	Logs the string *s* to syslog marked with *priority*.  See your
 	system's syslog.h file for the legal values of *priority*.
 Example
 	std.syslog(8 + 1, "Something is wrong");
@@ -165,12 +167,13 @@ VOID collect(HEADER)
 --------------------
 
 Prototype
-	VOID collect(HEADER)
+	VOID collect(HEADER hdr)
 
 Description
-	Collapses the header, joining the headers into one.
+	Collapses the header *hdr*, joining them into one.
 Example
 	std.collect(req.http.cookie);
+
 	This will collapse several Cookie: headers into one, long
 	cookie header.
 
@@ -180,12 +183,12 @@ DURATION duration(STRING, DURATION)
 -----------------------------------
 
 Prototype
-	DURATION duration(STRING, DURATION)
+	DURATION duration(STRING s, DURATION fallback)
 
 Description
 	Converts the string *s* to seconds. *s* must be quantified
 	with ms (milliseconds), s (seconds), m (minutes), h (hours),
-	d (days), w (weeks) or y (years) units. If *s* fails to parse,
+	d (days), w (weeks) or y (years) units. If conversion fails,
 	*fallback* will be returned.
 Example
 	set beresp.ttl = std.duration("1w", 3600s);
@@ -196,13 +199,15 @@ INT integer(STRING, INT)
 ------------------------
 
 Prototype
-	INT integer(STRING, INT)
+	INT integer(STRING s, INT fallback)
 
 Description
-	Converts the string *s* to an integer.  If *s* fails to parse,
+	Converts the string *s* to an integer.	If conversion fails,
 	*fallback* will be returned.
 Example
-	if (std.integer(beresp.http.x-foo, 0) > 5) { ... }
+	| if (std.integer(beresp.http.x-foo, 0) > 5) {
+	| 	...
+	| }
 
 .. _func_ip:
 
@@ -210,14 +215,16 @@ IP ip(STRING, IP)
 -----------------
 
 Prototype
-	IP ip(STRING, IP)
+	IP ip(STRING s, IP fallback)
 
 Description
-	Converts string *s* to the first IP number returned by
+	Converts the string *s* to the first IP number returned by
 	the system library function getaddrinfo(3).  If conversion
 	fails, *fallback* will be returned.
 Example
-	if (std.ip(req.http.X-forwarded-for, "0.0.0.0") ~ my_acl) { ... }
+	| if (std.ip(req.http.X-forwarded-for, "0.0.0.0") ~ my_acl) {
+	| 	...
+	| }
 
 .. _func_real:
 
@@ -225,10 +232,10 @@ REAL real(STRING, REAL)
 -----------------------
 
 Prototype
-	REAL real(STRING, REAL)
+	REAL real(STRING s, REAL fallback)
 
 Description
-	Converts the string *s* to a real.  If *s* fails to parse,
+	Converts the string *s* to a real.  If conversion fails,
 	*fallback* will be returned.
 Example
 	set req.http.x-real = std.real(req.http.x-foo, 0.0);
@@ -239,7 +246,7 @@ TIME real2time(REAL)
 --------------------
 
 Prototype
-	TIME real2time(REAL)
+	TIME real2time(REAL r)
 
 Description
 	Converts the real *r* to a time.
@@ -252,7 +259,7 @@ INT time2integer(TIME)
 ----------------------
 
 Prototype
-	INT time2integer(TIME)
+	INT time2integer(TIME t)
 
 Description
 	Converts the time *t* to a integer.
@@ -265,7 +272,7 @@ REAL time2real(TIME)
 --------------------
 
 Prototype
-	REAL time2real(TIME)
+	REAL time2real(TIME t)
 
 Description
 	Converts the time *t* to a real.
@@ -278,10 +285,10 @@ BOOL healthy(BACKEND)
 ---------------------
 
 Prototype
-	BOOL healthy(BACKEND)
+	BOOL healthy(BACKEND be)
 
 Description
-	Returns true if the backend is healthy.
+	Returns `true` if the backend *be* is healthy.
 
 .. _func_port:
 
@@ -289,10 +296,10 @@ INT port(IP)
 ------------
 
 Prototype
-	INT port(IP)
+	INT port(IP ip)
 
 Description
-	Returns the port number of an IP address.
+	Returns the port number of the IP address *ip*.
 
 .. _func_rollback:
 
@@ -300,10 +307,10 @@ VOID rollback(HTTP)
 -------------------
 
 Prototype
-	VOID rollback(HTTP)
+	VOID rollback(HTTP h)
 
 Description
-	Restore *h* HTTP headers to their original state.
+	Restores the *h* HTTP headers to their original state.
 Example
 	std.rollback(bereq);
 
@@ -313,13 +320,13 @@ VOID timestamp(STRING)
 ----------------------
 
 Prototype
-	VOID timestamp(STRING)
+	VOID timestamp(STRING s)
 
 Description
-	Introduces a timestamp in the log with the current time. Uses
-	the argument as the timespamp label. This is useful to time
-	the execution of lengthy VCL procedures, and makes the
-	timestamps inserted automatically by Varnish more accurate.
+	Introduces a timestamp in the log with the current time, using
+	the string *s* as the label. This is useful to time the execution
+	of lengthy VCL procedures, and makes the timestamps inserted
+	automatically by Varnish more accurate.
 Example
 	std.timestamp("curl-request");
 
@@ -332,10 +339,27 @@ Prototype
 	STRING querysort(STRING)
 
 Description
-        Sorts the querystring for cache normalization purposes.
+	Sorts the query string for cache normalization purposes.
 Example
         set req.url = std.querysort(req.url);
 
+.. _func_cache_req_body:
+
+VOID cache_req_body(BYTES)
+--------------------------
+
+Prototype
+	VOID cache_req_body(BYTES size)
+
+Description
+	Cache the req.body if it is smaller than *size*.
+
+	Caching the req.body makes it possible to retry pass
+	operations (POST, PUT).
+Example
+	std.cache_req_body(1KB);
+
+	This will cache the req.body if its size is smaller than 1KB.
 
 .. _func_strstr:
 
@@ -343,20 +367,42 @@ STRING strstr(STRING, STRING)
 -----------------------------
 
 Prototype
-	STRING strstr(STRING, STRING)
+	STRING strstr(STRING s1, STRING s2)
 
 Description
-	Returns the substring if the second string is a substring of the first
-	string. Note that the comparison is case sensitive. You can
-	use the tolower function on both strings if you want case
-	insensitivity.
-
-        If there is no match a NULL pointer is returned which would
-        evaluate to false in an if-test.
+	Returns the first occurrence of the string *s2* in the string
+	*s1*, or an empty string if not found.
 
+	Note that the comparison is case sensitive.
 Example
-	if (std.strstr(req.url, req.http.x-restrict))
+	| if (std.strstr(req.url, req.http.x-restrict)) {
+	| 	...
+	| }
+
+.. _func_time:
+
+TIME time(STRING, TIME)
+-----------------------
+
+Prototype
+	TIME time(STRING s, TIME fallback)
 
+Description
+	Converts the string *s* to a time.  If conversion fails,
+	*fallback* will be returned.
+
+	Supported formats:
+
+	| "Sun, 06 Nov 1994 08:49:37 GMT"
+	| "Sunday, 06-Nov-94 08:49:37 GMT"
+	| "Sun Nov  6 08:49:37 1994"
+	| "1994-11-06T08:49:37"
+	| "784111777.00"
+	| "784111777"
+Example
+	| if (std.time(resp.http.last-modified, now) < now - 1w) {
+	| 	...
+	| }
 
 
 SEE ALSO
diff --git a/doc/sphinx/build/html/_sources/tutorial/introduction.txt b/doc/sphinx/build/html/_sources/tutorial/introduction.txt
index 330764f..cff7268 100644
--- a/doc/sphinx/build/html/_sources/tutorial/introduction.txt
+++ b/doc/sphinx/build/html/_sources/tutorial/introduction.txt
@@ -30,7 +30,7 @@ Performance
 Varnish has a modern architecture and is written with performance
 in mind.  It is usually bound by the speed of the network, effectively
 turning performance into a non-issue. You get to focus on how your web
-application work and you can allow yourself, to some degree, to care
+applications work and you can allow yourself, to some degree, to care
 less about performance and scalability.
 
 .. XXX:Not totally sure what the last sentence above means. benc
@@ -58,7 +58,7 @@ About the Varnish development process
 -------------------------------------
 
 Varnish is a community driven project. The development is overseen by
-the Varnish Governing Board which currently consist of Poul-Henning Kamp
+the Varnish Governing Board which currently consists of Poul-Henning Kamp
 (Architect), Rogier Mulhuijzen (Fastly) and Lasse Karstensen (Varnish
 Software).
 
@@ -69,13 +69,13 @@ Getting in touch
 ----------------
 
 You can get in touch with us through many channels. For real time chat
-you can reach us on IRC trough the server irc.linpro.net on the #varnish
+you can reach us on IRC through the server irc.linpro.net on the #varnish
 and #varnish-hacking channels.
-There are two mailing lists available. One for user questions and one
+There are two mailing lists available: one for user questions and one
 for development discussions. See https://www.varnish-cache.org/lists
 for information and signup.  There is also a web forum on the same site.
 
-Now that you have a vague idea on what Varnish Cache is, let see if we
+Now that you have a vague idea on what Varnish Cache is, let's see if we
 can get it up and running.
 
 .. XXX:The above three paragraphs are repetitive this is already handled in previous chapters. The only new information is Governing Board which could be moved to the introduction and the paragraphs scrapped. benc
diff --git a/doc/sphinx/build/html/_sources/users-guide/increasing-your-hitrate.txt b/doc/sphinx/build/html/_sources/users-guide/increasing-your-hitrate.txt
index 231e27b..be76f2b 100644
--- a/doc/sphinx/build/html/_sources/users-guide/increasing-your-hitrate.txt
+++ b/doc/sphinx/build/html/_sources/users-guide/increasing-your-hitrate.txt
@@ -24,10 +24,9 @@ Tool: varnishtop
 ~~~~~~~~~~~~~~~~
 
 You can use varnishtop to identify what URLs are hitting the backend
-the most. ``varnishtop -i txurl`` is an essential command, showing
-you the top `txurl` requests Varnish is sending to the backend. You
-can see some other examples of `varnishtop` usage in
-:ref:`users-guide-statistics`.
+the most. ``varnishtop -i BereqURL`` is an essential command, showing
+you the top requests Varnish is sending to the backend. You can see some
+other examples of `varnishtop` usage in :ref:`users-guide-statistics`.
 
 
 Tool: varnishlog
@@ -35,8 +34,8 @@ Tool: varnishlog
 
 When you have identified an URL which is frequently sent to the
 backend you can use `varnishlog` to have a look at the request.
-``varnishlog -c -m 'RxURL:^/foo/bar`` will show you the requests
-coming from the client ('-c') matching `/foo/bar`.
+``varnishlog -q 'ReqURL ~ "^/foo/bar"'`` will show you the requests
+coming from the client matching `/foo/bar`.
 
 For more information on how `varnishlog` works please see
 :ref:`users-guide-logging` or man :ref:`ref-varnishlog`.
@@ -241,7 +240,8 @@ Age
 ~~~
 
 Varnish adds an 'Age' header to indicate how long the object has been
-kept inside Varnish. You can grep out 'Age' from `varnishlog` with ``varnishlog -i TxHeader -I ^Age``.
+kept inside Varnish. You can grep out 'Age' from `varnishlog` with
+``varnishlog -I RespHeader:^Age``.
 
 Pragma
 ~~~~~~
@@ -343,8 +343,8 @@ To achieve a high hitrate whilst using Vary is there therefore
 crucial to normalize the headers the backends varies on. Remember,
 just a difference in casing can force different cache entries.
 
-The following VCL code will normalize the 'Accept-Language' headers,
-to one of either "en", "de" or "fr"::
+The following VCL code will normalize the 'Accept-Language' header to
+either "en", "de" or "fr", in this order of precedence::
 
     if (req.http.Accept-Language) {
         if (req.http.Accept-Language ~ "en") {
@@ -360,9 +360,6 @@ to one of either "en", "de" or "fr"::
         }
     }
 
-The code sets the 'Accept-Encoding' header from the client to either
-gzip, deflate with a preference for gzip.
-
 Vary parse errors
 ~~~~~~~~~~~~~~~~~
 
diff --git a/doc/sphinx/build/html/_sources/users-guide/operation-logging.txt b/doc/sphinx/build/html/_sources/users-guide/operation-logging.txt
index 4dfa40f..d3e715c 100644
--- a/doc/sphinx/build/html/_sources/users-guide/operation-logging.txt
+++ b/doc/sphinx/build/html/_sources/users-guide/operation-logging.txt
@@ -20,13 +20,13 @@ is logging. `varnishlog` gives you the raw logs, everything that is
 written to the logs. There are other clients that can access the logs as well, we'll show you
 these later.
 
-In the terminal window you started Varnish now type ``varnishlog`` and
-press enter.
+In the terminal window you started Varnish now type ``varnishlog -g raw``
+and press enter.
 
 You'll see lines like these scrolling slowly by.::
 
-    0 CLI          - Rd ping
-    0 CLI          - Wr 200 PONG 1273698726 1.0
+    0 CLI            - Rd ping
+    0 CLI            - Wr 200 19 PONG 1273698726 1.0
 
 These is the Varnish master process checking up on the caching process
 to see that everything is OK.
@@ -37,25 +37,24 @@ app.
 
 You'll see lines like these.::
 
-   11 SessionOpen  c 127.0.0.1 58912 0.0.0.0:8080
-   11 ReqStart     c 127.0.0.1 58912 595005213
-   11 RxRequest    c GET
-   11 RxURL        c /
-   11 RxProtocol   c HTTP/1.1
-   11 RxHeader     c Host: localhost:8080
-   11 RxHeader     c Connection: keep-alive
+   11 SessOpen       c 127.0.0.1 58912 :8080 0.0.0.0 8080 1273698726.933590 14
+   11 ReqStart       c 127.0.0.1 58912
+   11 ReqMethod      c GET
+   11 ReqURL         c /
+   11 ReqProtocol    c HTTP/1.1
+   11 ReqHeader      c Host: localhost:8080
+   11 ReqHeader      c Connection: keep-alive
 
 
 The first column is an arbitrary number, it identifies the
-session. Lines with the same number are coming from the same session
-and are being handled by the same thread. The second column is the
-*tag* of the log message. All log entries are tagged with a tag
-indicating what sort of activity is being logged. Tags starting with
-'Rx' indicate Varnish is receiving data and 'Tx' indicates sending data.
+transaction. Lines with the same number are coming from the same
+transaction. The second column is the *tag* of the log message. All
+log entries are tagged with a tag indicating what sort of activity is
+being logged.
 
-The third column tell us whether this is is data coming or going to
-the client ('c') or to/from the backend ('b'). The forth column is the
-data being logged.
+The third column tell us whether this is is data coming from or going
+to the client ('c'), or the backend ('b'). The forth column is the data
+being logged.
 
 Now, you can filter quite a bit with `varnishlog`. The basic options we think you
 want to know are:
@@ -67,9 +66,11 @@ want to know are:
 '-c'
  Same as '-b' but for client side traffic.
 
-'-m tag:regex'
- Only list transactions where the tag matches a regular expression. If
- it matches you will get the whole transaction.
+'-g request'
+ Group transactions by request.
+
+'-q query'
+ Only list transactions matching this query.
 
 .. XXX:Maybe a couple of sample commands here? benc
 
diff --git a/doc/sphinx/build/html/_sources/users-guide/operation-statistics.txt b/doc/sphinx/build/html/_sources/users-guide/operation-statistics.txt
index 788e600..de25bd8 100644
--- a/doc/sphinx/build/html/_sources/users-guide/operation-statistics.txt
+++ b/doc/sphinx/build/html/_sources/users-guide/operation-statistics.txt
@@ -18,11 +18,10 @@ With suitable filtering using the -I, -i, -X and -x options, it can be
 used to display a ranking of requested documents, clients, user
 agents, or any other information which is recorded in the log.
 
-``varnishtop -i rxurl`` will show you what URLs are being asked for
-by the client. ``varnishtop -i txurl`` will show you what your backend
-is being asked the most. ``varnishtop -i RxHeader -I
-Accept-Encoding`` will show the most popular Accept-Encoding header
-the client are sending you.
+``varnishtop -i ReqURL`` will show you what URLs are being asked for by
+the client. ``varnishtop -i BereqURL`` will show you what your backend
+is being asked the most. ``varnishtop -I ReqHeader:Accept-Encoding`` will
+show the most popular Accept-Encoding header the client are sending you.
 
 For more information please see :ref:`ref-varnishtop`.
 
diff --git a/doc/sphinx/build/html/_sources/users-guide/purging.txt b/doc/sphinx/build/html/_sources/users-guide/purging.txt
index 70fb415..43df304 100644
--- a/doc/sphinx/build/html/_sources/users-guide/purging.txt
+++ b/doc/sphinx/build/html/_sources/users-guide/purging.txt
@@ -73,7 +73,7 @@ Support for bans is built into Varnish and available in the CLI
 interface. To ban every png object belonging on example.com, issue
 the following command::
 
-  ban req.http.host == "example.com" && req.url ~ "\.png$"
+  ban req.http.host == "example.com" && req.url ~ "\\.png$"
 
 Quite powerful, really.
 
diff --git a/doc/sphinx/build/html/_sources/users-guide/troubleshooting.txt b/doc/sphinx/build/html/_sources/users-guide/troubleshooting.txt
index d05b9d6..4be7543 100644
--- a/doc/sphinx/build/html/_sources/users-guide/troubleshooting.txt
+++ b/doc/sphinx/build/html/_sources/users-guide/troubleshooting.txt
@@ -106,16 +106,17 @@ give you a clue. Since `varnishlog` logs a lot of data it might be hard
 to track the entries down. You can set `varnishlog` to log all your 503
 errors by issuing the following command::
 
-   $ varnishlog -c -m TxStatus:503
+   $ varnishlog -q 'RespStatus == 503' -g request
 
 If the error happened just a short time ago the transaction might still
 be in the shared memory log segment. To get `varnishlog` to process the
 whole shared memory log just add the '-d' parameter::
 
-   $ varnishlog -d -c -m TxStatus:503
+   $ varnishlog -d -q 'RespStatus == 503' -g request
 
-Please see the `varnishlog` man page for elaborations on further
-filtering capabilities and explanation of the various options.
+Please see the `vsl-query` and `varnishlog` man pages for elaborations
+on further filtering capabilities and explanation of the various
+options.
 
 
 Varnish doesn't cache
diff --git a/doc/sphinx/build/html/_sources/users-guide/vcl-built-in-subs.txt b/doc/sphinx/build/html/_sources/users-guide/vcl-built-in-subs.txt
index 9c9c690..7b38812 100644
--- a/doc/sphinx/build/html/_sources/users-guide/vcl-built-in-subs.txt
+++ b/doc/sphinx/build/html/_sources/users-guide/vcl-built-in-subs.txt
@@ -1,45 +1,52 @@
-
 .. _vcl-built-in-subs:
 
-.. XXX:This document needs substantional review.
+====================
+Built in subroutines
+====================
 
+Various built-in subroutines are called during processing of client-
+and backend requests as well as upon ``vcl.load`` and ``vcl.discard``.
 
-Built in subroutines
---------------------
+-----------
+client side
+-----------
 
+.. _vcl_recv:
 
 vcl_recv
 ~~~~~~~~
 
 Called at the beginning of a request, after the complete request has
-been received and parsed. Its purpose is to decide whether or not to
-serve the request, how to do it, and, if applicable, which backend to
-use.
+been received and parsed, after a `restart` or as the result of an ESI
+include.
 
-It is also used to modify the request, something you'll probably find
-yourself doing frequently. 
+Its purpose is to decide whether or not to serve the request, possibly
+modify it and decide on how to process it further. A backend hint may
+be set as a default for the backend processing side.
 
 The `vcl_recv` subroutine may terminate with calling ``return()`` on one
 of the following keywords:
 
-  synth(status code, reason)
-    Return a synthetic object with the specified status code to the
-    client and abandon the request.
+  ``hash``
+    Continue processing the object as a potential candidate for
+    caching. Passes the control over to :ref:`vcl_hash`.
 
-  pass
-    Switch to pass mode. Control will eventually pass to vcl_pass.
+  ``pass``
+    Switch to pass mode. Control will eventually pass to :ref:`vcl_pass`.
 
-  pipe
-    Switch to pipe mode. Control will eventually pass to vcl_pipe.
+  ``pipe``
+    Switch to pipe mode. Control will eventually pass to :ref:`vcl_pipe`.
 
-  hash
-    Continue processing the object as a potential candidate for
-    caching. Passes the control over to vcl_hash.
+  ``synth(status code, reason)``
+    Transition to :ref:`vcl_synth` with ``resp.status`` and
+    ``resp.reason`` being preset to the arguments of ``synth()``.
 
-  purge
-    Purge the object and it's variants. Control passes through 
+  ``purge``
+    Purge the object and it's variants. Control passes through
     vcl_hash to vcl_purge.
 
+.. _vcl_pipe:
+
 vcl_pipe
 ~~~~~~~~
 
@@ -53,12 +60,15 @@ other VCL subroutine will ever get called after `vcl_pipe`.
 The `vcl_pipe` subroutine may terminate with calling ``return()`` with one
 of the following keywords:
 
-  synth(status code, reason)
-    Return the specified status code to the client and abandon the request.
-
-  pipe
+  ``pipe``
     Proceed with pipe mode.
 
+  ``synth(status code, reason)``
+    Transition to :ref:`vcl_synth` with ``resp.status`` and
+    ``resp.reason`` being preset to the arguments of ``synth()``.
+
+.. _vcl_pass:
+
 vcl_pass
 ~~~~~~~~
 
@@ -70,63 +80,86 @@ submitted over the same client connection are handled normally.
 The `vcl_pass` subroutine may terminate with calling ``return()`` with one
 of the following keywords:
 
-  synth(status code, reason)
-    Return the specified status code to the client and abandon the request.
+  ``fetch``
+    Proceed with pass mode - initiate a backend request.
 
-  pass
-    Proceed with pass mode.
-
-  restart
+  ``restart``
     Restart the transaction. Increases the restart counter. If the number
     of restarts is higher than *max_restarts* Varnish emits a guru meditation
     error.
 
+  ``synth(status code, reason)``
+    Transition to :ref:`vcl_synth` with ``resp.status`` and
+    ``resp.reason`` being preset to the arguments of ``synth()``.
+
+.. _vcl_hit:
 
 vcl_hit
 ~~~~~~~
 
-Called when a cache lookup is successful. 
+Called when a cache lookup is successful. The object being hit may be
+stale: It can have a zero or negative `ttl` with only `grace` or
+`keep` time left.
 
-The `vcl_hit` subroutine may terminate with calling ``return()`` with one of the following keywords:
+The `vcl_hit` subroutine may terminate with calling ``return()``
+with one of the following keywords:
+
+  ``deliver``
+    Deliver the object. If it is stale, a background fetch to refresh
+    it is triggered.
+
+  ``fetch``
+    Synchronously refresh the object from the backend despite the
+    cache hit. Control will eventually pass to :ref:`vcl_miss`.
 
+  ``pass``
+    Switch to pass mode. Control will eventually pass to :ref:`vcl_pass`.
 
-  restart
+  ``restart``
     Restart the transaction. Increases the restart counter. If the number
     of restarts is higher than *max_restarts* Varnish emits a guru meditation
     error.
 
-  deliver
-    Deliver the object. Control passes to `vcl_deliver`.
+  ``synth(status code, reason)``
+    Transition to :ref:`vcl_synth` with ``resp.status`` and
+    ``resp.reason`` being preset to the arguments of ``synth()``.
 
-  synth(status code, reason)
-    Return the specified status code to the client and abandon the request.
+.. XXX: #1603 hit should not go to miss
 
+.. _vcl_miss:
 
 vcl_miss
 ~~~~~~~~
 
 Called after a cache lookup if the requested document was not found in
-the cache. Its purpose is to decide whether or not to attempt to
-retrieve the document from the backend, and which backend to use.
+the cache or if :ref:`vcl_hit` returned ``fetch``.
+
+Its purpose is to decide whether or not to attempt to retrieve the
+document from the backend. A backend hint may be set as a default for
+the backend processing side.
 
 The `vcl_miss` subroutine may terminate with calling ``return()`` with one
 of the following keywords:
 
-  synth(status code, reason)
-    Return the specified status code to the client and abandon the request.
-
-  pass
-    Switch to pass mode. Control will eventually pass to `vcl_pass`.
-
-  fetch
+  ``fetch``
     Retrieve the requested object from the backend. Control will
     eventually pass to `vcl_backend_fetch`.
 
-  restart
+  ``pass``
+    Switch to pass mode. Control will eventually pass to :ref:`vcl_pass`.
+
+  ``restart``
     Restart the transaction. Increases the restart counter. If the number
     of restarts is higher than *max_restarts* Varnish emits a guru meditation
     error.
 
+  ``synth(status code, reason)``
+    Transition to :ref:`vcl_synth` with ``resp.status`` and
+    ``resp.reason`` being preset to the arguments of ``synth()``.
+
+.. XXX: #1603 hit should not go to miss
+
+.. _vcl_hash:
 
 vcl_hash
 ~~~~~~~~
@@ -134,13 +167,18 @@ vcl_hash
 Called after `vcl_recv` to create a hash value for the request. This is
 used as a key to look up the object in Varnish.
 
-The `vcl_hash` subroutine may terminate with calling ``return()`` with one
-of the following keywords:
+The `vcl_hash` subroutine may only terminate with calling ``return(lookup)``:
 
-  lookup
-    Look up the object in cache. Control passes to vcl_miss, vcl_hit
-    or vcl_purge.
+  ``lookup``
+    Look up the object in cache.
+    Control passes to :ref:`vcl_purge` when coming from a ``purge``
+    return in `vcl_recv`.
+    Otherwise control passes to :ref:`vcl_hit`, :ref:`vcl_miss` or
+    :ref:`vcl_pass` if the cache lookup result was a hit, a miss or hit
+    on a hit-for-pass object (object with ``obj.uncacheable ==
+    true``), respectively.
 
+.. _vcl_purge:
 
 vcl_purge
 ~~~~~~~~~
@@ -150,31 +188,66 @@ Called after the purge has been executed and all its variants have been evited.
 The `vcl_purge` subroutine may terminate with calling ``return()`` with one
 of the following keywords:
 
-  synth
-    Produce a response.
-
-  restart
+  ``restart``
     Restart the transaction. Increases the restart counter. If the number
     of restarts is higher than *max_restarts* Varnish emits a guru meditation
     error.
 
+  ``synth(status code, reason)``
+    Transition to :ref:`vcl_synth` with ``resp.status`` and
+    ``resp.reason`` being preset to the arguments of ``synth()``.
+
+.. _vcl_deliver:
 
 vcl_deliver
 ~~~~~~~~~~~
 
-Called before a cached object is delivered to the client.
+Called before any object except a `vcl_synth` result is delivered to the client.
 
 The `vcl_deliver` subroutine may terminate with calling ``return()`` with one
 of the following keywords:
 
-  deliver
+  ``deliver``
     Deliver the object to the client.
 
-  restart
+  ``restart``
+    Restart the transaction. Increases the restart counter. If the number
+    of restarts is higher than *max_restarts* Varnish emits a guru meditation
+    error.
+
+  ``synth(status code, reason)``
+    Transition to :ref:`vcl_synth` with ``resp.status`` and
+    ``resp.reason`` being preset to the arguments of ``synth()``.
+
+.. _vcl_synth:
+
+vcl_synth
+~~~~~~~~~
+
+Called to deliver a synthetic object. A synthetic object is generated
+in VCL, not fetched from the backend. Its body may be contructed using
+the ``synthetic()`` function.
+
+A `vcl_synth` defined object never enters the cache, contrary to a
+:ref:`vcl_backend_error` defined object, which may end up in cache.
+
+The subroutine may terminate with calling ``return()`` with one of the
+following keywords:
+
+  ``deliver``
+    Directly deliver the object defined by `vcl_synth` to the
+    client without calling `vcl_deliver`.
+
+  ``restart``
     Restart the transaction. Increases the restart counter. If the number
     of restarts is higher than *max_restarts* Varnish emits a guru meditation
     error.
 
+------------
+Backend Side
+------------
+
+.. _vcl_backend_fetch:
 
 vcl_backend_fetch
 ~~~~~~~~~~~~~~~~~
@@ -185,50 +258,71 @@ typically alter the request before it gets to the backend.
 The `vcl_backend_fetch` subroutine may terminate with calling
 ``return()`` with one of the following keywords:
 
-  fetch
+  ``fetch``
     Fetch the object from the backend.
 
-  abandon
-    Abandon the backend request and generates an error.
+  ``abandon``
+    Abandon the backend request. Unless the backend request was a
+    background fetch, control is passed to :ref:`vcl_synth` on the
+    client side with ``resp.status`` preset to 503.
 
+.. _vcl_backend_response:
 
 vcl_backend_response
 ~~~~~~~~~~~~~~~~~~~~
 
-Called after the response headers has been successfully retrieved from
+Called after the response headers have been successfully retrieved from
 the backend.
 
 The `vcl_backend_response` subroutine may terminate with calling
 ``return()`` with one of the following keywords:
 
-  deliver
-    Possibly insert the object into the cache, then deliver it to the
-    Control will eventually pass to `vcl_deliver`.
+  ``deliver``
+    For a 304 response, create an updated cache object.
+    Otherwise, fetch the object body from the backend and initiate
+    delivery to any waiting client requests, possibly in parallel
+    (streaming).
 
-  abandon
-    Abandon the backend request and generates an error.
+  ``abandon``
+    Abandon the backend request. Unless the backend request was a
+    background fetch, control is passed to :ref:`vcl_synth` on the
+    client side with ``resp.status`` preset to 503.
 
-  retry
+  ``retry``
     Retry the backend transaction. Increases the `retries` counter.
-    If the number of retries is higher than *max_retries* Varnish
-    emits a guru meditation error.
+    If the number of retries is higher than *max_retries*,
+    control will be passed to :ref:`vcl_backend_error`.
+
+.. _vcl_backend_error:
 
 vcl_backend_error
 ~~~~~~~~~~~~~~~~~
 
-This subroutine is called if we fail the backend fetch. 
+This subroutine is called if we fail the backend fetch or if
+*max_retries* has been exceeded.
+
+A synthetic object is generated in VCL, whose body may be contructed
+using the ``synthetic()`` function.
 
 The `vcl_backend_error` subroutine may terminate with calling ``return()``
 with one of the following keywords:
 
-  deliver
-    Deliver the error.
+  ``deliver``
+    Deliver and possibly cache the object defined in
+    `vcl_backend_error` **as if it was fetched from the backend**, also
+    referred to as a "backend synth".
 
-  retry
-    Retry the backend transaction. Increases the `retries` counter. If
-    the number of retries is higher than *max_retries* Varnish emits a
-    guru meditation error.
+  ``retry``
+    Retry the backend transaction. Increases the `retries` counter.
+    If the number of retries is higher than *max_retries*,
+    :ref:`vcl_synth` on the client side is called with ``resp.status``
+    preset to 503.
 
+----------------------
+vcl.load / vcl.discard
+----------------------
+
+.. _vcl_init:
 
 vcl_init
 ~~~~~~~~
@@ -239,9 +333,13 @@ Typically used to initialize VMODs.
 The `vcl_init` subroutine may terminate with calling ``return()``
 with one of the following keywords:
 
-  ok
+  ``ok``
     Normal return, VCL continues loading.
 
+  ``fail``
+    Abort loading of this VCL.
+
+.. _vcl_fini:
 
 vcl_fini
 ~~~~~~~~
@@ -252,5 +350,5 @@ Typically used to clean up VMODs.
 The `vcl_fini` subroutine may terminate with calling ``return()``
 with one of the following keywords:
 
-  ok
+  ``ok``
     Normal return, VCL will be discarded.
diff --git a/doc/sphinx/build/html/_sources/users-guide/vcl-inline-c.txt b/doc/sphinx/build/html/_sources/users-guide/vcl-inline-c.txt
index 5cc0ead..e0d0998 100644
--- a/doc/sphinx/build/html/_sources/users-guide/vcl-inline-c.txt
+++ b/doc/sphinx/build/html/_sources/users-guide/vcl-inline-c.txt
@@ -1,16 +1,16 @@
 
 
 
-Using In-line C to extend Varnish
+Using inline C to extend Varnish
 ---------------------------------
 
 (Here there be dragons. Big and mean ones.)
 
-You can use *in-line C* to extend Varnish. Please note that you can
+You can use *inline C* to extend Varnish. Please note that you can
 seriously mess up Varnish this way. The C code runs within the Varnish
 Cache process so if your code generates a segfault the cache will crash.
 
-One of the first uses of In-line C was logging to `syslog`.::
+One of the first uses of inline C was logging to `syslog`.::
 
         # The include statements must be outside the subroutines.
         C{
@@ -22,3 +22,7 @@ One of the first uses of In-line C was logging to `syslog`.::
                         syslog(LOG_INFO, "Something happened at VCL line XX.");
                 }C
         }
+
+To use inline C you need to enable it with the ``vcc_allow_inline_c``
+parameter.
+
diff --git a/doc/sphinx/build/html/_sources/users-guide/vcl-variables.txt b/doc/sphinx/build/html/_sources/users-guide/vcl-variables.txt
index 644c046..70862e5 100644
--- a/doc/sphinx/build/html/_sources/users-guide/vcl-variables.txt
+++ b/doc/sphinx/build/html/_sources/users-guide/vcl-variables.txt
@@ -22,7 +22,7 @@ objects can be accessed and manipulated using VCL.
 *beresp*
  The backend response object. It contains the headers of the object
  coming from the backend. If you want to modify the response coming from the
- server you modify this object in `vcl_backend_reponse`.
+ server you modify this object in `vcl_backend_response`.
 
 *resp*
  The HTTP response right before it is delivered to the client. It is
diff --git a/doc/sphinx/build/html/_sources/whats-new/upgrading.txt b/doc/sphinx/build/html/_sources/whats-new/upgrading.txt
index cb36b08..0e5b800 100644
--- a/doc/sphinx/build/html/_sources/whats-new/upgrading.txt
+++ b/doc/sphinx/build/html/_sources/whats-new/upgrading.txt
@@ -67,7 +67,7 @@ vcl_error is now vcl_backend_error
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 To make a distinction between internally generated errors and
-VCL synthetic responses, `vcl_backend_error` will be called when 
+VCL synthetic responses, `vcl_backend_error` will be called when
 varnish encounters an error when trying to fetch an object.
 
 error() is now synth()
@@ -145,14 +145,7 @@ The `purge;` keyword has been retired.
 obj is now read-only
 ~~~~~~~~~~~~~~~~~~~~
 
-`obj` is now read-only. `obj.hits`, if enabled in VCL, now counts per
-objecthead, not per object. `obj.last_use` has been retired.
-
-Note that obj.hits may not be reset in some cases where bans are in use. See
-bug 1492_ for details.
-
-.. _1492: https://www.varnish-cache.org/trac/ticket/1492
-
+`obj` is now read-only.  `obj.last_use` has been retired.
 
 Some return values have been replaced
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
@@ -192,13 +185,22 @@ The `remove` keyword is gone
 Replaced by `unset`.
 
 
+X-Forwarded-For is now set before vcl_recv
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+In many cases, people unintentionally removed X-Forwarded-For when
+implementing their own vcl_recv. Therefore it has been moved to before
+vcl_recv, so if you don't want an IP added to it, you should remove it
+in vcl_recv.
+
 
 Changes to existing parameters
 ==============================
 
 session_linger
 ~~~~~~~~~~~~~~
-`session_linger` has been renamed to `timeout_linger`.
+`session_linger` has been renamed to `timeout_linger` and it is in
+seconds now (previously was milliseconds).
 
 sess_timeout
 ~~~~~~~~~~~~
@@ -217,6 +219,14 @@ If you are using a lot of VMODs,  you may need to increase
 either `workspace_backend` and `workspace_client` based on where
 your VMOD is doing its work.
 
+thread_pool_purge_delay
+~~~~~~~~~~~~~~~~~~~~~~~
+`thread_pool_purge_delay` has been renamed to `thread_pool_destroy_delay`
+and it is in seconds now (previously was milliseconds).
+
+thread_pool_add_delay and thread_pool_fail_delay
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+They are in seconds now (previously were milliseconds).
 
 New parameters since 3.0
 ========================
diff --git a/doc/sphinx/build/html/genindex.html b/doc/sphinx/build/html/genindex.html
index a797b9d..c08ff1c 100644
--- a/doc/sphinx/build/html/genindex.html
+++ b/doc/sphinx/build/html/genindex.html
@@ -10,7 +10,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Index &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Index &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="_static/default.css" type="text/css" />
     <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
@@ -18,7 +18,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -27,7 +27,7 @@
     <script type="text/javascript" src="_static/jquery.js"></script>
     <script type="text/javascript" src="_static/underscore.js"></script>
     <script type="text/javascript" src="_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="index.html" /> 
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="index.html" /> 
   </head>
   <body>
     <div class="related">
@@ -36,7 +36,7 @@
         <li class="right" style="margin-right: 10px">
           <a href="#" title="General Index"
              accesskey="I">index</a></li>
-        <li><a href="index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>  
 
@@ -258,7 +258,7 @@
         <li class="right" style="margin-right: 10px">
           <a href="#" title="General Index"
              >index</a></li>
-        <li><a href="index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>
     <div class="footer">
diff --git a/doc/sphinx/build/html/glossary/index.html b/doc/sphinx/build/html/glossary/index.html
index 4496c12..481ef9e 100644
--- a/doc/sphinx/build/html/glossary/index.html
+++ b/doc/sphinx/build/html/glossary/index.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Varnish Glossary &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Varnish Glossary &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="prev" title="Why Sphinx and reStructuredText ?" href="../phk/sphinx.html" /> 
   </head>
   <body>
@@ -38,7 +38,7 @@
         <li class="right" >
           <a href="../phk/sphinx.html" title="Why Sphinx and reStructuredText ?"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>  
 
@@ -171,7 +171,7 @@ it again, to keep your website alive.</dd>
         <li class="right" >
           <a href="../phk/sphinx.html" title="Why Sphinx and reStructuredText ?"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>
     <div class="footer">
diff --git a/doc/sphinx/build/html/index.html b/doc/sphinx/build/html/index.html
index 9e416f2..b4d3dba 100644
--- a/doc/sphinx/build/html/index.html
+++ b/doc/sphinx/build/html/index.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Varnish Administrator Documentation &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Varnish Administrator Documentation &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="_static/default.css" type="text/css" />
     <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="_static/jquery.js"></script>
     <script type="text/javascript" src="_static/underscore.js"></script>
     <script type="text/javascript" src="_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="#" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="#" />
     <link rel="next" title="Varnish Installation" href="installation/index.html" /> 
   </head>
   <body>
@@ -38,7 +38,7 @@
         <li class="right" >
           <a href="installation/index.html" title="Varnish Installation"
              accesskey="N">next</a> |</li>
-        <li><a href="#">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="#">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>  
 
@@ -75,7 +75,7 @@ terminal or after starting one of the tools.</dd>
 <dd>A hyperlink.</dd>
 </dl>
 </div></blockquote>
-<p>Longer listings like example command output and VCL will look like this:</p>
+<p>Longer listings like example command output and VCL look like this:</p>
 <div class="highlight-python"><pre>$ /opt/varnish/sbin/varnishd -V
 varnishd (varnish-4.0.0-tp1 revision ddd00e1)
 Copyright (c) 2006 Verdens Gang AS
@@ -149,7 +149,7 @@ Copyright (c) 2006-2011 Varnish Software AS</pre>
         <li class="right" >
           <a href="installation/index.html" title="Varnish Installation"
              >next</a> |</li>
-        <li><a href="#">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="#">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>
     <div class="footer">
diff --git a/doc/sphinx/build/html/installation/bugs.html b/doc/sphinx/build/html/installation/bugs.html
index 464bb08..08bc2b8 100644
--- a/doc/sphinx/build/html/installation/bugs.html
+++ b/doc/sphinx/build/html/installation/bugs.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Reporting bugs &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Reporting bugs &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Varnish Installation" href="index.html" />
     <link rel="next" title="Platform specific notes" href="platformnotes.html" />
     <link rel="prev" title="Getting help" href="help.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="help.html" title="Getting help"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Varnish Installation</a> &raquo;</li> 
       </ul>
     </div>  
@@ -231,7 +231,7 @@ program.</p>
         <li class="right" >
           <a href="help.html" title="Getting help"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Varnish Installation</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/installation/help.html b/doc/sphinx/build/html/installation/help.html
index 581676f..fe879ac 100644
--- a/doc/sphinx/build/html/installation/help.html
+++ b/doc/sphinx/build/html/installation/help.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Getting help &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Getting help &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Varnish Installation" href="index.html" />
     <link rel="next" title="Reporting bugs" href="bugs.html" />
     <link rel="prev" title="Installing Varnish" href="install.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="install.html" title="Installing Varnish"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Varnish Installation</a> &raquo;</li> 
       </ul>
     </div>  
@@ -185,7 +185,7 @@ an email to <a class="reference external" href="mailto:phk&#37;&#52;&#48;FreeBSD
         <li class="right" >
           <a href="install.html" title="Installing Varnish"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Varnish Installation</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/installation/index.html b/doc/sphinx/build/html/installation/index.html
index d6354ca..8fe17b2 100644
--- a/doc/sphinx/build/html/installation/index.html
+++ b/doc/sphinx/build/html/installation/index.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Varnish Installation &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Varnish Installation &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="next" title="Prerequisites" href="prerequisites.html" />
     <link rel="prev" title="Varnish Administrator Documentation" href="../index.html" /> 
   </head>
@@ -42,7 +42,7 @@
         <li class="right" >
           <a href="../index.html" title="Varnish Administrator Documentation"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>  
 
@@ -141,7 +141,7 @@ to get help, and how to report bugs. It also contains a set of platform specific
         <li class="right" >
           <a href="../index.html" title="Varnish Administrator Documentation"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>
     <div class="footer">
diff --git a/doc/sphinx/build/html/installation/install.html b/doc/sphinx/build/html/installation/install.html
index 63a6ec3..0ddc389 100644
--- a/doc/sphinx/build/html/installation/install.html
+++ b/doc/sphinx/build/html/installation/install.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Installing Varnish &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Installing Varnish &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Varnish Installation" href="index.html" />
     <link rel="next" title="Getting help" href="help.html" />
     <link rel="prev" title="Prerequisites" href="prerequisites.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="prerequisites.html" title="Prerequisites"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Varnish Installation</a> &raquo;</li> 
       </ul>
     </div>  
@@ -235,7 +235,7 @@ figuring out what.</p>
         <li class="right" >
           <a href="prerequisites.html" title="Prerequisites"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Varnish Installation</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/installation/platformnotes.html b/doc/sphinx/build/html/installation/platformnotes.html
index 34dce89..f28914d 100644
--- a/doc/sphinx/build/html/installation/platformnotes.html
+++ b/doc/sphinx/build/html/installation/platformnotes.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Platform specific notes &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Platform specific notes &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Varnish Installation" href="index.html" />
     <link rel="next" title="The Varnish Tutorial" href="../tutorial/index.html" />
     <link rel="prev" title="Reporting bugs" href="bugs.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="bugs.html" title="Reporting bugs"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Varnish Installation</a> &raquo;</li> 
       </ul>
     </div>  
@@ -163,7 +163,7 @@ they are less than the system default value.</p>
         <li class="right" >
           <a href="bugs.html" title="Reporting bugs"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Varnish Installation</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/installation/prerequisites.html b/doc/sphinx/build/html/installation/prerequisites.html
index e615695..17bc3c7 100644
--- a/doc/sphinx/build/html/installation/prerequisites.html
+++ b/doc/sphinx/build/html/installation/prerequisites.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Prerequisites &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Prerequisites &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Varnish Installation" href="index.html" />
     <link rel="next" title="Installing Varnish" href="install.html" />
     <link rel="prev" title="Varnish Installation" href="index.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="index.html" title="Varnish Installation"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Varnish Installation</a> &raquo;</li> 
       </ul>
     </div>  
@@ -125,7 +125,7 @@ time, said to work on:</p>
         <li class="right" >
           <a href="index.html" title="Varnish Installation"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Varnish Installation</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/objects.inv b/doc/sphinx/build/html/objects.inv
index f1c84bd432b03b6f92c1439d19ea72e8e6d1611a..07a9d04d1a5b62ab4d6f1428efc1f2af4ca9340f 100644
GIT binary patch
delta 4489
zcmV;45q9p8BJ(4VMFBIBMpA#%Y-?=VX5&nY*%yJ9Xj>auQboy$=hyE!hZj*7I~G%*
zXe^4~N1B&&<Dtv6luXshZ?&wpjQ@kJvqC9R?cbz%BA+fc^)~w(zT>YLKP#61lW~1|
z{Zc4(dhKPA>?hO~@q^40R!LPBxjOM%7!-FXezuFV(_4Kkss~xISy_J-u~h2(G^9px
z0|J^&I$;#2eM3a-M3tv%qiRu4AJD0-By5&1e`Akny<xAD*C!5%1@nB#5y}%B7AX=K
z-IIH8adBGRwzGMx#OeIobjtcQP1I7=lR=wQO<ED(n@O!~g{r47TaEITZJebtpZ?|Q
zqMVG$iuD9Jvw4UfMP7dwIbkxflo^7c{EaS;5*V+liR-k;H5lG;gZZZacvaY{s93#`
zY+Xr#BeyP!<g8J$QheQ{iL`<wf}$OicH8wTz5(%KD=Xdd2o1M1@9ZYj&oI-gs1%jh
zMqBX|RkE&9*=r1{$V%ohG-dXbZU)LZL17-BxP^K&XVkSO&1!$1=3F()=e~tsRk!hq
zy~9G5!oWAns%YvomwvAS7bR&mwa3^T!VH`ySTuDJSE3wFv3=7{tgHJzP1wF@SS+#(
zCv?l)tGXyM#eP3qHF+Gt%)`Hf-P{&1({*yOmbt88L6{CBlpE;c{%-#H1Jh44{q&P5
zJ;xDgMP5<j8asb+8eg$5xA*fepBFR;@D-@vj}mnX$=tzk4C}N5GlIW|Wqwa%@lCRC
zP|ChRu^twfQCQ<uu}t#|Uq2igBbX~N5Q<8Tjuf$RVzUdMy}P{n_x0!ZY^0^xx#@(+
zlVW=zk|g>8eIPOpWUdQezs#ZiK_fHMwV&AC_2tdEx2S*1xRS6R>v$7o>DH+739B3N
zobX)Z`-EE3L}^}E#o;|kuYHlC>*IXBOV{kHZk^qxaotqX>;I;%OB~g;j8s#WMK$>w
zAOj}`ZW)H8UW;)Y#l?0jj!fNwmg1OOWJ}^P*Bg+~NmRlD)-t}>!{1Eor#7UCI1+I~
z#5K{uCcJ-ctp7^OXxXe*a<Z&LC^t}#rlW1(dzWAas<f}+{Po~fvZCXvE%Jr3$|6;Y
zSWXtpD&rdHC_Gw}C{z}CcESX9hvx?0CnO1o>+I*ZQ3jhdDpt5hfL7H*F{mrHqEA0_
z1oC3V9q`*`&pzJY-@f_z;w?)G(2;oobP{xht&@M|>$5Zmb2`g7*&p53%qxLX-M3F(
zxji`dYS6bRr2>m@Fi6<%5@uAtYx~|-zhv!uwuPw`Yw2qjXW$+lc&uVO=oM*UyAf*h
z14KR23}n2|Z8T(bGhf`F_tqxZoev>PlW>;6<4ojAG+7<3tAI6cz+8hnR9+KV)##<T
z6WM>%768i~)+f?4vVw(!gZ2Yv#ZnDsrr!prUR<Rpj)n^qOWUPMbv_o4?8ATOw?8oy
z)cEP|*NeH{z-Szrec;RObSuGJ1bqh@W3tRNXl~G5GCgelo}XyV0c?KD($ZOQ^V{=|
zC`P9mwqF__v6hPxd10@6we5~uxDszPRJwmwa=nAymnYfu;V^LS;9WYJOQo{mR6=1p
zlUM_VVP3Gs;sz|^wtp$mfU5%*ni=Y;JwyVI1a|7!fby&c%e+cO#z*WP`%W7@iSNk0
zB8vwmFA-Z1iUJJTV#OZil7Zv;v<K5a-oU!h0g91@*lKt60-HhkW`gQl23xt!<W7HP
zLAHSdcc?HJ=iBFDVgX2evz&d=5k8N1WY6N%h3;6w`b0e!7Ze@H>$30HoaW>Lm}_u{
zs<VFqzdvSEgDEZ)tQQV$W5qXVjiY5(8rliChJ4d6uF`s$)?k|!S+QD8HgGkZTX>Jo
z*D<8^BXCjBq?@c|2+b|JOV$~otXO}qal@P--b__HJU0e8D)Cn-c*fCkU&~M-LJS-k
zoD><7dMz$R9wkjVd8h!#31<n0;^KQF8yV*P8KFT8#{V0V_Ei6m@qL~8A9%lG4O##9
z9OFch+Jk6)ibR|p4-)Bmy3zKTBknS$Fk)Pw2+wE*DmJ^kx>3f_N4w{kF>rrWZyW6V
z^F1@4TNVEKUfVNEQB~<6T8E0zzG=0gtGkeK1AB7MT#2{5A2*^_JeQASet~=0bqc;g
z@oVrh<fF&L{(14X@1mm++ay(xbB^K=u|Cn6!(xCf0`<5&5=@LUN8EzA0o~G{QRh#M
z`KeR9KT9y6q&fTrytI*!S0#TX|4Z6<2u|QH{4H1pMYG<(G6Omc=Yrxy<G_yjFP$;>
z{rqj3za)Tw@E)BXKT6AB8HiXX{d^+5g=$b5kAYjrVofB|Ja!#59hj<`JU^--Oa(tU
zWiep?R_IWZr(g^1c7pDW?4xqe?F-GwK7k1ccElWu^cM%&S?$%aP}YC3uim1~mv;p-
z8^P7X3u6r?{Wi?EXwf8e-Q&!Q65F*Hm(hcirO48qp5n>NF)q1dpr+Z7RDUab)-v_`
zAdbEXeCRF{ayZIlKjLvfspoQF9h8S`ar^#HmZS+RJGKQ}v)#f{+=*DnO#0^_3Rh9!
zL5RWnMCK4+uR@2yKxuz8^ye999UK22L^*uffGYRJ5lhtQ!)T?W?ioc{gXhtaSj!O8
zNTWHTyJTc2V323>IT98Vke^vEyQl`;^NCD_-q9Mm*BWTc{n(g04?p~cu}UvChDGh}
z{~1O%3*P-2jpqr>J<jgupRWDIv6S_r1lt^~S{14%3<+7w$|--0QEGFrWHjZ7Zq;x6
zLnKp|b}r}$iOLn1UYb9kIRCwKaPz|sZ3bsX9sb#QFJxXk49-d?xO!I_@2hR<bCj05
zUngsAs=^8C(O8|`lx48a)>x;r>G4o-^(7IUPVlA^xABZXk=E0rR|cj3bWTc7Jt4Kv
z_Rvy0GeHCD!1{kw&^*o1@$ZMJ!;X6}P;HPc$wAHkjE#Ph?l&A`#C{kfD`HUE58#zd
zjbI>>6S5`g>_w661TZ+)(q>I?x9vmoCoFS6k-}qsZ$BC1b@z-5>o<aRzh2!i?p%he
zB44HJM#n$cjmX!HIe{6SKX65N*~_L+Q;g7>?*sdNRaAdl9EQW+%d6ynKObwqA=>5N
z<Wj+IWVh}6!TGUNB|4Q+CiAf4V<12ml_SA`()U%>;Ssd)>sRdS;-+)tvuxJWk9rV9
z|C{(rnn|>#f+UFp8`*51XSa9ruhG@z%}tvgqRmfPgH`}_pu$X02}V`P5w6WpM>nGY
zh?1g;d!~PxE;CNmLRYx$u4fY{42sE`n4`w}MEVRg6E&``5u3xk@{T}V?b|daE5nr>
zFsuU=oo`lKiV<3E?DoTdr`o!J(`jp_7ZDyjM|n|?*v~j1qt)8MF|Rqk=I~k@({@L{
z$3yMUMa@1!X?x6~j3;jUaNxwHU(Mv+^;v8mS_gmMI`y6{7^adnl&og`d4`{dc{yqW
z4m--n$yp{o(tV^Ewi;_C>p0A>v6@LU@Q%t&1C0nkS|g$*=}TxjE_z9V51l@B@_T&B
z(=_}BJe+#-!_~W?{iy%M8yP>SVanPMN*VLg)`odw<IT0fbD9)I>5I?FPn=e7A{6B@
zZs>n-oiE<pF8<9f;aTQ&s-q&5t*4G8rh!I{n<^w4+fPyBEz{vf{8LXDmokdu$p@Z@
z<AAdS9w%mQ+KA0mUc}na5A%tJx&!@v72zTX)Eq>>iC{q4kycwAx&ZSDklZ32iGR|D
zk_H21@utZiRQlKCZ$b>b!!RTrT7=)Dkj8(EHTazqxI;xEc$Ma9kmMyG@5re{?oyB^
zvbOhFMmhajUY@~wDrT<SUz>3Zc1=-5Dgz@OhiUQ(H4K~>aO~NT)E&izsUnT+tDrzT
z33ZT#dNkC<(q1c?+Cu{Jk=(7i&O$S{5bDtkHp&ZkNq>v9`-AK|7!CPURwE{zdE<Xs
zaWDW>7hTTlC!4vc^pFar!iH4P-Hp)*FfFVX#DF!vPpJFbRO`SsK*;XC9XS>1#`3)L
zRZIu6rtcqEiG9FI+B_&jkBA6}r_1<ZHt$4(?CN?57)`rM3F{NJhWgRFCeBXp)#{n)
zr(ZO|s8pC<!qApMwj}<-Yt$aImh^vhxCj%orXN6P4tu3ebBqypE}_Jc$g<)wO7kqu
zWfV`pj}miY;F^KQY)I;dF71`4!)-u~UicD9d<u6Z>@Wvb>5*VjKl>~^^~}pV(@AIg
zU~iM=Ph&@WSneP0Q9Vp4T<DK<<SQ3+%c`klaxb6iPM%?0<T>cpV3nldty+KT(v8c&
zr5Jd2lVqUA_X%}+-t$iH@ytApw@G>Q)X5_NuRJvC7{P7Yafixp0wW$OAl;0@Cj@j9
z-Sm@Z^G;r&8XS!}zQD*-Wyi`iWF6_Z4ZRz&b$25Sh1NJEjmV;P7o4Z+9-<%<nJCEd
z?9$HO{ds@AI6rKWCNiFW!rXteNj1k9aVJzFtE#A86e`gS+`EzRV?24fl`wGO`wjFj
zeo-1%E+3<&Tvs9)B)+t1Uao>}(*k)5{KI{!i#GM^%-(M85|7<^ZSRzPFmFc^bYWG5
z=I0{Rqw)6ahzZux9yGx2Y!&uN<PFFcTq)p}g~d$?$PeXgO?SFFIa_}K@6nMEx4Dtw
zV%#wpL2jQ-z$!GMpv@(qGy<FLs242`GjwSeG|U9_hZ%8G$CfbopV`I~stc2U7W?kY
zmm6jtIuSN&Gl^vTOgEuM&tifS|LVbDk$YDU4y^HeQ{${^a?o@pUG!LToU3I9t$`V^
zIG1lqxy{}rRE^r8$5?;l0hj9#%pJHx)eqYR#q4yzPEU1Wk4Ho1+JWEyad(LqpP4Oj
zE8M<0@7efGuEa`0!Ss_VH1IW?6TC-v20a~F8n)CNpn2(txFdf)nzr}c&emwm4Px$b
z*6!^@;u%GlnzdNtVn;Ph-7-7kteXmIQxtVCt<z%fyH(ubkMDoP({&^?G`Fc*%8l6J
z=aYUwfv(#Pj|VIv_XwSb`>8E+UM{*X2_`QMy%#EOoflo}PCS_V446Hv%V25#tCEtO
znJ*>yx{IQzK))@DRsAUNqBZRAI7^QUfHu?*dmn3G-OL$hOVH`w@G(K>3#|zfZ}5h-
zI%I&D*FE#Yg06qeUq9=d7L)s(lc_6-fchX4^O;l=KMb<=aB#hs?GXEj`R(pkw$Kl>
zX6$Vp=$(j1elDTkK~t$+BQ1e_$IM?ZneQbx4mt!F81f5DQlGzAr8=@C;ANY5meb{4
zyv|*ylw={@UAs<TpcYUY1WlYZiR@n6!LZrUq-;~cwsU`L>f<^F?-lc~eR*oEn#qC`
zaQde^48iCff#*#5XYUADf&t|L+i)e)?B!Xu$TE^<+mho>7+L+k;c#0t8UHA0yp{3k
z8CcuP2DH6dn{kn4g9D0FeMN)SPNII8eZ0PWe|^_akfh&Iz&o_^=#L7xTJ|f<w-^Hz
zdX3UgGZ24=sMZbM!0hDQ9!scpHF_2qlys67DGDB9-Ww>H_8!fFHKOWcR{jagLlX=r
z^>C<6-!eFo%A_mw{k*S>8}=VU`bPr25Y28`1Vv~NX9+q7BLV|-(+@;6%={hQ`g(Z6
zcfP^*3C;a3ok%ctzspZC(D%DcT}on33i_F#trUMbTkhFw^Y*n(WezswS}TqWIBUZ8
zbH2?S#DS9-+e!4#%k$<T@QNZL&DF$~q!Zqj&&H;)N<Y9YJN^tF8U}R_PaZYUQIMxT
zOr4tIr4!nC==ix4)9U;NUuam%`_aL!<07jHybUM|aa#b)HMm1Hb~^vEbj|PmY|Za}
zvgUnw*b$TLUl?^HiV<30MbM2KeVAQ|)heC5k2Hfm)3yu)QuiA$Nf96Y1sHm8+EPFI
zPEl{)2ZZZr-y_Zv^iE6d)rJVKHbmxXL*QMAapq1%b{TI{Nv@V)n-shx^TJ*jl*4n^
bjz>iAJJ$s@;*S1UGqwFSjkEs)7Kb`TfM(Ge

delta 4262
zcmV;X5Lxf@BatGIMFBFAMpA#1Y->!~dgDxs-4}tDXj>aeR7J^&=hyE!yor=#$5H|e
zCKko-lf=upvt?RxBJ1S0npZiY{~()8NXe@GyR=C7)5W&Vv%ldz`i9UmvHBm6>(l#}
zOv=-HuSBvR(VN8&yhupJWhn}I;#U|Hbtrnai?h?8`Y5UgUXfW@iI{&&d43vFqo@G^
z%{Cn|isQZz5j$2Dsoct%)#C?r>{AjlD^|ae$F$y(x5?WRhs1(uv7!j22@VTq35@Q^
zZ*XyOTHp3%i&(PL`SWzl`ZbTJxvWQnwy7MoB7QWZo{}?Jk6*SL<t^JdOL;N=<7!ck
z#$;kMLe6X-qDNNLqELUBjIDTvAZUN5+oJ@=t7_sp6@>=FJ!&xD^&hVbS&NF)TTV6=
zXE<^jA(FF3@=DT8lP25>k_ei1&>BA1>-Y}Di|s7+lLu(1rTJhtp}vNhUPmRXSRUo<
zDXMr~rM&Yn=)x;r#PBGyr}Sf>ohm5I;}f+|kH#a1myD9M8cTnS--a*)SM$J{TErDA
z`!iwhwBzskUZ)A!i-yE3%W&Lt;%?PKWRm=Twr+|zf(e5E4!&kCU_$ETV#5nw!MvFl
zMkqDV<^A3K%SWQGX8P(U(|V30(n=;#;!-$qwBL}gi~IT4FH1ED@CoX@A32JCB^rCf
z(eKj^%mDr#R^xxY8jJ6oe1}%@9h&v9RHA{UScz3yT=-)A&=|p7fgTr?92_adMirY~
zpX9^k)gL!suF1fYX6NQ5SdobQf+b1x3h$uED3G~V`1W-U&+k2CW?t<la(8oid+sgj
zGOjpmn>yY`S(+P-J7RSso+>=m_%5Lq2vJ(pl{hQ_)NOx%=j;ABpC8f<`KF&v7HM2J
z75CnMTh}Fy>V`+MDN9j}{sLs6ih){&KB@P_IF4eG=j_PT9e7e4Q;Td#Jmz`}f;5Rr
zSio8oi#`0!*naGTG!aE2YKW*NI`|0hH8y{xWwdJ6Yd%`mA(R@ZM-wOo`0f&{HJNr5
zk-r|iPF8<(T(wQUP?lLFOBVCdVp(QX1097&ixNe(MV>kz!S3+X;JbuM0^&OR`F)hZ
zCXK`z_XyC+x-SNG$5!;|Yl=WB*3<#NZ};TW{r%$I&lm4WB0!ZD0_ZsC3fm_wHfL!8
zR&SP3WhR7AGq)H@b>ED5<M!a(>!H4)<Pr?C-XMSBdzUby`d<6)ZTCyk-X}RsE!%Kk
zyEr@a@W5ji`+{DR7Pea^x33`Tk)|i(eQu*6qucrN{=Bm`!90AJvNRRW5_p^mU$Z8w
zqfIqo%^NV);DE||L{>F=DehP{_6dNc4(k)?8Ck=^!9jb4S+P{Tndv?QR4=Yl6i599
zimiX`(o}suiAVDBzw^aU1O+wz`uojtt~W4j54#V1xt-=*G&Sfu&={j-ra@DK4$1Ve
zb>I9%YYt%Z1xZV1!Oa)vfhb1b7q(v-A2H2EiM+7az20`mEnSN@8ZzBTzS+U<E0S#d
za2Pms@Q_Z;rIcBJDxtBRN$i2bun=Uqyaj*DxP8AAXuu-@3(XAm*f&H1iUfA*NRRTY
z2FtukSw;u!9(zw4J&Escy-^kqOkTor5Q+>8S+ORMd_};&eA<KQA8%n@=s3c_LTt6W
ze1Xj%eKSFJErXor8Q<}2l5OC?0Tsr~eEWQwSO5~=EGJ)eAkO0**t0lwQ+KSw`b2*n
zPZSg#$m_D}*PP~y0+?!WKo#s?!0(UQ)L@D;3G0P|+gQ<UTH|Qhm4<c#t|8y_i>tI=
zr8U^5A`|QNXaiTnsfBmwd>x~-egrNGnslSJj6ze34#|QM%EV@a8|DP@X1dzpxi!c^
ziN8+4GmcjKnokuXih&}7lOlam?}>jaRzyitjvgw&QH8SveR1)l;SHbW{TZR57>xhd
zC+(>I*YSOw`tNzaLl3h4?>PptBe@6B`V_G^J06kJ{q#fIYl^tbSVj9{fg(IpD^QZz
z<<+e;jy~Ew$BcoadfQ;<U+#(d-Ky{}_u8IWv8qaYK{Zr__D-t}UEd{-8`yu7d*WKW
z<^8y2wWI}q9P$g?&Cn_M4$W`D%ixb56Zz-G`>u<QLTsB<lbmxDhlurw&Kwp4Y!Rr(
z)sdKAoH^naL=9-6{tP;Qa>!2|<NaBJ9;KSYU%*Qn2zgbU)4#Zlhu{SMLf?aBAezk<
zmKo4t)D;vb8V7dFe+kCi_w#@Aw0KDX0pT4wKYo;!lVu=co%HjG^cJc?X*^EcLKbTx
zndUNd)O28~YKr2hhA<uc;FQIH{ac|!tvm(WXtxu*-oQR8_tf6djN~(zfM7?=u}Ob8
z$j)jnkA<?1eR_*FAMYAwHiD~%7seV)`h1#i(V~^mb(b?QN^I9+Tt<HnoR=(1cY2CP
zFUPo~jzK+|^hxzs*_6oG??IgU68I4=6XkG}$$r4&fL71tz&<Ds$#QZ1ACjaAEIX0|
zuE}#)iaQqTm`OKXA#oK=%vTt!Ph^q+dpUI|3{;JV{yhV&W8?q5D2Fc_Q02ZjVu>2P
zAFXuM9iu2~Fl`*M4WEBv8fi2|bVzn)J!Db!sD0^RI&`vE=o)LFZTI6^F6DgqWwA>q
zu7yqQ&ixriCY!u-H5zjP#9hwr=bvx<iCyvfk%L{07O9*n;|+<jbfpvagVZJ|WVGCX
zUetH|1d!>gb{)ufj*1bNO<FvlDE>W2y1ZJ#rI+ss_-E&xaJPSW=%ph^xM^1!@2gz(
z&QV(KejTlGRTrwD9*xzvO<7LXw;Jp8t-3rE7=20fB?!C(F&EE(V`)7;@?=o@Pmtw2
zHM?oAZNgDIB9jKxfptdDT+PsF?}nJCrD`z9Y>+L<L9P9aeSMPNHXK95eh4BHF(}*z
z@F>Pc9}r0uvL$~B_99Dm3>chSXbTgl+xAmS6fASMR>5Pww!e(wxqHU_^dEwKzg^uD
z>dgHsQLNKVqhlB3mKB@EWKRa?58TLI_Oj{I6a%#8dtkq>MU~?)9R4n^lmC4_)_x({
z)Zh6^!fqss_I@w-%VmiUVU+P=TIv@F(7mKc(4+MIOnHBJ1a0j34f(db4bnBMW-~rb
zgCO;P6FW&Wj+W3QN#ejpHrwmj;%@#ey1Kl*ZA&|}>Bwu)3ZM?;H1m<ypkOG%wF&9y
zW-53gIjiDMNL05OhiIugEW-6{f_#(WsU}{iu|AQ`UuLYv)iq#qxLaQO()C`Xv9dB;
z%K@W!qN0EEO=3$iK&w8%a738$jS5k#)Mx*52D`PNW^PlwP2sl6e7gO3jp^hsq9&i9
zwM}qH;{)4wIFRe;b~D9kT^9Qet!r)FY0r|IrcgCh*}VGq41f14V&oQFWt48C>pOg;
z`x&UVbfU5bq*c}}Nmml8l*&trU{r=CsDbe*Pt$*-Tks^h8}t>_sG<F&|HNA!KgfPr
z*DIA(d8J+b+N$BlwE<=|DN>dAJtwDdTD^&os@89-63}${Zn6A>T*5Uk>QqM#R7IOS
zQoIG4D{iVO5zB5F7j2miKg7=r!nl-C9FI;4B8~#i5_p_g-Dsm4V|fv4!z08e>dR>K
zt7U(Li(sOJRs>WL^e6+llH<@#FjD|YEz*(r*(i>ale4FI+Y}En{cH4>C<YoZ^hx`c
z*N<q*!;IDSgDP-9708%`?^2Kjytc<F1_g@W%gdu*t7hWb{dE<`p!-D?$qWox{KV0#
z%P>&Ifa6B`q#eOO(F#DxZ=oK|Kt)hpXH$Rcfe`A^^p@5O*Hw2>wJS>5E^!v|r?MI_
zSIiyHLILfe`l2&*^JMD*<#0?;O~nhMf*Ri?4A$sCgg=b!c)2nx?XbqwpV*0f#7<g`
zl~cq03W%9P{4tvc(E&TB4->}0t__9tiCWX|XnDW0{5rilhTrM6{TQW~CO<LMVUT|<
ziN9nTxyK3=eF7=MBAfBSWX)kuF=>t=;^06*9I-4DkKjjVX~Cm-{Mmw-Dh8?<XiWN~
zekjYHGCBMV=+OyhL5ok}PT?Hpz%CsUZ0c4LO)n$zYKU|JkxtTV)8c6;O@r-zqDJ+@
z^01};snU0RsSdU@6;JN@QytWd#iD;GK#xoo;u_ux@{n#=dacmpdV%!P_%5L?wR+x-
zI$mX^@wUK9T?IK|@bjitkRrG(Aq}YfN1z8RCzK8;cUl1*MOaGkYz@I1R6c`Is23PR
zvJ9*tLl#KCd}^J0?&{q0UY&c#Y)N=LK6lr#hBU_zu~(J-I-Z)U%<j2p-3Nbk55K5V
zmV!S<O}VL9(o6ogr7o_6ex?P|7Wk+8Rg1R#<;)($3yFu0=e2e9AI;r?B1JHdr`9MU
z)T8m%`he-u(jGKi?razGnH5d2Cxar9@kVt}a{}-Vof2HOwrjfRatuaz*=rL_n3_~=
z^QkJ8YOA%nu_d$($Bv7_;QxQj_E8~_{iL_F*biU7-V$>WL@un3XG#9dYeJ8XhKClv
z?76qNyt3y5YwO<hIIEfhB(o`1J64$EdYM6M3hHpK)=kw_dXrE!a*KY2C?*{2K`?dT
zfT|k~nG_4rfe<~_iB0cJnQI5W{`2k<4_y-5;#Q}<bKbE@n?kZRhlYRgk#;mlHJmDV
zhwcpCbYN-NR+9kmN}+H!{d}}!=($~~(OBC++~rK~OP#l>VZc|}k(`z3Ah$x)okB2+
zy$`#%ptbKRssjvY&g7|F@h#io?~_hOs{=ayV5udf9-;H2KDTYomqH^s!IFu-jjWnm
z6Iu7VV-KbR8tV;p8!UgQe^s0-llf~29@SDb6=;K{Sl5pXk7mNIjI;FkwrvBSuw$|J
z)$N>6vH}h04Ig1D+S)4Yc#CH;<so%#Zg-Tm1znlHex0fs60CrbP5jWS^TC1fZnneY
zBj$_UuVkq&)O_38{5S*aYT$5mcXmyuc79s|dykmEUir^U>WhB^0t_Aa4W<mpUuaw&
znNGObmZ}u$C?6i)6f#xPN1ar;NnoIs&>OaPoHYp#i}cH;I$or2I@sqdOn+R1;NM`?
zr7yvZ4KP}C0Zt#(Hw1$f!Ot13&sGFmf*$1oOKQ#1?Bz9e$TCn=*OKE-7+C$js$PgD
zqo24MZ)v<f0(O7pssa6K)@CfStQW35aamfdGUCm}?9<KV_03(kq)MHf#uIb==n-Pq
z%YMQ<$0!-oYg8S?RvfI_G<e=BsM0%DKIwXNY#?X}%A8bma*8o*pvn;TXb!9qSs$~B
zPgowBphu~PLuR_B_(<`C?$GsUzAbObzZG&gRI47eTZw;3K0M+qK@hNJ7{VDJsMav^
zcW~?L;hDbk4ZcfgPIKs#=+J2nKUu0zbC|xW>@gAQ9|g%dE68e3-kQ5_gZPyhsCeQ?
z$9AOs^jy(AOguG&NOM}KB?+RG{MisAcIn0`d0^&awq(-lVai1V9ffi}`!y9~98ZNd
zPAC5E*xY}-s=!c&wkZ}jfT;!tR6_~7msLvr=oU)-@av?8V@g=x`ofTsq8Om{Wvwby
z*O|78t=H-3wXPX-!p$=DNZmi3kcjx`Kb)X0oZ8WszGu+cn-d~DYHuRW5_A$%wyHS7
zs^Z906;CWf9%c?YlFN9Ta^-I@vQ5ENFgNTu8{QgEaRqLHx*wdf(TF?s$J%@CA@sBV
I1EG*(v-p8&IsgCw

diff --git a/doc/sphinx/build/html/phk/autocrap.html b/doc/sphinx/build/html/phk/autocrap.html
index b7b7d28..6eaa709 100644
--- a/doc/sphinx/build/html/phk/autocrap.html
+++ b/doc/sphinx/build/html/phk/autocrap.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Did you call them autocrap tools ? &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Did you call them autocrap tools ? &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="Why Sphinx and reStructuredText ?" href="sphinx.html" />
     <link rel="prev" title="What were they thinking ?" href="thoughts.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="thoughts.html" title="What were they thinking ?"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -158,7 +158,7 @@ and replace it with a 5 line shellscript that calls <tt class="docutils literal"
         <li class="right" >
           <a href="thoughts.html" title="What were they thinking ?"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/phk/backends.html b/doc/sphinx/build/html/phk/backends.html
index 4a256ff..2f89d9c 100644
--- a/doc/sphinx/build/html/phk/backends.html
+++ b/doc/sphinx/build/html/phk/backends.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>What do you mean by &#39;backend&#39; ? &mdash; Varnish version 4.0.2 documentation</title>
+    <title>What do you mean by &#39;backend&#39; ? &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="Picking platforms" href="platforms.html" />
     <link rel="prev" title="IPv6 Suckage" href="ipv6suckage.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="ipv6suckage.html" title="IPv6 Suckage"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -203,7 +203,7 @@ which throws jobs into the work-pool as the backends needs polled.</p>
         <li class="right" >
           <a href="ipv6suckage.html" title="IPv6 Suckage"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/phk/barriers.html b/doc/sphinx/build/html/phk/barriers.html
index f043b6d..236f968 100644
--- a/doc/sphinx/build/html/phk/barriers.html
+++ b/doc/sphinx/build/html/phk/barriers.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Security barriers in Varnish &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Security barriers in Varnish &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="What were they thinking ?" href="thoughts.html" />
     <link rel="prev" title="Picking platforms" href="platforms.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="platforms.html" title="Picking platforms"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -211,7 +211,7 @@ process like all other server programs.</p>
         <li class="right" >
           <a href="platforms.html" title="Picking platforms"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/phk/dough.html b/doc/sphinx/build/html/phk/dough.html
index 8cd0ca6..97c9e69 100644
--- a/doc/sphinx/build/html/phk/dough.html
+++ b/doc/sphinx/build/html/phk/dough.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Raking in the dough on Free and Open Source Software &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Raking in the dough on Free and Open Source Software &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="Wanton destruction for the greater good" href="wanton_destruction.html" />
     <link rel="prev" title="A persistent message" href="persistent.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="persistent.html" title="A persistent message"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -84,7 +84,7 @@ or suitability for the task at hand.</p>
 <p>But in 2004 crowd-funding was not yet &quot;in&quot;, and I had to figure
 out how to do it myself.</p>
 <p>My parents brought me up to think that finances is a private matter
-but I concluded that the only way you could ask strangers to trow
+but I concluded that the only way you could ask strangers to throw
 money at you, would be to run an open book, where they could see
 what happened to them, so I did open books.</p>
 <p>My next dilemma was about my rate, again I had always perceived my
@@ -308,7 +308,7 @@ of software which does serious work for serious companies.</p>
         <li class="right" >
           <a href="persistent.html" title="A persistent message"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/phk/gzip.html b/doc/sphinx/build/html/phk/gzip.html
index 107396b..87c8b0e 100644
--- a/doc/sphinx/build/html/phk/gzip.html
+++ b/doc/sphinx/build/html/phk/gzip.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>How GZIP, and GZIP+ESI works in Varnish &mdash; Varnish version 4.0.2 documentation</title>
+    <title>How GZIP, and GZIP+ESI works in Varnish &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="VCL Expressions" href="vcl_expr.html" />
     <link rel="prev" title="Why no SSL ?" href="ssl.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="ssl.html" title="Why no SSL ?"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -242,7 +242,7 @@ by making varnish do it.</p>
         <li class="right" >
           <a href="ssl.html" title="Why no SSL ?"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/phk/http20.html b/doc/sphinx/build/html/phk/http20.html
index cb1de3b..9bf05d8 100644
--- a/doc/sphinx/build/html/phk/http20.html
+++ b/doc/sphinx/build/html/phk/http20.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Why HTTP/2.0 does not seem interesting &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Why HTTP/2.0 does not seem interesting &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="Varnish Does Not Hash" href="varnish_does_not_hash.html" />
     <link rel="prev" title="What SPDY did to my summer vacation" href="spdy.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="spdy.html" title="What SPDY did to my summer vacation"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -351,7 +351,7 @@ people will start to use, the Varnish project will be interested.</p>
         <li class="right" >
           <a href="spdy.html" title="What SPDY did to my summer vacation"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/phk/index.html b/doc/sphinx/build/html/phk/index.html
index 1dbd0fc..6d380ef 100644
--- a/doc/sphinx/build/html/phk/index.html
+++ b/doc/sphinx/build/html/phk/index.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Poul-Hennings random outbursts &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Poul-Hennings random outbursts &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="next" title="A persistent message" href="persistent.html" />
     <link rel="prev" title="Upgrading to Varnish 4" href="../whats-new/upgrading.html" /> 
   </head>
@@ -42,7 +42,7 @@
         <li class="right" >
           <a href="../whats-new/upgrading.html" title="Upgrading to Varnish 4"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>  
 
@@ -124,7 +124,7 @@
         <li class="right" >
           <a href="../whats-new/upgrading.html" title="Upgrading to Varnish 4"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>
     <div class="footer">
diff --git a/doc/sphinx/build/html/phk/ipv6suckage.html b/doc/sphinx/build/html/phk/ipv6suckage.html
index 9fa05b1..2e1344d 100644
--- a/doc/sphinx/build/html/phk/ipv6suckage.html
+++ b/doc/sphinx/build/html/phk/ipv6suckage.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>IPv6 Suckage &mdash; Varnish version 4.0.2 documentation</title>
+    <title>IPv6 Suckage &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="What do you mean by &#39;backend&#39; ?" href="backends.html" />
     <link rel="prev" title="VCL Expressions" href="vcl_expr.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vcl_expr.html" title="VCL Expressions"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -150,7 +150,7 @@ now you know why.</p>
         <li class="right" >
           <a href="vcl_expr.html" title="VCL Expressions"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/phk/persistent.html b/doc/sphinx/build/html/phk/persistent.html
index 28ee8ed..0b65a3b 100644
--- a/doc/sphinx/build/html/phk/persistent.html
+++ b/doc/sphinx/build/html/phk/persistent.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>A persistent message &mdash; Varnish version 4.0.2 documentation</title>
+    <title>A persistent message &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="Raking in the dough on Free and Open Source Software" href="dough.html" />
     <link rel="prev" title="Poul-Hennings random outbursts" href="index.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="index.html" title="Poul-Hennings random outbursts"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -82,7 +82,7 @@ all the banned objects.</p>
 <p>With persistent storage, we not only have to store the still live
 bans with the cached objects, and keep the two painfully in sync,
 so the bans gets revived with the objects, we also have to worry
-about missing bans duing the downtime, since those might ban objects
+about missing bans during the downtime, since those might ban objects
 we will recover on startup.</p>
 <p>Ouch:  Straight into database/filesystem consistency territory.</p>
 <p>But we knew that, and I thought I had a good strategy to deal with
@@ -180,7 +180,7 @@ and if you know what you're doing, by using:</p>
         <li class="right" >
           <a href="index.html" title="Poul-Hennings random outbursts"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/phk/platforms.html b/doc/sphinx/build/html/phk/platforms.html
index 0c5a446..b23c627 100644
--- a/doc/sphinx/build/html/phk/platforms.html
+++ b/doc/sphinx/build/html/phk/platforms.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Picking platforms &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Picking platforms &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="Security barriers in Varnish" href="barriers.html" />
     <link rel="prev" title="What do you mean by &#39;backend&#39; ?" href="backends.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="backends.html" title="What do you mean by &#39;backend&#39; ?"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -189,7 +189,7 @@ Edited Nils, 2014-03-18 with Poul-Hennings concent</p>
         <li class="right" >
           <a href="backends.html" title="What do you mean by &#39;backend&#39; ?"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/phk/spdy.html b/doc/sphinx/build/html/phk/spdy.html
index b53fbc8..1303ab0 100644
--- a/doc/sphinx/build/html/phk/spdy.html
+++ b/doc/sphinx/build/html/phk/spdy.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>What SPDY did to my summer vacation &mdash; Varnish version 4.0.2 documentation</title>
+    <title>What SPDY did to my summer vacation &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="Why HTTP/2.0 does not seem interesting" href="http20.html" />
     <link rel="prev" title="Wanton destruction for the greater good" href="wanton_destruction.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="wanton_destruction.html" title="Wanton destruction for the greater good"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -233,7 +233,7 @@ to talk more about this.</p>
         <li class="right" >
           <a href="wanton_destruction.html" title="Wanton destruction for the greater good"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/phk/sphinx.html b/doc/sphinx/build/html/phk/sphinx.html
index 9addcf0..c1f6559 100644
--- a/doc/sphinx/build/html/phk/sphinx.html
+++ b/doc/sphinx/build/html/phk/sphinx.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Why Sphinx and reStructuredText ? &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Why Sphinx and reStructuredText ? &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="Varnish Glossary" href="../glossary/index.html" />
     <link rel="prev" title="Did you call them autocrap tools ?" href="autocrap.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="autocrap.html" title="Did you call them autocrap tools ?"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -159,7 +159,7 @@ from Tcl to Python in that case.</p>
         <li class="right" >
           <a href="autocrap.html" title="Did you call them autocrap tools ?"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/phk/ssl.html b/doc/sphinx/build/html/phk/ssl.html
index 9ea987b..0ec4e4d 100644
--- a/doc/sphinx/build/html/phk/ssl.html
+++ b/doc/sphinx/build/html/phk/ssl.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Why no SSL ? &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Why no SSL ? &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="How GZIP, and GZIP+ESI works in Varnish" href="gzip.html" />
     <link rel="prev" title="Thoughts on the eve of Varnish 3.0" href="three-zero.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="three-zero.html" title="Thoughts on the eve of Varnish 3.0"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -154,7 +154,7 @@ and effort to even think about it..</p>
         <li class="right" >
           <a href="three-zero.html" title="Thoughts on the eve of Varnish 3.0"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/phk/thetoolsweworkwith.html b/doc/sphinx/build/html/phk/thetoolsweworkwith.html
index c29ce1d..cb811f4 100644
--- a/doc/sphinx/build/html/phk/thetoolsweworkwith.html
+++ b/doc/sphinx/build/html/phk/thetoolsweworkwith.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>The Tools We Work With &mdash; Varnish version 4.0.2 documentation</title>
+    <title>The Tools We Work With &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="Thoughts on the eve of Varnish 3.0" href="three-zero.html" />
     <link rel="prev" title="Varnish Does Not Hash" href="varnish_does_not_hash.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="varnish_does_not_hash.html" title="Varnish Does Not Hash"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -264,7 +264,7 @@ program through well-thought-out examples.</p>
         <li class="right" >
           <a href="varnish_does_not_hash.html" title="Varnish Does Not Hash"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/phk/thoughts.html b/doc/sphinx/build/html/phk/thoughts.html
index e6e7bc2..ab98e2b 100644
--- a/doc/sphinx/build/html/phk/thoughts.html
+++ b/doc/sphinx/build/html/phk/thoughts.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>What were they thinking ? &mdash; Varnish version 4.0.2 documentation</title>
+    <title>What were they thinking ? &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="Did you call them autocrap tools ?" href="autocrap.html" />
     <link rel="prev" title="Security barriers in Varnish" href="barriers.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="barriers.html" title="Security barriers in Varnish"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -126,7 +126,7 @@ possibly from the moon, if you bring your binoculars.</p>
         <li class="right" >
           <a href="barriers.html" title="Security barriers in Varnish"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/phk/three-zero.html b/doc/sphinx/build/html/phk/three-zero.html
index eeaaf94..5c6feab 100644
--- a/doc/sphinx/build/html/phk/three-zero.html
+++ b/doc/sphinx/build/html/phk/three-zero.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Thoughts on the eve of Varnish 3.0 &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Thoughts on the eve of Varnish 3.0 &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="Why no SSL ?" href="ssl.html" />
     <link rel="prev" title="The Tools We Work With" href="thetoolsweworkwith.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="thetoolsweworkwith.html" title="The Tools We Work With"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -150,7 +150,7 @@ for these past five years.</p>
         <li class="right" >
           <a href="thetoolsweworkwith.html" title="The Tools We Work With"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/phk/varnish_does_not_hash.html b/doc/sphinx/build/html/phk/varnish_does_not_hash.html
index 0271938..1d06001 100644
--- a/doc/sphinx/build/html/phk/varnish_does_not_hash.html
+++ b/doc/sphinx/build/html/phk/varnish_does_not_hash.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Varnish Does Not Hash &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Varnish Does Not Hash &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="The Tools We Work With" href="thetoolsweworkwith.html" />
     <link rel="prev" title="Why HTTP/2.0 does not seem interesting" href="http20.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="http20.html" title="Why HTTP/2.0 does not seem interesting"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -222,7 +222,7 @@ be the first person to find a SHA256 collision.</p>
         <li class="right" >
           <a href="http20.html" title="Why HTTP/2.0 does not seem interesting"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/phk/vcl_expr.html b/doc/sphinx/build/html/phk/vcl_expr.html
index d31b3e2..412815f 100644
--- a/doc/sphinx/build/html/phk/vcl_expr.html
+++ b/doc/sphinx/build/html/phk/vcl_expr.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>VCL Expressions &mdash; Varnish version 4.0.2 documentation</title>
+    <title>VCL Expressions &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="IPv6 Suckage" href="ipv6suckage.html" />
     <link rel="prev" title="How GZIP, and GZIP+ESI works in Varnish" href="gzip.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="gzip.html" title="How GZIP, and GZIP+ESI works in Varnish"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -160,7 +160,7 @@ lowest precedence:</p>
         <li class="right" >
           <a href="gzip.html" title="How GZIP, and GZIP+ESI works in Varnish"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/phk/wanton_destruction.html b/doc/sphinx/build/html/phk/wanton_destruction.html
index 931ef99..07e51c1 100644
--- a/doc/sphinx/build/html/phk/wanton_destruction.html
+++ b/doc/sphinx/build/html/phk/wanton_destruction.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Wanton destruction for the greater good &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Wanton destruction for the greater good &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Poul-Hennings random outbursts" href="index.html" />
     <link rel="next" title="What SPDY did to my summer vacation" href="spdy.html" />
     <link rel="prev" title="Raking in the dough on Free and Open Source Software" href="dough.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="dough.html" title="Raking in the dough on Free and Open Source Software"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>  
@@ -158,7 +158,7 @@ in the future.</p>
         <li class="right" >
           <a href="dough.html" title="Raking in the dough on Free and Open Source Software"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >Poul-Hennings random outbursts</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/reference/index.html b/doc/sphinx/build/html/reference/index.html
index 1abd8bc..23c5f72 100644
--- a/doc/sphinx/build/html/reference/index.html
+++ b/doc/sphinx/build/html/reference/index.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>The Varnish Reference Manual &mdash; Varnish version 4.0.2 documentation</title>
+    <title>The Varnish Reference Manual &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="next" title="VCL" href="vcl.html" />
     <link rel="prev" title="Troubleshooting Varnish" href="../users-guide/troubleshooting.html" /> 
   </head>
@@ -42,7 +42,7 @@
         <li class="right" >
           <a href="../users-guide/troubleshooting.html" title="Troubleshooting Varnish"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>  
 
@@ -87,10 +87,6 @@
 <li class="toctree-l2"><a class="reference internal" href="varnishreplay.html#http-traffic-replay-tool">HTTP traffic replay tool</a></li>
 </ul>
 </li>
-<li class="toctree-l1"><a class="reference internal" href="varnishsizes.html">varnishsizes</a><ul>
-<li class="toctree-l2"><a class="reference internal" href="varnishsizes.html#varnish-object-size-request-histogram">Varnish object size request histogram</a></li>
-</ul>
-</li>
 <li class="toctree-l1"><a class="reference internal" href="varnishstat.html">varnishstat</a><ul>
 <li class="toctree-l2"><a class="reference internal" href="varnishstat.html#varnish-cache-statistics">Varnish Cache statistics</a></li>
 </ul>
@@ -188,7 +184,7 @@
         <li class="right" >
           <a href="../users-guide/troubleshooting.html" title="Troubleshooting Varnish"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>
     <div class="footer">
diff --git a/doc/sphinx/build/html/reference/varnish-cli.html b/doc/sphinx/build/html/reference/varnish-cli.html
index 4654c82..1539662 100644
--- a/doc/sphinx/build/html/reference/varnish-cli.html
+++ b/doc/sphinx/build/html/reference/varnish-cli.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Varnish CLI &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Varnish CLI &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Reference Manual" href="index.html" />
     <link rel="next" title="varnishadm" href="varnishadm.html" />
     <link rel="prev" title="VCL" href="vcl.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vcl.html" title="VCL"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>  
@@ -148,16 +148,24 @@ be entered with the \xnn syntax.</p>
 <dd>Clear the last panic, if any.</dd>
 <dt>storage.list</dt>
 <dd>List storage devices</dd>
-<dt>backend.list</dt>
-<dd>List all backends</dd>
-<dt>backend.set_health matcher state</dt>
-<dd>Set health status on a backend</dd>
+<dt>backend.list [&lt;backend_expression&gt;]</dt>
+<dd>List backends.</dd>
+<dt>backend.set_health &lt;backend_expression&gt; &lt;state&gt;</dt>
+<dd>Set health status on the backends.
+State is any of auto, healthy or sick values.</dd>
 <dt>ban &lt;field&gt; &lt;operator&gt; &lt;arg&gt; [&amp;&amp; &lt;field&gt; &lt;oper&gt; &lt;arg&gt;]...</dt>
 <dd>All objects where the all the conditions match will be marked obsolete.</dd>
 <dt>ban.list</dt>
 <dd>List the active bans.</dd>
 </dl>
 </div>
+<div class="section" id="backend-expression">
+<h4>Backend Expression<a class="headerlink" href="#backend-expression" title="Permalink to this headline">¶</a></h4>
+<p>A backend expression can be a backend name or a combination of backend
+name, IP address and port in &quot;name(IP address:port)&quot; format. All fields
+are optional. If no exact matching backend is found, partial matching
+will be attempted based on the provided name, IP address and port fields.</p>
+</div>
 <div class="section" id="ban-expressions">
 <h4>Ban Expressions<a class="headerlink" href="#ban-expressions" title="Permalink to this headline">¶</a></h4>
 <p>A ban expression consists of one or more conditions.  A condition
@@ -301,6 +309,7 @@ itself. See LICENCE for details.</p>
 <li><a class="reference internal" href="#description">DESCRIPTION</a><ul>
 <li><a class="reference internal" href="#syntax">Syntax</a></li>
 <li><a class="reference internal" href="#commands">Commands</a></li>
+<li><a class="reference internal" href="#backend-expression">Backend Expression</a></li>
 <li><a class="reference internal" href="#ban-expressions">Ban Expressions</a></li>
 <li><a class="reference internal" href="#scripting">Scripting</a></li>
 <li><a class="reference internal" href="#how-s-psk-authentication-works">How -S/PSK Authentication Works</a></li>
@@ -356,7 +365,7 @@ itself. See LICENCE for details.</p>
         <li class="right" >
           <a href="vcl.html" title="VCL"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/reference/varnishadm.html b/doc/sphinx/build/html/reference/varnishadm.html
index d80bd72..23055e5 100644
--- a/doc/sphinx/build/html/reference/varnishadm.html
+++ b/doc/sphinx/build/html/reference/varnishadm.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>varnishadm &mdash; Varnish version 4.0.2 documentation</title>
+    <title>varnishadm &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Reference Manual" href="index.html" />
     <link rel="next" title="varnishd" href="varnishd.html" />
     <link rel="prev" title="Varnish CLI" href="varnish-cli.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="varnish-cli.html" title="Varnish CLI"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>  
@@ -204,7 +204,7 @@ itself. See LICENCE for details.</p>
         <li class="right" >
           <a href="varnish-cli.html" title="Varnish CLI"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/reference/varnishd.html b/doc/sphinx/build/html/reference/varnishd.html
index 3ce6ffd..9e0193a 100644
--- a/doc/sphinx/build/html/reference/varnishd.html
+++ b/doc/sphinx/build/html/reference/varnishd.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>varnishd &mdash; Varnish version 4.0.2 documentation</title>
+    <title>varnishd &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Reference Manual" href="index.html" />
     <link rel="next" title="varnishhist" href="varnishhist.html" />
     <link rel="prev" title="varnishadm" href="varnishadm.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="varnishadm.html" title="varnishadm"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>  
@@ -330,13 +330,13 @@ here, in order to conserve VM space.</p>
 </ul>
 </div></blockquote>
 <p>If we run out of resources, such as file descriptors or worker threads, the acceptor will sleep between accepts.
-This parameter (multiplicatively) reduce the sleep duration for each succesfull accept. (ie: 0.9 = reduce by 10%)</p>
+This parameter (multiplicatively) reduce the sleep duration for each successful accept. (ie: 0.9 = reduce by 10%)</p>
 </div>
 <div class="section" id="acceptor-sleep-incr">
 <span id="ref-param-acceptor-sleep-incr"></span><h5>acceptor_sleep_incr<a class="headerlink" href="#acceptor-sleep-incr" title="Permalink to this headline">¶</a></h5>
 <blockquote>
 <div><ul class="simple">
-<li>Units: s</li>
+<li>Units: seconds</li>
 <li>Default: 0.001</li>
 <li>Minimum: 0.000</li>
 <li>Maximum: 1.000</li>
@@ -350,7 +350,7 @@ This parameter control how much longer we sleep, each time we fail to accept a n
 <span id="ref-param-acceptor-sleep-max"></span><h5>acceptor_sleep_max<a class="headerlink" href="#acceptor-sleep-max" title="Permalink to this headline">¶</a></h5>
 <blockquote>
 <div><ul class="simple">
-<li>Units: s</li>
+<li>Units: seconds</li>
 <li>Default: 0.050</li>
 <li>Minimum: 0.000</li>
 <li>Maximum: 10.000</li>
@@ -378,13 +378,13 @@ This parameter limits how long it can sleep between attempts to accept new conne
 <li>Default: on</li>
 </ul>
 </div></blockquote>
-<p>Elimited older identical bans when new bans are created.  This test is CPU intensive and scales with the number and complexity of active (non-Gone) bans.  If identical bans are frequent, the amount of CPU needed to actually test  the bans will be similarly reduced.</p>
+<p>Eliminate older identical bans when new bans are created.  This test is CPU intensive and scales with the number and complexity of active (non-Gone) bans.  If identical bans are frequent, the amount of CPU needed to actually test  the bans will be similarly reduced.</p>
 </div>
 <div class="section" id="ban-lurker-age">
 <span id="ref-param-ban-lurker-age"></span><h5>ban_lurker_age<a class="headerlink" href="#ban-lurker-age" title="Permalink to this headline">¶</a></h5>
 <blockquote>
 <div><ul class="simple">
-<li>Units: s</li>
+<li>Units: seconds</li>
 <li>Default: 60.000</li>
 <li>Minimum: 0.000</li>
 </ul>
@@ -405,7 +405,7 @@ This parameter limits how long it can sleep between attempts to accept new conne
 <span id="ref-param-ban-lurker-sleep"></span><h5>ban_lurker_sleep<a class="headerlink" href="#ban-lurker-sleep" title="Permalink to this headline">¶</a></h5>
 <blockquote>
 <div><ul class="simple">
-<li>Units: s</li>
+<li>Units: seconds</li>
 <li>Default: 0.010</li>
 <li>Minimum: 0.000</li>
 </ul>
@@ -417,7 +417,7 @@ A value of zero disables the ban lurker.</p>
 <span id="ref-param-between-bytes-timeout"></span><h5>between_bytes_timeout<a class="headerlink" href="#between-bytes-timeout" title="Permalink to this headline">¶</a></h5>
 <blockquote>
 <div><ul class="simple">
-<li>Units: s</li>
+<li>Units: seconds</li>
 <li>Default: 60.000</li>
 <li>Minimum: 0.000</li>
 </ul>
@@ -467,7 +467,7 @@ NB: Must be specified with -p to have effect.</p>
 <li>Maximum: 99999999b</li>
 </ul>
 </div></blockquote>
-<p>Maximum size of CLI response.  If the response exceeds this limit, the reponse code will be 201 instead of 200 and the last line will indicate the truncation.</p>
+<p>Maximum size of CLI response.  If the response exceeds this limit, the response code will be 201 instead of 200 and the last line will indicate the truncation.</p>
 </div>
 <div class="section" id="cli-timeout">
 <span id="ref-param-cli-timeout"></span><h5>cli_timeout<a class="headerlink" href="#cli-timeout" title="Permalink to this headline">¶</a></h5>
@@ -484,7 +484,7 @@ NB: Must be specified with -p to have effect.</p>
 <span id="ref-param-clock-skew"></span><h5>clock_skew<a class="headerlink" href="#clock-skew" title="Permalink to this headline">¶</a></h5>
 <blockquote>
 <div><ul class="simple">
-<li>Units: s</li>
+<li>Units: seconds</li>
 <li>Default: 10</li>
 <li>Minimum: 0</li>
 </ul>
@@ -495,7 +495,7 @@ NB: Must be specified with -p to have effect.</p>
 <span id="ref-param-connect-timeout"></span><h5>connect_timeout<a class="headerlink" href="#connect-timeout" title="Permalink to this headline">¶</a></h5>
 <blockquote>
 <div><ul class="simple">
-<li>Units: s</li>
+<li>Units: seconds</li>
 <li>Default: 3.500</li>
 <li>Minimum: 0.000</li>
 </ul>
@@ -506,14 +506,14 @@ NB: Must be specified with -p to have effect.</p>
 <span id="ref-param-critbit-cooloff"></span><h5>critbit_cooloff<a class="headerlink" href="#critbit-cooloff" title="Permalink to this headline">¶</a></h5>
 <blockquote>
 <div><ul class="simple">
-<li>Units: s</li>
+<li>Units: seconds</li>
 <li>Default: 180.000</li>
 <li>Minimum: 60.000</li>
 <li>Maximum: 254.000</li>
 <li>Flags: wizard</li>
 </ul>
 </div></blockquote>
-<p>How long time the critbit hasher keeps deleted objheads on the cooloff list.</p>
+<p>How long the critbit hasher keeps deleted objheads on the cooloff list.</p>
 </div>
 <div class="section" id="debug">
 <span id="ref-param-debug"></span><h5>debug<a class="headerlink" href="#debug" title="Permalink to this headline">¶</a></h5>
@@ -550,6 +550,8 @@ NB: Must be specified with -p to have effect.</p>
 <dd>VSL Ban lurker</dd>
 <dt><em>esi_chop</em></dt>
 <dd>Chop ESI fetch to bits</dd>
+<dt><em>flush_head</em></dt>
+<dd>Flush after http1 head</dd>
 </dl>
 </div></blockquote>
 </div>
@@ -628,7 +630,7 @@ NB: Must be specified with -p to have effect.</p>
 <blockquote>
 <div><ul class="simple">
 <li>Units: bytes</li>
-<li>Default: 128k</li>
+<li>Default: 16k</li>
 <li>Minimum: 4k</li>
 <li>Flags: experimental</li>
 </ul>
@@ -652,7 +654,7 @@ Internal limits in the storage_file module makes increases above 128kb a dubious
 <span id="ref-param-first-byte-timeout"></span><h5>first_byte_timeout<a class="headerlink" href="#first-byte-timeout" title="Permalink to this headline">¶</a></h5>
 <blockquote>
 <div><ul class="simple">
-<li>Units: s</li>
+<li>Units: seconds</li>
 <li>Default: 60.000</li>
 <li>Minimum: 0.000</li>
 </ul>
@@ -796,7 +798,7 @@ The memory for the request is allocated from the client workspace (param: worksp
 <li>Minimum: 0.25k</li>
 </ul>
 </div></blockquote>
-<p>Maximum number of bytes of HTTP backend resonse we will deal with.  This is a limit on all bytes up to the double blank line which ends the HTTP request.
+<p>Maximum number of bytes of HTTP backend response we will deal with.  This is a limit on all bytes up to the double blank line which ends the HTTP request.
 The memory for the request is allocated from the worker workspace (param: thread_pool_workspace) and this parameter limits how much of that the request is allowed to take up.</p>
 </div>
 <div class="section" id="ref-param-idle-send-timeout">
@@ -1084,7 +1086,7 @@ This is mostly an anti-DoS measure, and setting it plenty high should not hurt,
 <span id="ref-param-shortlived"></span><h5>shortlived<a class="headerlink" href="#shortlived" title="Permalink to this headline">¶</a></h5>
 <blockquote>
 <div><ul class="simple">
-<li>Units: s</li>
+<li>Units: seconds</li>
 <li>Default: 10.000</li>
 <li>Minimum: 0.000</li>
 </ul>
@@ -1178,7 +1180,7 @@ Set this to a few milliseconds if you see the 'threads_failed' counter grow too
 </div></blockquote>
 <p>Wait this long after destroying a thread.</p>
 <p>This controls the decay of thread pools when idle(-ish).</p>
-<p>Minimum is 0.01 second.</p>
+<p>Minimum is 0.01 seconds.</p>
 </div>
 <div class="section" id="thread-pool-fail-delay">
 <span id="ref-param-thread-pool-fail-delay"></span><h5>thread_pool_fail_delay<a class="headerlink" href="#thread-pool-fail-delay" title="Permalink to this headline">¶</a></h5>
@@ -1312,7 +1314,7 @@ A connection is considered idle, until we receive a non-white-space character on
 <li>Flags: experimental</li>
 </ul>
 </div></blockquote>
-<p>How long time the workerthread lingers on an idle session before handing it over to the waiter.
+<p>How long the worker thread lingers on an idle session before handing it over to the waiter.
 When sessions are reused, as much as half of all reuses happen within the first 100 msec of the previous request completing.
 Setting this too high results in worker threads not doing anything for their keep, setting it too low just means that more sessions take a detour around the waiter.</p>
 </div>
@@ -1325,7 +1327,7 @@ Setting this too high results in worker threads not doing anything for their kee
 <li>Minimum: 0.000</li>
 </ul>
 </div></blockquote>
-<p>Max time to receive clients request header, measured from first non-white-space character to double CRNL.</p>
+<p>Max time to receive clients request headers, measured from first non-white-space character to double CRNL.</p>
 </div>
 <div class="section" id="user">
 <span id="ref-param-user"></span><h5>user<a class="headerlink" href="#user" title="Permalink to this headline">¶</a></h5>
@@ -1509,7 +1511,7 @@ Setting this too high costs memory, setting it too low will cause more VSL flush
 <li>Flags: delayed</li>
 </ul>
 </div></blockquote>
-<p>Bytes of auxillary workspace per thread.
+<p>Bytes of auxiliary workspace per thread.
 This workspace is used for certain temporary data structures during the operation of a worker thread.
 One use is for the io-vectors for writing requests and responses to sockets, having too little space will result in more writev(2) system calls, having too much just wastes the space.</p>
 </div>
@@ -1732,7 +1734,7 @@ itself. See LICENCE for details.</p>
         <li class="right" >
           <a href="varnishadm.html" title="varnishadm"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/reference/varnishhist.html b/doc/sphinx/build/html/reference/varnishhist.html
index a8d9cb2..d6281f9 100644
--- a/doc/sphinx/build/html/reference/varnishhist.html
+++ b/doc/sphinx/build/html/reference/varnishhist.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>varnishhist &mdash; Varnish version 4.0.2 documentation</title>
+    <title>varnishhist &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Reference Manual" href="index.html" />
     <link rel="next" title="varnishlog" href="varnishlog.html" />
     <link rel="prev" title="varnishd" href="varnishd.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="varnishd.html" title="varnishd"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>  
@@ -102,7 +102,7 @@ and misses are marked with a hash character (&quot;#&quot;).</p>
 <tr><td class="option-group" colspan="2">
 <kbd><span class="option">-P <var>&lt;size|responsetime|tag:field_num:min:max&gt;</var></span></kbd></td>
 </tr>
-<tr><td>&nbsp;</td><td>Either specify &quot;size&quot; or &quot;responstime&quot; profile or create a new one. Define the tag we'll look for, and the field number of the value we are interested in. min and max are the boundaries of the graph (these are power of tens).</td></tr>
+<tr><td>&nbsp;</td><td>Either specify &quot;size&quot; or &quot;responsetime&quot; profile or create a new one. Define the tag we'll look for, and the field number of the value we are interested in. min and max are the boundaries of the graph (these are power of tens).</td></tr>
 <tr><td class="option-group">
 <kbd><span class="option">-q <var>query</var></span></kbd></td>
 <td>Specifies the VSL query to use.</td></tr>
@@ -207,7 +207,7 @@ itself. See LICENCE for details.</p>
         <li class="right" >
           <a href="varnishd.html" title="varnishd"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/reference/varnishlog.html b/doc/sphinx/build/html/reference/varnishlog.html
index 939912d..a3fb698 100644
--- a/doc/sphinx/build/html/reference/varnishlog.html
+++ b/doc/sphinx/build/html/reference/varnishlog.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>varnishlog &mdash; Varnish version 4.0.2 documentation</title>
+    <title>varnishlog &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Reference Manual" href="index.html" />
     <link rel="next" title="varnishncsa" href="varnishncsa.html" />
     <link rel="prev" title="varnishhist" href="varnishhist.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="varnishhist.html" title="varnishhist"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>  
@@ -59,7 +59,7 @@
 <h2>Display Varnish logs<a class="headerlink" href="#display-varnish-logs" title="Permalink to this headline">¶</a></h2>
 <div class="section" id="synopsis">
 <h3>SYNOPSIS<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h3>
-<p>varnishlog [-a] [-b] [-B] [-c] [-C] [-d] [-D] [-g &lt;session|request|vxid|raw&gt;] [-h] [-i taglist] [-k num] [-I &lt;[taglist:]regex&gt;] [-L limit] [-n name] [-N filename] [-P file] [-q query] [-r filename] [-T seconds] [-v] [-V] [-w filename] [-x taglist] [-X &lt;[taglist:]regex&gt;] &lt;query expression&gt;</p>
+<p>varnishlog [-a] [-b] [-B] [-c] [-C] [-d] [-D] [-g &lt;session|request|vxid|raw&gt;] [-h] [-i taglist] [-I &lt;[taglist:]regex&gt;] [-k num] [-L limit] [-n name] [-N filename] [-P file] [-q query] [-r filename] [-T seconds] [-v] [-V] [-w filename] [-x taglist] [-X &lt;[taglist:]regex&gt;]</p>
 </div>
 <div class="section" id="options">
 <h3>OPTIONS<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h3>
@@ -101,9 +101,6 @@
 <td><p class="first">Include log records of these tags in output. Taglist is a comma-separated list of tag globs. Multiple -i options may be given.</p>
 <p class="last">If a tag include option is the first of any tag selection options, all tags are first marked excluded.</p>
 </td></tr>
-<tr><td class="option-group">
-<kbd><span class="option">-k <var>num</var></span></kbd></td>
-<td>Process this number of matching log transactions before exiting.</td></tr>
 <tr><td class="option-group" colspan="2">
 <kbd><span class="option">-I <var>&lt;[taglist:]regex&gt;</var></span></kbd></td>
 </tr>
@@ -111,6 +108,9 @@
 <p class="last">If a tag include option is the first of any tag selection options, all tags are first marked excluded.</p>
 </td></tr>
 <tr><td class="option-group">
+<kbd><span class="option">-k <var>num</var></span></kbd></td>
+<td>Process this number of matching log transactions before exiting.</td></tr>
+<tr><td class="option-group">
 <kbd><span class="option">-L <var>limit</var></span></kbd></td>
 <td>Sets the upper limit of incomplete transactions kept before the oldest transaction is force completed. A warning record is synthesized when this happens. This setting keeps an upper bound on the memory usage of running queries. Defaults to 1000 transactions.</td></tr>
 <tr><td class="option-group">
@@ -254,7 +254,7 @@ itself. See LICENCE for details.</p>
         <li class="right" >
           <a href="varnishhist.html" title="varnishhist"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/reference/varnishncsa.html b/doc/sphinx/build/html/reference/varnishncsa.html
index 0c59231..d6a9737 100644
--- a/doc/sphinx/build/html/reference/varnishncsa.html
+++ b/doc/sphinx/build/html/reference/varnishncsa.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>varnishncsa &mdash; Varnish version 4.0.2 documentation</title>
+    <title>varnishncsa &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Reference Manual" href="index.html" />
     <link rel="next" title="varnishreplay" href="varnishreplay.html" />
     <link rel="prev" title="varnishlog" href="varnishlog.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="varnishlog.html" title="varnishlog"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>  
@@ -283,7 +283,7 @@ itself. See LICENCE for details.</p>
         <li class="right" >
           <a href="varnishlog.html" title="varnishlog"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/reference/varnishreplay.html b/doc/sphinx/build/html/reference/varnishreplay.html
index 1c217dc..9baf76c 100644
--- a/doc/sphinx/build/html/reference/varnishreplay.html
+++ b/doc/sphinx/build/html/reference/varnishreplay.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>varnishreplay &mdash; Varnish version 4.0.2 documentation</title>
+    <title>varnishreplay &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,9 +25,9 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Reference Manual" href="index.html" />
-    <link rel="next" title="varnishsizes" href="varnishsizes.html" />
+    <link rel="next" title="varnishstat" href="varnishstat.html" />
     <link rel="prev" title="varnishncsa" href="varnishncsa.html" /> 
   </head>
   <body>
@@ -38,12 +38,12 @@
           <a href="../genindex.html" title="General Index"
              accesskey="I">index</a></li>
         <li class="right" >
-          <a href="varnishsizes.html" title="varnishsizes"
+          <a href="varnishstat.html" title="varnishstat"
              accesskey="N">next</a> |</li>
         <li class="right" >
           <a href="varnishncsa.html" title="varnishncsa"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>  
@@ -135,8 +135,8 @@ itself. See LICENCE for details.</p>
   <p class="topless"><a href="varnishncsa.html"
                         title="previous chapter">varnishncsa</a></p>
   <h4>Next topic</h4>
-  <p class="topless"><a href="varnishsizes.html"
-                        title="next chapter">varnishsizes</a></p>
+  <p class="topless"><a href="varnishstat.html"
+                        title="next chapter">varnishstat</a></p>
   <h3>This Page</h3>
   <ul class="this-page-menu">
     <li><a href="../_sources/reference/varnishreplay.txt"
@@ -166,12 +166,12 @@ itself. See LICENCE for details.</p>
           <a href="../genindex.html" title="General Index"
              >index</a></li>
         <li class="right" >
-          <a href="varnishsizes.html" title="varnishsizes"
+          <a href="varnishstat.html" title="varnishstat"
              >next</a> |</li>
         <li class="right" >
           <a href="varnishncsa.html" title="varnishncsa"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/reference/varnishstat.html b/doc/sphinx/build/html/reference/varnishstat.html
index 22cd76b..3579ba8 100644
--- a/doc/sphinx/build/html/reference/varnishstat.html
+++ b/doc/sphinx/build/html/reference/varnishstat.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>varnishstat &mdash; Varnish version 4.0.2 documentation</title>
+    <title>varnishstat &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,10 +25,10 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Reference Manual" href="index.html" />
     <link rel="next" title="varnishtest" href="varnishtest.html" />
-    <link rel="prev" title="varnishsizes" href="varnishsizes.html" /> 
+    <link rel="prev" title="varnishreplay" href="varnishreplay.html" /> 
   </head>
   <body>
     <div class="related">
@@ -41,9 +41,9 @@
           <a href="varnishtest.html" title="varnishtest"
              accesskey="N">next</a> |</li>
         <li class="right" >
-          <a href="varnishsizes.html" title="varnishsizes"
+          <a href="varnishreplay.html" title="varnishreplay"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>  
@@ -114,7 +114,7 @@ also be used with -1, -x or -j for repeated output.</td></tr>
 <div class="section" id="curses-mode">
 <h3>CURSES MODE<a class="headerlink" href="#curses-mode" title="Permalink to this headline">¶</a></h3>
 <p>When neither -1, -j or -x options are given, the application starts up
-in curses mode. This shows a continously updated view of the counter
+in curses mode. This shows a continuously updated view of the counter
 values, along with their description.</p>
 <p>The top area shows process uptime information.</p>
 <p>The center area shows a list of counter values.</p>
@@ -153,14 +153,14 @@ Varnish daemon, or a period if the counter can't be averaged.</dd>
 <dd>Navigate the counter list one page up.</dd>
 <dt>&lt;PAGEDOWN&gt; or &lt;SPACE&gt;</dt>
 <dd>Navigate the counter list one page down.</dd>
-<dt>&lt;g&gt;</dt>
-<dd>Go to the top of the counter list.</dd>
-<dt>&lt;G&gt;</dt>
-<dd>Go to the bottom of the counter list.</dd>
 <dt>&lt;d&gt;</dt>
 <dd>Toggle between showing and hiding unseen counters. Unseen
 counters are those that has been zero for the entire runtime
 of varnishstat. Defaults to hide unseen counters.</dd>
+<dt>&lt;g&gt;</dt>
+<dd>Go to the top of the counter list.</dd>
+<dt>&lt;G&gt;</dt>
+<dd>Go to the bottom of the counter list.</dd>
 <dt>&lt;v&gt;</dt>
 <dd>Cycle through the verbosity levels. Defaults to only showing
 informational counters.</dd>
@@ -174,11 +174,17 @@ informational counters.</dd>
 <div class="section" id="xml-output">
 <h3>XML Output<a class="headerlink" href="#xml-output" title="Permalink to this headline">¶</a></h3>
 <p>When using the -x option, the output is:</p>
-<div class="highlight-python"><pre>&lt;stat&gt;
-  &lt;name&gt;FIELD NAME&lt;/name&gt;
-  &lt;value&gt;FIELD VALUE&lt;/value&gt;
-  &lt;description&gt;FIELD DESCRIPTION&lt;/description&gt;
-&lt;/stat&gt;</pre>
+<div class="highlight-python"><pre>&lt;varnishstat timestamp="YYYY-MM-DDTHH:mm:SS"&gt;
+  &lt;stat&gt;
+    &lt;type&gt;FIELD TYPE&lt;/type&gt;
+    &lt;ident&gt;FIELD IDENT&lt;/ident&gt;
+    &lt;name&gt;FIELD NAME&lt;/name&gt;
+    &lt;value&gt;FIELD VALUE&lt;/value&gt;
+    &lt;flag&gt;FIELD FORMAT&lt;/flag&gt;
+    &lt;description&gt;FIELD DESCRIPTION&lt;/description&gt;
+  &lt;/stat&gt;
+  [..]
+&lt;/varnishstat&gt;</pre>
 </div>
 </div>
 <div class="section" id="json-output">
@@ -186,23 +192,14 @@ informational counters.</dd>
 <p>With -j the output format is:</p>
 <div class="highlight-python"><pre>{
   "timestamp": "YYYY-MM-DDTHH:mm:SS",
-  "client_conn": {
-      "value": 0, "flag": "a",
-      "description": "Client connections accepted"
-  },
-  "client_drop": {
-      "value": 0, "flag": "a",
-      "description": "Connection dropped, no sess/wrk"
-  },
-  "LCK.backend.creat": {
-      "type": "LCK", "ident": "backend", "value": 1,
-      "flag": "a", "description": "Created locks"
-  },
+  "FIELD NAME": {"type": "FIELD TYPE", "ident": "FIELD IDENT", "value": FIELD VALUE, "flag": "FIELD FORMAT", "description": "FIELD DESCRIPTION"},
   [..]
 }</pre>
 </div>
-<p>Timestamp is the time when the report was generated by varnishstat.</p>
-<p>Repeated output with -1, -x or -j will have a single empty line (\n) between each block of output.</p>
+<p>Type and ident are optional.  Timestamp is the time when the report was
+generated by varnishstat.</p>
+<p>Repeated output with -1, -x or -j will have a single empty line (\n)
+between each block of output.</p>
 </div>
 <div class="section" id="see-also">
 <h3>SEE ALSO<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
@@ -264,8 +261,8 @@ itself. See LICENCE for details.</p>
 </ul>
 
   <h4>Previous topic</h4>
-  <p class="topless"><a href="varnishsizes.html"
-                        title="previous chapter">varnishsizes</a></p>
+  <p class="topless"><a href="varnishreplay.html"
+                        title="previous chapter">varnishreplay</a></p>
   <h4>Next topic</h4>
   <p class="topless"><a href="varnishtest.html"
                         title="next chapter">varnishtest</a></p>
@@ -301,9 +298,9 @@ itself. See LICENCE for details.</p>
           <a href="varnishtest.html" title="varnishtest"
              >next</a> |</li>
         <li class="right" >
-          <a href="varnishsizes.html" title="varnishsizes"
+          <a href="varnishreplay.html" title="varnishreplay"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/reference/varnishtest.html b/doc/sphinx/build/html/reference/varnishtest.html
index 43361eb..36cb649 100644
--- a/doc/sphinx/build/html/reference/varnishtest.html
+++ b/doc/sphinx/build/html/reference/varnishtest.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>varnishtest &mdash; Varnish version 4.0.2 documentation</title>
+    <title>varnishtest &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Reference Manual" href="index.html" />
     <link rel="next" title="varnishtop" href="varnishtop.html" />
     <link rel="prev" title="varnishstat" href="varnishstat.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="varnishstat.html" title="varnishstat"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>  
@@ -254,7 +254,7 @@ itself. See LICENCE for details.</p>
         <li class="right" >
           <a href="varnishstat.html" title="varnishstat"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/reference/varnishtop.html b/doc/sphinx/build/html/reference/varnishtop.html
index 52e08a9..dfa3586 100644
--- a/doc/sphinx/build/html/reference/varnishtop.html
+++ b/doc/sphinx/build/html/reference/varnishtop.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>varnishtop &mdash; Varnish version 4.0.2 documentation</title>
+    <title>varnishtop &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Reference Manual" href="index.html" />
     <link rel="next" title="VSM: Shared Memory Logging and Statistics" href="vsm.html" />
     <link rel="prev" title="varnishtest" href="varnishtest.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="varnishtest.html" title="varnishtest"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>  
@@ -247,7 +247,7 @@ itself. See LICENCE for details.</p>
         <li class="right" >
           <a href="varnishtest.html" title="varnishtest"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/reference/vcl.html b/doc/sphinx/build/html/reference/vcl.html
index 768e4c0..cc101fa 100644
--- a/doc/sphinx/build/html/reference/vcl.html
+++ b/doc/sphinx/build/html/reference/vcl.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>VCL &mdash; Varnish version 4.0.2 documentation</title>
+    <title>VCL &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Reference Manual" href="index.html" />
     <link rel="next" title="Varnish CLI" href="varnish-cli.html" />
     <link rel="prev" title="The Varnish Reference Manual" href="index.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="index.html" title="The Varnish Reference Manual"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>  
@@ -192,6 +192,20 @@ sub vcl_recv {
 }</pre>
 </div>
 </div>
+<div class="section" id="comments">
+<h4>Comments<a class="headerlink" href="#comments" title="Permalink to this headline">¶</a></h4>
+<p>Single lines of VCL can be commented out using // or #. Multi-line blocks can
+be commented out with /* block /*.</p>
+<p>Example:</p>
+<div class="highlight-python"><pre>sub vcl_recv {
+    // Single line of out-commented VCL.
+    # Another way of commenting out a single line.
+    /*
+        Multi-line block of commented-out VCL.
+    */
+}</pre>
+</div>
+</div>
 <div class="section" id="backend-definition">
 <h4>Backend definition<a class="headerlink" href="#backend-definition" title="Permalink to this headline">¶</a></h4>
 <p>A backend declaration creates and initialises a named backend object. A
@@ -403,7 +417,9 @@ the backend.  Not available in pipe mode.</p>
 <blockquote>
 <div><p>Type: BOOL</p>
 <p>Readable from: backend</p>
-<p>Writable from: backend</p>
+<p>Indicates whether this request is uncacheable due
+to a pass in the client side or a hit on an existing
+uncacheable object (aka hit-for-pass).</p>
 </div></blockquote>
 <p>bereq.url</p>
 <blockquote>
@@ -495,6 +511,11 @@ request is pass'ed it will not be stored in memory.</p>
 <div><p>Type: DURATION</p>
 <p>Readable from: vcl_backend_response, vcl_backend_error</p>
 <p>Writable from: vcl_backend_response, vcl_backend_error</p>
+<p>Set to a period to enable conditional backend requests.</p>
+<p>The keep time is cache lifetime in addition to the ttl.</p>
+<p>Objects with ttl expired but with keep time left may be used
+to issue conditional (If-Modified-Since / If-None-Match)
+requests to the backend to refresh them.</p>
 </div></blockquote>
 <p>beresp.proto</p>
 <blockquote>
@@ -538,6 +559,11 @@ beresp.ttl is writable.</p>
 <div><p>Type: BOOL</p>
 <p>Readable from: vcl_backend_response, vcl_backend_error</p>
 <p>Writable from: vcl_backend_response, vcl_backend_error</p>
+<p>Inherited from bereq.uncacheable, see there.</p>
+<p>Setting this variable makes the object uncacheable, which may
+get stored as a hit-for-pass object in the cache.</p>
+<p>Clearing the variable has no effect and will log the warning
+&quot;Ignoring attempt to reset beresp.uncacheable&quot;.</p>
 </div></blockquote>
 </div>
 <div class="section" id="client">
@@ -573,18 +599,14 @@ used in string context it returns a formatted string.</p>
 <blockquote>
 <div><p>Type: DURATION</p>
 <p>Readable from: vcl_hit</p>
-<p>The object's grace period in seconds.</p>
+<p>The object's remaining grace period in seconds.</p>
 </div></blockquote>
 <p>obj.hits</p>
 <blockquote>
 <div><p>Type: INT</p>
 <p>Readable from: vcl_hit, vcl_deliver</p>
-<p>The count of cache-hits on this hash-key since it was
-last instantiated.  This counts cache-hits across all
-Vary:-ants on this hash-key.
-The counter will only be reset to zero if/when all objects
-with this hash-key have disappeared from cache.
-NB: obj.hits == 0 does <em>not</em> indicate a cache miss.</p>
+<p>The count of cache-hits on this object. A value of 0 indicates a
+cache miss.</p>
 </div></blockquote>
 <p>obj.http.</p>
 <blockquote>
@@ -596,6 +618,7 @@ NB: obj.hits == 0 does <em>not</em> indicate a cache miss.</p>
 <blockquote>
 <div><p>Type: DURATION</p>
 <p>Readable from: vcl_hit</p>
+<p>The object's remaining keep period in seconds.</p>
 </div></blockquote>
 <p>obj.proto</p>
 <blockquote>
@@ -624,7 +647,8 @@ NB: obj.hits == 0 does <em>not</em> indicate a cache miss.</p>
 <p>obj.uncacheable</p>
 <blockquote>
 <div><p>Type: BOOL</p>
-<p>Readable from: vcl_hit</p>
+<p>Readable from: vcl_deliver</p>
+<p>Whether the object is uncacheable (pass or hit-for-pass).</p>
 </div></blockquote>
 </div>
 <div class="section" id="req">
@@ -908,6 +932,7 @@ itself. See LICENSE for details.</p>
 <li><a class="reference internal" href="#regular-expressions">Regular Expressions</a></li>
 <li><a class="reference internal" href="#include-statement">Include statement</a></li>
 <li><a class="reference internal" href="#import-statement">Import statement</a></li>
+<li><a class="reference internal" href="#comments">Comments</a></li>
 <li><a class="reference internal" href="#backend-definition">Backend definition</a></li>
 <li><a class="reference internal" href="#probes">Probes</a></li>
 <li><a class="reference internal" href="#access-control-list-acl">Access Control List (ACL)</a></li>
@@ -982,7 +1007,7 @@ itself. See LICENSE for details.</p>
         <li class="right" >
           <a href="index.html" title="The Varnish Reference Manual"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/reference/vmod.html b/doc/sphinx/build/html/reference/vmod.html
index d8511ae..9b5620c 100644
--- a/doc/sphinx/build/html/reference/vmod.html
+++ b/doc/sphinx/build/html/reference/vmod.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>VMOD - Varnish Modules &mdash; Varnish version 4.0.2 documentation</title>
+    <title>VMOD - Varnish Modules &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Reference Manual" href="index.html" />
     <link rel="next" title="vmod_std" href="vmod_std.generated.html" />
     <link rel="prev" title="VSM: Shared Memory Logging and Statistics" href="vsm.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vsm.html" title="VSM: Shared Memory Logging and Statistics"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>  
@@ -274,7 +274,7 @@ malloc would look like this:</p>
 <div class="highlight-python"><pre>if (priv-&gt;priv == NULL) {
         priv-&gt;priv = calloc(sizeof(struct myfoo), 1);
         AN(priv-&gt;priv);
-        priv-&gt;priv = free;      /* free(3) */
+        priv-&gt;free = free;      /* free(3) */
         mystate = priv-&gt;priv;
         mystate-&gt;foo = 21;
         ...
@@ -403,7 +403,7 @@ and use <tt class="docutils literal"><span class="pre">import</span> <span class
         <li class="right" >
           <a href="vsm.html" title="VSM: Shared Memory Logging and Statistics"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/reference/vmod_directors.generated.html b/doc/sphinx/build/html/reference/vmod_directors.generated.html
index 3bd6e91..49890ca 100644
--- a/doc/sphinx/build/html/reference/vmod_directors.generated.html
+++ b/doc/sphinx/build/html/reference/vmod_directors.generated.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>vmod_directors &mdash; Varnish version 4.0.2 documentation</title>
+    <title>vmod_directors &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Reference Manual" href="index.html" />
     <link rel="next" title="VSL" href="vsl.html" />
     <link rel="prev" title="vmod_std" href="vmod_std.generated.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vmod_std.generated.html" title="vmod_std"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>  
@@ -348,7 +348,7 @@ vdir.add_backend(backend2, 1.0);</dd>
         <li class="right" >
           <a href="vmod_std.generated.html" title="vmod_std"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/reference/vmod_std.generated.html b/doc/sphinx/build/html/reference/vmod_std.generated.html
index a25f668..11067dc 100644
--- a/doc/sphinx/build/html/reference/vmod_std.generated.html
+++ b/doc/sphinx/build/html/reference/vmod_std.generated.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>vmod_std &mdash; Varnish version 4.0.2 documentation</title>
+    <title>vmod_std &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Reference Manual" href="index.html" />
     <link rel="next" title="vmod_directors" href="vmod_directors.generated.html" />
     <link rel="prev" title="VMOD - Varnish Modules" href="vmod.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vmod.html" title="VMOD - Varnish Modules"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>  
@@ -83,6 +83,7 @@ they return the second argument, which must have the given TYPE.</p>
 <div class="section" id="contents">
 <h3>CONTENTS<a class="headerlink" href="#contents" title="Permalink to this headline">¶</a></h3>
 <ul class="simple">
+<li><a class="reference internal" href="#func-cache-req-body"><em>VOID cache_req_body(BYTES)</em></a></li>
 <li><a class="reference internal" href="#func-collect"><em>VOID collect(HEADER)</em></a></li>
 <li><a class="reference internal" href="#func-duration"><em>DURATION duration(STRING, DURATION)</em></a></li>
 <li><a class="reference internal" href="#func-fileread"><em>STRING fileread(PRIV_CALL, STRING)</em></a></li>
@@ -99,6 +100,7 @@ they return the second argument, which must have the given TYPE.</p>
 <li><a class="reference internal" href="#func-set-ip-tos"><em>VOID set_ip_tos(INT)</em></a></li>
 <li><a class="reference internal" href="#func-strstr"><em>STRING strstr(STRING, STRING)</em></a></li>
 <li><a class="reference internal" href="#func-syslog"><em>VOID syslog(INT, STRING_LIST)</em></a></li>
+<li><a class="reference internal" href="#func-time"><em>TIME time(STRING, TIME)</em></a></li>
 <li><a class="reference internal" href="#func-time2integer"><em>INT time2integer(TIME)</em></a></li>
 <li><a class="reference internal" href="#func-time2real"><em>REAL time2real(TIME)</em></a></li>
 <li><a class="reference internal" href="#func-timestamp"><em>VOID timestamp(STRING)</em></a></li>
@@ -109,9 +111,9 @@ they return the second argument, which must have the given TYPE.</p>
 <span id="func-toupper"></span><h4>STRING toupper(STRING_LIST)<a class="headerlink" href="#string-toupper-string-list" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>STRING toupper(STRING_LIST)</dd>
+<dd>STRING toupper(STRING_LIST s)</dd>
 <dt>Description</dt>
-<dd>Converts the string <em>s</em> to upper case.</dd>
+<dd>Converts the string <em>s</em> to uppercase.</dd>
 <dt>Example</dt>
 <dd>set beresp.http.x-scream = std.toupper(&quot;yes!&quot;);</dd>
 </dl>
@@ -120,9 +122,9 @@ they return the second argument, which must have the given TYPE.</p>
 <span id="func-tolower"></span><h4>STRING tolower(STRING_LIST)<a class="headerlink" href="#string-tolower-string-list" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>STRING tolower(STRING_LIST)</dd>
+<dd>STRING tolower(STRING_LIST s)</dd>
 <dt>Description</dt>
-<dd>Converts the string <em>s</em> to lower case.</dd>
+<dd>Converts the string <em>s</em> to lowercase.</dd>
 <dt>Example</dt>
 <dd>set beresp.http.x-nice = std.tolower(&quot;VerY&quot;);</dd>
 </dl>
@@ -131,10 +133,10 @@ they return the second argument, which must have the given TYPE.</p>
 <span id="func-set-ip-tos"></span><h4>VOID set_ip_tos(INT)<a class="headerlink" href="#void-set-ip-tos-int" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>VOID set_ip_tos(INT)</dd>
+<dd>VOID set_ip_tos(INT tos)</dd>
 <dt>Description</dt>
-<dd>Sets the Type-of-Service flag for the current session. Please
-note that the TOS flag is not removed by the end of the
+<dd>Sets the IP type-of-service (TOS) field for the current session to <em>tos</em>.
+Please note that the TOS field is not removed by the end of the
 request so probably want to set it on every request should you
 utilize it.</dd>
 <dt>Example</dt>
@@ -152,9 +154,9 @@ utilize it.</dd>
 <span id="func-random"></span><h4>REAL random(REAL, REAL)<a class="headerlink" href="#real-random-real-real" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>REAL random(REAL, REAL)</dd>
+<dd>REAL random(REAL lo, REAL hi)</dd>
 <dt>Description</dt>
-<dd>Returns a random REAL number between <em>a</em> and <em>b</em>.</dd>
+<dd>Returns a random real number between <em>lo</em> and <em>hi</em>.</dd>
 <dt>Example</dt>
 <dd>set beresp.http.x-random-number = std.random(1, 100);</dd>
 </dl>
@@ -163,9 +165,9 @@ utilize it.</dd>
 <span id="func-log"></span><h4>VOID log(STRING_LIST)<a class="headerlink" href="#void-log-string-list" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>VOID log(STRING_LIST)</dd>
+<dd>VOID log(STRING_LIST s)</dd>
 <dt>Description</dt>
-<dd>Logs <em>string</em> to the shared memory log, using VSL tag <em>SLT_VCL_Log</em>.</dd>
+<dd>Logs the string <em>s</em> to the shared memory log, using VSL tag <em>SLT_VCL_Log</em>.</dd>
 <dt>Example</dt>
 <dd>std.log(&quot;Something fishy is going on with the vhost &quot; + req.host);</dd>
 </dl>
@@ -174,9 +176,9 @@ utilize it.</dd>
 <span id="func-syslog"></span><h4>VOID syslog(INT, STRING_LIST)<a class="headerlink" href="#void-syslog-int-string-list" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>VOID syslog(INT, STRING_LIST)</dd>
+<dd>VOID syslog(INT priority, STRING_LIST s)</dd>
 <dt>Description</dt>
-<dd>Logs <em>string</em> to syslog marked with <em>priority</em>.  See your
+<dd>Logs the string <em>s</em> to syslog marked with <em>priority</em>.  See your
 system's syslog.h file for the legal values of <em>priority</em>.</dd>
 <dt>Example</dt>
 <dd>std.syslog(8 + 1, &quot;Something is wrong&quot;);</dd>
@@ -200,24 +202,25 @@ account. Also, files are not re-read.</dd>
 <span id="func-collect"></span><h4>VOID collect(HEADER)<a class="headerlink" href="#void-collect-header" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>VOID collect(HEADER)</dd>
+<dd>VOID collect(HEADER hdr)</dd>
 <dt>Description</dt>
-<dd>Collapses the header, joining the headers into one.</dd>
+<dd>Collapses the header <em>hdr</em>, joining them into one.</dd>
 <dt>Example</dt>
-<dd>std.collect(req.http.cookie);
-This will collapse several Cookie: headers into one, long
-cookie header.</dd>
+<dd><p class="first">std.collect(req.http.cookie);</p>
+<p class="last">This will collapse several Cookie: headers into one, long
+cookie header.</p>
+</dd>
 </dl>
 </div>
 <div class="section" id="duration-duration-string-duration">
 <span id="func-duration"></span><h4>DURATION duration(STRING, DURATION)<a class="headerlink" href="#duration-duration-string-duration" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>DURATION duration(STRING, DURATION)</dd>
+<dd>DURATION duration(STRING s, DURATION fallback)</dd>
 <dt>Description</dt>
 <dd>Converts the string <em>s</em> to seconds. <em>s</em> must be quantified
 with ms (milliseconds), s (seconds), m (minutes), h (hours),
-d (days), w (weeks) or y (years) units. If <em>s</em> fails to parse,
+d (days), w (weeks) or y (years) units. If conversion fails,
 <em>fallback</em> will be returned.</dd>
 <dt>Example</dt>
 <dd>set beresp.ttl = std.duration(&quot;1w&quot;, 3600s);</dd>
@@ -227,34 +230,48 @@ d (days), w (weeks) or y (years) units. If <em>s</em> fails to parse,
 <span id="func-integer"></span><h4>INT integer(STRING, INT)<a class="headerlink" href="#int-integer-string-int" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>INT integer(STRING, INT)</dd>
+<dd>INT integer(STRING s, INT fallback)</dd>
 <dt>Description</dt>
-<dd>Converts the string <em>s</em> to an integer.  If <em>s</em> fails to parse,
+<dd>Converts the string <em>s</em> to an integer.  If conversion fails,
 <em>fallback</em> will be returned.</dd>
 <dt>Example</dt>
-<dd>if (std.integer(beresp.http.x-foo, 0) &gt; 5) { ... }</dd>
+<dd><div class="first last line-block">
+<div class="line">if (std.integer(beresp.http.x-foo, 0) &gt; 5) {</div>
+<div class="line-block">
+<div class="line">...</div>
+</div>
+<div class="line">}</div>
+</div>
+</dd>
 </dl>
 </div>
 <div class="section" id="ip-ip-string-ip">
 <span id="func-ip"></span><h4>IP ip(STRING, IP)<a class="headerlink" href="#ip-ip-string-ip" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>IP ip(STRING, IP)</dd>
+<dd>IP ip(STRING s, IP fallback)</dd>
 <dt>Description</dt>
-<dd>Converts string <em>s</em> to the first IP number returned by
+<dd>Converts the string <em>s</em> to the first IP number returned by
 the system library function getaddrinfo(3).  If conversion
 fails, <em>fallback</em> will be returned.</dd>
 <dt>Example</dt>
-<dd>if (std.ip(req.http.X-forwarded-for, &quot;0.0.0.0&quot;) ~ my_acl) { ... }</dd>
+<dd><div class="first last line-block">
+<div class="line">if (std.ip(req.http.X-forwarded-for, &quot;0.0.0.0&quot;) ~ my_acl) {</div>
+<div class="line-block">
+<div class="line">...</div>
+</div>
+<div class="line">}</div>
+</div>
+</dd>
 </dl>
 </div>
 <div class="section" id="real-real-string-real">
 <span id="func-real"></span><h4>REAL real(STRING, REAL)<a class="headerlink" href="#real-real-string-real" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>REAL real(STRING, REAL)</dd>
+<dd>REAL real(STRING s, REAL fallback)</dd>
 <dt>Description</dt>
-<dd>Converts the string <em>s</em> to a real.  If <em>s</em> fails to parse,
+<dd>Converts the string <em>s</em> to a real.  If conversion fails,
 <em>fallback</em> will be returned.</dd>
 <dt>Example</dt>
 <dd>set req.http.x-real = std.real(req.http.x-foo, 0.0);</dd>
@@ -264,7 +281,7 @@ fails, <em>fallback</em> will be returned.</dd>
 <span id="func-real2time"></span><h4>TIME real2time(REAL)<a class="headerlink" href="#time-real2time-real" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>TIME real2time(REAL)</dd>
+<dd>TIME real2time(REAL r)</dd>
 <dt>Description</dt>
 <dd>Converts the real <em>r</em> to a time.</dd>
 <dt>Example</dt>
@@ -275,7 +292,7 @@ fails, <em>fallback</em> will be returned.</dd>
 <span id="func-time2integer"></span><h4>INT time2integer(TIME)<a class="headerlink" href="#int-time2integer-time" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>INT time2integer(TIME)</dd>
+<dd>INT time2integer(TIME t)</dd>
 <dt>Description</dt>
 <dd>Converts the time <em>t</em> to a integer.</dd>
 <dt>Example</dt>
@@ -286,7 +303,7 @@ fails, <em>fallback</em> will be returned.</dd>
 <span id="func-time2real"></span><h4>REAL time2real(TIME)<a class="headerlink" href="#real-time2real-time" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>REAL time2real(TIME)</dd>
+<dd>REAL time2real(TIME t)</dd>
 <dt>Description</dt>
 <dd>Converts the time <em>t</em> to a real.</dd>
 <dt>Example</dt>
@@ -297,27 +314,27 @@ fails, <em>fallback</em> will be returned.</dd>
 <span id="func-healthy"></span><h4>BOOL healthy(BACKEND)<a class="headerlink" href="#bool-healthy-backend" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>BOOL healthy(BACKEND)</dd>
+<dd>BOOL healthy(BACKEND be)</dd>
 <dt>Description</dt>
-<dd>Returns true if the backend is healthy.</dd>
+<dd>Returns <cite>true</cite> if the backend <em>be</em> is healthy.</dd>
 </dl>
 </div>
 <div class="section" id="int-port-ip">
 <span id="func-port"></span><h4>INT port(IP)<a class="headerlink" href="#int-port-ip" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>INT port(IP)</dd>
+<dd>INT port(IP ip)</dd>
 <dt>Description</dt>
-<dd>Returns the port number of an IP address.</dd>
+<dd>Returns the port number of the IP address <em>ip</em>.</dd>
 </dl>
 </div>
 <div class="section" id="void-rollback-http">
 <span id="func-rollback"></span><h4>VOID rollback(HTTP)<a class="headerlink" href="#void-rollback-http" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>VOID rollback(HTTP)</dd>
+<dd>VOID rollback(HTTP h)</dd>
 <dt>Description</dt>
-<dd>Restore <em>h</em> HTTP headers to their original state.</dd>
+<dd>Restores the <em>h</em> HTTP headers to their original state.</dd>
 <dt>Example</dt>
 <dd>std.rollback(bereq);</dd>
 </dl>
@@ -326,12 +343,12 @@ fails, <em>fallback</em> will be returned.</dd>
 <span id="func-timestamp"></span><h4>VOID timestamp(STRING)<a class="headerlink" href="#void-timestamp-string" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>VOID timestamp(STRING)</dd>
+<dd>VOID timestamp(STRING s)</dd>
 <dt>Description</dt>
-<dd>Introduces a timestamp in the log with the current time. Uses
-the argument as the timespamp label. This is useful to time
-the execution of lengthy VCL procedures, and makes the
-timestamps inserted automatically by Varnish more accurate.</dd>
+<dd>Introduces a timestamp in the log with the current time, using
+the string <em>s</em> as the label. This is useful to time the execution
+of lengthy VCL procedures, and makes the timestamps inserted
+automatically by Varnish more accurate.</dd>
 <dt>Example</dt>
 <dd>std.timestamp(&quot;curl-request&quot;);</dd>
 </dl>
@@ -342,26 +359,75 @@ timestamps inserted automatically by Varnish more accurate.</dd>
 <dt>Prototype</dt>
 <dd>STRING querysort(STRING)</dd>
 <dt>Description</dt>
-<dd>Sorts the querystring for cache normalization purposes.</dd>
+<dd>Sorts the query string for cache normalization purposes.</dd>
 <dt>Example</dt>
 <dd>set req.url = std.querysort(req.url);</dd>
 </dl>
 </div>
+<div class="section" id="void-cache-req-body-bytes">
+<span id="func-cache-req-body"></span><h4>VOID cache_req_body(BYTES)<a class="headerlink" href="#void-cache-req-body-bytes" title="Permalink to this headline">¶</a></h4>
+<dl class="docutils">
+<dt>Prototype</dt>
+<dd>VOID cache_req_body(BYTES size)</dd>
+<dt>Description</dt>
+<dd><p class="first">Cache the req.body if it is smaller than <em>size</em>.</p>
+<p class="last">Caching the req.body makes it possible to retry pass
+operations (POST, PUT).</p>
+</dd>
+<dt>Example</dt>
+<dd><p class="first">std.cache_req_body(1KB);</p>
+<p class="last">This will cache the req.body if its size is smaller than 1KB.</p>
+</dd>
+</dl>
+</div>
 <div class="section" id="string-strstr-string-string">
 <span id="func-strstr"></span><h4>STRING strstr(STRING, STRING)<a class="headerlink" href="#string-strstr-string-string" title="Permalink to this headline">¶</a></h4>
 <dl class="docutils">
 <dt>Prototype</dt>
-<dd>STRING strstr(STRING, STRING)</dd>
+<dd>STRING strstr(STRING s1, STRING s2)</dd>
 <dt>Description</dt>
-<dd><p class="first">Returns the substring if the second string is a substring of the first
-string. Note that the comparison is case sensitive. You can
-use the tolower function on both strings if you want case
-insensitivity.</p>
-<p class="last">If there is no match a NULL pointer is returned which would
-evaluate to false in an if-test.</p>
+<dd><p class="first">Returns the first occurrence of the string <em>s2</em> in the string
+<em>s1</em>, or an empty string if not found.</p>
+<p class="last">Note that the comparison is case sensitive.</p>
 </dd>
 <dt>Example</dt>
-<dd>if (std.strstr(req.url, req.http.x-restrict))</dd>
+<dd><div class="first last line-block">
+<div class="line">if (std.strstr(req.url, req.http.x-restrict)) {</div>
+<div class="line-block">
+<div class="line">...</div>
+</div>
+<div class="line">}</div>
+</div>
+</dd>
+</dl>
+</div>
+<div class="section" id="time-time-string-time">
+<span id="func-time"></span><h4>TIME time(STRING, TIME)<a class="headerlink" href="#time-time-string-time" title="Permalink to this headline">¶</a></h4>
+<dl class="docutils">
+<dt>Prototype</dt>
+<dd>TIME time(STRING s, TIME fallback)</dd>
+<dt>Description</dt>
+<dd><p class="first">Converts the string <em>s</em> to a time.  If conversion fails,
+<em>fallback</em> will be returned.</p>
+<p>Supported formats:</p>
+<div class="last line-block">
+<div class="line">&quot;Sun, 06 Nov 1994 08:49:37 GMT&quot;</div>
+<div class="line">&quot;Sunday, 06-Nov-94 08:49:37 GMT&quot;</div>
+<div class="line">&quot;Sun Nov  6 08:49:37 1994&quot;</div>
+<div class="line">&quot;1994-11-06T08:49:37&quot;</div>
+<div class="line">&quot;784111777.00&quot;</div>
+<div class="line">&quot;784111777&quot;</div>
+</div>
+</dd>
+<dt>Example</dt>
+<dd><div class="first last line-block">
+<div class="line">if (std.time(resp.http.last-modified, now) &lt; now - 1w) {</div>
+<div class="line-block">
+<div class="line">...</div>
+</div>
+<div class="line">}</div>
+</div>
+</dd>
 </dl>
 </div>
 </div>
@@ -419,7 +485,9 @@ itself. See LICENCE for details.</p>
 <li><a class="reference internal" href="#void-rollback-http">VOID rollback(HTTP)</a></li>
 <li><a class="reference internal" href="#void-timestamp-string">VOID timestamp(STRING)</a></li>
 <li><a class="reference internal" href="#string-querysort-string">STRING querysort(STRING)</a></li>
+<li><a class="reference internal" href="#void-cache-req-body-bytes">VOID cache_req_body(BYTES)</a></li>
 <li><a class="reference internal" href="#string-strstr-string-string">STRING strstr(STRING, STRING)</a></li>
+<li><a class="reference internal" href="#time-time-string-time">TIME time(STRING, TIME)</a></li>
 </ul>
 </li>
 <li><a class="reference internal" href="#see-also">SEE ALSO</a></li>
@@ -471,7 +539,7 @@ itself. See LICENCE for details.</p>
         <li class="right" >
           <a href="vmod.html" title="VMOD - Varnish Modules"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/reference/vsl-query.html b/doc/sphinx/build/html/reference/vsl-query.html
index aca520d..d3f20fa 100644
--- a/doc/sphinx/build/html/reference/vsl-query.html
+++ b/doc/sphinx/build/html/reference/vsl-query.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Varnish VSL Query Expressions &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Varnish VSL Query Expressions &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Reference Manual" href="index.html" />
     <link rel="next" title="What&#39;s new in Varnish 4.0" href="../whats-new/index.html" />
     <link rel="prev" title="VSL" href="vsl.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vsl.html" title="VSL"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>  
@@ -330,7 +330,7 @@ their ESI subrequests. (Assumes request grouping mode).</p>
         <li class="right" >
           <a href="vsl.html" title="VSL"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/reference/vsl.html b/doc/sphinx/build/html/reference/vsl.html
index b42b57c..2631c3a 100644
--- a/doc/sphinx/build/html/reference/vsl.html
+++ b/doc/sphinx/build/html/reference/vsl.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>VSL &mdash; Varnish version 4.0.2 documentation</title>
+    <title>VSL &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Reference Manual" href="index.html" />
     <link rel="next" title="Varnish VSL Query Expressions" href="vsl-query.html" />
     <link rel="prev" title="vmod_directors" href="vmod_directors.generated.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vmod_directors.generated.html" title="vmod_directors"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>  
@@ -403,12 +403,12 @@ G F E 159 173 80 1304 1314</pre>
 <dt>TTL - TTL set on object</dt>
 <dd><p class="first">A TTL record is emitted whenever the ttl, grace or keep values for an object is set.</p>
 <p>The format is:</p>
-<div class="highlight-python"><pre>%s %d %d %d %d %d [ %d %u %u ]
-|  |  |  |  |  |    |  |  |
-|  |  |  |  |  |    |  |  +- Max-Age from Cache-Control header
-|  |  |  |  |  |    |  +---- Expires header
-|  |  |  |  |  |    +------- Date header
-|  |  |  |  |  +------------ Age (incl Age: header value)
+<div class="highlight-python"><pre>%s %d %d %d %d [ %d %d %u %u ]
+|  |  |  |  |    |  |  |  |
+|  |  |  |  |    |  |  |  +- Max-Age from Cache-Control header
+|  |  |  |  |    |  |  +---- Expires header
+|  |  |  |  |    |  +------- Date header
+|  |  |  |  |    +---------- Age (incl Age: header value)
 |  |  |  |  +--------------- Reference time for TTL
 |  |  |  +------------------ Keep
 |  |  +--------------------- Grace
@@ -417,12 +417,8 @@ G F E 159 173 80 1304 1314</pre>
 </div>
 <p>The last four fields are only present in &quot;RFC&quot; headers.</p>
 <p>Examples:</p>
-<div class="last highlight-python"><pre>RFC 19 -1 -1 1312966109 4 0 0 23
-VCL 10 -1 -1 1312966109 4
-VCL 7 -1 -1 1312966111 6
-VCL 7 120 -1 1312966111 6
-VCL 7 120 3600 1312966111 6
-VCL 12 120 3600 1312966113 8</pre>
+<div class="last highlight-python"><pre>RFC 60 -1 -1 1312966109 1312966109 1312966109 0 60
+VCL 120 10 0 1312966111</pre>
 </div>
 </dd>
 <dt>Timestamp - Timing information</dt>
@@ -623,7 +619,7 @@ Martin Blix Grydeland.</p>
         <li class="right" >
           <a href="vmod_directors.generated.html" title="vmod_directors"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/reference/vsm.html b/doc/sphinx/build/html/reference/vsm.html
index 85da9a8..0742d8a 100644
--- a/doc/sphinx/build/html/reference/vsm.html
+++ b/doc/sphinx/build/html/reference/vsm.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>VSM: Shared Memory Logging and Statistics &mdash; Varnish version 4.0.2 documentation</title>
+    <title>VSM: Shared Memory Logging and Statistics &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Reference Manual" href="index.html" />
     <link rel="next" title="VMOD - Varnish Modules" href="vmod.html" />
     <link rel="prev" title="varnishtop" href="varnishtop.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="varnishtop.html" title="varnishtop"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>  
@@ -190,7 +190,7 @@ VSM files.</p>
         <li class="right" >
           <a href="varnishtop.html" title="varnishtop"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Reference Manual</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/search.html b/doc/sphinx/build/html/search.html
index 4c4de56..a87e3f8 100644
--- a/doc/sphinx/build/html/search.html
+++ b/doc/sphinx/build/html/search.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Search &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Search &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="_static/default.css" type="text/css" />
     <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -26,7 +26,7 @@
     <script type="text/javascript" src="_static/underscore.js"></script>
     <script type="text/javascript" src="_static/doctools.js"></script>
     <script type="text/javascript" src="_static/searchtools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="index.html" />
   <script type="text/javascript">
     jQuery(function() { Search.loadIndex("searchindex.js"); });
   </script>
@@ -40,7 +40,7 @@
         <li class="right" style="margin-right: 10px">
           <a href="genindex.html" title="General Index"
              accesskey="I">index</a></li>
-        <li><a href="index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>  
 
@@ -88,7 +88,7 @@
         <li class="right" style="margin-right: 10px">
           <a href="genindex.html" title="General Index"
              >index</a></li>
-        <li><a href="index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>
     <div class="footer">
diff --git a/doc/sphinx/build/html/searchindex.js b/doc/sphinx/build/html/searchindex.js
index b55620b..8cbcc70 100644
--- a/doc/sphinx/build/html/searchindex.js
+++ b/doc/sphinx/build/html/searchindex.js
@@ -1 +1 @@
-Search.setIndex({objects:{},terms:{obious:34,entropi:53,waslock:20,resist:1,demand:[84,3,34,58],four:[51,1],secondli:37,prefix:[62,14,72,64,20,58],sleep:[66,20,58],vcl_acl:51,oldest:[83,61,36,60],hate:66,min_pool:58,forget:[62,77,53,28,57,80,17,39],storage_fil:58,kqueue:63,accur:47,"const":[62,57],spew:63,sorri:48,logdata:55,concret:20,swap:30,under:[83,84,50,60,18,26,69,61,3,14,62,27,47,34,42,82,88,58,64,24,31],sha256:[53,31],worth:[34,42,63,38,57],everi:[1,72,77,44,63,19,47,78,34,83,36,53,88,10,86,64],risk:53,vastli:[3,42],"void":[59,62,57,20,47],gover:84,ptxmcgnnsdxsvdmv:31,govern:2,affect:[76,52,3,71,66,15,53],vast:62,school:[79,12,26],showcas:65,upload:31,string_list:[62,59,47],vector:58,session_max:58,geoip:38,initialis:88,x86_64:9,properti:19,throught:1,quilt:75,"10m":27,geekiest:48,direct:[50,19,88,44,31,58],budget:12,enjoi:77,consequ:[88,30,68],second:[69,52,63,14,75,71,79,80,37,10,60,61,82,42,43,44,58,62,72,47,21,83,88,23,24],street:34,aggreg:[84,81,55],ill:[84,42],even:[0,1,50,52,3,53,26,7,78,79,10,17,64,20,39,87,84,42,43,44,58,62,23,66,34,48],aim:50,hide:14,backend1:[59,50],thunder:37,madvis:71,lookback:77,fetch_maxchunks:58,strictli:27,child_main:63,"new":[51,52,3,22,75,31,32,76,78,79,36,37,10,59,39,60,84,44,58,62,66,86,20,21,88],net:[1,2,84],ever:[62,66,34,6,75,48,12],metadata:[52,84,64,36],ongo:88,elimin:53,kilobyt:53,nanni:17,noreturn:20,never:[62,63,43,58,16,34,71,44,23,64,20,17],accus:48,here:[50,70,3,63,56,57,31,76,7,9,36,37,10,64,39,41,43,44,58,62,46,34],herd:37,wanton:[85,66],china:66,debugg:58,elimit:58,path:[32,50,27,47,30,23,59,58],interpret:[3,58],acceptor:58,dry:75,forum:2,announc:[84,39],anymor:[66,76],robin:[44,59],precis:75,loop:[88,20,68],permit:[58,39],vcl_backend_respons:[0,25,56,76,3,27,16,6,7,22,36,37,88,64,17],studi:46,c89a:31,werror:58,portabl:[57,20,43],carl:48,newspap:34,storage_malloc:9,brought:[34,20],substr:47,unix:[62,51,43,11,20,31],moral:34,printf:20,total:[84,1,26,50,69,51,79,86,34,75],unit:[51,62,58,47],highli:[34,23,63],plot:66,describ:[84,1,63,76,51,71,62,82,35,21,28,10,88,30,64],would:[1,2,50,52,3,53,16,57,30,47,59,77,78,79,36,12,20,40,84,42,43,44,62,23,63,64,66,38,34,88,48],found:[62,51,34,55,79,6,23,64,58],ddthh:14,lwp:[64,4],leaki:34,init:[8,62,71],choosen:31,call:[25,51,3,43,19,6,68,63,76,7,79,80,36,37,10,17,64,59,39,41,53,44,58,84,62,85,66,86,20,38,88,23],telegraph:39,passport:34,spike:84,lru_cand:51,old_nam:86,type:[25,69,51,52,3,14,16,28,63,31,76,77,8,7,9,80,41,15,58,62,72,47,88],tell:[0,87,62,48,63,80,77,3,43,86,58,16,35,19,28,53,44,23,64,20,39],"0x4178fd":9,vmod_foo:62,lru_fail:51,paperwork:34,autogen:28,relax:[62,12],relat:[32,1,51,62,72,53,31],notic:[62,76,52,46,84,9,75],hurt:[58,57],grief:34,phone:10,warm:[84,18],adult:34,hole:26,hold:[39,20,37],must:[1,75,76,51,70,37,62,47,77,79,71,88,10,11,58,64,59,31],shoot:51,join:[44,87,47,63,39],room:66,restor:[88,47],setup:[80,64,38],work:[25,49,1,75,2,50,51,52,3,63,16,57,31,76,77,7,35,79,80,36,37,10,11,58,64,20,39,40,81,41,15,42,43,44,17,84,62,48,66,86,34,85,88,23],roof:34,coalesc:[44,37],glossari:[32,17],erl:[60,69,14,61,83,24,58],sbin:[32,28],root:[10,1,11,58],overrid:[4,36,7,56,64,58],give:[83,39,1,48,50,52,62,81,5,58,86,34,9,80,42,63,44,23,20,17],txreq:27,indic:[0,32,62,2,50,76,52,3,58,34,80,88,10,23,64,31],http_range_support:58,unavail:35,want:[49,1,2,50,40,51,52,3,16,28,29,57,30,59,77,87,7,9,80,36,81,10,58,64,20,39,13,66,84,42,53,44,17,62,85,46,86,47,38,34,88,48,68],vmod_std:[88,8,62,47],viceminist:12,attract:79,somekei:53,recov:42,end:[25,1,51,63,14,19,6,68,75,35,80,36,38,60,61,42,53,44,58,57,84,72,47,34,83,88],do_stream:88,manipul:[49,1,65,29,64,59,17],turn:[62,2,18,4,66,84,16,19,36,23,59],polic:[5,75],revisit:46,how:[25,1,75,2,50,69,51,3,43,4,19,6,74,63,86,31,32,77,33,78,7,9,36,37,10,58,64,20,40,81,84,53,44,16,17,62,85,66,5,59,34,88,23],hot:[78,84],confin:77,"128b":58,answer:[1,2,26,77,34,53,10,23,39],verifi:64,widespread:[79,20],perspect:[7,39],connect_timeout:[88,58],"128k":58,updat:[83,62,18,60,69,51,61,14,82,27,55,8,22,77,58,24,31],dialect:43,recogn:84,mess:[70,1,50],chines:12,after:[32,84,81,40,51,66,76,58,7,27,20,34,6,28,44,88,30,48,24,39],superus:1,diagram:26,befor:[49,50,66,3,63,16,6,28,71,31,7,36,11,17,20,39,60,72,61,84,83,43,4,58,62,46,86,38,88,48],wrong:[84,76,33,66,47,35,7,9,28,63,10,20,39],beauti:64,cli_req:26,law:[10,34,12,50],parallel:[27,71],averag:[51,61,14,75],rhel6:71,handl:[2,69,51,16,19,6,29,63,76,7,80,36,81,10,17,64,20,39,15,44,58,5,34,88,23],attempt:[1,18,51,3,84,47,34,6,43,88,58],third:[62,79,80,34],opaqu:62,gottcha:41,think:[1,50,63,75,26,85,77,7,79,80,36,17,12,20,53,42,43,44,58,84,23,66,34,48],insuffer:43,wink:34,maintain:[34,62,39],environ:[27,57],max_restart:[6,58],incorpor:84,enter:[16,6,80,36,4,31],no_coredump:58,ethernet:[48,43],berespbodi:51,order:[1,2,69,3,53,14,5,28,56,71,35,7,9,36,37,10,11,17,64,59,84,42,43,58,62,63,88],origin:[14,61,87,27,47,7,88,44,64],tcp_keepalive_tim:[58,71],feedback:[41,58],objhead:[51,58,53],over:[32,84,86,18,66,61,82,14,79,59,35,77,34,6,80,42,63,88,58,20,45],fall:[34,66],becaus:[57,86,75,48,63,50,76,52,43,84,34,4,35,77,79,42,53,10,23,20,58],jpeg:[3,17],privileg:[1,46,58],omnio:[2,57],flexibl:[10,34,2],vari:[3,16,7,36,81,88,4,64],digest:[53,59,31],makefil:[62,43],streamlin:39,cli:[1,26,51,52,81,54,86,15,82,8,9,80,36,77,10,58,31],fit:[23,66,20,47],cld:26,fix:[75,81,50,63,16,34,42,28,53,64],crew:34,better:[84,50,76,63,58,16,34,42,57,10,23,12,20,47],offic:34,persist:[51,3,54,42,71,30,85,58],hidden:50,easier:[84,76,7,75,23,64],descend:2,them:[25,1,2,50,69,52,3,53,28,57,26,77,78,7,10,12,20,66,41,42,43,44,58,84,62,85,63,64,46,86,59,34,23,24],gnu99:58,woken:26,thei:[1,75,50,52,43,14,68,71,31,26,85,77,78,80,36,10,58,12,20,39,41,42,53,44,17,57,84,62,23,64,66,86,47,34,88,48,24],proce:[88,6,28,17],priv_cal:[62,47],safe:[62,52,34,42,10,64,20],"break":[52,84,50,57],band:43,bang:57,promis:[42,20,53],interrupt:31,yourself:[28,6,2,26],bank:34,rumour:63,choic:57,"40b":58,reopen:[83,69],"0xb7509610":36,arrow:26,each:[1,69,51,52,14,27,72,68,63,30,31,77,10,64,59,40,61,84,53,44,58,62,66,86,34,88,23,24],debug:[18,51,86,9,63,31,64,20,58],went:[86,20,63],side:[25,40,62,50,76,66,84,16,34,80,81,23,64],mean:[25,50,52,16,63,76,77,87,79,36,70,17,64,20,72,62,53,44,4,58,84,66,86,34,85],doddl:75,pdflatex:79,reqstart:[51,80],req_stat:58,interop:84,list:[25,1,2,52,14,55,68,31,32,76,77,33,67,35,79,9,80,36,17,64,20,39,72,61,15,83,58,46,86,59,34,88,23,24],exactli:[1,63,46,86,53,23,64,20,31],spider:17,"1kb":78,taught:20,forgot:[50,39],logo:86,dawn:50,extract:[84,64,72],"24x":86,respreason:51,network:[84,1,2,51,7,67,68,71,88,58,31],goe:[1,63,52,33,34,9,42,57,44,38],crucial:64,content:[0,25,1,2,26,69,51,52,3,4,5,22,30,31,32,59,76,7,36,37,58,64,20,81,82,72,53,44,16,17,84,62,86,47,38,87,88],rewrit:[79,58],adjust:[30,5,71],adapt:[34,66],reader:52,got:[34,66,20,37],forth:[0,77,80,6,66],outburst:[32,16,85,20,4],cli_auth:31,barrier:[85,26],worthwhil:84,gzipbodi:27,nightmar:23,situat:[34,63,84,58],free:[62,50,7,34,71,88,30,85,20,58],standard:[84,50,86,47,8,7,48,20,58],small:[25,84,30,57,66,7,78,34,53,88,10,58,17],fret:10,spdy:[84,85,50],speedi:50,convent:[32,50],libedit:28,angl:25,haywir:63,openssl:[34,23,31],filter:[84,69,76,61,55,9,80,36,10,31,64,39],soekri:75,vcl_backend_fetch:[22,6,76,16],ish:[25,77,75,81,58],iso:[57,20,43],isn:[35,30,42,64,66],iphon:7,regress:[27,57],subtl:34,loud:34,spersist:42,user:[1,2,50,40,51,75,4,5,57,32,26,76,69,7,81,64,38,39,13,61,42,53,44,55,58,84,66,72,34,88],rang:[88,34,58],httpgarbag:51,grade:11,meet:39,independ:[79,84,50],wast:[23,58,20,50,16],rank:[8,34,75,61,55],restrict:[84,1,47,79,31,58],hook:62,instruct:[25,2,3,9,28,37,10,64,17],alreadi:[87,62,48,50,76,3,75,84,58,16,35,5,9,36,37,88,30,23,39],vug6:50,messag:[84,51,52,86,34,9,80,42,63,88,85,58],wasn:66,ditch:42,fantast:20,primari:62,vmod_director:[88,8,59,76],xid:88,rewritten:[3,61],top:[1,60,26,14,84,55,63,88,44,64,24,17],sometim:[84,51,86,78,34,9,75,64],fiction:50,sdeprecated_persist:42,master:[1,51,86,9,80,63,17,58],too:[1,75,53,66,58,34,42,28,36,71,23,20,39],similarli:58,lognam:69,critter:[84,31],john:[26,75],listen:[1,51,46,9,31,58],danish:34,murder:75,consol:[5,9],namespac:[76,64,4],signup:2,clueful:64,took:34,waster:84,tee:63,only_root:58,compressor:84,somewhat:[44,62,64,15,37],conserv:[35,64,58],wchar:58,technic:[26,57],past:[84,50,75,34,22,43,39],silli:[43,64,20,53],target:62,keyword:[76,15,67,6,68,88,64,20],provid:[87,1,26,52,3,46,62,7,86,5,9,68,42,63,44,58,59,31],expr:72,tree:[62,23,58,27,53],zero:[62,50,52,3,14,82,72,88,10,48,58],shower:34,matter:[84,2,52,43,34,59,79,28,53,20],bca3633d52607f38a107cb5297fd66e5:53,silly:20,frankli:79,"5mm":75,minut:[25,62,63,47,28,37,88,20],expected_respons:88,vanrishadm:31,mini:43,fashion:[88,44,59],websocket:[84,65,45],abov:[25,1,76,3,63,46,62,27,16,35,9,28,36,53,11,58,64,31],ran:[5,34],modern:[11,2],mind:[62,2,84,39],localnetwork:88,spent:[51,52,34,75],raw:[80,83,61,72,75],pessimist:57,manner:[30,9,58],wmiss:58,concent:57,seem:[44,79,85,84,50],incompat:[28,20,43],seek:30,minu:[23,66],recreat:58,wpointer:58,latter:62,sound:[34,50,63],client:[0,49,2,50,69,51,3,14,27,55,22,68,63,76,67,35,7,80,36,37,17,64,59,61,84,83,16,58,62,4,72,38,21,6,88,24],evalu:[51,36,47],transmit:[51,58],vrt_magic_string_end:62,simplifi:64,crippl:20,plenti:[34,64,58],though:[34,42,75,31],vmodtool:62,"0x4196af":63,glob:[61,83,14,72],object:[0,25,2,26,51,66,3,4,55,19,6,29,30,31,50,76,78,8,7,36,37,58,64,20,81,15,42,53,16,17,59,62,49,46,86,38,88,24,56],what:[0,1,75,2,50,40,52,3,43,54,55,5,28,68,74,57,87,32,85,77,34,35,7,9,80,36,81,10,58,12,20,39,13,66,72,41,15,42,53,44,17,84,62,48,63,64,46,86,38,21,88,23],supress:48,regular:[62,60,69,52,72,61,86,7,29,79,83,80,36,57,88,44,68,64,24,31],letter:20,bsd:43,objstatu:51,tradit:58,wish:34,don:[0,1,50,4,19,28,7,10,64,20,39,84,15,42,53,16,58,62,12,66,38,87,48],vcl_fetch:[22,76],doc:[88,79],alarm:66,camp:84,flow:[84,19,68,39],doe:[26,51,52,3,63,16,5,71,85,33,7,79,9,36,37,10,58,64,20,39,81,84,15,53,17,62,23,46,72,34,88,48],declar:[62,77,68,88,44,59],annoi:[20,39],wildcard:77,gzip_stack_buff:58,enclos:[88,58,68,31],unchang:3,sum:[59,37],came:[51,34,12,62,43],treati:50,busyobj_worker_cach:58,othervis:0,pragma:[64,4],pope:48,opposit:53,varnish_secret:[1,86],probe:[51,44,77,88,58],"_noreturn":20,syntax:[77,3,82,72,19,28,68,81,88,30,31,58],pipe_timeout:58,advisori:53,directli:[1,2,76,34,28,53,88,64],radio:48,pkg:28,radic:79,protocol:[84,69,51,17,58,88,48,20,31],priv:62,involv:[1,34,50,7],despit:34,submit:[1,6],layout:52,menu:79,explain:[3,81,43,53,10,39],configur:[1,2,51,52,54,16,19,28,71,30,86,31,32,76,77,33,87,73,35,8,81,10,58,64,43,44,17,5,21,88,23],apach:[8,34,69,10],stanza:[44,36],bust:9,busi:[88,36,75],phpsessid:64,painfulli:[84,42],gzip_buff:58,"0x42bce1":63,steel:20,txurl:[64,55],nasti:63,stop:[84,51,54,34,73,86,5,44,58,31],next:[13,62,40,52,66,41,4,84,77,34,57,88,48,87,20],obscur:[63,43],report:[75,63,81,51,3,33,14,72,27,34,9,74,57,10,48],txresp:27,transpir:[20,43],earn:84,bar:[62,27,53,44,64,20],ietf:[84,64,50],patch:[75,57],fals:[62,41,72,47,88,16],reload:[35,80,58],bad:[75,66,86,34,36,63,20,58],"sm\u00f8rgrav":[60,69,14,61,83,24,58],ban:[76,51,86,4,7,42,36,81,88,30,58,31],told:[1,9,57],respond:[34,16],blew:34,victim:75,pummel:77,job:[62,77,66,84,27,34,53,10,39,64,58],wstrict:58,cache_esi_deliv:9,roadmap:25,"0x40":58,nul:[88,62,68],num:83,mandatori:[88,72,18,57],result:[57,84,62,64,51,52,3,43,14,41,58,38,34,72,82,37,16,31,24,17],respons:[0,49,1,2,26,69,51,16,19,6,56,31,76,7,81,17,64,84,42,4,58,62,65,72,88],fail:[7,50,51,86,27,47,79,6,28,71,88,64,58],themselv:[53,43,31],so_sndtimeo:58,vcc_allow_inline_c:[1,76,58],best:[84,2,77,34,27,79,23,20,58],subject:[88,84,39,64,17],awar:[49,4,78,21,36,63,30,64,58],said:[11,34,50,75],hopefulli:[35,10,3,75],databas:[62,42],field_list:14,arcana:53,figur:[63,66,7,34,28,43,12,39],outstand:[83,69],finger:34,awai:[84,69,52,86,83,53,10,23],irc:[2,33,34,9,63,39],approach:[77,84,41],attribut:88,accord:[68,53,75,20,17],triplet:77,extend:[81,69,70,76,4,19,75,10,64,59],mandat:[84,43],boss:[34,54,86,81],extens:[84,11,22,62],workaround:62,wear:42,extent:[52,84],toler:57,advertis:84,kitchen:66,setsockopt:58,protect:[62,1,54,79,58],expos:35,fault:58,howev:[62,84,9,28,68,53,88,44,64,38],misguid:84,against:[0,26,54,86,72,68,67,42,29,88,58,36],futil:63,countri:38,varnishstat:[60,69,61,14,27,55,78,8,83,74,63,10,58,24,17],fileformat:79,compromis:[1,66,26],suggest:[63,75,39],host_head:88,"16k":58,foobar:[3,62],excess:[34,58],gopher:84,"16b":58,cnt_deliv:9,shortcut:[77,84,58],infirm:34,wider:84,diff:79,guid:[13,2,40,32,9,81,64,58],assum:[25,84,26,3,7,72,35,21,36,43,30,23],goodby:23,speak:[32,1],question:[84,62,2,77,41,34,81,88,10,39],trapdoor:50,coredump:58,divers:[10,43],three:[25,84,1,50,26,52,81,14,62,4,34,36,63,58],been:[87,84,26,64,52,76,14,21,73,41,34,6,42,88,10,58,12,20,39],accumul:[36,26,58],trigger:[63,37],unsubscrib:39,dlopen:[62,58],interest:[84,60,50,63,34,79,29,57,10,85,64,39],advers:30,futur:[84,50,76,66,88,39,58],vcl_deliv:[49,62,7,6,36,88],tini:34,threw:34,http_req:26,life:[57,84,50,63,66,75],spit:53,dismiss:77,worker:[62,51,52,75,46,86,58,9,36,63,10,17,31],"25g":58,telnet:[79,48,84,31],argument:[1,63,81,54,82,43,46,62,47,7,28,68,14,52,88,86,20,31],vcc_err_unref:58,implict:58,craft:7,cli_buff:[58,31],child:[1,26,51,52,86,58,9,63,10,23,31,17],"catch":50,spin:63,emploi:84,ugli:[42,20],ident:[84,76,52,63,14,77,9,53,88,44,59,58],aix:[57,43],prefer_ipv6:[86,58],servic:[32,1,48,26,81,46,58,47,35,73,63,31,39],zlib:23,commerci:[7,33,39],employ:34,calcul:[64,38,34,53,12,20,31],devicedetect:7,neat:[52,66,20],aid:33,vagu:2,alloc_seq:52,sanit:1,seven:50,fe80:[1,46],tabl:[32,84,58],elicit:50,conf:[46,71],tediou:43,"0x43ef68":63,thread_pool_stack:58,sever:[49,84,75,87,47,34,37,44,64],grown:20,vclrel:58,"80m":58,perform:[84,2,81,50,30,44,57,86,15,4,51,19,72,36,71,10,23,58],nazi:77,make:[1,75,2,26,51,52,3,57,4,55,19,28,68,71,47,31,78,50,76,34,35,79,9,37,10,58,12,38,39,87,72,41,15,7,42,53,44,16,17,84,62,63,64,66,86,20,21,88,23],transpar:[33,71],bikesh:[34,50],complex:[84,76,34,10,23,39,58],split:[76,4,21,22,63,30],vmod_dir:[1,58],complet:[83,60,76,51,61,46,86,15,6,88,23,64,58],raid:12,nil:57,nake:41,lustr:50,hang:[63,39],deflect:[34,84],hand:[75,41,34,42,43,58,20,17],fairli:11,rais:42,portal:78,evit:6,tune:[3,81,46,86,55,71,10,4],kid:[34,23,66,84],lockless:[58,53],kept:[60,61,27,78,34,83,36,30,64],scenario:[77,7],thu:[84,1,36,50,31],itself:[83,9,18,60,69,61,72,14,82,27,47,7,42,88,58,64,24,31],inherit:[88,68,26],eur700k:34,vcc_unsafe_path:[1,58],contact:[34,46],cooloff:58,thi:[0,25,1,2,72,26,69,51,52,3,43,54,27,4,55,5,22,28,59,74,71,30,47,87,31,83,32,50,76,77,33,21,73,35,79,9,80,36,37,10,58,64,38,39,40,60,14,81,61,82,15,7,42,53,44,16,70,17,57,84,62,48,18,66,63,49,46,19,86,20,34,6,88,23,24,68],mother:[34,9],gzip:[85,50,51,3,27,16,75,88,4,64,58],programm:[10,79,20],everyth:[62,3,84,55,7,9,28,57,80,23,64],legisl:84,left:[84,26,60,14,72,55,79,24],agon:34,identifi:[84,52,7,80,77,64,20],just:[0,1,75,50,52,53,55,19,57,26,77,7,9,36,10,17,12,20,39,66,84,43,44,58,62,64,46,86,59,34,48],sigusr1:[83,69],bandwidth:[3,84],via:[1,76,87,36,64,39],backend_hint:[76,7,37,88,44,59],human:34,yet:[1,23,63,34,20],languag:[62,1,2,81,69,65,41,27,20,8,19,72,76,43,88,10,58,64,38,17],previous:[30,76],easi:[10,64,20,26,63],elm:20,royal:79,must_reload:58,my_acl:47,spread:34,esi_chop:58,board:2,els:[57,62,63,3,53,86,27,7,67,9,37,88,44,23,64,38],save:[84,50,3,88,64,58],explanatori:20,transit:58,elt:34,gave:[34,43],opt:[32,58],applic:[32,2,69,14,83,16,35,6,80,37,44,64],mayb:[44,34,50],preserv:84,sanitari:66,objreason:51,donat:34,ktrace:63,vrt_ctx:62,background:[22,36,37],elabor:9,dreamt:23,lck:14,ineffici:50,apart:[66,62,64,76],measur:[10,61,58],daemon:[8,69,14,83,58],rxrequest:80,specif:[1,2,69,71,27,55,19,28,57,32,77,33,81,10,64,20,42,43,17,62,72,88],arbitrari:[44,1,80,19,38],nudg:34,manual:[32,62,18,60,69,61,81,14,82,27,47,8,83,59,63,88,10,58,24,31],pool_sess:58,instanci:88,zoop:44,remind:39,confid:1,docutil:[79,28],hung:63,uppercas:20,el6:28,unnecessari:[3,64],el5:28,www:[25,32,62,2,35,87,88,44,64,31],right:[49,40,57,75,63,50,66,43,14,34,86,84,79,53,10,62,58],old:[9,62,69,51,52,66,86,83,24,84,22,80,36,42,77,64,20,58],deal:[84,52,58,4,77,34,42,37,10,23,39],negat:[88,68,31],interv:[88,44,62,14,58],crown:43,somehow:77,dead:26,intern:[76,7,30,64,38,58],varnishd:[25,1,69,51,52,14,27,16,28,63,30,31,32,77,8,9,80,10,17,60,61,82,15,83,55,58,18,46,86,47,88,24],i686:9,heritag:84,bore:20,successfulli:[35,6,20],txt:79,cooper:[60,69,14,61,27,83,88,58],vcl_hash:[76,7,6,36,53,88,38],bottom:[79,14],establish:[52,82],fpic:58,generer:51,massiv:20,multipli:41,fog:50,condit:[2,50,3,72,9,63,88,31,58],wunus:58,localhost:[87,1,46,73,82,68,67,80,36,88,44,31,58],peek:[25,79],plu:23,sensibl:[62,75,3,43,16,57,20],uncompress:[3,16,58,4],burn:23,unreason:77,repositori:[66,28,27],post:[32,39],chapter:[32,1,9,46,58],sshd:1,http_max_hdr:58,obj:[49,76,16,7,36,37,88,58,31],smalloc:9,unfortun:[42,64,20],algo:1,commit:[77,84,50],produc:[62,69,3,84,79,6,36,43,58],commis:84,match:[69,14,56,31,77,68,80,36,64,39,60,61,83,53,44,58,72,47,67,88,24,29],net5501:75,dilemma:34,tackl:34,"float":[62,72],encod:[84,51,3,58,27,55,88,16,64,17],bound:[2,60,61,46,83,16,87,9,30],verbiag:20,down:[1,50,66,14,9,68,42,44,88,10,64],vcl_log:[51,69],resili:44,nuke_limit:58,wrap:[1,79,20],opportun:12,stall:52,storag:[62,51,46,3,81,54,84,15,16,78,52,42,58,53,88,30,55,31],often:[62,26,50,76,53,63,88,58],somedict:53,git:[66,28,75],crowd:[34,63],suffici:46,boutiqu:62,transform:[5,7,75],happi:[88,34,75,62,16],avail:[25,1,2,69,52,71,14,27,28,68,57,30,31,76,7,36,60,61,84,42,58,62,18,72,34,83,88,24],gif:[56,50,16],reli:[44,64,57],editor:[35,44,79,87,75],fraction:[34,72,58],hit_for_pass:76,overhead:[51,78,58],constantli:55,clockskew:58,fork:26,head:[84,60,69,61,83,88,64],amateur:20,form:[40,1,18,52,47,16,63,48],xabyt:58,forc:[60,50,51,77,3,61,4,83,36,88,64,58],recommend:[32,1,46,15,47,28,36,71,48,64,59,58],refcount:[51,50],hitrat:[9,64,81,58,4],vcl_all:88,hear:50,idle_send_timeout:58,heap:36,icmp:84,"true":[25,62,76,3,72,41,27,16,86,9,28,36,63,88,47,64],analyst:84,mymod:62,reset:[88,3,76,58],absent:[83,61],suspect:[9,50],full:[25,62,48,50,68,30,88,10,23],toolchest:50,bugfix:63,vcl_init:[88,44,6,59,76],maximum:[60,77,3,61,83,71,88,30,58,20,31],until:[62,50,69,77,57,41,72,73,6,36,53,48,20,58],strace:[9,63],ncurs:28,fundament:[77,10,84,2,40],autoconf:28,retir:[77,76],c_byte:52,nnn:31,classif:7,adopt:[34,84],openbsd:[11,2,57],sight:23,semicolon:68,classic:[42,58],httpbi:84,http2cfi:84,textbook:50,sale:39,diagnost:64,workerthread:58,exist:[50,69,52,76,41,7,21,43,88,30,23,38],request:[0,49,1,2,72,50,69,51,3,54,27,4,55,19,22,29,74,31,76,35,8,7,36,37,10,58,64,60,81,61,83,44,16,17,84,65,46,86,47,6,88,24],ship:19,check:[26,69,51,52,14,72,19,28,31,9,80,36,37,10,64,38,39,60,81,61,41,83,43,44,58,62,86,34],shit:75,sticki:59,assembl:[25,10,20],encrypt:1,when:[0,25,1,2,72,26,69,51,52,3,14,27,4,55,19,6,29,63,30,86,31,50,76,77,33,21,35,8,7,9,80,36,37,10,58,64,38,39,60,66,81,61,42,43,44,16,17,59,62,48,49,46,5,20,34,83,88,23,24],actor:26,til:1,role:[84,64,26,4],test:[25,62,75,18,73,51,3,57,86,27,47,8,34,72,28,36,43,11,58,17],tie:[10,87],presum:[10,20],unlimit:[30,9],wcast:58,intend:[88,68,63],benefici:71,devot:34,felt:[34,84],fell:[20,26],intent:[44,57],consid:[62,50,69,66,84,78,34,44,88,30,64,58],exp_inbox:51,warn:[60,51,61,83,42,20],receiv:[49,1,2,69,51,3,58,83,6,80,88,17,64,59,31],faster:[2,52,80,71,58,39],furthermor:[1,53],logstream:5,anywher:[84,23],exce:[64,72,58],ignor:[69,51,3,16,68,88,64,24,58],distro:57,time:[25,1,75,2,50,69,51,52,3,43,14,27,4,19,28,71,30,31,77,9,36,10,11,58,12,20,39,72,61,41,42,53,44,55,17,57,84,62,48,18,63,64,66,5,47,34,88,23],push:[52,84,53,50,31],serious:[70,50,57],backward:20,wshadow:58,stick:[48,50],vmod_set_ip_to:62,concept:[84,52,53,87,42,75,44,64],cli_timeout:58,snif:43,whoever:20,skip:[1,3],global:[88,62,74,58],focus:[88,84,39,4],invent:20,haxlw:63,shellscript:43,signific:[78,31],netbsd:[11,2,57],millisecond:[88,58,47],varnish:[0,25,1,75,2,72,26,40,51,52,3,43,54,27,4,55,5,6,28,59,74,71,30,47,87,31,83,32,50,76,77,33,21,73,35,8,79,9,80,36,37,10,11,45,64,38,39,13,78,60,14,81,61,82,15,7,42,58,53,44,16,70,17,57,84,62,48,18,66,63,49,46,19,86,20,34,22,69,85,88,23,24,68],middl:[84,75],depend:[32,33,19,7,79,72,28,63,88,30,64,17],graph:[60,55],exp_rearm:51,flash:[84,42],readabl:[88,79,62,57],"_that_":26,rel:[62,52,41,34,10,58],default_ttl:58,certainli:[62,34,63,20,57],vec:3,downtim:42,addon:64,oversight:62,sourc:[57,39,62,85,50,87,33,58,34,27,55,79,9,28,42,43,88,23,31,20,17],string:[62,59,60,69,51,3,72,61,41,58,47,7,83,68,53,88,48,64,20,31],"3am":26,vdir:[44,59],daemon_opt:73,spate:53,revalid:64,varnishncsa:[60,69,51,52,14,27,8,83,61,10,58,24,17],lru:[51,78,58],cook:66,word:[84,79,42,20,31],exact:[34,86,58],cool:[52,42,26],exp_when:51,foo:[62,72,82,27,47,9,53,88,44,64,20,31],hour:[88,34,47,39],administr:[32,1,26,46,10,12,58],level:[62,1,81,51,3,63,14,79,72,84,34,42,57,88,58],did:[85,50,26,3,57,66,72,34,42,43,48,20],die:[10,86,50],gui:50,overarch:21,shortcom:[84,20],ccf_panic:63,mystat:62,cooki:[25,62,2,81,63,84,4,56,72,29,53,10,47,64,59,31],sedimentari:84,round:[30,58,59,50,44],prevent:[1,77,84,34,36,20,58],brave:[10,28],htc:7,core:[23,9,63,58],trend:75,cache_cli:63,sign:[84,26,58],cost:[34,48,12,84,58],gzipe:3,unprotect:26,port:[40,1,18,76,51,77,82,46,7,47,35,73,9,28,84,44,88,10,48,87,58],comparis:31,pipeacct:51,appear:[88,34,84,31],cecili:[18,82],filler:20,repli:[88,12,82,58],"64bit":71,anywai:[52,34,48,77],current:[84,1,2,50,76,86,14,21,58,47,34,36,63,88,23,20,39],wors:[84,20],rephras:63,appeal:34,boost:34,deriv:34,compos:[50,39],gener:[1,75,63,26,51,70,53,14,55,6,57,31,78,76,35,9,64,20,39,41,42,43,16,58,84,62,46,86],timeout_req:58,satisfi:[1,72,34,28,57,58],kamp:[32,84,2,60,69,51,61,14,27,16,83,88,58],address:[84,1,18,76,51,52,82,46,86,7,47,35,88,67,9,68,77,61,48,38,58],along:[84,62,14,1,47,36,75,64],wait:[84,26,50,63,14,82,37,88,24,58],box:[7,84,63],buck:57,insan:23,fenc:23,volumin:50,errorhandl:63,group_cc:58,queue:[58,37],behav:[9,43,17],dusti:77,extrem:[19,34],weird:[35,41,50,57],instantan:86,transact:[0,84,60,50,69,51,83,81,61,72,27,6,9,80,68,63,17],commonli:[64,61,59,55],ourselv:57,semant:88,love:[62,34,66,20,57],humour:64,extra:[7,42,76,58],tweak:[3,28,50,15],modul:[1,26,76,62,47,8,42,10,88,44,59,58],prefer:[84,77,86,68,53,11,64,58],marker:[88,62,84],instal:[32,62,33,46,35,87,9,28,11,58],smallish:53,mobil:[44,7,84],"0x42f838":9,transplant:34,regex:[61,83,80,36,88,24],memori:[1,26,69,51,52,16,5,71,30,78,8,9,80,10,60,61,82,83,53,55,58,62,72,47,88,24],subvert:26,franca:79,visit:35,todai:[42,66,50],subvers:1,everybodi:[58,63,39],live:[57,66,34,4,79,42,36,43,88,30,58,64,39],handler:58,"417a":48,criteria:[84,72,38,56],scope:88,angri:20,reorder:7,twitterif:36,fridai:34,afford:53,peopl:[1,75,63,50,76,77,57,66,84,34,42,36,53,48,64,20,39],claus:37,finit:50,clue:9,suckag:[48,85],drown:39,foon:31,prototyp:[84,62,47,34,59,58],examin:[84,52,3,86,63,88,58],exp_expir:51,effort:[84,50,34,42,57,23,20],easiest:[64,86],fly:[84,86,16,58,64,31],graphic:79,car:34,prepar:[88,10],pretend:87,focu:[34,2],cat:[50,31],descriptor:[51,62,63,58],hardest:62,whatev:[84,1,50,52,62,86,36,63,64,58],purpos:[87,41,15,47,73,6,36,44,64,58],materi:[34,20],problemat:84,heart:28,favourit:50,sourcefil:31,stream:[50,51,3,5,7,45],predict:[72,50,53],slightli:[52,3],"1980i":[62,17],wnest:58,backslash:[72,14,68,31],agent:[69,61,72,55,7,88,44,4,64],topic:[40,34,48,80,39],heard:[34,57],critic:[34,84],abort:[23,38],"14b":63,hash_always_miss:[88,36],recycl:53,simul:[63,27,17],occur:[61,55],alwai:[84,62,63,26,69,3,57,66,86,27,16,34,72,15,53,88,58,20,31],multipl:[62,14,81,46,86,77,19,83,88,52,61,44,24,58],oslo:75,charset:76,ping:[58,80,31],uptim:14,write:[2,50,69,52,27,5,57,30,31,26,77,79,80,36,10,12,20,42,43,58,62,34,83,23],anyon:57,fourth:79,swore:34,parameter:82,fetch_bodi:51,map:[62,50,52,7,44,12],product:[37,46,34,79,57,58],ban_lurker_sleep:[36,58],book:[12,34,42,75,64,20],max:[51,9,64,60,58],clone:28,timedout:20,spot:[84,79,20,26,39],usabl:[77,20,63],intrus:[57,39],mac:[48,57],mad:43,mai:[1,69,57,14,6,28,68,63,30,76,7,17,20,39,61,41,83,53,58,62,23,46,34,85,88,48],shuffl:[0,6],suck:79,data:[0,50,51,52,63,6,75,30,31,26,78,8,9,80,64,20,41,83,53,44,58,62,72,38,88,23],grow:[23,58],repeat:[84,14,58],accessori:57,repo:28,stress:[34,20],autotool:28,practic:[84,26,3,79,34,20],mgr:26,disabigu:77,secur:[84,1,85,81,26,46,53,54,86,15,34,30,10,58,39],ideolog:34,mangl:64,inform:[2,69,51,14,55,5,28,63,76,77,9,80,64,39,60,61,83,53,44,58,84,88],"switch":[62,76,77,58,5,15,86,19,6,10,31,79],wrt54g:57,combin:[8,72,69],block:[51,9,14,68],anoth:[84,62,26,77,3,43,46,19,58,7,34,36,53,88,10,48,64,20,17],talk:[62,50,77,16,79,88,10,48,31],shield:37,virtualis:71,brain:34,ttl:[25,76,51,64,58,27,4,36,37,88,30,47,15,56],clock_skew:58,still:[25,84,1,75,63,50,43,86,7,34,9,36,42,53,64],pointer:[62,51,77,47,8,20,58],dynam:52,entiti:62,snippet:[7,64],vtc:[28,27],group:[1,60,69,61,84,72,8,7,83,68,88,44,48,20,58],thank:[66,34,2,50,57],polici:[25,84,2,77,86,88,10,39],torn:66,norwai:[79,34],unambiti:20,instantli:[10,62,86,77],platform:[57,40,2,33,35,79,9,71,85],window:[51,44,11,80,88],monopol:58,curli:[88,68],mail:[33,2,39],main:[84,50,51,81,63,10,39],limbo:42,do_gzip:[88,3,16],non:[25,62,2,81,69,43,82,72,79,42,57,58],synopsi:[18,60,69,61,14,82,27,47,83,59,24,58],ban_lurker_batch:58,set_health:31,losthead:51,smarter:[79,7],rake:[34,85],objprotocol:51,initi:[84,1,50,69,51,62,83,72,6,68,42,88,59,58],nation:34,underneath:84,safari:7,half:[79,34,58],now:[25,75,2,50,40,3,43,14,73,28,29,57,76,77,87,35,79,9,80,37,64,20,13,41,42,53,44,84,62,23,66,86,47,34,88,48],discuss:[2,86],nor:[62,84,24,68,88,16,20,58],introduct:9,wont:[34,9],wagon:43,term:[84,53,34,57,10,17,64,58],workload:15,polish:50,name:[69,51,52,14,27,68,30,31,76,77,10,64,60,61,82,15,83,53,58,84,62,46,72,67,88,24],realist:[66,53],opera:20,config:[44,62,58,28,45],drop:[34,58,14,39],crypto:[84,23],separ:[62,26,46,61,84,83,72,22,23,64,58],pcrepattern:64,careless:48,between_bytes_timeout:[88,58],polit:26,backendclos:51,failov:10,domain:[88,19,84,26],replai:[8,18],replac:[84,50,76,37,35,43,88,48,58],individu:[25,62,51,72,31,58],continu:[40,60,61,14,27,24,34,6,58,88,55,64,20,31],ensur:[10,3],vcl_trace:[51,63,58],"0x8006b51c1":63,sponsor:[34,42],year:[84,50,66,34,47,79,75,88,20],operand:72,happen:[50,70,3,63,75,26,76,79,9,36,37,10,64,59,60,61,62,83,58,84,66,34],disturbingli:75,shown:[34,62],accomplish:64,libjemalloc:28,space:[76,14,72,58,78,34,42,80,88,30,48,31],repetoir:41,max_retri:[6,58],stupid:[77,1,26],pagedown:14,rational:64,internet:[34,48,26],ironi:[75,63],bla:50,correct:[64,20],varnishlog:[83,18,60,69,51,61,14,27,4,8,5,9,80,63,10,58,64,24,17],monster:20,state:[62,77,47,42,88,31,58],migrat:77,million:75,libpcre3:28,theori:[3,38,53],ebcdic:17,org:[32,62,2,87,84,27,55,35,79,28,75,88,58,64,38,39],"byte":[0,84,69,51,3,58,6,53,88,30,23,31,24,17],rfc1884:48,vcc_if:62,care:[62,2,57,34,28,53,44,48,64,38,17],reusabl:[88,68],funki:66,wai:[1,75,26,52,63,57,77,8,7,9,80,36,70,64,20,53,39,81,82,46,43,58,84,62,23,66,86,38,34,48],badli:[34,64,84,16],waiter:58,dunno:1,synchron:58,modest:34,honest:[34,50],motion:50,thing:[1,50,3,63,16,5,75,26,77,78,10,64,20,84,43,44,58,62,66,86,34,23],place:[62,37,66,9,36,53,48,39],router:[88,84,67,68],vcl_backend_repons:49,principl:12,imposs:50,frequent:[64,6,61,58],first:[1,50,69,51,70,3,75,54,4,73,63,31,59,76,34,78,79,9,80,36,37,10,12,20,39,87,81,61,84,83,53,44,58,62,23,64,46,72,47,38,21,88,48],oper:[1,26,51,52,71,5,28,68,63,30,31,76,10,64,41,82,42,43,44,58,46,72,67,88,29],redhat:[33,71],carri:[78,23,64,26],onc:[32,62,81,66,63,61,86,73,77,5,9,28,36,42,37,10,59],arrai:[42,53],housekeep:62,wedg:63,potentialiii:84,fetcher:58,textual:84,waitinglist:[51,58,71],oppos:5,open:[1,50,51,52,57,28,63,30,31,77,87,9,10,39,62,44,58,84,46,34,88,85],predefin:7,size:[84,75,60,50,69,51,52,53,54,20,78,8,7,9,36,71,30,81,58,24,31],given:[84,61,82,72,14,41,27,47,83,77,30,59,31],sheet:23,silent:52,teenag:75,mailman:39,autocrap:[85,43],caught:9,sessclos:51,traction:84,necessarili:9,cassett:48,white:[72,58],conveni:[62,86,39],get_lock_befor:20,friend:[34,76],amonst:58,arith:58,cope:50,copi:[1,3,37,58,62,43,7,34,53,88,45,64,39],circumst:[42,26],specifi:[1,69,14,27,6,68,30,31,78,10,20,60,61,82,83,58,62,18,46,42,88,24],qual:58,"short":[0,65,15,9,30,58],vcl_backend_error:[0,51,6,88,76],packet:[84,20],mostli:[52,58,64,39],quad:58,grunt:12,than:[1,75,2,26,69,52,3,63,16,6,28,71,30,50,77,79,80,36,10,11,20,39,66,72,41,15,82,42,43,58,84,23,46,86,34,83,48],png:[3,86,36,56],serv:[35,84,78,2,59,69,46,86,47,6,7,22,36,39,37,44,17,64,38,31],wide:[84,64,71],sess_workspac:76,slt_vcl_log:47,posix:[20,43],balanc:[84,87,5,53,88,44,23,59,17],were:[84,62,18,76,82,86,24,34,43,85,12,20],posit:[51,84,20,72],yesteryear:84,surrog:64,browser:[3,35,79,80,64,38,17],pre:[10,1,30],lowest:41,sai:[1,50,26,3,63,84,20,34,29,53,44,48,64,38],cnt_session:9,nicer:20,vcl_string:62,ani:[1,26,69,51,52,3,63,16,5,6,56,57,30,31,32,50,76,77,34,7,9,36,10,58,64,20,39,61,84,83,53,44,55,17,62,72,21,88,68],slap:52,subroutin:[70,19,6,68,81,88],relativli:4,"20g":36,deliv:[0,49,84,75,2,76,51,3,57,7,58,16,34,6,36,37,88,4,64,17],exclud:[83,61,24,69],saw:[34,12,20],worst:[51,34,43],reqacct:51,engin:[88,7,23,58],squar:[75,58],advic:46,berequrl:51,destroi:[66,20,58],offer:[84,1,86,7,10,39,20,58],note:[25,40,84,76,64,3,33,86,16,68,88,70,28,29,71,44,30,47,12,59,58],schmocument:79,"_end":63,take:[75,50,52,57,4,19,28,68,63,30,47,34,79,36,10,64,20,84,58,62,86,38,21,88,23],noth:[62,77,66,34,39,59,58],channel:[45,33,2,26,39],begin:[63,60,51,53,61,72,83,6,43,88,44,20,58],sure:[2,50,52,3,57,16,63,31,71,26,76,77,35,7,9,17,64,39,84,15,44,58,62,66,34],importantli:53,trace:[51,9,66,63,31],normal:[51,3,41,7,4,34,6,80,75,47,64,24],buffer:[30,48,72,58],reqend:72,knowingli:34,compress:[81,51,3,75,16,53,88,4,58],paid:34,server1:44,exclus:14,varnishs:[8,24],abus:84,rsh:84,copy_of_varnish_secret:86,homepag:75,gunzip:[51,3,27,58],latex:79,renam:[52,62,42,76],pcre_match_limit_recurs:58,esi_syntax:25,drive:[30,34],"0x4193f6":63,varnishtest:[8,27,17],runtim:[62,58,14,60,71],eur10:34,patchlevel:64,translat:[35,88,19,48,31],shop:39,backendreus:51,show:[25,50,51,63,14,27,55,75,31,79,35,7,9,80,17,64,60,72,82,15,43,58,86,24],cheap:[78,58],merit:52,n900:57,permiss:[10,9,31],hack:[28,84,2],threshold:[51,44,88,58],corner:[84,60,24,26,55],trow:34,boom:63,fifth:79,ground:50,xml:[25,58,14,81,17],onli:[25,49,1,75,26,51,52,3,63,14,27,16,6,28,71,30,50,76,77,7,78,79,9,80,36,37,11,58,64,20,39,72,61,82,15,42,43,17,84,62,48,18,86,34,83,88,23,24],slow:[58,66,47],ratio:36,stair:66,esi_ignore_http:58,dick:84,activ:[25,84,1,77,3,63,62,16,78,86,80,57,10,58,31],get_lock_tim:20,carrag:31,wood:75,rexec:84,analyz:[64,55],summertim:50,analyt:64,analys:[84,12],offici:[35,42],overwritten:[83,80,24,69],nearli:34,variou:[84,1,2,18,26,64,3,19,4,5,9,30,58,12,31],get:[1,75,2,26,69,52,3,43,14,16,19,6,28,59,57,86,31,32,50,76,77,33,87,7,9,80,36,37,58,64,20,39,40,60,66,81,61,84,15,42,53,44,17,62,48,63,46,5,38,34,83,88,23,24],stomp:52,auto_restart:[86,58],ssm:[27,58],ssl:[23,85],cannot:[84,1,2,50,26,76,3,62,79,68,53,23,20],ssh:[84,1,26,52,86,82,48],ssd:42,geo:84,harsher:34,requir:[1,76,86,58,80,36,53,88,44,31,39],truli:[77,84],reveal:34,seldom:36,dramat:25,berespprotocol:51,sidewai:12,priviledg:26,draft:[84,20],through:[1,2,51,52,3,14,19,6,68,63,31,32,73,9,36,10,58,64,20,39,13,15,53,45,46,5,23],where:[1,2,50,51,52,63,14,72,19,57,30,87,31,76,77,33,7,79,9,80,12,20,13,66,61,84,43,44,58,62,64,46,86,38,34,23,24],vision:84,summari:[82,74,75],wiki:[84,2,79,31,64,39],kernel:[1,52,71,63,23,58],aquaeduct:20,surgeri:66,workspace_backend:[62,76,58],shm_reclen:58,seal:30,sport:84,wonder:[66,34,75,12,53],youself:1,detect:[81,19,43,7,71],review:34,enumer:84,label:[51,84,47],behind:[84,50,7,57,64,39],between:[62,60,26,76,51,61,3,14,82,58,20,34,83,80,77,88,10,47,64,24,17],"import":[49,1,50,63,54,68,75,26,76,77,20,81,64,59,41,44,58,62,46,86,47,88,23],engang:34,tcp_keepalive_:71,across:[88,1,84],assumpt:50,parent:[51,34,9,58],screen:[7,60],pool_req:58,style:[10,31,17],cycl:[23,14,16],jobb:64,sessopen:51,refman:1,come:[49,1,46,63,4,56,75,9,80,10,64,20,61,84,15,42,53,44,55,62,66,83,48],tue:9,beliv:34,sketchi:84,quiet:[57,27,39],contract:34,emit:[51,6,31],audienc:34,tutori:[13,40,32,35,87,28,81],"80013339a":63,mani:[57,84,62,2,66,51,52,53,46,82,27,34,9,30,88,10,23,64,20,58],clf:69,evict:[51,78,36],acceler:[32,8,87,44,31,64,58],displai:[60,69,51,61,14,55,8,83,80,58,24,31],overview:[51,8,72],inspir:34,period:[60,52,61,72,14,88,58],pole:39,featur:[13,84,2,77,75,16,34,42,80,37,58,20,39],colon:[48,72],toupper:[62,47],typic:[49,32,2,18,3,53,7,6,28,30,10,39,17],karstensen:[88,14,2],poll:[77,55,88,44,20,58],damag:[1,48],libvarnish:31,sess:[51,14,50],"0x8006b8b76":63,segfault:[70,9,81],stretch:41,invert:72,fritzvold:[18,82],mark:[60,51,52,61,58,47,68,83,36,75,88,44,55,24,31],resphead:51,varnish_nam:[14,24],listen_address:[46,1,54,58],addit:[77,84,2,20],surplu:34,hitpass:51,avian:79,repons:[31,58,17],"80013822c":63,reaction:50,thousand:[63,37],resolut:[10,34],drawer:48,doxygen:79,doesn:[25,84,72,47,81,79,16,20,34,9,80,68,42,43,30,23,64,38,31],workspac:[62,63,58],those:[1,2,50,66,72,14,62,86,35,77,34,42,57,23,64,20,39],"case":[1,50,51,3,53,16,57,31,76,79,7,64,20,43,58,62,46,72,47,34,88,24],myself:[88,34,68,26],hdr:27,ungzip:3,tinderbox:57,"40gbit":84,trick:[26,7,44,48,20,39],admin:[5,64,26],invok:[36,31],outcom:84,familiar:64,invulner:1,reenter:30,invoc:43,margin:[84,23,26],advantag:42,stdout:[1,14,82,58],metric:10,canon:23,undercut:34,worri:[1,50,34,42,28,75,48],cluster:[44,34,42,87],bias:34,pthread:[20,58],reqmethod:51,telescop:34,ascii:[1,48,26,17],kettl:42,add_backend:[88,44,59,76],subscrib:[10,79,52,26,39],develop:[83,40,84,2,60,69,61,75,14,27,20,34,9,42,57,88,58,24,39],contriv:62,author:[1,26,50,84,4,64,58],respstatu:51,tour:5,same:[1,2,26,69,52,3,14,27,6,57,30,31,50,77,35,7,80,36,37,64,60,61,82,83,53,58,84,62,18,46,86,47,22,88,48,24],trip:[50,63],binari:[18,60,61,79,19,83,28],epoch:[51,88,62],html:[25,50,3,75,7,79,53,17],pad:63,sentenc:39,pai:[34,75,39],document:[50,69,51,63,14,27,16,6,68,57,31,32,79,81,39,60,61,82,83,44,55,58,84,62,18,72,47,34,88,24],medit:[9,6,81],arcitect:84,vmod_tolow:62,week:[88,34,75,66,47],exhaust:51,finish:[51,75,82,58],webserv:[50,46,75,48,64,17],see:[25,2,26,69,51,66,3,14,27,16,19,28,56,63,47,31,50,76,7,35,86,9,80,36,64,20,39,60,61,82,83,44,55,58,59,84,62,48,18,46,5,38,34,88,23,24,68],rxresp:27,assist:12,driver:26,ness:3,weed:84,director:[76,8,19,81,88,44,59],capabl:[3,9,65,79,59],improv:[84,34,22,20,81],extern:[10,58],immedi:[39,64,58,31],defi:20,spend:[50,51,63,16,34,71,39],stdin:[1,82,86,58],vtailq_next:20,supdup:84,appropri:[25,35,28,64],all_added_weight:59,choos:[28,12,59,44],patchwork:75,macro:[20,27,43],page:[25,69,14,27,30,31,32,7,78,20,79,9,80,36,37,64,38,39,40,60,61,82,83,58,84,18,47,88,24],without:[1,50,69,3,63,72,28,57,31,77,36,10,12,20,53,39,82,83,43,84,62,86,34,42,88],sigsegv_handl:58,model:[84,26],roughli:[1,63],summer:[85,50],affair:12,abund:46,execut:[1,59,51,77,19,47,5,6,36,63,88,10,86,64,38,58],resp:[49,62,76,51,27,7,36,88,58],bitmap:20,gdb:9,kill:[84,26,50,51,63,58],multiplex:50,aspect:[10,23,20],touch:[40,34,58,2,52],monei:[34,42,53],listelm:20,speed:[30,84,63,2,32],mebibyt:30,http_resp_hdr_len:58,blow:74,ixslvvxrgkjptxmcgnnsdxsvdmvfympg:31,downright:50,europ:39,struct:[51,62,53],hint:[88,5,34],mmap:[30,58],korken:64,except:[72,67,36,88,30,48,64,68],littl:[84,78,34,63,20,58],blog:32,"255b":58,pile:[84,23,75,39,37],exercis:35,tarreau:84,vulner:[34,39],session_ling:76,real:[62,2,59,50,63,41,47,55,34,57,88,10,17,20,39],psk:[10,1,31],around:[1,75,63,81,57,54,86,16,34,53,48,12,58],libm:43,secreci:1,read:[49,1,50,40,51,52,3,55,5,28,68,63,31,32,26,76,69,79,64,13,60,61,82,15,42,58,84,62,86,47,83,24],rfc2616:50,dark:10,esi_level:[88,3],traffic:[62,50,75,18,26,44,63,19,84,8,5,80,71,10,58,64,59,17],mon:62,loos:42,world:[84,35,23,64,20,39],unsign:[62,53],dare:43,tolow:[62,47],towel:66,stranger:34,whitespac:[64,58],vcl_dir:[1,58],mgt_param:58,exploit:26,integ:[62,72,47,42,53,88,31],server:[0,25,2,26,27,16,19,29,75,31,32,50,76,79,80,37,11,58,64,38,39,40,81,42,53,44,4,17,84,18,49,46,59,87,88,24],benefit:[34,42,12,84,57],shmfile:9,either:[32,62,60,50,76,77,3,63,46,82,72,79,6,68,43,88,30,11,64,20,58],output:[25,32,62,69,51,61,3,63,14,7,83,77,79,9,53,58],strcmp:63,reqprotocol:51,fulfil:84,"0x8006b4307":63,thermodynam:53,handshak:23,authent:[1,82,5,31],respect:[84,50,76,52,3,34,81,64],intact:25,basic:[40,59,50,77,81,7,47,6,19,9,80,68,57,88,64,20],whould:84,shmlog:58,micro:43,freebsd:[57,84,2,63,14,33,46,27,34,83,28,71,11,23,39],definit:[88,77,42,27],token:31,legal:[57,47],moon:[25,12],exit:[60,26,69,52,14,86,83,82,6,61,24,58],"128kb":58,notabl:[3,84],overli:64,ntpd:20,refer:[32,62,69,51,58,84,27,68,8,79,36,81,44,39,64,31],needlessli:58,immun:53,timeout:[60,61,82,83,88,44,20,58],power:[1,60,19,36,48,58],garbag:[20,50],inspect:[15,9,36,44,48,31],hexdump:31,fulli:[44,50,53],regexp:[62,31],getnameinfo:48,"throw":[84,77,86,34,36,53,23],src:[25,27],deflat:[51,3,64,84],y2k:58,central:[34,1,22,79,26],coupl:[66,41,55,5,9,28,34,7,64,39],drag:50,greater:[34,85,66,72],acl:[1,51,65,67,36,88,68],chop:58,eur90k:34,degre:[1,2],intens:58,stand:[79,23,84,50],act:[64,24,57],industri:34,rebuild:66,road:[66,50],xnn:31,stevedor:[88,75],outlook:34,bom:58,effici:[84,77,3,16,52,58],paypal:34,surviv:[30,50,58],inbox:51,counterintuit:7,your:[0,25,1,2,50,66,43,54,4,55,19,28,68,71,30,47,31,32,59,76,77,7,35,79,9,80,36,70,10,12,38,39,87,78,81,84,42,53,44,16,17,57,62,63,64,46,73,20,21],stare:[50,53],"14f0553caa5c796650ec82256e3f111ae2f20020a4b9029f135a01610932054":53,log:[0,1,26,69,51,52,75,14,27,55,5,74,63,76,8,79,9,80,70,10,17,64,39,13,60,81,61,42,58,18,72,47,83,88,24],area:[78,84,14],aren:64,hex:[10,31],overwrit:[52,83,80,69],start:[25,1,75,2,50,69,51,52,63,54,27,72,5,68,71,30,31,32,26,73,35,9,80,81,10,58,64,40,60,14,61,42,44,17,84,66,46,86,87,83,88,23,24],compliant:[84,57],mindless:[79,26],interfac:[1,82,81,54,62,86,8,42,36,43,10,58,31],low:[30,58,26,53],lot:[50,3,57,55,19,28,68,63,76,78,9,36,64,20,41,53,44,84,66,72,34,48],ipv6:[84,85,77,46,86,48,58],submiss:34,hen:[75,2,50,69,51,53,14,27,16,57,32,26,85,77,79,12,20,60,61,41,42,43,58,84,23,66,34,83,88,48],machin:[1,77,46,86,35,9,88,10,48],hei:66,unam:43,ago:[77,9,50,75],hard:[57,84,1,81,50,43,62,15,9,53,30,58],relic:43,verbatim:69,enough:[62,77,63,66,34,42,53,20],conclud:34,bundl:58,regard:57,sighup:[83,69],amongst:[20,43],client_conn:14,decend:57,cryptograph:[1,53],buggi:58,categor:63,conclus:[77,34,84],longer:[32,50,76,82,15,4,36,20,58],notat:77,hire:34,fraud:75,possibl:[1,2,26,52,3,75,43,6,68,57,31,71,76,77,7,9,10,17,12,39,53,58,46,34,88],"default":[1,2,69,51,3,14,4,73,28,71,30,76,35,7,9,37,64,38,60,72,61,84,15,83,53,44,16,58,62,46,86,87,88,24],bucket:58,exp_kil:51,monopoli:26,deadlock:88,expect:[51,52,57,34,27,35,79,53,88,64],gone:[1,76,21,42,36,10,58],ohh:[84,66,20],unreferenc:58,creat:[25,49,1,26,52,3,14,27,55,6,56,30,76,7,45,64,59,60,17,15,58,84,67,88,68],certain:[25,1,51,33,84,15,4,19,36,88,44,58,64,59,56],strongli:[1,84],intro:[30,54],decreas:[72,58],some_filenam:86,file:[25,1,75,63,26,69,51,52,3,43,54,27,16,19,57,30,31,7,73,8,79,80,58,20,39,60,61,82,42,53,44,17,62,18,46,86,47,87,83,88,23,24],legacy_broken_cm:64,proport:57,fill:58,workdai:79,again:[40,26,77,66,86,73,34,9,42,10,39,38,17],collid:20,googl:[64,50,75],binocular:12,hybrid:84,prepend:[31,16],field:[84,60,69,51,52,14,72,58,88,34,61,48,20,31],valid:[36,50,72],compet:12,copyright:[32,18,60,69,61,14,82,27,47,83,88,58,24,31],writabl:88,you:[0,25,1,75,2,26,40,51,52,3,43,54,4,55,5,6,28,59,71,30,47,87,31,32,67,50,76,77,33,21,73,35,79,9,80,36,37,10,11,45,12,38,39,13,78,66,82,81,41,15,7,42,58,53,44,16,70,17,57,84,62,48,63,64,49,46,19,86,20,34,85,88,23,68],architectur:[32,84,2,50,47,20],sequenc:[69,72,31],symbol:9,listen_depth:58,ansi:43,briefli:86,track:[62,50,41,9,39,64,58],http_front_end:86,z_ok:9,pool:[77,58],reduc:[25,4,7,42,71,30,58],assert:[9,20,63],escal:58,neuter:79,directori:[1,62,27,35,8,29,30,58],invest:34,descript:[59,62,18,60,69,51,61,82,14,86,27,47,34,15,88,58,24,31],slt_error:64,fuse:34,tricki:[78,52,63],mass:84,potenti:[1,37,84,72,7,6,63,88,58,39],escap:[69,9,14,72,31],invoic:34,degrad:6,cpu:[20,23,36,58,16],unset:[76,3,36,7,56,88,10,64,29],logarithm:[24,60,55],represent:[77,62,24],all:[25,1,75,63,26,69,51,52,3,43,27,16,6,29,57,30,31,50,77,78,7,9,80,36,37,10,58,64,20,39,60,66,72,61,84,15,42,53,44,17,62,46,86,47,34,83,88,48,24,68],usd15:34,consider:21,lack:[34,64,84],standardis:20,month:[34,75],mp3:16,abil:[77,30,34,37],follow:[26,69,14,27,16,6,28,68,63,30,31,76,35,7,9,36,37,11,58,64,39,60,81,61,83,45,18,72,87,88,24],disk:[34,5,80,71,30,58],children:66,vcl_void:62,mathisen:[27,58],default_keep:58,spectacular:39,catastrophi:42,discard:[62,51,77,86,6,36,44,30,64,31],articl:[25,34,7,53],tail:[83,61,60,69],program:[1,26,69,51,57,54,27,55,5,63,8,79,80,10,17,64,20,60,61,41,83,58,62,86],solicit:34,scratch:[84,76,50,63],neglig:19,introduc:[52,47,16,53,44,48],"4d45b9544077921575c3c5a2a14c779bff6c4830d1fbafe4bd7e03e5dd93ca05":53,fax:34,liter:79,parcel:47,far:[25,84,48,50,57,34,53,23,64,20],secret_fil:82,faq:23,buer:[18,14,82,47,83,88,24,31],offlin:30,ouch:42,util:[32,18,60,69,61,14,82,55,83,47,24],candid:[51,6,57],mechan:[88,52,1,36,20],failur:[72,27,58],veri:[25,1,50,63,55,5,22,57,30,26,77,35,79,10,64,20,39,41,42,53,58,84,62,47,34],ticket:[34,9,63,33,39],fan:50,unalt:6,"0x80":58,colleagu:34,binheap:51,random:[32,1,85,59,47,75,16,79,53,44,4,38,39],emul:59,sane:15,sma:52,node1:88,expban:51,enterpris:[35,73,33,71],ten:[60,50],tea:28,sync:42,tex:79,syslog:[1,70,47,9,63,58],biolog:50,design:[84,1,26,50,62,86,53,88,10],pass:[0,62,69,51,3,76,82,16,6,56,57,88,58,64,17],further:[1,72,6,7,9,68,39],heartble:34,dial:88,sub:[25,51,70,3,27,16,56,76,29,7,36,37,10,45,64,59,53,44,58,62,38,67,88,68],clock:[10,34,20,58],section:[40,63,21,44,33,54,19,4,5,9,28,68,74,71,10,81,47,87,59],advanc:34,abl:[57,62,1,63,50,26,82,53,66,5,15,86,84,79,42,71,23,20,58],delet:[55,64,29,58,31],version:[25,1,2,69,51,3,14,28,71,32,76,7,79,11,17,64,60,61,84,83,43,58,62,18,88,48,24],time2r:47,deepli:[34,84],"public":[87,64,50],movement:26,cookie1:64,hasn:58,cookie2:64,hash:[0,85,59,60,76,51,81,24,19,6,36,53,88,55,38,58],variat:64,unmodifi:16,sessionclos:51,decid:[1,2,26,66,78,34,6,42,48,64],behaviour:[25,2,15,16,21,4,17],modular:50,http_resp_siz:58,solari:[57,11,43,2,71],trunk:66,recompress:16,method:[62,69,51,76,1,7,67,22,28,36,88],strong:1,modifi:[49,62,3,72,1,16,7,6,81,86],legend:[51,53],valu:[72,62,59,60,69,51,43,14,84,58,16,55,76,6,68,71,88,47,24,31],search:[32,39],ahead:50,ixslvvxrgkj:31,newlin:[88,68,31],prior:71,amount:[78,30,3,84,58],reqstatu:72,action:[0,62,19,36,81,88,44,64,56],narrow:[42,41],magnitud:2,lurker:[36,58],shorthand:58,primit:62,vcl_return:51,"while":[25,62,1,75,84,51,63,66,21,7,16,78,34,22,28,37,30,20,39],filenam:[1,60,69,61,14,62,83,79,42,31,58],href:25,famili:[53,66,39],sanction:48,suddenli:[77,34,57,37],acceptor_sleep_decai:58,select:[69,51,14,76,61,72,83,20,58],aggress:36,ear:39,hexadecim:31,ripe:84,distinct:[62,76],ctrl:14,regist:84,two:[1,2,46,3,63,27,22,28,75,77,37,10,64,84,42,53,44,17,62,66,86,34,88,48],formul:39,taken:[84,69,52,66,28,29,31],md5:53,minor:[58,57],more:[1,2,26,52,3,43,27,16,28,59,71,47,31,50,76,79,9,80,10,64,20,39,13,66,41,42,53,44,55,58,84,62,63,46,86,38,34,88,48,68],reachabl:1,precompil:62,flaw:[84,26],desir:[34,7],openvz:[33,71],tumbl:66,hundr:39,mozilla:[7,64],flag:[62,51,14,54,47,88,10,58],vxid:[60,69,51,61,72,83],broke:20,particular:[62,50,52,3,84,47,34,22,28,36,77,88,31],known:[32,50,69,46,71,48,12,20],compani:[34,43,86,20,39],doom:20,cach:[0,25,2,72,26,69,51,70,3,75,54,27,4,19,6,28,63,30,86,31,32,50,76,77,35,8,7,9,80,36,37,10,58,64,38,40,78,14,81,84,15,42,44,16,17,62,18,49,46,5,47,87,88],none:[84,46,72,79,20,58],endpoint:[51,84,58],thread:[9,62,63,76,51,52,71,46,27,55,77,22,80,36,37,58,20,39],valuabl:63,hous:[66,20],outlin:68,dev:[1,9,28,39],histori:[18,60,69,51,61,72,14,82,27,47,8,83,88,58,24,31],remain:[25,51,88],rfc5952:48,nine:23,caveat:[1,63],learn:[1,84,39],abandon:[60,69,52,14,83,79,6,57,61],pick:[1,51,87,36,57,85,64,59,39],userbas:57,typograph:79,prompt:26,bogu:51,scan:69,challeng:[1,62,31],share:[1,60,26,69,51,52,82,72,61,62,20,55,8,9,80,77,88,10,47,24,58],accept:[1,3,14,86,27,16,58,88,55,64,17],firmli:50,minimum:[30,58],sharp:84,pong:80,varnishsoftwar:64,huge:[23,20,37],cours:[26,75],ixsl:31,freshli:[62,36],divid:41,rather:[84,69,63,66,41,83,79,9,34,43,23,31],stig:[27,58],comfort:28,nostdreturn:20,fame:53,divis:10,heck:[20,75],fed:[5,34,53],reject:[88,68],reviv:42,simpl:[25,1,63,84,68,7,6,36,44,10,58,64,20,31],css:50,unabl:[88,68],idioci:20,absentmindedli:12,resourc:[62,51,84,42,71,10,58,39],penetr:84,referenc:[10,62,58],unprivileg:58,variant:[84,6,64,36],sneak:84,time2integ:47,unlink:30,stabil:84,resons:58,github:7,coax:50,postfix:36,confus:[75,48,63,20,41],proto:[88,50],fulltim:64,dragon:70,caus:[84,63,71,72,34,9,53,30,12,58],thread_pool_max:58,wrench:[10,50],tangibl:84,dream:23,sysctl:71,help:[86,47,63,72,26,51,52,82,33,58,34,27,41,84,5,9,36,71,10,39,31],max_ag:58,erod:34,soon:[42,66,71],radar:84,berespstatu:[51,72],dough:[34,85],hierarchi:72,suffer:[84,64],paramet:[25,1,26,51,52,3,71,54,16,28,63,30,31,32,76,7,9,36,81,17,64,82,15,58,46,86,21,88],typedef:62,"384b":58,render:[25,76],nifti:55,brows:20,wrk:14,late:[62,75],harmless:48,rapidli:20,astonish:50,bypass:64,might:[13,84,78,64,53,16,35,20,79,9,28,36,42,37,44,12,38,58],alter:[25,2,65,16,19,6,56],epol:[9,58],wouldn:[1,20],ant:[88,7],good:[84,1,85,51,53,66,62,58,86,34,9,42,71,88,23,64,20,39],"return":[0,51,16,6,68,31,76,20,7,36,37,45,64,59,17,82,53,58,62,86,47,38,67,88,48],authorized_keys2:26,timestamp:[51,47,14,36,31],uhm:68,libwww:64,detour:58,framework:76,somebodi:[12,20,43],barbarian:12,complain:34,bigger:[30,84,58],eventu:[84,6,48],pkgconfig:28,quoted_vclstr:31,troubleshoot:[10,9,81],txheader:64,userid:31,unlik:[84,63],refresh:[22,64,36,60,37],caseless:[83,61,60,69],easili:[34,64],achiev:[9,64,81,4],"0x416a70":9,"1tbit":84,khtml:7,ceas:64,dialin:[67,68],backtrac:[9,63],phamplet:34,truncat:[30,58],subsystem:34,n_lru_nuk:78,mental:35,send_timeout:58,needless:[26,53],bereq:[25,49,62,56,76,51,3,58,27,16,7,36,88,47,64,45],set_ip_to:[62,47],monoton:20,idea:[13,62,2,51,3,75,86,58,34,43,23,12,20,39],procedur:[62,33,47,35,79,63],realli:[25,1,50,46,3,16,68,63,32,26,80,36,10,64,39,41,42,44,58,84,66,86,34],heavi:64,varnishadm:[32,1,86,15,82,8,5,58,31],iter:[88,27],inflict:43,stabl:52,beyond:37,event:[51,30,84,58,39],linpro:[88,2,27,39],"try":[63,50,52,3,53,16,28,57,31,26,76,77,35,79,9,36,17,12,59,39,84,43,58,62,46,20],flower:66,vmod_toupp:62,varnishhist:[60,51,61,14,27,55,8,83,74,58,24,17],publish:[34,48],research:[84,20],footnot:57,etag:16,health:[51,77,81,19,37,88,44,31],print:[60,69,14,61,86,83,77,31,64,58],occurr:[88,58],nest:88,digest_len:53,foreground:[58,31],php_sid:64,bass:84,dirt:66,differ:[25,50,52,3,43,27,19,30,76,77,87,7,10,64,20,84,42,53,44,62,5,38,34,23],unload:[44,62,31],significantli:[84,23,43],quick:[5,46],reason:[35,84,26,51,86,47,6,79,9,28,57,88,10,23,12,20,39],base:[25,49,84,2,59,26,69,87,76,7,79,58,38,34,36,44,30,45,64,24,17],applewebkit:7,put:[57,40,62,48,75,50,51,43,46,73,15,38,79,58,53,23,20,17],decompress:16,basi:[88,44,79,84,57],thrown:34,driven:[2,27],vmod:[1,59,50,76,75,62,47,8,6,68,10,88,44,38,58],launch:[9,63,31],drupal:64,exponenti:58,perhap:7,due:[51,52,78,9,28,30],circuit:0,corkscrew:23,assign:[88,84,62,68,58],feed:[34,53],sess_timeout:[32,76],"lyngst\u00f8l":[88,24,27],obviou:[77,86,37],upper:[60,61,47,83,20,58],feel:[84,26,50,75,86,28,53,20],famou:[41,75],misc:39,number:[1,50,51,52,3,63,14,27,6,28,71,31,76,77,80,10,20,60,61,41,83,53,58,84,62,23,46,72,47,88,48,24],evolut:50,calloc:62,done:[76,44,63,66,73,7,34,72,28,36,71,10,23,64,59,58],unhealthi:44,blank:58,slower:[53,4],miss:[84,60,69,3,72,58,4,7,42,36,63,88,10,55,24,17],can_gzip:88,stage:[3,34],guess:[44,20],guest:66,vararg:62,interact:[10,14],berespreason:51,construct:[25,66,58],"0x8006b3ef2":63,paint:75,stori:42,bumbl:75,fympg:31,saint:77,illeg:34,ton:[84,43],scheme:[10,77],store:[49,62,2,51,52,3,66,84,16,78,42,53,88,30,58,38,17],statement:[25,62,76,51,70,29,63,88,68],relationship:26,blindli:41,park:[77,58],round_robin:[88,44,59,76],part:[84,1,72,69,52,76,14,62,47,68,22,36,42,43,10,64,58],hugepag:[33,71],wextra:58,consult:34,fastli:2,tebibyt:30,"0x429f8b":63,std:[62,69,51,76,47,37,88,58],kind:[84,1,50,52,75,62,7,86,34,72,63,88,58],simplist:50,grep:64,prebuilt:28,whenev:[62,51,52,86,35,57],remot:[1,50,69,51,86,71,10],seamlessli:77,horizont:[24,60,55],bugfre:26,reus:[51,52,58],architect:[2,50],str:88,arrang:62,stale:[60,69,61,14,83,22,37,44,31],toward:88,weapon:50,randomli:[23,31],stataddr:61,comput:[84,75,26,57,79,59,34,43,11,86,20],default_grac:58,grandios:84,peculiar:[40,5],packag:[33,46,87,28,57,10],ackward:84,expir:[60,51,61,41,83,42,36,58],propos:[34,12,84,50],dedic:[75,58],"null":[62,9,84,47],option:[1,69,51,54,27,16,71,9,80,36,64,60,14,61,82,83,44,55,58,84,62,18,46,72,88,24],sell:[84,66],mountain:71,entireti:72,xref:1,built:[84,66,81,46,19,5,6,36,53,88,12,68],lib:[58,31],ee30d0770eb460634e9d5dcfb562a2c5:53,vcl_int:62,troublesom:[42,48],efh:63,also:[1,2,50,69,51,52,3,63,14,27,16,22,56,57,31,32,77,33,78,36,37,12,59,39,40,60,72,61,41,82,42,43,44,58,84,62,48,18,64,46,86,83,47,34,6,88,23,24],thatotherserv:46,build:[62,50,33,66,7,27,34,28,12],tp1:32,techniqu:59,donor:34,cc_command:[1,58],backend_health:51,brace:68,tool:[32,62,85,18,26,51,84,4,78,8,79,43,10,55,64,20,58],pipelin:[50,75],distribut:[84,60,55,20,28,88,44,59,24],exec:58,wswitch:58,previou:[32,40,86,7,59,58],reach:[62,2,19,80,36,88],react:9,most:[0,25,75,2,50,51,66,3,43,55,19,28,63,30,86,31,77,35,79,9,36,10,64,39,61,41,15,42,53,58,84,62,49,46,5,34,48],plai:[44,34],must_restart:58,plan:[50,58,34,75,30,23,12,39],gzip_level:58,metacharact:48,wisdom:[12,20],vcl_purg:[6,36],amaz:[20,50,43],fileread:47,esi_remove_bom:58,bug:[75,63,76,3,33,34,9,57,39],filesystem:[1,42],clear:[39,84,50,26,66,34,79,23,20,31],cover:[40,84,33,54,19,74,57,10,64,17],destruct:[85,66],execept:84,clean:[52,62,6,28],page_s:58,pars:[18,51,3,47,6,88,4,64,31],subgroup:88,sector:42,ridicul:20,carefulli:[34,12],cdn:10,alphanumer:64,fini:62,session:[83,84,51,61,72,58,47,9,80,71,23,59,31],particularli:[20,53],thread_pool_fail_delai:58,finn:64,fine:64,trhead:22,impact:[10,19,58,36,30],ambit:20,firewal:84,avg_1000:14,pretti:[1,37,66,7,42,53,39],avg_10:14,writer:52,solut:[77,34,36,50,43],writev:58,queu:58,templat:[64,36],factor:32,lennon:75,remedi:84,hit:[25,69,51,3,63,55,56,75,76,77,9,80,36,37,10,17,64,60,58,72,88,24],unus:58,luke:84,financ:34,sydnei:20,cheaper:86,sfile:[9,63],nativ:[17,16],grew:57,tcp:[1,18,51,33,46,84,6,71,10,58],dependend:58,banner:31,him:12,restart:[0,32,62,50,26,40,51,52,3,76,86,72,73,6,63,88,10,58],silo:[30,58],vsl_reclen:58,synthet:[88,6,36,76],diffabl:79,synthes:[83,61,60,69],rfc:[51,48,64,76],common:[0,62,2,53,34,81],rxprotocol:80,nowher:[28,20],remov:[25,84,56,76,3,81,86,58,16,7,36,44,10,47,64,29],wrote:[34,43],certif:[34,23],forego:34,set:[25,1,26,69,51,52,3,63,27,16,5,56,71,30,47,31,59,76,33,87,78,7,9,36,37,58,64,20,60,72,61,41,15,42,43,44,45,62,46,86,38,34,83,88],art:[20,26,17],dump:[55,9,63,23,31,58],sep:62,jade:48,startup:[1,42,46,24],celebr:10,lion:71,max_pool:58,bare:84,wg14:20,arg:[52,31],reserv:[88,20,76],jemalloc:[23,28],arm:42,project:[84,2,66,34,79,57,12],inconveni:53,systemat:11,someth:[57,35,62,75,63,50,64,44,33,84,47,6,79,9,28,37,10,12,70],grandmoth:66,particip:84,won:[0,62,66,9,36,81,20],mutex:[52,20,58],append_ua:7,subscript:[72,58],experi:[84,2,50,3,79,34,58],vmod_priv:62,altern:[1,28,84],appreci:75,numer:[46,72,86,43,48,20],javascript:64,lowercas:38,succeed:[35,44,88,82],percent:34,distinguish:[34,43],popul:49,hairi:[77,3],lass:[88,14,2],last:[62,60,51,14,84,55,34,9,42,88,44,58,24,31],delimit:68,hyperlink:[32,79],start_child:63,alon:[79,23],anon:26,intercept:84,context:[76,77,63,41,7,4,79,53,88],pdf:[79,20],protector:58,whole:[0,80,9,28,88],becam:[48,43],load:[25,84,1,86,26,77,44,53,62,58,59,5,6,37,88,10,31,87,20,17],simpli:[62,17,34,42,68,88,23,39],point:[62,2,51,77,3,84,20,35,36,44,30,23,64,38,58],instanti:[88,50],schedul:37,z_stream_end:9,leon:64,header:[49,2,69,51,3,55,6,56,63,31,76,35,7,81,10,45,64,59,17,84,83,43,16,58,62,4,65,72,47,38,88,29],provok:[50,27],hash_data:[88,7,38,53],linux:[57,2,33,7,43,35,73,9,71,11],batteri:10,mistak:20,backend:[0,49,2,72,26,51,52,3,54,27,4,55,19,22,29,30,31,78,50,76,77,87,35,8,7,80,36,37,58,64,59,40,14,81,61,83,44,16,17,62,18,65,46,86,47,21,6,88,85,24,56],duh:50,identif:[88,53],faithfulli:84,becom:[25,84,57,50,53,66,7,79,43,20],java:44,"_atom":20,stamp:51,territori:42,devic:[84,81,7,19,30,44,17,31],first_byte_timeout:[88,58],empti:[77,1,14,34,69],secret:[1,23,73,82,5,63,48,31,58],pcre_match_limit:58,synth:[67,6,36,7,76],wwrite:58,thread_pool_destroy_delai:58,nonexist:62,strategi:[25,1,42,7],firm:50,invis:58,ram:58,fire:35,imag:[78,84,3,29,16],densiti:84,great:[10,1,79,19,73],fund:34,understand:[50,26,7,34,9,53,88,64,20,17],workspace_sess:58,station:48,tangenti:34,repetit:63,invit:66,trojan:1,look:[0,25,1,63,50,51,3,43,5,6,57,31,32,26,35,80,36,37,12,20,13,60,81,82,42,53,44,58,84,62,64,46,73,38,87,88,48],solid:58,straight:[42,39],"4084b":58,real2tim:47,batch:58,durat:[62,50,41,27,47,88,86,20,58],ramif:50,pace:58,respprotocol:51,"256m":73,smart:[3,39,53,16],behavior:[59,27],doubli:58,fun:[66,50],vmod_:62,everyon:[88,67,68,73],lingo:62,pack:20,subsect:[21,4],eur1:34,malloc:[62,51,46,54,78,73,9,88,30,58],larger:[3,72,34,63,23,58],pounc:84,hcritbit:[9,63],readi:[51,28,2,77],vacat:[33,85,50,63],workspace_cli:[62,76,58],rip:[66,43],revers:[32,1,2,58],rxreq:27,cento:[35,46,73,33,28],demot:57,seen:[52,61,41,7,5,9,53,12,20,79],"00z":20,rid:86,time_firstbyt:69,esi_bodybyt:51,shirt:20,minim:10,belong:[36,72],shorter:[15,58],anniversari:10,lengthi:47,grand:50,octal:31,higher:[6,72,58],x86:11,optic:34,imagin:[62,77,66,86,42,43],optim:[23,80,36,58],banter:39,unwarr:84,"1000x":32,alert:57,healthi:[76,47,37,88,44,59],moment:[25,62,37,63,44,39],temporari:[27,58],varnishreplai:[8,18],provabl:20,stack:[9,31,20,58,71],focal:84,recent:[41,11,34,31],expend:84,task:[87,84,26,51,41,86,78,34,53,44,31],equival:88,ampl:88,older:[58,28,36,20],entri:[52,61,55,8,9,80,68,88,58,64,38,24],parenthes:[88,68],joyent:57,person:[1,28,53],cheer:20,expens:[78,62],tast:[28,57],anybodi:79,ubuntu:[33,46,35,73,28,71],darn:48,explan:[62,26,53,9,63,39],burden:57,from:[0,25,1,75,2,72,50,69,51,52,3,43,14,4,55,19,22,28,29,74,63,30,31,32,59,76,77,33,7,68,79,9,80,36,37,10,11,58,12,20,39,87,78,60,66,81,61,41,83,53,44,16,17,84,62,48,18,64,49,46,86,47,34,6,88,23,24,56],uselessli:16,collabor:50,press:[32,79,80,60],shape:[20,50,75],pan_ic:[9,63],mob:84,regardless:88,pipesess:51,northern:12,poller:77,sessionopen:80,fstack:58,bereqmethod:51,cut:50,"455ce847f0073c7ab3b1465f74507b75d3dc064c1e7de3b71e00de9092fdc89a":31,tablet:7,cup:28,libncurs:28,restructuredtext:[79,85,82],vcl_pipe:[88,6,45],objcor:51,notifi:36,input:[18,51,77,41,86,53,88,58,38,31],subsequ:[0,51,1,6],app:[80,53],useless:[20,58],bin:[25,27],hashedg:58,complaint:34,obsolet:31,format:[48,60,69,51,61,3,14,58,8,79,83,88,10,31,20,17],big:[84,62,70,81,46,34,78,77,79,22,75,10,23,20,58],misconfigur:9,do_gunzip:[88,3,16],intuit:44,simple_list:58,wiser:34,bit:[75,50,51,3,71,16,5,28,63,77,7,9,80,36,10,11,64,84,42,53,44,58,62,23,66,34,48],characterist:30,formal:84,strstr:47,bereqprotocol:51,signal:[7,69,63,83,58],shortkei:32,resolv:[88,84,46,68],elaps:[83,61,60],collect:[32,50,26,65,34,47,79,72,63,48,20],api:[51,52,72,57,10,48,20],conceiv:[84,63,57],popular:[25,20,55],vcl_error:[51,76],interestingli:42,encount:[51,3,62,76],scare:23,gnnsdxsvdmvfympg:31,creation:[51,3,58],some:[1,2,26,66,43,27,86,19,22,28,71,31,78,50,76,87,73,35,7,9,36,37,10,12,20,39,82,15,42,53,44,58,57,84,62,63,64,65,46,5,38,34,23],back:[0,62,2,50,26,76,77,86,34,6,42,43,30,39,64,31],understood:84,litter:20,unspecifi:72,sampl:14,workspace_thread:58,mirror:87,sizeof:[62,57],surpris:34,"_bool":20,scale:[77,58,24,60,55],fifo:58,pet:34,chunksiz:58,per:[62,18,76,71,14,82,58,47,78,7,83,59,74,37,88,30,39,24,53,31],cli_resp:26,substitut:[25,77],retri:[0,76,51,6,88,58],larg:[34,84,58],slash:[7,58],init_funct:62,reproduc:[18,63],taglist:[83,61,72],cgi:[25,7],run:[1,75,2,26,40,51,70,3,57,54,27,16,73,28,71,30,31,32,50,87,35,8,9,80,81,10,45,64,39,13,60,14,72,61,82,58,42,43,44,17,62,48,63,46,86,34,83,88,23],lose:[50,53],agreement:34,legibl:[88,68],step:[88,33,28,20,71],logrecord:74,squeez:[63,53],prerequisit:[11,33],meantim:[62,43],crap:43,major:[84,26,81,66,42,75,58],subtract:41,mortgag:34,constraint:78,reappear:30,gibibyt:30,preclud:79,prove:[42,20,31],manag:[1,50,26,52,63,62,58,82,34,28,36,44,88,10,31,17],idl:58,"99999999b":58,candi:17,wait_silo:58,loadabl:[76,58],fetch_chunks:58,uncach:[88,64,76],cygwin:11,yyyi:14,miracl:84,doubl:[62,66,72,78,88,58,31,39],plethora:9,graviti:20,within:[88,70,58,72,31],backend2:59,grydeland:[69,51,14,61,72,47,83,88],pastebin:39,tmpdir:27,frf91:7,contributor:[2,57],threads_fail:58,perl:[88,64,68],pcre:[88,28,72],occupi:58,inclus:[14,58],institut:57,spam:39,errno:63,megabyt:[46,58],fast:[32,50,77,63,42,53,30,58],custom:[34,42,76],systemcal:20,doubt:[63,39],includ:[25,1,50,51,52,3,27,16,28,68,71,30,31,32,77,7,9,36,70,17,20,81,61,83,58,62,72,34,88,23,24],suit:28,forward:[2,51,47,35,39,58],paren:88,datastructur:20,vienna:50,properli:[25,35,26],reorgan:57,fishi:47,kristian:[88,24,27],wno:58,server2:44,navig:14,link:[25,40,51,52,72,78,79,58,20,39],multilevel:10,newer:[28,36],atom:41,line:[1,69,51,70,54,72,19,29,63,31,76,8,9,80,52,10,39,14,81,15,83,43,58,62,46,86,34,23],mitig:[84,64],redpil:88,info:39,concaten:[88,62],utf:[76,58],consist:[84,2,52,81,14,72,9,42,53,31],munin:55,pageup:14,intim:10,pkg_add:28,contin:[61,14],similar:[62,3,1,73,36,75,64],curv:20,derang:43,constant:[62,41],curs:14,bind:[1,9,14],palisad:12,parser:[51,3],lyx:79,composit:[25,81],repres:[77,84,27,76],"char":[62,53],incomplet:[0,83,61,60],webcach:64,chat:2,home:[34,23,64,41],curl:47,gecko:7,bracket:[88,58],"200c":48,profil:60,titl:64,sequenti:62,redhat_transparent_hugepag:71,invalid:[88,5,76,36,86],proxi:[40,84,2,32,6,23],codec:7,transport:84,unadult:37,responsetim:[60,17],nice:[55,80,9,75,47],storage_hint:88,esi_deliv:9,"3f8":63,formatt:69,critbit:58,cs101:52,libtool:28,param:[62,82,15,86,31,58],pool_vbo:58,land:66,algorithm:[87,58,53],verden:[32,60,69,14,61,34,83,88,58],pool_vbc:58,orbit:12,scream:47,depth:58,dot:[88,58],acceptor_sleep_max:58,syncvsl:58,fresh:[66,36],marvel:64,scroll:80,pluggabl:30,code:[1,26,51,70,3,63,27,55,19,6,28,68,57,86,31,59,76,7,79,9,37,10,64,20,39,84,42,43,58,62,23,46,5,38,34,22,88,48],edg:[25,58,12,81,16],leak:[23,26],queri:[60,76,69,61,72,8,7,83,88],gang:[32,60,69,61,14,34,83,88,39,58],amiss:35,objecthead:76,privat:[8,34,62],ulimit:[9,71],wizard:[50,58],elsewher:[59,76],friendli:[84,64,34,12,36],send:[0,49,84,63,18,3,57,58,7,27,47,35,34,6,80,37,88,44,55,64,17],granular:[30,58],lower:[1,47,20,31],vcl_conf:62,gzip_memlevel:58,"256k":58,sens:[50,51,41,16,78,42,57,64,20],sent:[84,69,51,3,7,82,34,64,59,58],settl:41,nett:64,religi:48,unzip:88,rollback:[88,47],garden:66,reinterpret:79,trough:2,retriev:[88,1,6,31],implicitli:88,relev:[69,9,28,63,44,31,20,39],tri:[2,26,50,76,16,43,58,39],magic:[3,31,62,42,16],complic:[3,64],perceiv:[34,20,50],geograph:10,fewer:[34,4],unquot:72,forsiden:64,"0x42cbe8":9,freed:[52,62],pleas:[25,62,2,50,47,70,3,80,46,58,16,55,9,28,68,63,88,44,39,64,31],malici:84,impli:61,smaller:[34,75],fortun:84,natur:[86,20,31],"0x0":47,crop:84,uniqu:[88,87,7,20,63],jump:[68,76,36,43],quickli:[84,22],parkinsson:12,video:7,detrim:58,download:[28,4],odd:[84,64],append:[69,52,76,46,83,10,31],compat:88,index:[51,32,50,53],"455c":31,rate:[25,34,80,10,64,58],resembl:50,"64k":58,multimedia:64,find:[26,52,3,53,27,73,6,28,74,32,77,9,64,38,39,84,42,43,44,58,62,46,86,87],access:[49,1,67,26,52,62,73,68,79,80,36,88,10,11,58,64,31],experiment:[30,54,58],journal:34,can:[0,25,1,75,2,72,26,51,66,3,43,54,27,4,55,19,28,59,71,30,47,87,31,32,50,76,77,67,73,78,79,9,80,36,37,10,11,58,12,38,39,86,60,14,82,81,61,41,15,7,42,53,44,16,70,17,57,84,62,63,64,49,46,5,20,34,88,23,68],tar:50,unmask:58,absolut:[62,50,51,41,64,58],usag:[84,60,69,61,83,36,10,64],http_req_siz:58,bodi:[25,84,76,51,27,88,17,58],srvr:23,let:[25,87,1,2,50,3,73,20,35,79,9,29,42,63,44,23,64,38,36],symlink:43,filedescriptor:[26,31],http_resp:26,max_esi_depth:58,vertic:[24,60,55],sinc:[1,2,50,51,52,3,76,77,34,35,9,64,20,87,42,53,44,58,62,12,66,72,21,88],convert:[72,82,47],convers:47,auxillari:58,overseen:2,technolog:45,host:[69,3,14,19,68,75,31,35,7,80,36,81,64,38,60,61,83,53,44,58,84,46,47,87,88,48,24],later:[62,18,69,51,43,61,83,34,42,28,68,53,88,80,58,20,39],resurrect:63,earli:84,opinion:84,chang:[0,1,75,2,50,51,52,63,14,16,73,22,28,71,31,32,26,76,77,35,7,10,64,38,39,60,53,44,58,84,66,86,21,88],honor:[88,76],chanc:[84,52,3,62],control:[1,2,26,51,3,14,4,6,68,31,76,7,8,79,9,36,81,10,64,82,58,84,86,67,88,48],short_pan:58,firefox:64,claim:20,appli:[62,51,61,3,14,84,72,83,71,30,58,12,31],approxim:[30,59],foundat:[34,50],apt:28,"boolean":[88,41,72],deputi:12,vsl_space:58,beresp:[25,49,62,76,51,3,58,27,16,7,36,37,88,47,64,56],timesync:20,tailor:[7,41],fee:34,personel:26,max_connect:88,zip:51,commun:[2,50,26,51,61,81,54,7,20,34,83,57,24,39],frob:3,upgrad:[84,76,77,21,57,45],flat:10,maker:84,websit:[84,66,4,35,81,10,17],few:[84,1,2,5,86,78,34,68,63,10,58,39],latenc:7,usr:[32,87,9,28,46],nth:72,subrequest:72,thread_pool:58,expiri:51,chip:42,rick:64,sort:[50,26,61,41,47,34,80,36,75,12,17],comparison:[41,72,47,68,88,31,58],impress:84,stone:20,lookup:[62,50,76,51,3,16,6,36,53,88,64,38,58],trail:7,"transient":[52,54,15,81,30,58],insensit:[88,72,47],vclexamplehitmisshead:64,rare:63,iii:43,had:[62,2,77,84,72,34,42,63,10,12,20],fetcherror:51,account:[51,34,26,47],alik:66,field_num:60,scalabl:2,tunnel:84,rxheader:[80,55],cumbersom:64,poul:[75,2,50,69,51,53,14,27,16,57,32,26,85,77,79,12,20,60,61,41,42,43,58,84,23,66,34,83,88,48],obvious:[62,48,41,57],vcl_recv:[0,49,62,76,77,3,7,16,67,6,29,44,88,10,45,64,38,36],endian:20,bidirect:45,reqhead:[51,61,72],fetch:[2,50,76,51,3,87,58,4,22,19,6,36,37,88,31,17],aliv:[33,58,80,71,31,17],proof:84,vsm_space:58,bent:50,grace:[51,88,58,37],process:[0,25,1,2,26,69,51,52,3,54,27,16,5,6,63,31,9,80,36,70,10,58,12,39,40,60,14,61,82,83,55,17,62,86,34,88,23,24],lock:[1,52,14,62,8,20,58],sudo:28,tax:34,high:[84,63,81,7,37,34,73,4,79,9,71,64,20,53,58],benc:[0,80,1,64,55],tag:[25,60,51,61,72,47,83,80,24,58],vcl_:[88,68,76],tarbal:28,onlin:[88,64,28],crimin:[26,17],serial:62,weaken:16,delai:[84,51,14,86,24,58],insuffi:58,gcc:58,forese:84,guru:[9,6,81],tamper:16,vcl_miss:[3,6,7],six:34,timeout_idl:[76,58],subdirectori:[62,42],instead:[62,86,60,64,52,3,69,14,19,24,88,34,83,80,76,53,61,58,5,20,39],panic:[9,63,81,58,31],circular:30,fare:84,everywher:62,express:[69,72,68,30,31,76,79,8,7,80,36,64,60,61,62,41,83,44,84,86,88,85,24,29],attend:75,farm:84,watch:[78,66,64,75],men:[84,20],fcj8cnd5188:64,tier:57,hasher:58,timespamp:47,physic:[77,66],villag:12,alloc:[62,52,84,71,30,58],denounc:34,essenti:[64,4],seriou:[30,34,84,58],sit:[0,84,34,20,50],robot:17,processor:[25,19,43],issu:[84,1,2,81,51,63,79,58,82,35,34,9,36,42,57,39,64,20,31],mainten:34,rfc3986:48,furious:63,fallback:[59,47],hipster:50,vml:34,least:[25,84,50,66,34,53,64,24,58],lingua:79,routin:[84,63],solv:[62,50,63,84,37,57],move:[66,76,51,46,14,7,22,17,58],pipe_if_loc:[88,68],sysconfig:[73,46],whilst:64,tcl:79,comma:[61,83,46,72,58],"0xb75096d0":36,bunch:64,perfect:[66,53],consensu:50,chosen:[19,48,12,84],youtub:64,brook:84,labor:10,suppli:[51,7,58],willing:3,infrastructur:[10,1],decai:58,purg:[1,76,81,86,4,67,6,36,7],therefor:[62,75,63,26,77,53,84,34,42,28,71,64,20,39],dag:[60,69,14,61,83,24,58],crash:[71,81,70,33,9,63,31],pure:[52,84,26,37],thread_queue_limit:58,hurrican:10,spell:88,dai:[84,26,75,47,34,36,43,88,64,39],auth:[69,31],devel:28,mention:[1,50,3,7,11,48,12],log_info:[70,58],kiss:23,front:[32,50,78,36,64,58],ban_lurker_ag:58,thread_pool_timeout:58,wrangler:1,libvarnishapi:77,somewher:[44,50],trac:[64,84,2],anyth:[62,1,50,3,63,41,7,20,84,79,57,86,38,58],edit:[35,79,62,73,57],orderto:58,nocach:64,mode:[1,18,51,52,3,14,72,27,6,9,37,88,58,31],thread_pool_workspac:58,disregard:[25,88,64],querystr:47,cluster1:76,vsl_buffer:58,subset:[25,1,84],lie:50,cry:20,activit:43,dgst:31,intellig:39,"_catch_bug":63,chunk:[52,5,84,39],consum:[51,72],mar:9,"static":57,our:[32,84,2,50,57,41,7,34,9,28,29,42,53,44,58,87,39],shannon:53,out:[75,63,50,52,3,43,27,4,5,28,74,57,86,32,26,77,35,7,36,37,12,20,39,53,44,58,84,64,66,19,38,34],variabl:[25,62,69,3,41,47,79,88,20,31],antiqu:20,vcc:[8,79,62,26,86],overridden:27,incompet:84,influenc:[19,76,37],busyobj:58,defend:26,req:[0,49,50,51,3,27,16,29,31,76,7,36,37,10,45,64,59,53,44,58,62,86,47,38,67,88],vcl:[25,49,1,2,26,69,51,70,3,75,54,27,16,19,22,28,29,63,86,31,32,50,76,77,87,73,35,8,7,9,36,37,10,45,64,38,39,13,81,41,58,82,72,44,17,59,62,65,46,5,47,21,6,88,85,68],stdnoreturn:20,suitabl:[62,51,61,55,34,83],disappear:[88,84,50],hardwar:[84,23,43,71],stead:44,ref:[25,44],defens:[10,34],red:[35,46,73,33,28],statist:[26,52,81,14,55,8,74,77,61,10,58,64,20,17],clarifi:50,shut:34,insid:[52,34,64,50,58],parenthesi:72,ipod:72,unpars:51,hash_ignore_busi:88,york:75,dictionari:84,advisor:12,releas:[75,50,71,47,34,28,37,58,39],txstatu:9,critbit_cooloff:58,complianc:84,http_req_hdr_len:58,unwant:64,could:[25,1,51,64,75,66,62,59,34,9,43,58,12,20,31],latest:[88,28,20],ask:[1,50,26,3,86,55,34,63,10,12,20,39],keep:[50,51,63,4,28,71,31,26,77,33,7,80,36,37,17,64,59,39,60,61,41,42,44,58,12,66,83,88],scari:64,length:[84,1,51,52,62,53,10,58,31],outsid:[78,70,7],pcre_exec:58,retain:0,timezon:39,thread_stats_r:58,softwar:[2,69,57,14,27,28,75,31,32,64,39,60,61,82,83,58,18,66,34,88,85,24],suffix:[30,58],frap:68,qualiti:[34,57],echo:[25,82,71],date:[25,62,69,51,77,84,37],wreturn:58,kerbero:84,facil:[84,10,1,20],underscor:[64,20],utc:[62,20],prioriti:47,forgeri:84,"long":[50,51,52,71,27,4,68,57,31,77,36,64,20,39,42,53,58,84,72,47,34,88],fair:9,unknown:[88,64],licens:[25,18,60,69,61,14,82,27,47,34,83,88,58,24,31],perfectli:[34,64,20],system:[1,63,26,52,43,46,79,47,19,28,71,30,11,86,64,58],wrapper:[1,20],attach:[88,62,58,57],attack:[1,54,26,53],sadli:84,multiprogram:20,privaci:84,scant:84,termin:[32,62,51,6,80,23,31,58],licenc:[18,60,69,61,14,82,27,47,83,58,24,31],man:[88,64,9,31,16],"final":[32,1,26,77,27,4,34,28,36,10],misunderstood:64,udp:84,shell:[9,58,48],rxurl:[80,64,55],joani:64,shall:20,crnl:58,nobodi:[62,26,50,84,34,37,58],haven:10,cli_common:31,datatyp:76,hitmiss:69,gethdr_:62,bloat:20,free_spac:88,bother:[62,12],"65k":64,structur:[62,63,34,72,79,42,53,88,30,20,58],charact:[84,60,51,63,14,72,55,68,53,88,58,64,24,31],collaps:47,sensit:[62,63,28,84,47],dubiou:58,"0x41f778":9,other:[25,1,75,72,26,69,52,3,63,54,16,19,6,28,68,57,78,50,76,77,34,35,79,9,80,36,37,10,11,64,20,39,66,81,61,84,42,53,44,55,58,62,46,5,59,21,88,23],sooner:53,webfold:35,"function":[62,1,75,2,72,76,43,41,58,4,8,22,53,88,47,64,20,31],counter:[51,52,14,55,78,77,6,74,44,88,10,58,17],favorit:[35,44,87],barf:[68,27,53],msec:58,clearli:[84,75],correspond:88,requrl:[51,61,72],have:[25,1,75,2,26,51,66,3,43,14,4,5,22,59,57,30,47,87,31,32,50,76,77,21,35,79,9,80,36,37,10,11,12,38,39,13,78,86,72,41,7,42,53,44,16,58,84,62,48,63,64,46,19,20,34,6,88,23],close:[32,26,51,77,57,72,6,34,9,71,58,31],need:[25,49,1,63,50,52,3,43,5,28,68,71,32,76,77,34,73,79,9,80,36,10,58,64,38,39,87,66,84,7,42,53,44,45,62,23,46,86,59,21,88,48],blix:[69,51,14,61,72,47,83,88],element:[62,72,20,50,58],border:[12,50],devicetyp:7,afraid:57,soak:58,min:60,rout:[44,84],"0x00":[88,68],sandbox:[1,58],mix:[84,20],builtin:[19,76,68,58],preced:[88,72,41,68],impur:34,which:[1,75,2,26,51,52,3,43,27,16,19,6,28,59,71,30,86,31,50,76,77,73,79,10,58,12,20,66,72,61,82,42,53,44,55,17,57,84,62,63,64,46,5,47,34,88,23,24,68],roug:1,vpn:1,ncsa:[8,17,69,58,10],singl:[62,26,69,63,14,86,27,72,34,36,44,88,10,64,20],cli_limit:58,lastst:31,unless:[1,86,59,69,3,46,62,15,16,79,83,58,30,10,23,64,24,39],allow:[25,84,1,2,72,26,69,3,63,62,83,4,22,67,9,36,37,88,10,58],tcp_keepalive_prob:[58,71],deploy:[30,84],quantifi:47,who:[84,1,77,66,34,67,42,75,39],oracl:[2,57],discov:[52,62],fragment:[25,30,51,58],jul:84,rush_expon:58,histogram:[8,55,24,60,17],segment:[10,9,80,58],why:[62,1,48,26,85,51,3,66,79,84,34,9,42,53,23,12,20],urg:84,url:[25,50,69,51,3,27,55,56,31,7,36,64,59,72,61,53,44,58,62,86,47,38,88,48,29],"32k":58,gather:69,frederick:84,uri:84,sandbeck:[27,58],face:63,pipe:[0,60,69,51,3,58,16,55,6,68,88,45,24,17],deni:67,determin:[62,3,72,88,64,58],north:75,occasion:39,"0x0a":31,fact:[26,43,34,81,30,20],malamud:48,priv_vcl:62,tape:48,text:[25,87,1,76,51,62,73,16,35,34,44,58,20,31],borderlin:84,verbos:[83,14,27],elif:88,connect:[0,84,1,26,51,52,72,14,86,82,5,6,80,77,88,44,58,31],bring:[34,12],thaumaturg:62,bedroom:66,utter:20,rough:13,trivial:[52,42,64,50],res_writeobj:9,redirect:[7,83,64,69],highest:[84,41],locat:[32,84,51,52,82,35,7,81,38],tire:63,timeout_ling:[76,58],should:[0,1,2,26,52,3,4,5,28,63,30,78,50,76,77,35,10,64,20,13,72,82,15,42,53,44,58,84,62,23,46,86,47,34,88,48],ixslvvxrgkjptxmc:31,"0x20":58,elseif:[25,88,7],local:[32,1,51,46,62,67,9,28,68,88,87],hope:[84,26,50,75,34,42,57,23,12],expkil:51,meant:20,explicitli:[51,44,76,86,58],obj2:50,contribut:[62,2],beat:84,approv:1,rush:[84,58],bear:[62,20,50],regularli:55,autos:58,jpg:[56,16],increas:[25,76,72,4,78,6,36,71,44,20,58],lucki:50,esi_xmlerror:51,enabl:[1,2,76,51,3,71,37,88,36,10,44,30,59,58],organ:[19,50,81],devast:34,stuff:[26,50,51,52,86,78,42,43,64],vcl_someth:70,integr:[10,84],partit:[1,46],contain:[25,32,62,51,14,3,33,46,72,58,47,68,49,36,81,88,23,20,31],grab:[50,39],shl:58,do_esi:[25,88,3,27],view:[52,84,14,17],conform:3,btw:43,legaci:64,modulo:58,vcl_pass:[3,6,7,76],unimport:50,frame:84,knowledg:34,ipng:48,shm:58,temporarili:7,danger:[1,20],mulhuijzen:2,statu:[84,72,50,69,51,77,76,86,82,7,6,36,88,10,64,31],error:[6,69,51,77,76,86,4,35,9,63,10,64,58],correctli:84,pattern:[77,84,43,64,39],boundari:[34,84,60],tcp_keepalive_intvl:[58,71],tend:[34,38,50,63],b00000:28,written:[2,69,51,75,14,27,16,5,68,63,31,80,64,20,60,61,82,83,58,62,18,12,72,47,34,88,48,24],unusu:41,crude:26,chemic:50,neither:[14,82,24,16,20,58],email:[34,63,84,50,39],midnight:34,bought:66,entic:3,kei:[1,2,60,69,53,14,34,6,37,88,10,38,58],vrt:62,reinforc:20,entis:84,entir:[84,50,66,14,34,42,63,88,20,58],otherwis:[1,52,82,27,16,7,63,44],crc32:58,disput:34,succesful:58,monitor:[10,55,72,81,52],doorwai:50,reqbodi:51,instant:[77,75],used_spac:88,plugin:[64,20,55],career:12,goal:50,mpg:31,ramp:[34,58],equal:[41,72],vtqe_prev:20,etc:[1,63,50,51,66,3,43,5,28,57,71,26,87,73,35,79,9,81,10,17,20,84,53,58,62,46,86,47,34],instanc:[1,50,69,51,52,3,14,68,57,31,26,77,8,10,20,60,61,41,82,83,58,84,62,86,88,48,24],admir:34,lru_interv:58,strftime:69,preprocessor:20,comment:[25,7,35,19,68,44,23],anti:58,unclear:84,toilet:66,wall:[34,12,20,58],last_us:76,arriv:[19,53],vcl_fini:6,walk:[77,36],vcl_synth:[88,7,76],ssl_clear:23,laugh:20,cli_run:63,"48k":58,rpm:28,quit:[39,50,66,57,14,5,41,22,34,9,80,36,53,44,68,31,64,20,79],slowli:80,tread:58,vtailq_insert_befor:20,addition:82,ban_dup:58,polka:68,rogier:2,cent:59,compon:[62,42,72,26],json:[25,14,81],besid:[34,80,63],treat:[72,86,58],querysort:47,varnishtop:[60,51,61,14,27,4,8,83,58,74,55,64,24,17],percentag:30,"31d":9,hat:[84,33,46,35,73,28],backendopen:51,both:[62,1,86,51,52,72,46,79,20,84,77,34,6,28,57,41,47,64,24,58],inbound:19,bulk:23,togeth:[25,62,72,38,87,44,16,24,31],"8001337af":63,overwhelmingli:34,present:[25,84,60,69,51,61,14,72,16,7,42,55,64,24,17],multi:62,obj1:50,plain:[51,76,63],align:[76,58],shortliv:[30,15,58],defin:[83,1,60,50,76,61,46,62,27,59,87,42,36,77,88,44,64,20,58],decept:84,wild:7,kibibyt:30,observ:58,layer:[84,50,43],langaug:20,vapi:52,almost:[1,63,86,34,28,53,10,64,20,58],squid:[36,50],horribl:[77,28],site:[25,84,2,66,46,78,73,63,44,64],scanf:20,substanti:61,fiddl:[77,75],incom:[44,5,2,34],revis:32,myfoo:62,surprisingli:50,scienc:[20,50],outdat:36,ping_interv:58,welcom:[77,39,41,58,31],insight:50,parti:[66,75],cross:[34,39],member:62,python:[79,28,62],matcher:31,vmod_priv_free_f:62,constel:41,android:7,inc:34,incl:51,difficult:64,phk:[84,14,27,83,31,39],competit:84,eur27k:34,overal:[52,84],http:[25,49,1,2,50,69,51,3,54,4,55,19,28,29,74,63,31,32,59,76,7,73,35,8,79,9,80,36,81,10,45,64,38,72,41,58,53,44,16,17,84,62,85,18,46,86,47,88,48,56],hostnam:[88,64,38,47],responstim:60,logic:[88,30,76,68,37],upon:6,effect:[1,2,52,86,36,30,58],handi:62,beast:63,unchalleng:50,logfil:52,dealloc:52,dust:66,php:44,expand:30,wronli:86,off:[86,51,52,3,19,58,16,34,75,4,5,64,39],center:14,com:[25,46,7,36,88,44,31,64,39],vcl_real:62,well:[0,84,1,50,26,66,72,46,21,16,79,42,80,30,11,48,64,20],regsubal:[88,64],thought:[84,26,50,79,42,75,85,20,39],vsl_mask:58,exampl:[25,51,27,19,28,68,31,32,76,8,7,36,81,64,59,61,82,20,42,53,44,62,65,46,72,47,87,88,23],command:[32,1,81,46,63,54,86,15,82,8,5,9,36,52,10,58,64,31],english:64,piec:[62,53,66,34,44,10],usual:[0,62,48,2,84,35,9,28,36,63,39,64,31],sporad:[42,71],therebi:[36,4],http_gzip_support:[88,3,58,16],less:[84,2,71,72,34,75,38,39],compel:84,obtain:[82,58],esi_disable_xml_check:58,procesess:52,heavili:62,compar:[68,88,58,20,53],py3k:79,web:[25,32,1,2,50,26,40,53,84,63,16,35,80,29,37,44,4,64],rapid:58,amd64:63,bodylen:27,tight:44,appearantli:20,onward:58,sky:37,knew:[42,20,43],script:[25,1,26,43,62,27,7,79,28,71,10,31,17],add:[84,59,52,43,41,27,16,7,9,36,53,88,44,64,38,58],expr1:72,rtld_now:62,collis:53,kick:[7,58],gmt:[84,9],"16g":78,esi_ignore_other_el:58,sick:[88,44,34,37],webpag:34,log_local_addr:51,arguabl:84,realiz:66,five:[25,84,50,34,75,58],know:[1,50,51,52,3,57,5,23,28,75,31,7,80,64,13,42,58,62,85,46,86,48],unseen:14,thoughtlessli:58,password:63,recurs:58,insert:[51,3,47,6,88,16],unplan:[30,58],resid:30,like:[0,25,1,75,2,26,52,3,63,16,5,28,59,57,31,32,50,77,87,73,35,7,80,36,37,10,58,12,20,66,41,15,42,53,44,17,84,62,64,46,86,38,34,88,48,68],success:[6,28,75],incred:50,profound:50,c1x:20,necessari:[62,76,66,46,42,71,58,31],martin:[69,51,14,61,72,47,83,88],workthread:[51,58],decis:[10,1,12,86],backlog:39,"80013801e":63,didn:[25,3,42,20,48],shutdown:[30,58],captur:[64,63],twitter:75,"0x8006b8d84":63,bogohead:51,self:[58,43],vsa:62,vsc:52,"export":[52,62],shabbi:75,flush:[3,69,83,58],proper:76,guarante:[52,62,23,20,53],peter:12,vsl:[60,69,51,52,76,61,72,47,8,83,80,58],vsm:[26,60,69,52,14,8,83,61,58],librari:[62,47,10,23,64,20],tmp:[30,23,27,63],nokia:57,trust:[1,43,3,26,79],competitor:43,rtld_local:62,lead:[30,20],truss:[9,63],avoid:[84,62,56,77,3,53,7,79,36,37,88,58,39],suckaddr:62,bereqacct:51,estim:84,leav:[84,86,27,9,42,53,20],ipv4:[84,18,51,77,46,86,48,58],happend:12,eso:34,duplic:36,kiddi:17,esi:[25,85,50,76,51,3,81,72,27,16,75,88,10,4,58],bereqhead:51,has_j:64,deprec:[88,42],facilit:20,paper:[34,75],vhost:[82,47],headerninja:64,toggl:14,offset:[52,53],handedli:20,microsecond:[10,2,69],simpler:64,about:[1,75,2,50,40,51,52,3,43,54,16,5,28,57,78,76,77,35,79,81,10,58,12,20,39,13,84,42,53,44,55,17,62,23,63,64,66,34,48],misbehav:[81,16,19,9,37,44,64],actual:[50,63,5,75,30,35,26,78,80,36,10,17,64,20,39,82,42,43,58,84,34,88],socket:[1,48,81,50,51,57,54,62,82,9,71,88,10,23,58],linger:[34,58],column:[80,14],vcl_hit:[88,6,37],uplex:39,fear:[84,20],carrier:79,thread_pool_add_delai:58,segovia:20,emperor:12,disabl:[84,1,60,69,61,76,14,86,16,83,36,71,88,58],compil:[62,26,76,33,86,58,5,28,43,88,10,17,20,31],getaddrinfo:47,own:[62,1,3,46,41,72,84,34,68,53,10,23,87,20,58],necessit:22,vcl_call:51,thread_pool_min:58,lenght:31,automat:[84,63,76,51,37,86,47,53,88,10,58],dataset:[30,55],warranti:62,automak:28,guard:26,merk:64,smarto:[2,57],pitfal:[64,4],pointless:39,automag:17,contruct:49,nuke:58,val:27,pictur:[10,62,81],transfer:[51,88],support:[2,50,69,52,3,71,16,57,33,36,45,64,39,40,84,43,44,4,58,62,18,65,23],rotat:[30,83,69],regsub:[88,62,64,68,7],debian:[33,46,35,73,28,71,58],"12k":58,vax:42,much:[57,84,1,75,50,26,52,53,86,58,16,77,34,22,80,68,71,23,64,20,39],"var":[9,82],trickeri:[8,52],deliveri:[32,51,52,3,72,86,16,23,58],alexa:75,client_drop:14,weight:59,yeah:48,admonish:84,acceptor_sleep_incr:58,gain:[84,58],grate:34,inlin:[1,50,76,62,10,31,58],eat:58,count:[62,76,51,72,1,55,68,88,36],succe:86,made:[84,1,50,76,66,21,86,34,53,88,20],wise:[79,23,84],krypto:23,tab:31,whether:[25,2,69,6,80,64],shrunk:43,murphi:10,wife:10,smooth:84,flip:80,troubl:[9,84,26,51,33,86,42,63,39],asynchron:37,record:[60,69,51,52,61,72,55,83,63,10,24,58],below:[62,3,86,63,30,64,58],limit:[1,60,51,66,57,61,41,58,72,78,83,10,30,17,64,20,31],monument:12,lvl:72,problem:[57,84,62,63,50,51,44,53,66,34,43,79,9,37,30,58,20,39],ikllqv:27,beresphead:51,epel:28,sockaddr:48,ddd00e1:32,dual:84,"25k":58,"int":[88,62,47,20,41],mask:[51,86,58],dure:[25,1,51,3,84,58,88,10,23,17],pid:[69,83,58],twist:[84,53],implement:[25,62,59,50,77,3,65,84,58,16,42,43,88,23,20,45],some_nam:86,ing:7,pit:50,girl:75,probabl:[25,35,62,59,50,40,51,64,75,84,47,6,87,9,53,30,23,12,20,58],mutual:34,quot:[88,72,31],syslog_cli_traff:[1,58],boot:20,detail:[50,69,14,27,16,74,31,32,76,7,10,13,60,61,82,83,58,18,47,34,88,48,24],virtual:[44,19,84,81],expr2:72,avg_100:14,bool:[62,86,41,88,47,58],special:[84,62,76,3,7,20,79,68,88,64,59,17],rememb:[62,76,77,3,63,48,64,58],behold:38,stat:[77,52,14,58],xxx:[0,80,1,64,55],openoffic:79,confignam:31,troub:39,"class":[52,79,7,47],june:50,humbl:84,stai:36,multithread:62,outsourc:1,overfund:34,sphinx:[79,85,28],nogroup:58,reliabl:71,rule:[62,64,20,26,41],emerg:[86,50],elsif:[88,44,64],yell:34,invari:[34,53],sincer:50},objtypes:{},titles:["actions","Security first","The fundamentals of web proxy caching with Varnish","How GZIP, and GZIP+ESI works in Varnish","Varnish and Website Performance","Peculiarities","Built in subroutines","Device detection","The Varnish Reference Manual","Troubleshooting Varnish","The Big Varnish Picture","Prerequisites","What were they thinking ?","Now what?","varnishstat","Parameters","Compression","Varnish Glossary","varnishreplay","VCL - Varnish Configuration Language","The Tools We Work With","What's new in Varnish 4.0","Changes in Varnish 4","Why no SSL ?","varnishsizes","Content composition with Edge Side Includes","Security barriers in Varnish","varnishtest","Installing Varnish","Manipulating request headers in VCL","Storage backends","Varnish CLI","Varnish Administrator Documentation","Varnish Installation","Raking in the dough on Free and Open Source Software","Starting Varnish","Purging and banning","Misbehaving servers","Hashing","Getting help","The Varnish Tutorial","VCL Expressions","A persistent message","Did you call them <em>autocrap</em> tools ?","Backend servers","Implementing websocket support","Important command line arguments","vmod_std","IPv6 Suckage","Request and response VCL objects","What SPDY did to my summer vacation","VSL","VSM: Shared Memory Logging and Statistics","Varnish Does Not Hash","Starting and running Varnish","Statistics","Altering the backend response","Picking platforms","varnishd","vmod_directors","varnishhist","varnishtop","VMOD - Varnish Modules","Reporting bugs","Achieving a high hitrate","VCL Examples","Wanton destruction for the greater good","ACLs","VCL Syntax","varnishncsa","Using In-line C to extend Varnish","Platform specific notes","Varnish VSL Query Expressions","Put Varnish on port 80","Reporting and statistics","Thoughts on the eve of Varnish 3.0","Upgrading to Varnish 4","What do you mean by 'backend' ?","Sizing your cache","Why Sphinx and reStructuredText ?","Logging in Varnish","The Varnish Users Guide","varnishadm","varnishlog","Why HTTP/2.0 does not seem interesting","Poul-Hennings random outbursts","CLI - bossing Varnish around","Backend servers","VCL"],objnames:{},filenames:["users-guide/vcl-actions","users-guide/run_security","tutorial/introduction","phk/gzip","users-guide/performance","tutorial/peculiarities","users-guide/vcl-built-in-subs","users-guide/devicedetection","reference/index","users-guide/troubleshooting","users-guide/intro","installation/prerequisites","phk/thoughts","tutorial/now_what","reference/varnishstat","users-guide/params","users-guide/compression","glossary/index","reference/varnishreplay","users-guide/vcl","phk/thetoolsweworkwith","whats-new/index","whats-new/changes","phk/ssl","reference/varnishsizes","users-guide/esi","phk/barriers","reference/varnishtest","installation/install","users-guide/vcl-example-manipulating-headers","users-guide/storage-backends","reference/varnish-cli","index","installation/index","phk/dough","tutorial/starting_varnish","users-guide/purging","users-guide/vcl-grace","users-guide/vcl-hashing","installation/help","tutorial/index","phk/vcl_expr","phk/persistent","phk/autocrap","users-guide/vcl-backends","users-guide/vcl-example-websockets","users-guide/command-line","reference/vmod_std.generated","phk/ipv6suckage","users-guide/vcl-variables","phk/spdy","reference/vsl","reference/vsm","phk/varnish_does_not_hash","users-guide/running","users-guide/operation-statistics","users-guide/vcl-example-manipulating-responses","phk/platforms","reference/varnishd","reference/vmod_directors.generated","reference/varnishhist","reference/varnishtop","reference/vmod","installation/bugs","users-guide/increasing-your-hitrate","users-guide/vcl-examples","phk/wanton_destruction","users-guide/vcl-example-acls","users-guide/vcl-syntax","reference/varnishncsa","users-guide/vcl-inline-c","installation/platformnotes","reference/vsl-query","tutorial/putting_varnish_on_port_80","users-guide/report","phk/three-zero","whats-new/upgrading","phk/backends","users-guide/sizing-your-cache","phk/sphinx","users-guide/operation-logging","users-guide/index","reference/varnishadm","reference/varnishlog","phk/http20","phk/index","users-guide/run_cli","tutorial/backend_servers","reference/vcl"]})
\ No newline at end of file
+Search.setIndex({objects:{},terms:{obious:33,entropi:52,waslock:20,resist:1,demand:[83,3,33,57],four:[50,1],secondli:36,prefix:[61,14,85,63,20,57],sleep:[65,20,57],vcl_acl:50,oldest:[82,60,35,59],hate:65,min_pool:57,forget:[61,76,52,27,56,79,17,38],storage_fil:57,kqueue:62,accur:46,"const":[61,56],spew:62,sorri:47,logdata:54,concret:20,swap:29,under:[82,83,49,59,18,25,68,60,3,14,61,26,46,33,41,81,87,57,63,30],sha256:[52,30],worth:[33,41,62,37,56],everi:[1,85,76,43,62,19,46,77,33,82,35,52,87,10,71,63],risk:52,vastli:[3,41],"void":[58,61,56,20,46],gover:83,ptxmcgnnsdxsvdmv:30,govern:2,affect:[75,51,3,70,65,15,52],vast:61,school:[78,12,25],showcas:64,upload:30,string_list:[61,58,46],vector:57,session_max:57,geoip:37,initialis:87,x86_64:9,properti:19,throught:1,quilt:74,"10m":26,geekiest:47,direct:[49,19,87,43,30,57],budget:12,enjoi:76,consequ:[87,29,67],second:[68,51,62,14,74,70,75,78,79,36,10,59,60,81,41,42,43,57,61,85,46,21,82,87,23],street:33,aggreg:[83,80,54],ill:[83,41],even:[0,1,49,51,3,52,25,7,77,78,10,17,63,20,38,86,83,41,42,43,57,61,23,65,33,47],aim:49,hide:14,backend1:[58,49],neg:6,madvis:70,lookback:76,fetch_maxchunks:57,strictli:26,child_main:62,"new":[50,51,3,22,74,30,31,75,77,78,35,36,10,58,38,59,83,43,57,61,65,71,20,21,87],net:[1,2,83],ever:[61,65,33,6,74,47,12],metadata:[51,83,63,35],ongo:87,elimin:[57,52],kilobyt:52,nanni:17,noreturn:20,never:[61,62,42,57,16,33,6,70,43,23,63,20,17],accus:47,here:[49,69,3,62,55,56,30,75,7,9,35,36,10,63,38,40,42,43,57,61,45,33],herd:36,wanton:[84,65],china:65,debugg:57,path:[31,49,26,46,29,23,58,57],interpret:[3,57],acceptor:57,dry:74,forum:2,announc:[83,38],anymor:[65,75],robin:[43,58],precis:74,loop:[87,20,67],permit:[57,38],vcl_backend_respons:[0,24,55,75,3,7,26,16,6,48,22,35,36,87,63,17],aka:87,c89a:30,werror:57,portabl:[56,20,42],carl:47,newspap:33,storage_malloc:9,brought:[33,20],unix:[61,50,42,11,20,30],moral:33,printf:20,total:[83,1,25,49,68,50,78,71,33,74],unit:[50,61,57,46],highli:[33,23,62],plot:65,describ:[83,1,62,75,50,70,61,81,34,21,27,10,87,29,63],would:[1,2,49,51,3,52,16,56,29,76,77,78,35,12,58,39,83,41,42,43,61,23,62,63,65,20,37,33,87,47],found:[61,50,33,57,46,54,78,6,23,63,30],ddthh:14,lwp:[63,4],leaki:33,init:[8,61,70],choosen:30,call:[24,50,3,42,19,6,67,62,75,7,78,79,35,36,10,17,63,58,38,40,52,43,57,83,61,84,65,71,20,37,87,23],telegraph:38,passport:33,spike:83,lru_cand:50,old_nam:71,type:[24,68,50,51,3,14,16,27,62,30,75,76,8,7,9,79,40,15,57,61,85,46,87],tell:[0,86,61,47,62,79,76,3,42,71,57,16,34,19,27,52,43,23,63,20,38],"0x4178fd":9,vmod_foo:61,lru_fail:50,paperwork:33,autogen:27,relax:[61,12],relat:[31,1,50,61,85,52,30],notic:[61,75,51,45,83,9,74],hurt:[57,56],grief:33,phone:10,warm:[83,18],adult:33,hole:25,hold:[38,20,36],must:[1,74,75,50,69,36,61,46,76,78,70,87,10,11,57,63,58,30],shoot:50,join:[43,86,46,62,38],room:65,restor:[87,46],setup:[79,63,37],work:[24,48,1,74,2,49,50,51,3,62,16,56,30,75,76,7,34,78,79,35,36,10,11,57,63,20,38,39,80,40,15,41,42,43,17,83,61,47,65,71,33,84,87,23],roof:33,coalesc:[43,36],glossari:[31,17],erl:[59,68,14,60,82,57],sbin:[31,27],root:[10,1,11,57],overrid:[4,35,7,55,63,57],give:[82,38,1,47,49,51,61,80,5,57,71,33,9,79,41,62,43,23,20,17],txreq:26,indic:[0,31,61,2,49,75,51,3,57,33,79,87,10,23,63,30],http_range_support:57,unavail:34,want:[48,1,2,49,39,50,51,3,16,27,28,56,29,58,75,76,86,7,9,79,35,80,10,57,63,20,38,13,65,83,41,52,43,17,61,84,45,71,46,37,33,87,47,67],vmod_std:[87,8,61,46],viceminist:12,attract:78,somekei:52,recov:41,end:[24,1,50,62,14,19,6,67,74,34,79,35,37,59,60,41,52,43,57,56,83,85,46,33,82,87],manipul:[48,1,64,28,63,58,17],turn:[61,2,18,4,65,83,16,19,35,23,58],polic:[5,74],revisit:45,how:[24,1,74,2,49,68,50,3,42,4,19,6,73,62,71,30,31,76,32,77,7,9,35,36,10,57,63,20,39,80,83,52,43,16,17,61,84,65,5,58,33,87,23],hot:[77,83],confin:76,"128b":57,answer:[1,2,25,76,33,52,10,23,38],verifi:63,widespread:[78,20],perspect:[7,38],connect_timeout:[87,57],updat:[82,61,18,59,68,50,60,14,81,26,54,6,8,22,76,57,30],dialect:42,recogn:83,mess:[69,1,49],chines:12,after:[31,83,80,39,50,65,75,57,7,26,33,6,27,43,87,29,47,20,38],superus:1,diagram:25,befor:[48,49,65,3,62,16,6,27,70,30,75,7,35,11,17,20,38,59,85,60,83,82,42,4,57,61,45,71,37,87,47],wrong:[83,75,32,65,46,34,7,9,27,62,10,20,38],beauti:63,cli_req:25,law:[10,33,12,49],parallel:[6,26,70],averag:[50,60,14,74],rhel6:70,handl:[2,68,50,16,19,6,28,62,75,7,35,80,10,17,63,20,38,15,43,57,5,33,87,23],attempt:[1,18,50,3,83,46,33,6,42,87,57,30],third:[61,78,79,33],opaqu:61,gottcha:40,think:[1,49,62,74,25,84,76,7,78,79,35,17,12,20,52,41,42,43,57,83,23,65,33,47],insuffer:42,wink:33,maintain:[33,61,38],environ:[26,56],max_restart:[6,57],incorpor:83,enter:[16,6,79,35,4,30],no_coredump:57,ethernet:[47,42],berespbodi:50,order:[1,2,68,3,52,14,5,27,55,70,34,7,9,35,36,10,11,17,63,58,83,41,42,57,61,62,87],origin:[14,60,86,26,46,7,87,43,63],tcp_keepalive_tim:[57,70],feedback:[40,57],objhead:[50,57,52],over:[31,83,71,18,65,60,81,14,78,58,34,76,33,6,79,41,62,87,57,20,44],fall:[33,65],becaus:[56,71,74,47,62,49,75,51,42,83,33,4,34,76,78,41,52,10,23,20,57],jpeg:[3,17],privileg:[1,45,57],omnio:[2,56],flexibl:[10,33,2],vari:[3,16,7,35,80,4,63],digest:[52,58,30],makefil:[61,42],streamlin:38,cli:[1,25,50,51,80,53,71,15,81,8,9,79,35,76,10,57,30],fit:[23,65,20,46],cld:25,fix:[74,80,49,62,16,33,41,27,52,63],crew:33,better:[83,49,75,62,57,16,33,41,56,10,23,12,20,46],offic:33,persist:[50,3,53,41,70,29,84,57],hidden:49,easier:[83,75,7,74,23,63],descend:2,them:[24,1,2,49,68,51,3,52,27,58,56,25,76,77,7,10,12,20,65,40,41,42,43,57,83,61,84,62,63,45,71,46,33,87,23],gnu99:57,woken:25,thei:[1,74,49,51,42,14,67,70,30,25,75,76,77,79,35,10,57,12,20,38,40,41,52,43,17,56,83,61,23,63,65,71,46,33,84,87,47],proce:[87,6,27,17],priv_cal:[61,46],safe:[61,51,33,41,10,63,20],"break":[51,83,49,56],band:42,bang:56,promis:[41,20,52],interrupt:30,yourself:[27,2,25],bank:33,rumour:62,choic:56,"40b":57,reopen:[82,68],"0xb7509610":35,arrow:25,each:[1,68,50,51,14,26,85,67,62,29,30,76,10,63,58,39,60,83,52,43,57,61,65,71,33,87,23],debug:[18,50,71,9,62,30,63,20,57],went:[71,20,62],side:[24,39,61,49,75,65,83,16,33,6,79,80,87,23,63],mean:[24,49,51,16,62,75,76,86,78,35,69,17,63,20,85,61,52,43,4,57,83,65,71,33,84],doddl:74,pdflatex:78,reqstart:[50,79],req_stat:57,interop:83,list:[24,1,2,51,14,54,67,30,31,75,76,32,66,34,78,9,79,35,17,63,58,38,85,60,15,82,57,45,71,20,33,87,23],exactli:[1,62,45,71,52,23,63,20,30],spider:17,"1kb":[77,46],taught:20,forgot:[49,38],logo:71,dawn:49,extract:[83,63,85],"24x":71,respreason:50,network:[83,1,2,50,7,66,67,70,87,57,30],goe:[1,62,51,32,33,9,41,56,43,37],crucial:63,content:[0,24,1,2,25,68,50,51,3,4,5,22,29,30,31,58,75,7,35,36,57,63,20,80,81,85,52,43,16,17,83,61,71,46,37,86,87],rewrit:[78,57],adjust:[29,5,70],adapt:[33,65],reader:51,got:[33,65,20,36],forth:[0,76,79,6,65],outburst:[31,16,84,20,4],cli_auth:30,barrier:[84,25],worthwhil:83,gzipbodi:26,nightmar:23,situat:[33,62,83,57],free:[61,49,7,33,70,87,29,84,20,57],standard:[83,49,71,46,8,7,47,20,57],small:[24,83,29,56,65,7,77,33,52,87,10,57,17],fret:10,spdy:[83,84,49],speedi:49,convent:[31,49],libedit:27,angl:24,haywir:62,openssl:[33,23,30],filter:[83,68,75,60,54,9,79,35,10,30,63,38],soekri:74,vcl_backend_fetch:[22,6,75,16],ish:[24,76,74,80,57],iso:[56,20,42],isn:[34,29,41,63,65],iphon:7,regress:[26,56],subtl:33,loud:33,spersist:41,user:[1,2,49,39,50,74,4,5,56,31,25,75,68,7,80,63,37,38,13,60,41,52,43,54,57,83,65,85,33,87],rang:[87,33,57],httpgarbag:50,grade:11,meet:38,independ:[78,83,49],wast:[23,57,20,49,16],rank:[8,33,74,60,54],restrict:[83,1,46,78,30,57],hook:61,instruct:[24,2,3,9,27,36,10,63,17],alreadi:[86,61,47,49,75,3,74,83,57,16,34,5,9,35,36,87,29,23,38],vug6:49,messag:[83,50,51,71,33,9,79,41,62,87,84,57],wasn:65,ditch:41,fantast:20,primari:61,vmod_director:[87,8,58,75],xid:87,rewritten:[3,60],top:[1,59,25,14,83,54,62,87,43,63,17],sometim:[83,50,71,77,33,9,74,63],fiction:49,sdeprecated_persist:41,master:[1,50,71,9,79,62,17,57],too:[1,74,52,65,57,33,41,27,35,70,23,20,38],similarli:57,lognam:68,critter:[83,30],john:[25,74],listen:[1,50,45,9,30,57],danish:33,murder:74,consol:[5,9],namespac:[75,63,4],signup:2,clueful:63,took:33,waster:83,tee:62,only_root:57,compressor:83,somewhat:[43,61,63,15,36],conserv:[34,63,57],wchar:57,technic:[25,56],past:[83,49,74,33,22,42,38],silli:[42,63,20,52],target:61,keyword:[75,15,66,6,67,87,63,20],provid:[86,1,25,51,3,45,61,7,71,5,9,67,41,62,43,57,58,30],expr:85,tree:[61,23,57,26,52],zero:[61,49,51,3,14,81,85,6,10,47,57],shower:33,matter:[83,2,51,42,33,58,78,27,52,20],bca3633d52607f38a107cb5297fd66e5:52,silly:20,frankli:78,"5mm":74,minut:[24,61,62,46,27,36,87,20],expected_respons:87,vanrishadm:30,mini:42,fashion:[87,43,58],websocket:[83,64,44],abov:[24,1,75,3,62,45,61,26,16,34,9,27,35,52,11,57,63,30],ran:[5,33],modern:[11,2],mind:[61,2,83,38],localnetwork:87,spent:[50,51,33,74],raw:[79,82,60,85,74],pessimist:56,manner:[29,9,57],wmiss:57,concent:56,seem:[43,78,84,83,49],incompat:[27,20,42],seek:29,minu:[23,65],recreat:57,wpointer:57,latter:61,sound:[33,49,62],client:[0,48,2,49,68,50,3,26,54,22,67,62,75,66,34,7,79,35,36,17,63,58,60,83,82,16,57,61,4,85,37,21,6,87],evalu:[50,35],transmit:[50,57],vrt_magic_string_end:61,simplifi:63,crippl:20,plenti:[33,63,57],though:[33,41,74,30],vmodtool:61,"0x4196af":62,glob:[60,82,14,85],object:[0,24,2,25,50,65,3,4,54,19,6,28,29,30,49,75,77,7,35,36,57,63,20,80,15,41,52,16,17,58,61,48,45,71,37,87,55],what:[0,1,74,2,49,39,51,3,42,53,54,5,27,67,73,56,86,31,84,76,33,34,7,9,79,35,80,10,57,12,20,38,13,65,85,40,15,41,52,43,17,83,61,47,62,63,45,71,37,21,87,23],supress:47,regular:[61,59,68,51,85,60,71,7,67,78,82,35,56,87,43,30,63,28],letter:20,bsd:42,objstatu:50,tradit:57,wish:33,don:[0,1,49,4,19,27,75,7,10,63,20,38,83,15,41,52,16,57,61,12,65,37,86,47],vcl_fetch:[22,75],doc:[87,78],alarm:65,camp:83,flow:[83,19,67,38],doe:[25,50,51,3,62,16,5,70,84,32,7,78,9,35,36,10,57,63,20,38,80,83,15,52,17,61,23,45,85,33,87,47],declar:[61,76,67,87,43,58],annoi:[20,38],wildcard:76,thunder:36,gzip_stack_buff:57,enclos:[87,57,67,30],unchang:3,sum:[58,36],came:[50,33,12,61,42],treati:49,busyobj_worker_cach:57,othervis:0,mostli:[51,57,63,38],pope:47,opposit:52,varnish_secret:[1,71],probe:[50,43,76,87,57],"_noreturn":20,syntax:[76,3,81,85,19,27,67,80,87,29,30,57],pipe_timeout:57,advisori:52,directli:[1,2,75,33,6,27,52,87,63],radio:47,pkg:27,radic:78,protocol:[83,68,50,17,57,87,47,20,30],priv:61,involv:[1,33,49,7],despit:[33,6],submit:[1,6],layout:51,menu:78,explain:[3,80,42,52,10,38],configur:[1,2,50,51,53,16,19,27,70,29,71,30,31,75,76,32,86,72,34,8,80,10,57,63,42,43,17,5,21,87,23],apach:[8,33,68,10],stanza:[43,35],bust:9,busi:[87,35,74],phpsessid:63,painfulli:[83,41],gzip_buff:57,"0x42bce1":62,thread_pool_purge_delai:75,steel:20,nasti:62,stop:[83,50,53,33,72,71,5,43,57,30],next:[13,61,39,51,65,40,4,83,76,33,56,87,47,86,20],obscur:[62,42],report:[74,62,80,50,3,32,14,85,26,33,9,73,56,10,47],txresp:26,transpir:[20,42],earn:83,bar:[61,26,52,43,63,20],ietf:[83,63,49],patch:[74,56],fals:[87,61,85,40,16],reload:[34,79,57],bad:[74,65,71,33,35,62,20,57],"sm\u00f8rgrav":[59,68,14,60,82,57],ban:[50,71,4,7,41,35,80,87,29,57,30],told:[1,9,56],respond:[33,16],blew:33,victim:74,pummel:76,job:[61,76,65,83,26,33,52,10,38,63,57],wstrict:57,cache_esi_deliv:9,roadmap:24,"0x40":57,nul:[87,61,67],num:82,mandatori:[87,85,18,56],result:[56,83,61,85,50,51,3,42,14,40,57,16,33,6,81,36,30,63,37,17],respons:[0,48,1,2,25,68,50,16,19,6,55,30,75,7,80,17,63,83,41,4,57,61,64,85,87],fail:[7,49,50,71,26,46,78,6,27,70,87,63,57],themselv:[52,42,30],so_sndtimeo:57,vcc_allow_inline_c:[69,1,75,57],best:[83,2,76,33,26,78,23,20,57],subject:[87,83,38,63,17],awar:[48,4,77,21,35,62,29,63,57],said:[11,33,49,74],hopefulli:[34,10,3,74],databas:[61,41],field_list:14,arcana:52,figur:[62,65,7,33,27,42,12,38],outstand:[82,68],finger:33,awai:[83,68,51,71,82,52,10,23],irc:[2,32,33,9,62,38],approach:[76,83,40],attribut:87,accord:[67,52,74,20,17],triplet:76,extend:[80,68,69,75,4,19,74,10,63,58],mandat:[83,42],boss:[33,53,71,80],extens:[83,11,22,61],workaround:61,wear:41,extent:[51,83],toler:56,advertis:83,kitchen:65,setsockopt:57,protect:[61,1,53,78,57],expos:34,fault:57,howev:[61,83,9,27,67,52,87,43,63,37],misguid:83,against:[0,25,53,71,85,67,66,41,28,87,57,35],futil:62,countri:37,varnishstat:[59,68,60,14,26,54,77,8,82,73,62,10,57,17],fileformat:78,compromis:[1,65,25],suggest:[62,74,38],host_head:87,"16k":57,foobar:[3,61],excess:[33,57],gopher:83,"16b":57,cnt_deliv:9,shortcut:[76,83,57],infirm:33,wider:83,diff:78,guid:[13,2,39,31,9,80,63,57],assum:[24,83,25,3,7,85,34,21,35,42,29,23],goodby:23,speak:[31,1],question:[83,61,2,76,40,33,80,87,10,38],trapdoor:49,coredump:57,divers:[10,42],three:[24,83,1,49,25,51,80,14,61,4,33,35,62,57],been:[86,83,25,63,51,75,14,21,72,40,33,6,41,87,10,57,12,20,38],accumul:[35,25,57],trigger:[6,62,36],unsubscrib:38,dlopen:[61,57],interest:[83,59,49,62,33,78,28,56,10,84,63,38],advers:29,futur:[83,49,75,65,87,38,57],vcl_deliv:[48,61,7,6,35,87],tini:33,threw:33,http_req:25,life:[56,83,49,62,65,74],spit:52,dismiss:76,worker:[61,50,51,74,45,71,57,9,35,62,10,17,30],"25g":57,telnet:[78,47,83,30],argument:[1,62,80,45,81,42,53,61,46,7,6,27,67,14,51,87,71,20,30],vcc_err_unref:57,implict:57,craft:7,cli_buff:[57,30],child:[1,25,50,51,71,57,9,62,10,23,30,17],"catch":49,spin:62,emploi:83,ugli:[41,20],ident:[83,75,51,62,14,76,9,52,87,43,58,57],aix:[56,42],prefer_ipv6:[71,57],servic:[31,1,47,25,80,45,57,46,34,72,62,30,38],zlib:23,commerci:[7,32,38],employ:33,calcul:[63,37,33,52,12,20,30],devicedetect:7,neat:[51,65,20],aid:32,vagu:2,alloc_seq:51,sanit:1,seven:49,fe80:[1,45],tabl:[31,83,57],complaint:33,elicit:49,conf:[45,70],tediou:42,"0x43ef68":62,thread_pool_stack:57,sever:[48,83,74,86,46,33,36,43,63],grown:20,vclrel:57,"80m":57,perform:[83,2,80,49,29,43,56,71,15,4,50,19,85,35,70,10,23,57],nazi:76,make:[1,74,2,25,50,51,3,56,4,54,19,27,67,70,46,30,77,49,75,33,34,78,9,36,10,57,12,37,38,86,85,40,15,7,41,52,43,16,17,83,61,62,63,65,71,20,21,87,23],transpar:[32,70],bikesh:[33,49],complex:[83,75,33,10,23,38,57],split:[75,4,21,22,62,29],vmod_dir:[1,57],complet:[82,59,75,50,60,45,71,15,6,87,23,63,57],raid:12,nil:56,nake:40,lustr:49,hang:[62,38],deflect:[33,83],hand:[74,40,33,41,42,57,20,17],fairli:11,rais:41,portal:77,evit:6,studi:45,tune:[3,80,45,71,54,70,10,4],kid:[33,23,65,83],lockless:[57,52],kept:[59,60,26,77,33,82,35,29,63],scenario:[76,7],thu:[83,1,35,49,30],itself:[82,9,18,59,68,60,85,14,81,26,46,7,41,87,57,63,30],inherit:[87,67,25],eur700k:33,vcc_unsafe_path:[1,57],contact:[33,45],cooloff:57,thi:[0,24,1,2,85,25,68,50,51,3,42,53,26,4,54,5,22,27,58,73,70,29,46,86,30,82,31,49,75,76,32,21,72,34,78,9,79,35,36,10,57,63,37,38,39,59,14,80,60,81,15,7,41,52,43,16,69,17,56,83,61,47,18,65,62,48,45,19,71,20,33,6,87,23,67],mother:[33,9],gzip:[84,49,50,3,26,16,74,87,4,57],programm:[10,78,20],everyth:[61,3,83,54,7,9,27,56,79,23,63],legisl:83,left:[83,25,59,14,85,54,78,6,87],agon:33,identifi:[83,51,7,79,76,63,20],just:[0,1,74,49,51,52,54,19,56,25,76,7,9,35,10,17,12,20,38,65,83,42,43,57,61,63,45,71,58,33,47],sigusr1:[82,68],bandwidth:[3,83],via:[1,75,86,35,63,38],backend_hint:[75,7,36,87,43,58],human:33,yet:[1,23,62,33,20],languag:[61,1,2,80,68,64,40,26,20,8,19,85,75,42,87,10,57,63,37,17],previous:[29,75],easi:[10,63,20,25,62],elm:20,royal:78,must_reload:57,my_acl:46,spread:33,esi_chop:57,board:2,els:[56,61,62,3,52,71,26,7,66,9,36,87,43,23,63,37],save:[83,49,3,87,63,57],explanatori:20,transit:[6,57],elt:33,gave:[33,42],opt:[31,57],applic:[31,2,68,14,16,34,82,79,36,43,63],mayb:[43,33,49],preserv:83,sanitari:65,objreason:50,donat:33,ktrace:62,vrt_ctx:61,background:[22,6,35,36],elabor:9,dreamt:23,ineffici:49,apart:[65,61,63,75],measur:[10,60,57],daemon:[8,68,14,82,57],specif:[1,2,68,70,26,54,19,27,56,31,76,32,80,10,63,20,41,42,17,61,85,87],arbitrari:[43,1,79,19,37],nudg:33,manual:[31,61,18,59,68,60,80,14,81,26,46,8,82,62,87,10,57,58,30],pool_sess:57,instanci:87,zoop:43,remind:38,confid:1,docutil:[78,27],hung:62,uppercas:[20,46],el6:27,unnecessari:[3,63],el5:27,www:[24,31,61,2,34,86,87,43,63,30],right:[48,39,56,74,62,49,65,42,14,33,71,83,78,52,10,61,57],old:[9,61,68,50,51,65,71,82,83,22,79,35,41,76,63,20,57],deal:[83,51,57,4,76,33,41,36,10,23,38],negat:[87,67,30],interv:[87,43,61,14,57],crown:42,somehow:76,dead:25,intern:[75,7,29,63,37,57],varnishd:[24,1,68,50,51,14,26,16,27,62,29,30,31,76,8,9,79,10,17,59,60,81,15,82,54,57,18,45,71,46,87],i686:9,heritag:83,bore:20,successfulli:[34,6,20],txt:78,cooper:[59,68,14,60,26,82,87,57],vcl_hash:[75,7,6,35,52,87,37],bottom:[78,14],establish:[51,81],fpic:57,generer:50,massiv:20,multipli:40,fog:49,condit:[2,49,3,85,9,62,87,30,57],wunus:57,localhost:[86,1,45,72,81,67,66,79,35,87,43,30,57],peek:[24,78],plu:23,sensibl:[61,74,3,42,16,56,20],uncompress:[3,16,57,4],burn:23,unreason:76,repositori:[65,27,26],post:[31,46,38],chapter:[31,1,9,45,57],sshd:1,http_max_hdr:57,obj:[48,75,16,7,6,35,36,87,57,30],smalloc:9,unfortun:[41,63,20],algo:1,commit:[76,83,49],produc:[61,68,3,83,78,35,42,57],commis:83,match:[55,59,68,60,14,85,57,28,76,66,82,79,35,52,87,43,67,30,63,38],net5501:74,dilemma:33,tackl:33,"float":[61,85],encod:[83,50,3,57,26,54,87,16,63,17],bound:[2,59,60,45,82,16,86,9,29],verbiag:20,down:[1,49,65,14,9,67,41,43,87,10,63],vcl_log:[50,68],resili:43,nuke_limit:57,wrap:[1,78,20],opportun:12,stall:51,storag:[61,50,45,3,80,53,83,15,16,77,51,41,57,52,87,29,54,30],often:[61,25,49,75,52,62,87,57],somedict:52,git:[65,27,74],crowd:[33,62],suffici:45,boutiqu:61,transform:[5,7,74],happi:[87,33,74,61,16],avail:[24,1,2,68,51,70,14,26,27,67,56,29,30,75,7,35,59,60,83,41,57,61,18,85,33,82,87],gif:[55,49,16],reli:[43,63,56],editor:[34,43,78,86,74],fraction:[33,85,57],hit_for_pass:75,overhead:[50,77,57],constantli:54,clockskew:57,fork:25,head:[83,59,68,60,82,87,63,57],amateur:20,form:[39,1,18,51,46,16,62,47],xabyt:57,forc:[59,49,50,76,3,60,4,82,35,87,63,57],recommend:[31,1,45,15,46,27,35,70,47,63,58,57],refcount:[50,49],hitrat:[9,63,80,57,4],vcl_all:87,hear:49,idle_send_timeout:57,heap:35,icmp:83,"true":[24,61,75,3,85,40,26,16,6,71,9,27,35,62,87,46,63],analyst:83,mymod:61,reset:[87,3,57],absent:[82,60],suspect:[9,49],full:[24,61,47,49,67,29,87,10,23],toolchest:49,bugfix:62,vcl_init:[87,43,6,58,75],maximum:[59,76,3,60,82,70,87,29,57,20,30],until:[61,49,68,76,56,40,85,72,6,35,52,47,20,57],strace:[9,62],ncurs:27,fundament:[76,10,83,2,39],autoconf:27,retir:[76,75],c_byte:51,nnn:30,classif:7,adopt:[33,83],openbsd:[11,2,56],sight:23,semicolon:67,classic:[41,57],httpbi:83,http2cfi:83,textbook:49,sale:38,diagnost:63,exist:[49,68,51,75,40,7,21,42,87,29,23,37],request:[0,48,1,2,85,49,68,50,3,53,26,4,54,19,22,28,73,30,75,34,8,7,9,79,35,36,10,57,63,59,80,60,82,43,16,17,83,64,45,71,46,6,87],ship:19,check:[25,68,50,51,14,85,19,27,30,9,79,35,36,10,63,37,38,59,80,60,40,82,42,43,57,61,71,33],shit:74,sticki:58,assembl:[24,10,20],encrypt:1,when:[0,24,1,2,85,25,68,50,51,3,14,26,4,54,19,6,28,62,29,71,30,49,75,76,32,21,34,8,7,9,79,35,36,10,57,63,37,38,59,65,80,60,41,42,43,16,17,58,61,47,48,45,5,20,33,82,87,23],actor:25,til:1,role:[83,63,25,4],test:[24,61,74,18,50,3,56,71,26,72,8,33,85,27,35,42,11,57,17],tie:[10,86],presum:[10,20],unlimit:[29,9],wcast:57,intend:[87,67,62],benefici:70,devot:33,felt:[33,83],fell:[20,25],intent:[43,56],consid:[61,49,68,65,83,77,33,43,87,29,63,57],exp_inbox:50,warn:[59,50,60,82,41,87,20],receiv:[48,1,2,68,50,3,57,82,6,87,17,63,58,30],faster:[2,51,79,70,57,38],furthermor:[1,52],logstream:5,anywher:[83,23],exce:[63,85,57],ignor:[68,50,3,16,67,87,63,57],distro:56,time:[24,1,74,2,49,68,50,51,3,42,14,26,4,19,6,27,70,29,30,76,9,35,10,11,57,12,20,38,85,60,40,41,52,43,54,17,56,83,61,47,18,62,63,65,5,46,33,87,23],push:[51,83,52,49,30],serious:[69,49,56],backward:20,wshadow:57,stick:[47,49],vmod_set_ip_to:61,concept:[83,51,52,86,41,74,43,63],cli_timeout:57,snif:42,whoever:20,skip:[1,3],global:[87,61,73,57],focus:[87,83,38,4],invent:20,haxlw:62,shellscript:42,signific:[77,30],netbsd:[11,2,56],millisecond:[87,57,75,46],varnish:[0,24,1,74,2,85,25,39,50,51,3,42,53,26,4,54,5,6,27,58,73,70,29,46,86,30,82,31,49,75,76,32,21,72,34,8,78,9,79,35,36,10,11,44,63,37,38,13,77,59,14,80,60,81,15,7,41,57,52,43,16,69,17,56,83,61,47,18,65,62,48,45,19,71,20,33,22,68,84,87,23,67],middl:[83,74],depend:[31,32,19,7,78,85,27,62,87,29,63,17],graph:[59,54],exp_rearm:50,flash:[83,41],readabl:[87,78,61,56],"_that_":25,rel:[61,51,40,33,10,57],default_ttl:57,certainli:[61,33,62,20,56],vec:3,downtim:41,addon:63,oversight:61,sourc:[56,38,61,84,49,86,32,57,33,26,54,78,9,27,41,42,87,23,30,20,17],string:[61,58,59,68,50,3,85,60,40,57,46,7,82,67,52,87,47,63,20,30],"3am":25,vdir:[43,58],daemon_opt:72,spate:52,revalid:63,varnishncsa:[59,68,50,51,14,26,8,82,60,10,57,17],lru:[50,77,57],cook:65,word:[83,78,41,20,30],exact:[33,57,71,30],cool:[51,41,25],exp_when:50,foo:[61,85,81,26,46,9,52,87,43,63,20,30],hour:[87,33,46,38],administr:[31,1,25,45,10,12,57],level:[61,1,80,50,3,62,14,78,85,83,33,41,56,87,57],did:[84,49,25,3,56,65,85,33,41,42,47,20],die:[10,71,49],gui:49,overarch:21,shortcom:[83,20],ccf_panic:62,mystat:61,cooki:[24,61,2,80,62,83,4,55,85,28,52,10,46,63,58,30],sedimentari:83,round:[29,57,58,49,43],prevent:[1,76,83,33,35,20,57],brave:[10,27],htc:7,core:[23,9,62,57],trend:74,cache_cli:62,sign:[83,25,57],cost:[33,47,12,83,57],gzipe:3,unprotect:25,port:[1,50,72,27,30,75,76,34,7,9,10,39,81,43,57,83,18,45,46,86,87,47],comparis:30,pipeacct:50,appear:[87,33,83,30],cecili:[18,81],filler:20,repli:[87,12,81,57],"64bit":70,anywai:[51,33,47,76],current:[83,1,2,49,75,71,14,21,57,46,33,35,62,87,23,20,38],wors:[83,20],rephras:62,appeal:33,boost:33,deriv:33,compos:[49,38],gener:[1,74,62,25,50,69,52,14,54,6,56,30,77,75,34,9,63,20,38,40,41,42,16,57,83,61,45,71],timeout_req:57,satisfi:[1,85,33,27,56,57],kamp:[31,83,2,59,68,50,60,14,26,16,82,87,57],address:[1,50,51,67,30,75,76,34,7,9,37,60,81,57,83,18,45,71,46,66,87,47],along:[83,61,14,1,46,35,74,63],wait:[83,25,49,62,14,81,6,36,87,57],box:[7,83,62],buck:56,insan:23,fenc:23,volumin:49,errorhandl:62,group_cc:57,queue:[57,36],behav:[9,42,17],dusti:76,extrem:[19,33],weird:[34,40,49,56],transact:[0,83,59,49,68,50,82,80,60,85,26,6,9,79,67,62,17],commonli:[63,60,58,54],ourselv:56,semant:87,love:[61,33,65,20,56],humour:63,extra:[7,41,75,57],tweak:[3,27,49,15],modul:[1,25,75,61,46,8,41,10,87,43,58,57],prefer:[83,76,71,67,52,11,63,57],marker:[87,61,83],instal:[31,61,32,45,34,86,9,27,11,57],smallish:52,mobil:[43,7,83],"0x42f838":9,transplant:33,regex:[87,82,60,35],memori:[1,25,68,50,51,16,5,70,29,77,8,9,79,10,59,60,81,82,52,54,57,61,85,46,87],subvert:25,franca:78,visit:34,todai:[41,65,49],subvers:1,everybodi:[57,62,38],live:[56,65,33,4,78,41,35,42,87,29,57,63,38],handler:57,"417a":47,criteria:[83,85,37,55],scope:87,angri:20,reorder:7,twitterif:35,fridai:33,afford:52,peopl:[1,74,62,49,75,76,56,65,83,33,41,35,52,47,63,20,38],claus:36,finit:49,clue:9,suckag:[47,84],drown:38,prototyp:[83,61,46,33,58,57],examin:[83,51,3,71,62,87,57],exp_expir:50,effort:[83,49,33,41,56,23,20],easiest:[63,71],fly:[83,71,16,57,63,30],graphic:78,car:33,prepar:[87,10],pretend:86,focu:[33,2],cat:[49,30],descriptor:[50,61,62,57],hardest:61,http1:57,whatev:[83,1,49,51,61,71,35,62,63,57],purpos:[86,40,15,46,72,6,35,43,63,57],materi:[33,20],problemat:83,heart:27,favourit:49,sourcefil:30,stream:[49,50,3,7,5,6,44],predict:[85,49,52],slightli:[51,3],"1980i":[61,17],wnest:57,backslash:[85,14,67,30],agent:[68,60,85,54,7,87,43,4,63],topic:[39,33,47,79,38],heard:[33,56],critic:[33,83],abort:[23,6,37],"14b":62,hash_always_miss:[87,35],recycl:52,simul:[62,26,17],occur:[60,54],alwai:[83,61,62,25,68,3,56,65,71,26,16,33,85,15,52,87,57,20,30],sundai:46,multipl:[61,14,80,45,71,76,19,82,87,51,60,43,57],oslo:74,charset:75,ping:[57,79,30],uptim:14,write:[2,49,68,51,26,5,56,29,30,25,76,78,79,35,10,12,20,41,42,57,61,33,82,23],anyon:56,fourth:78,swore:33,parameter:81,fetch_bodi:50,map:[61,49,51,7,43,12],product:[36,45,33,78,56,57],ban_lurker_sleep:[35,57],book:[12,33,41,74,63,20],max:[50,9,63,59,57],clone:27,timedout:20,spot:[83,78,20,25,38],usabl:[76,20,62],intrus:[56,38],mac:[47,56],mad:42,mai:[1,68,56,14,6,27,67,62,29,75,7,17,20,38,60,40,82,52,57,61,23,45,33,84,87,47],shuffl:[0,6],suck:78,data:[0,49,50,51,62,6,74,29,30,25,77,8,9,79,63,20,40,82,52,43,57,61,85,37,87,23],grow:[23,57],repeat:[83,14,57],accessori:56,repo:27,stress:[33,20],autotool:27,practic:[83,25,3,78,33,20],mgr:25,disabigu:76,secur:[83,1,84,80,25,45,52,53,71,15,33,29,10,57,38],ideolog:33,mangl:63,inform:[2,68,50,14,54,5,27,62,75,76,9,79,63,38,59,60,82,52,43,57,83,87],"switch":[61,75,76,57,5,15,71,19,6,10,30,78],wrt54g:56,combin:[8,68,85,30],block:[50,87,9,14,67],anoth:[83,61,25,76,3,42,45,19,57,7,33,35,52,87,10,47,63,20,17],talk:[61,49,76,16,78,87,10,47,30],shield:36,virtualis:70,brain:33,ttl:[24,55,75,50,57,26,4,6,15,36,87,29,46,63,35],clock_skew:57,still:[24,83,1,74,62,49,42,71,7,33,9,35,41,52,63],pointer:[61,50,76,8,20,57],dynam:51,entiti:61,snippet:[7,63],vtc:[27,26],group:[1,59,68,60,83,85,8,7,82,79,67,87,43,47,20,57],thank:[65,33,2,49,56],polici:[24,83,2,76,71,87,10,38],torn:65,norwai:[78,33],unambiti:20,instantli:[10,61,71,76],platform:[56,39,2,32,34,78,9,70,84],window:[50,43,11,79,87],monopol:57,curli:[87,67],mail:[32,2,38],main:[83,49,50,80,62,10,38],limbo:41,do_gzip:[87,3,16],non:[24,61,2,80,68,42,81,85,78,41,56,57],synopsi:[18,59,68,60,14,81,26,46,82,58,57],ban_lurker_batch:57,set_health:30,losthead:50,smarter:[78,7],rake:[33,84],objprotocol:50,initi:[83,1,49,68,50,61,82,85,6,67,41,87,58,57],nation:33,underneath:83,safari:7,half:[78,33,57],nov:46,now:[24,74,2,49,39,3,42,14,72,27,28,56,75,76,86,34,78,9,79,36,63,20,13,40,41,52,43,83,61,23,65,71,46,33,87,47],discuss:[2,71],nor:[83,61,16,67,87,20,57],introduct:9,wont:[33,9],wagon:42,term:[83,52,33,56,10,17,63,57],workload:15,polish:49,name:[68,50,51,14,26,67,29,30,75,76,10,63,59,60,81,15,82,52,57,83,61,45,85,66,87],realist:[65,52],opera:20,config:[43,61,57,27,44],drop:[33,57,38],crypto:[83,23],separ:[61,25,45,60,83,82,85,22,23,63,57],pcrepattern:63,careless:47,between_bytes_timeout:[87,57],polit:25,reqstatu:85,backendclos:50,failov:10,domain:[87,19,83,25],replai:[8,18],replac:[83,49,75,36,34,42,87,47,57],individu:[24,61,50,85,30,57],continu:[39,59,60,14,26,54,33,6,87,57,63,20,30],ensur:[10,3],vcl_trace:[50,62,57],"0x8006b51c1":62,sponsor:[33,41],year:[83,49,65,33,46,78,74,87,20],operand:85,happen:[49,69,3,62,74,25,75,78,9,35,36,10,63,58,59,60,61,82,57,83,65,33],disturbingli:74,shown:[33,61],accomplish:63,libjemalloc:27,space:[75,14,85,57,77,33,41,79,87,29,47,30],repetoir:40,max_retri:[6,57],stupid:[76,1,25],pagedown:14,rational:63,internet:[33,47,25],ironi:[74,62],bla:49,correct:[63,20],varnishlog:[82,18,59,68,50,60,14,26,4,8,5,9,79,62,10,57,63,17],monster:20,state:[61,76,46,41,87,30,57],migrat:76,million:74,libpcre3:27,theori:[3,37,52],ebcdic:17,org:[31,61,2,86,83,26,54,34,78,27,74,87,57,63,37,38],"byte":[0,83,68,50,3,57,46,6,52,87,29,23,30,17],rfc1884:47,vcc_if:61,care:[61,2,56,33,27,52,43,47,63,37,17],reusabl:[87,67],funki:65,wai:[1,74,25,51,62,56,76,8,7,9,79,35,69,63,20,52,38,80,81,45,42,57,83,61,23,65,71,37,33,87,47],badli:[33,63,83,16],waiter:57,dunno:1,synchron:[6,57],modest:33,honest:[33,49],motion:49,thing:[1,49,3,62,16,5,74,25,76,77,10,63,20,83,42,43,57,61,65,71,33,23],place:[61,36,65,9,35,52,47,38],router:[87,83,66,67],principl:12,imposs:49,frequent:[63,60,57],first:[1,49,68,50,69,3,74,53,4,72,62,30,58,75,33,77,78,9,79,35,36,10,12,20,38,86,80,60,83,82,52,43,57,61,23,63,45,85,46,37,21,87,47],oper:[1,25,50,51,70,5,27,67,62,29,30,75,10,63,40,81,41,42,43,57,45,85,46,66,87,28],redhat:[32,70],carri:[77,23,63,25],onc:[31,61,80,65,62,60,71,72,76,5,9,27,35,41,36,10,58],arrai:[41,52],housekeep:61,wedg:62,potentialiii:83,fetcher:57,textual:83,waitinglist:[50,57,70],oppos:5,open:[1,49,50,51,56,27,62,29,30,76,86,9,10,38,61,43,57,83,45,33,87,84],predefin:7,size:[83,74,59,49,68,50,51,52,53,46,77,7,9,35,70,29,80,57,20,30],given:[83,60,81,85,14,40,26,46,82,76,29,58,30],sheet:23,silent:51,teenag:74,mailman:38,autocrap:[84,42],caught:9,sessclos:50,traction:83,necessarili:9,cassett:47,white:[85,57],conveni:[61,71,38],get_lock_befor:20,friend:[33,75],amonst:57,arith:57,cope:49,copi:[1,3,36,57,61,42,7,33,52,87,44,63,38],specifi:[82,1,18,59,68,14,45,61,26,81,77,87,41,67,29,60,10,57,20,30],qual:57,"short":[0,64,15,9,29,57],vcl_backend_error:[0,50,6,87,75],packet:[83,20],pragma:[63,4],quad:57,grunt:12,than:[1,74,2,25,68,51,3,62,16,6,27,70,29,49,76,78,79,35,10,11,20,38,65,85,40,15,81,41,42,57,83,47,45,71,46,33,82,23],png:[3,71,35,55],serv:[34,83,77,2,58,68,45,71,46,6,7,22,35,38,36,43,17,63,37,30],wide:[83,63,70],sess_workspac:75,slt_vcl_log:46,posix:[20,42],balanc:[83,86,5,52,87,43,23,58,17],were:[83,61,18,75,71,81,33,42,84,12,20],posit:[50,83,20,85],yesteryear:83,surrog:63,browser:[3,34,78,79,63,37,17],pre:[10,1,29],lowest:40,sai:[1,49,25,3,62,83,20,33,28,52,43,47,63,37],cnt_session:9,nicer:20,vcl_string:61,ani:[1,25,68,50,51,3,62,16,5,6,55,56,29,30,31,49,75,76,33,7,9,35,10,57,63,20,38,60,83,82,52,43,54,17,61,85,21,87,67],slap:51,ant:7,relativli:4,"20g":35,deliv:[0,48,83,74,2,75,50,3,56,7,57,16,33,6,35,36,87,4,63,17],exclud:[82,60,68],saw:[33,12,20],worst:[50,33,42],reqacct:50,engin:[87,7,23,57],squar:[74,57],advic:45,berequrl:[50,63,54],destroi:[65,20,57],offer:[83,1,71,7,10,38,20,57],note:[24,39,83,75,63,3,32,71,16,67,87,69,27,28,70,43,29,46,12,58,57],schmocument:78,"_end":62,take:[74,49,51,56,4,19,27,67,62,29,46,33,78,35,10,63,20,83,57,61,71,37,21,87,23],noth:[61,76,65,33,38,58,57],channel:[44,32,2,25,38],begin:[62,59,50,52,60,85,82,6,42,87,43,20,57],sure:[2,49,51,3,56,16,62,30,70,25,75,76,34,7,9,17,63,38,83,15,43,57,61,65,33],importantli:52,trace:[50,9,65,62,30],normal:[50,3,40,7,46,33,6,79,74,4,63],buffer:[29,47,85,57],reqend:85,knowingli:33,compress:[80,50,3,74,16,52,87,4,57],paid:33,server1:43,exclus:14,abus:83,copy_of_varnish_secret:71,homepag:74,gunzip:[50,3,26,57],latex:78,renam:[51,61,41,75],pcre_match_limit_recurs:57,esi_syntax:24,drive:[29,33],"0x4193f6":62,varnishtest:[8,26,17],runtim:[61,57,14,59,70],eur10:33,patchlevel:63,translat:[34,87,19,47,30],shop:38,backendreus:50,show:[24,49,50,62,14,26,54,74,30,78,34,7,9,79,17,63,59,85,81,15,42,57,71],cheap:[77,57],merit:51,n900:56,permiss:[10,9,30],hack:[27,83,2],threshold:[50,43,87,57],corner:[83,59,25,54],boom:62,fifth:78,ground:49,xml:[24,57,14,80,17],onli:[24,48,1,74,25,50,51,3,62,14,26,16,6,27,70,29,49,75,76,7,77,78,9,79,35,36,11,57,63,20,38,85,60,81,15,41,42,17,83,61,47,18,71,33,82,87,23],slow:[57,65,46],ratio:35,stair:65,esi_ignore_http:57,dick:83,activ:[24,83,1,76,3,62,61,16,77,71,79,56,10,57,30],get_lock_tim:20,carrag:30,wood:74,rexec:83,analyz:[63,54],summertim:49,analyt:63,analys:[83,12],offici:[34,41],overwritten:[82,79,68],nearli:33,variou:[9,1,2,18,25,63,3,19,4,83,5,6,29,57,12,30],get:[1,74,2,25,68,51,3,42,14,16,19,6,27,58,56,71,30,31,49,75,76,32,86,7,9,79,35,36,57,63,20,38,39,59,65,80,60,83,15,41,52,43,17,61,47,62,45,5,37,33,82,87,23],stomp:51,auto_restart:[71,57],ssm:[26,57],ssl:[23,84],cannot:[83,1,2,49,25,75,3,61,78,67,52,23,20],ssh:[83,1,25,51,71,81,47],ssd:41,geo:83,harsher:33,requir:[1,75,71,57,79,35,52,87,43,30,38],truli:[76,83],reveal:33,seldom:35,dramat:24,berespprotocol:50,sidewai:12,priviledg:25,draft:[83,20],through:[1,2,50,51,3,14,19,6,67,62,30,31,72,9,35,10,57,63,20,38,13,15,52,44,45,5,23],where:[1,2,49,50,51,62,14,85,19,56,29,86,30,75,76,32,7,78,9,12,20,13,65,60,83,42,43,57,61,63,45,71,37,33,23],vision:83,summari:[81,73,74],wiki:[83,2,78,30,63,38],kernel:[1,51,70,62,23,57],aquaeduct:20,surgeri:65,workspace_backend:[61,75,57],shm_reclen:57,seal:29,sport:83,wonder:[65,33,74,12,52],youself:1,detect:[80,19,42,7,70],review:33,enumer:83,label:[50,83,46],behind:[83,49,7,56,63,38],between:[61,59,25,75,50,60,3,14,81,46,33,82,79,76,87,10,57,63,20,17],"import":[48,1,49,62,53,67,74,25,75,76,20,80,63,58,40,43,57,61,45,71,46,87,23],engang:33,tcp_keepalive_:70,across:[1,83],assumpt:49,parent:[50,33,9,57],screen:[7,59],pool_req:57,style:[10,30,17],cycl:[23,14,16],jobb:63,sessopen:[50,79],refman:1,come:[48,1,45,62,54,6,55,74,9,79,10,63,20,60,83,15,41,52,43,4,61,65,82,47],tue:9,beliv:33,sketchi:83,quiet:[56,26,38],contract:33,emit:[50,6,30],audienc:33,tutori:[13,39,31,34,86,27,80],"80013339a":62,mani:[56,83,61,2,65,75,50,51,52,45,81,26,33,9,29,87,10,23,63,20,57],clf:68,evict:[50,77,35],acceler:[31,8,86,43,30,63,57],displai:[59,68,50,60,14,54,8,82,79,30,57],overview:[50,8,85],inspir:33,period:[59,51,60,85,14,87,57],pole:38,featur:[13,83,2,76,74,16,33,41,79,36,57,20,38],colon:[47,85],toupper:[61,46],typic:[48,31,2,18,3,52,7,6,27,29,10,38,17],karstensen:[87,14,2],poll:[76,54,87,43,20,57],damag:[1,47],libvarnish:30,sess:[50,49],"0x8006b8b76":62,segfault:[69,9,80],stretch:40,invert:85,fritzvold:[18,81],mark:[59,50,51,60,57,46,67,82,35,74,87,43,54,30],resphead:[50,63],varnish_nam:14,listen_address:[45,1,53,57],addit:[87,76,83,2,20],surplu:33,hitpass:50,avian:78,repons:[30,17],"80013822c":62,reaction:49,thousand:[62,36],resolut:[10,33],drawer:47,doxygen:78,doesn:[24,83,85,46,80,78,16,20,33,9,79,67,41,42,29,23,63,37,30],workspac:[61,62,57],those:[1,2,49,65,85,14,61,71,34,76,33,41,56,23,63,20,38],"case":[56,61,1,7,49,75,50,3,42,45,78,57,16,33,85,52,87,46,63,20,30],myself:[87,33,67,25],hdr:[26,46],ungzip:3,tinderbox:56,"40gbit":83,trick:[25,7,43,47,20,38],admin:[5,63,25],invok:[35,30],outcom:83,familiar:63,invulner:1,reenter:29,invoc:42,margin:[83,23,25],advantag:41,stdout:[1,14,81,57],metric:10,canon:23,undercut:33,worri:[1,49,33,41,27,74,47],cluster:[43,33,41,86],bias:33,pthread:[20,57],reqmethod:[50,79],telescop:33,ascii:[1,47,25,17],kettl:41,add_backend:[87,43,58,75],develop:[82,39,83,2,59,68,60,74,14,26,33,9,41,56,87,57,20,38],contriv:61,author:[1,25,49,83,4,63,57],respstatu:[50,9],tour:5,same:[1,2,25,68,51,3,14,26,6,56,29,30,49,76,34,7,79,35,36,63,59,60,81,82,52,57,83,61,18,45,71,46,22,87,47],trip:[49,62],binari:[18,59,60,78,19,82,27],epoch:[50,87,61],html:[24,49,3,74,7,78,52,17],pad:62,sentenc:38,pai:[33,74,38],document:[49,68,50,62,14,26,16,6,67,56,30,31,78,80,38,59,60,81,82,43,54,57,83,61,18,85,46,33,87],medit:[9,6,80],arcitect:83,vmod_tolow:61,week:[87,33,74,65,46],exhaust:50,finish:[50,74,81,57],webserv:[49,45,74,47,63,17],see:[24,2,25,68,50,65,3,14,26,16,19,27,55,62,71,30,49,75,34,7,9,79,35,63,20,38,59,60,81,82,43,54,57,58,83,61,47,18,45,5,46,37,33,87,23,67],rxresp:26,assist:12,driver:25,ness:3,weed:83,director:[75,8,19,80,87,43,58],capabl:[3,9,64,78,58],improv:[83,33,22,20,80],extern:[10,57],immedi:[38,63,57,30],defi:20,spend:[49,50,62,16,33,70,38],stdin:[1,81,71,57],vtailq_next:20,supdup:83,appropri:[24,34,27,63],all_added_weight:58,choos:[27,12,58,43],patchwork:74,macro:[20,26,42],page:[24,68,14,26,29,30,31,7,77,78,9,79,35,36,63,20,38,39,59,60,81,82,57,83,18,46,37,87],without:[1,49,68,3,62,85,6,27,56,30,76,35,10,12,20,52,38,81,41,42,83,61,71,33,82,87],sigsegv_handl:57,model:[83,25],roughli:[1,62],summer:[84,49],affair:12,abund:45,execut:[1,58,50,76,19,46,5,6,35,62,87,10,71,63,37,57],resp:[48,61,75,50,26,46,7,6,35,87,57],bitmap:20,gdb:9,kill:[83,25,49,50,62,57],multiplex:49,aspect:[10,23,20],touch:[39,33,57,2,51],monei:[33,41,52],listelm:20,speed:[29,83,62,2,31],mebibyt:29,http_resp_hdr_len:57,blow:73,ixslvvxrgkjptxmcgnnsdxsvdmvfympg:30,downright:49,europ:38,struct:[50,61,52],hint:[87,5,6,33],mmap:[29,57],korken:63,except:[85,66,6,35,87,29,47,63,67],littl:[83,77,33,62,20,57],blog:31,"255b":57,pile:[83,23,74,38,36],exercis:34,tarreau:83,vulner:[33,38],session_ling:75,real:[61,2,58,49,62,40,46,54,33,56,87,10,17,20,38],psk:[10,1,30],around:[1,74,62,80,56,53,71,16,33,52,47,12,57],libm:42,secreci:1,read:[48,1,49,39,50,51,3,54,5,27,67,62,30,31,25,75,68,78,63,13,59,60,81,15,41,57,83,61,71,46,82],rfc2616:49,dark:10,esi_level:[87,3],traffic:[61,49,74,18,25,43,62,19,83,8,5,79,70,10,57,63,58,17],mon:61,loos:41,world:[83,34,23,63,20,38],unsign:[61,52],dare:42,tolow:[61,46],towel:65,stranger:33,whitespac:[63,57],vcl_dir:[1,57],mgt_param:57,exploit:25,integ:[61,85,46,41,52,87,30],server:[0,24,2,25,26,16,19,28,74,30,31,49,75,78,79,36,11,57,63,37,38,39,80,41,52,43,4,17,83,18,48,45,58,86,87],benefit:[33,41,12,83,56],shmfile:9,either:[31,61,59,49,75,76,3,62,45,81,85,78,6,67,42,87,29,11,63,20,57],output:[24,31,61,68,50,60,3,62,14,7,82,76,78,9,52,57],strcmp:62,reqprotocol:[50,79],fulfil:83,thermodynam:52,handshak:23,authent:[1,81,5,30],respect:[83,49,75,51,3,33,6,80,63],intact:24,basic:[39,58,49,76,80,7,46,6,19,9,79,67,56,87,63,20],whould:83,shmlog:57,micro:42,freebsd:[56,83,2,62,14,32,45,26,33,82,27,70,11,23,38],definit:[87,76,41,26],token:30,legal:[56,46],moon:[24,12],exit:[25,59,68,51,14,71,82,81,6,60,57],"128kb":57,notabl:[3,83],overli:63,ntpd:20,refer:[31,61,68,50,57,83,26,67,8,78,6,35,80,43,38,63,30],needlessli:57,immun:52,timeout:[59,60,81,82,87,43,20,57],power:[1,59,19,35,47,57],whose:6,inspect:[15,9,35,43,47,30],hexdump:30,fulli:[43,49,52],regexp:[61,30],getnameinfo:47,"throw":[83,76,71,33,35,52,23],src:[24,26],deflat:[50,3,83],y2k:57,central:[33,1,22,78,25],coupl:[65,40,54,5,9,27,33,7,63,38],drag:49,greater:[33,84,65,85],acl:[1,50,64,66,35,87,67],chop:57,eur90k:33,degre:[1,2],intens:57,stand:[78,23,83,49],act:[63,56],industri:33,rebuild:65,road:[65,49],xnn:30,stevedor:[87,74],outlook:33,bom:57,effici:[83,76,3,16,51,57],paypal:33,surviv:[29,49,57],inbox:50,counterintuit:7,your:[0,24,1,2,49,65,42,53,4,54,19,27,67,70,29,46,30,31,58,75,76,7,34,78,9,79,35,69,10,12,37,38,86,77,80,83,41,52,43,16,17,56,61,62,63,45,72,20,21],stare:[49,52],"14f0553caa5c796650ec82256e3f111ae2f20020a4b9029f135a01610932054":52,log:[0,1,25,68,50,51,74,14,26,54,5,73,62,75,8,78,9,79,69,10,17,63,38,13,59,80,60,41,57,18,85,46,82,87],area:[77,83,14],aren:63,hex:[10,30],overwrit:[51,82,79,68],start:[24,1,74,2,49,68,50,51,62,53,26,85,5,67,70,29,30,31,25,72,34,9,79,80,10,57,63,39,59,14,60,41,43,17,83,65,45,71,86,82,87,23],compliant:[83,56],mindless:[78,25],interfac:[1,81,80,53,61,71,8,41,35,42,10,57,30],low:[29,57,25,52],lot:[49,3,56,54,19,27,67,62,75,77,9,35,63,20,40,52,43,83,65,85,33,47],ipv6:[83,84,76,45,71,47,57],submiss:33,hen:[74,2,49,68,50,52,14,26,16,56,31,25,84,76,78,12,20,59,60,40,41,42,57,83,23,65,33,82,87,47],machin:[1,76,45,71,34,9,87,10,47],hei:65,unam:42,ago:[76,9,49,74],hard:[56,83,1,80,49,42,61,15,9,52,29,57],relic:42,verbatim:68,enough:[61,76,62,65,33,41,52,20],conclud:33,bundl:57,regard:56,sighup:[82,68],amongst:[20,42],decend:56,cryptograph:[1,52],buggi:57,categor:62,conclus:[76,33,83],longer:[31,49,75,81,15,4,35,20,57],notat:76,hire:33,fraud:74,possibl:[1,2,25,51,3,74,42,6,67,56,30,70,75,76,7,9,10,17,12,38,52,57,45,46,33,87],"default":[1,2,68,50,3,14,4,72,6,27,70,29,75,34,7,9,36,63,37,59,85,60,83,15,82,52,43,16,57,61,45,71,86,87],bucket:57,exp_kil:50,monopoli:25,deadlock:87,expect:[50,51,56,33,26,34,78,52,87,63],gone:[1,75,21,41,35,10,57],ohh:[83,65,20],unreferenc:57,creat:[24,48,1,25,51,3,26,54,6,55,29,75,7,44,63,58,59,17,15,57,83,66,87,67],certain:[24,1,50,32,83,15,4,19,35,87,43,57,63,58,55],strongli:[1,83],intro:[29,53],decreas:[85,57],some_filenam:71,file:[24,1,74,62,25,68,50,51,3,42,53,26,16,19,56,29,30,7,72,8,78,79,57,20,38,59,60,81,41,52,43,17,61,18,45,71,46,86,82,87,23],legacy_broken_cm:63,proport:56,fill:57,workdai:78,again:[39,25,76,65,71,72,33,9,41,10,38,37,17],collid:20,googl:[63,49,74],binocular:12,hybrid:83,prepend:[30,16],field:[83,59,68,50,51,14,85,57,46,87,33,60,47,20,30],valid:[35,49,85],compet:12,copyright:[31,18,59,68,60,14,81,26,46,82,87,57,30],writabl:87,you:[0,24,1,74,2,25,39,50,51,3,42,53,4,54,5,6,27,58,70,29,46,86,30,31,66,49,75,76,32,21,72,34,78,9,79,35,36,10,11,44,12,37,38,13,77,65,81,80,40,15,7,41,57,52,43,16,69,17,56,83,61,47,62,63,48,45,19,71,20,33,84,87,23,67],architectur:[31,83,2,49,46,20],sequenc:[68,85,30],symbol:9,listen_depth:57,ansi:42,briefli:71,track:[61,49,40,9,38,63,57],http_front_end:71,z_ok:9,pool:[76,57],reduc:[24,4,7,41,70,29,57],assert:[9,20,62],escal:57,neuter:78,directori:[1,61,26,34,8,28,29,57],invest:33,descript:[61,18,59,68,50,60,81,14,71,15,46,33,26,87,57,58,30],slt_error:63,fuse:33,tricki:[77,51,62],mass:83,potenti:[1,36,83,85,7,6,62,87,57,38],escap:[68,9,14,85,30],invoic:33,degrad:6,cpu:[20,23,35,57,16],unset:[75,3,35,7,55,87,10,63,28],logarithm:[59,54],represent:[76,61],all:[24,1,74,62,25,68,50,51,3,42,26,16,6,28,56,29,30,49,76,77,7,9,79,35,36,10,57,63,20,38,59,65,85,60,83,15,41,52,43,17,61,45,71,46,33,82,87,47,67],usd15:33,consider:21,lack:[33,63,83],standardis:20,month:[33,74],mp3:16,abil:[76,29,33,36],follow:[25,68,14,26,16,6,27,67,62,29,30,75,34,7,9,35,36,11,57,63,38,59,80,60,82,44,18,85,86,87],disk:[33,5,79,70,29,57],children:65,vcl_void:61,mathisen:[26,57],default_keep:57,spectacular:38,catastrophi:41,discard:[61,50,76,71,6,35,43,29,63,30],articl:[24,33,7,52],tail:[82,60,59,68],program:[1,25,68,50,56,53,26,54,5,62,8,78,79,10,17,63,20,59,60,40,82,57,61,71],solicit:33,scratch:[83,75,49,62],neglig:19,introduc:[51,46,16,52,43,47],"4d45b9544077921575c3c5a2a14c779bff6c4830d1fbafe4bd7e03e5dd93ca05":52,fax:33,liter:78,parcel:46,far:[24,83,47,49,56,33,52,23,63,20],secret_fil:81,faq:23,buer:[18,14,81,46,82,87,30],offlin:29,ouch:41,util:[31,18,59,68,60,14,81,54,82,46],candid:[50,6,56],mechan:[87,51,1,35,20],failur:[85,26,57],veri:[24,1,49,62,54,5,22,56,29,25,76,34,78,10,63,20,38,40,41,52,57,83,61,46,33],ticket:[33,9,62,32,38],"06t08":46,fan:49,unalt:6,"0x80":57,colleagu:33,binheap:50,"99999999b":57,random:[31,1,84,58,46,74,16,78,52,43,4,37,38],emul:58,sane:15,sma:51,node1:87,expban:50,enterpris:[34,72,32,70],ten:[59,49],tea:27,sync:41,tex:78,syslog:[1,69,46,9,62,57],biolog:49,design:[83,1,25,49,61,71,52,87,10],pass:[0,61,68,50,3,75,81,57,46,6,55,56,87,16,63,17],further:[1,85,6,7,9,67,38],heartble:33,dial:87,sub:[24,50,69,3,26,16,55,75,28,7,35,36,10,44,63,58,52,43,57,61,37,66,87,67],clock:[10,33,20,57],sun:46,section:[39,62,21,43,32,53,19,4,5,9,27,67,73,70,10,80,46,86,58],advanc:33,abl:[56,61,1,62,49,25,81,52,65,5,15,71,83,78,41,70,23,20,57],delet:[54,63,28,57,30],version:[24,1,2,68,50,3,14,27,70,31,75,7,78,11,17,63,59,60,83,82,42,57,61,18,87,47],time2r:46,deepli:[33,83],"public":[86,63,49],movement:25,cookie1:63,hasn:57,cookie2:63,hash:[0,58,59,75,50,80,54,19,6,35,52,87,84,37,57],variat:63,unmodifi:16,sessionclos:50,decid:[1,2,25,65,77,33,6,41,47,63],behaviour:[24,2,15,16,21,4,17],modular:49,http_resp_siz:57,solari:[56,11,42,2,70],trunk:65,recompress:16,method:[61,68,50,75,1,7,66,22,27,35,87],strong:1,modifi:[48,1,85,3,80,61,46,71,6,7,87,16],legend:[50,52],valu:[61,85,59,68,50,42,14,83,57,16,54,75,6,67,70,87,46,58,30],search:[31,38],ahead:49,ixslvvxrgkj:30,newlin:[87,67,30],observ:57,prior:70,amount:[77,29,3,83,57],pick:[1,50,86,35,56,84,63,58,38],action:[0,61,19,35,80,87,43,63,55],narrow:[41,40],magnitud:2,lurker:[35,57],shorthand:57,primit:61,vcl_return:50,"while":[24,61,1,74,83,50,62,65,21,7,16,77,33,22,27,36,29,20,38],filenam:[1,59,68,60,14,61,82,78,41,30,57],href:24,famili:[52,65,38],sanction:47,suddenli:[76,33,56,36],acceptor_sleep_decai:57,select:[68,50,14,75,60,85,82,20,57],aggress:35,ear:38,hexadecim:30,ripe:83,distinct:[61,75],ctrl:14,regist:83,two:[1,2,45,3,62,26,22,27,74,76,36,10,63,83,41,52,43,17,61,65,71,33,87,47],formul:38,taken:[83,68,51,65,27,28,30],md5:52,minor:[57,56],more:[1,2,25,51,3,42,26,16,27,58,70,46,30,49,75,78,9,79,10,63,20,38,13,65,40,41,52,43,54,57,83,61,62,45,71,37,33,87,47,67],reachabl:1,precompil:61,flaw:[83,25],desir:[33,7],openvz:[32,70],tumbl:65,hundr:38,mozilla:[7,63],flag:[61,50,14,53,87,10,57],vxid:[59,68,50,60,85,82],broke:20,particular:[61,49,51,3,83,46,33,22,27,35,76,87,30],known:[31,49,68,45,70,47,12,20],compani:[33,42,71,20,38],doom:20,cach:[0,24,2,85,25,68,50,69,3,74,53,26,4,19,6,27,62,29,71,30,31,49,75,76,34,8,7,9,79,35,36,10,57,63,37,39,77,14,80,83,15,41,43,16,17,61,18,48,45,5,46,86,87],none:[83,45,85,78,87,20,57],endpoint:[50,83,57],thread:[9,61,62,75,50,51,70,45,26,54,76,22,35,36,57,20,38],valuabl:62,hous:[65,20],outlin:67,dev:[1,9,27,38],histori:[18,59,68,50,60,85,14,81,26,46,8,82,87,57,30],remain:[24,50,87],rfc5952:47,nine:23,caveat:[1,62],learn:[1,83,38],abandon:[59,68,51,14,82,78,6,56,60],instantan:71,userbas:56,typograph:78,prompt:25,bogu:50,scan:68,challeng:[1,61,30],share:[1,59,25,68,50,51,81,85,60,61,46,8,9,79,76,87,10,54,20,57],accept:[1,3,57,71,26,54,87,16,63,17],firmli:49,minimum:[29,57],sharp:83,pong:79,varnishsoftwar:63,huge:[23,20,36],cours:[25,74],ixsl:30,freshli:[61,35],divid:40,rather:[83,68,62,65,40,82,78,9,33,42,23,30],stig:[26,57],comfort:27,nostdreturn:20,fame:52,divis:10,heck:[20,74],fed:[5,33,52],reject:[87,67],reviv:41,simpl:[24,1,62,83,67,7,6,35,43,10,57,63,20,30],css:49,unabl:[87,67],idioci:20,absentmindedli:12,resourc:[61,50,83,41,70,10,57,38],penetr:83,referenc:[10,61,57],unprivileg:57,variant:[83,6,63,35],sneak:83,time2integ:46,unlink:29,stabil:83,circumst:[41,25],github:7,coax:49,postfix:35,confus:[74,47,62,20,40],proto:[87,49],fulltim:63,dragon:69,caus:[83,62,70,85,33,9,52,29,12,57],thread_pool_max:57,wrench:[10,49],tangibl:83,dream:23,sysctl:70,help:[71,46,62,85,25,50,51,81,32,57,33,26,40,83,5,9,35,70,10,38,30],max_ag:57,erod:33,soon:[41,65,70],radar:83,berespstatu:[50,85],dough:[33,84],hierarchi:85,suffer:[83,63],paramet:[24,1,25,50,51,3,62,53,16,27,70,29,30,31,75,7,9,35,69,17,63,80,81,15,57,45,71,21,87],typedef:61,"384b":57,render:[24,75],nifti:54,cache_req_bodi:46,brows:20,late:[61,74],harmless:47,rapidli:20,astonish:49,bypass:63,might:[13,83,77,63,52,16,34,20,78,9,27,35,41,36,43,12,37,57],alter:[24,2,64,16,19,6,55],epol:[9,57],wouldn:[1,20],foon:30,good:[83,1,84,50,52,65,61,57,71,33,9,41,70,87,23,63,20,38],"return":[0,50,16,6,67,30,75,20,7,35,36,44,63,58,17,81,52,57,61,71,46,37,66,87,47],authorized_keys2:25,timestamp:[50,46,14,35,30],uhm:67,libwww:63,detour:57,framework:75,somebodi:[12,20,42],barbarian:12,complain:33,bigger:[29,83,57],eventu:[83,6,47],pkgconfig:27,quoted_vclstr:30,troubleshoot:[10,9,80],"0x8006b4307":62,userid:30,unlik:[83,62],refresh:[59,6,22,35,36,87,63],caseless:[82,60,59,68],easili:[33,63],achiev:[9,63,80,4],"0x416a70":9,"1tbit":83,khtml:7,ceas:63,dialin:[66,67],backtrac:[9,62],phamplet:33,truncat:[29,57],subsystem:33,n_lru_nuk:77,mental:34,send_timeout:57,needless:[25,52],bereq:[24,48,61,55,75,50,3,57,26,16,7,35,87,46,63,44],set_ip_to:[61,46],monoton:20,idea:[13,61,2,50,3,74,71,57,33,42,23,12,20,38],procedur:[61,32,46,34,78,62],realli:[24,1,49,45,3,16,67,62,31,25,79,35,10,63,38,40,41,43,57,83,65,71,33],heavi:63,varnishadm:[31,1,71,15,81,8,5,57,30],iter:[87,26],inflict:42,stabl:51,beyond:36,event:[50,29,83,57,38],linpro:[87,2,26,38],"try":[62,49,51,3,52,16,27,56,30,25,75,76,34,78,9,35,17,12,58,38,83,42,57,61,45,20],flower:65,vmod_toupp:61,varnishhist:[59,50,60,14,26,54,8,82,73,57,17],publish:[33,47],research:[83,20],footnot:56,etag:16,health:[50,76,80,19,36,87,43,30],print:[59,68,14,60,71,82,76,30,63,57],occurr:[87,57,46],nest:87,digest_len:52,foreground:[57,30],php_sid:63,bass:83,dirt:65,differ:[24,49,51,3,42,26,19,29,75,76,86,7,10,63,20,83,41,52,43,61,5,37,33,23],unload:[43,61,30],significantli:[83,23,42],quick:[5,45],reason:[34,83,25,50,71,46,6,78,9,27,56,87,10,23,12,20,38],base:[24,48,83,2,7,25,68,86,75,57,78,44,58,33,35,43,29,30,63,37,17],applewebkit:7,put:[56,39,61,47,74,49,46,50,42,45,72,15,37,78,57,52,23,20,17],decompress:16,basi:[87,43,78,83,56],thrown:33,driven:[2,26],vmod:[1,58,49,75,74,61,46,8,6,67,10,87,43,37,57],launch:[9,62,30],drupal:63,exponenti:57,perhap:7,due:[50,51,77,9,27,87,29],circuit:0,corkscrew:23,lifetim:87,assign:[87,83,61,67,57],feed:[33,52],sess_timeout:[31,75],"lyngst\u00f8l":[87,26],obviou:[76,71,36],upper:[82,60,20,59,57],feel:[83,25,49,74,71,27,52,20],famou:[40,74],misc:38,number:[1,49,50,51,3,62,14,26,6,27,70,30,75,76,79,10,20,59,60,40,82,52,57,83,61,23,45,85,46,87,47],evolut:49,calloc:61,done:[75,43,62,65,72,7,33,85,27,35,70,10,23,63,58,57],unhealthi:43,blank:57,slower:[52,4],miss:[83,59,68,3,85,57,4,7,6,35,41,62,87,10,54,17],can_gzip:87,stage:[3,33],guess:[43,20],guest:65,vararg:61,interact:[10,14],berespreason:50,construct:[24,65,57],"0x8006b3ef2":62,paint:74,stori:41,bumbl:74,fympg:30,saint:76,illeg:33,ton:[83,42],scheme:[10,76],store:[48,61,2,50,51,3,65,83,16,77,41,52,87,29,57,37,17],statement:[24,61,75,50,69,28,62,87,67],relationship:25,blindli:40,park:[76,57],round_robin:[87,43,58,75],part:[83,1,85,68,51,75,14,61,46,67,22,35,41,42,10,63,57],hugepag:[32,70],wextra:57,consult:33,fastli:2,tebibyt:29,"0x429f8b":62,std:[61,68,50,75,46,36,87,57],kind:[83,1,49,51,74,61,7,71,33,85,62,87,57],simplist:49,grep:63,prebuilt:27,whenev:[61,50,51,71,34,56],remot:[1,49,68,50,71,70,10],seamlessli:76,horizont:[59,54],bugfre:25,reus:[50,51,57],architect:[2,49],str:87,arrang:61,stale:[59,68,60,14,82,6,22,36,43,30],toward:87,weapon:49,randomli:[23,30],stataddr:60,comput:[83,74,25,56,78,58,33,42,11,71,20],default_grac:57,grandios:83,peculiar:[39,5],packag:[32,45,86,27,56,10],ackward:83,expir:[59,50,60,40,82,41,35,87,57],propos:[33,12,83,49],dedic:[74,57],"null":[61,9,83],option:[1,68,50,53,26,16,70,30,9,79,35,63,59,14,60,81,82,43,54,57,83,61,18,45,85,87],sell:[83,65],mountain:70,entireti:85,xref:1,built:[83,65,80,45,19,5,6,35,52,87,12,67],lib:[57,30],ee30d0770eb460634e9d5dcfb562a2c5:52,vcl_int:61,troublesom:[41,47],efh:62,also:[1,2,49,68,50,51,3,62,14,26,16,22,55,56,30,31,76,32,77,35,36,12,58,38,39,59,85,60,40,81,41,42,43,57,83,61,47,18,63,45,71,82,46,33,6,87,23],thatotherserv:45,build:[61,49,32,65,7,26,33,27,12],tp1:31,techniqu:58,donor:33,cc_command:[1,57],backend_health:50,brace:67,tool:[31,61,84,18,25,50,83,4,77,8,78,42,10,54,63,20,57],pipelin:[49,74],distribut:[83,59,20,27,87,43,54,58],exec:57,wswitch:57,previou:[31,39,71,7,58,57],reach:[61,2,19,79,35,87],react:9,most:[0,24,74,2,49,50,65,3,42,54,19,27,62,29,71,30,76,34,78,9,35,10,63,38,60,40,15,41,52,57,83,61,48,45,5,33,47],plai:[43,33],must_restart:57,plan:[49,57,33,74,29,23,12,38],gzip_level:57,metacharact:47,wisdom:[12,20],vcl_purg:[6,35],amaz:[20,49,42],fileread:46,esi_remove_bom:57,bug:[74,62,3,32,33,9,56,38],filesystem:[1,41],clear:[38,83,49,25,65,33,78,87,23,20,30],cover:[39,83,32,53,19,73,56,10,63,17],destruct:[84,65],execept:83,clean:[51,61,6,27],page_s:57,pars:[18,50,3,4,6,87,63,30],subgroup:87,sector:41,ridicul:20,carefulli:[33,12],cdn:10,alphanumer:63,fini:61,session:[82,83,50,60,85,57,46,9,70,23,58,30],particularli:[20,52],thread_pool_fail_delai:[75,57],finn:63,fine:63,trhead:22,impact:[10,19,57,35,29],ambit:20,firewal:83,avg_1000:14,pretti:[1,36,65,7,41,52,38],avg_10:14,writer:51,solut:[76,33,35,49,42],writev:57,queu:57,templat:[63,35],factor:31,lennon:74,remedi:83,hit:[24,74,55,59,68,50,76,3,62,85,54,6,9,79,35,36,87,10,57,63,17],unus:57,luke:83,financ:33,sydnei:20,cheaper:71,sfile:[9,62],nativ:[17,16],grew:56,tcp:[1,18,50,32,45,83,6,70,10,57],dependend:57,contrari:6,banner:30,him:12,restart:[0,31,61,49,25,39,50,51,3,75,71,85,72,6,62,87,10,57],silo:[29,57],vsl_reclen:57,synthet:[87,6,35,75],diffabl:78,synthes:[82,60,59,68],rfc:[50,47,63,75],common:[0,61,2,52,33,80],nowher:[27,20],remov:[24,83,55,75,3,80,71,57,16,7,35,43,10,46,63,28],wrote:[33,42],certif:[33,23],forego:33,set:[24,1,25,68,50,51,3,62,26,16,5,6,55,70,29,46,30,58,75,32,86,77,7,9,35,36,57,63,20,59,85,60,40,15,41,42,43,44,61,45,71,37,33,82,87],art:[20,25,17],dump:[54,9,62,23,30,57],sep:61,jade:47,startup:[1,41,45],celebr:10,lion:70,max_pool:57,bare:83,wg14:20,arg:[51,30],reserv:[87,20,75],jemalloc:[23,27],arm:41,project:[83,2,65,33,78,56,12],inconveni:52,systemat:11,someth:[56,61,74,62,49,63,43,32,83,46,34,78,9,27,36,10,12,69],grandmoth:65,particip:83,won:[0,61,65,9,35,80,20],mutex:[51,20,57],append_ua:7,subscript:[85,57],experi:[83,2,49,3,78,33,57],vmod_priv:61,altern:[1,27,83],appreci:74,numer:[45,85,71,42,47,20],javascript:63,lowercas:[37,46],succeed:[34,43,87,81],percent:33,distinguish:[33,42],popul:48,hairi:[76,3],lass:[87,14,2],last:[61,59,50,14,83,57,46,33,9,41,43,54,30],delimit:67,hyperlink:[31,78],start_child:62,alon:[78,23],anon:25,intercept:83,context:[75,76,62,40,7,4,78,52,87],pdf:[78,20],protector:57,whole:[0,87,9,27],becam:[47,42],load:[24,83,1,71,25,76,43,52,61,57,58,5,6,36,87,10,30,86,20,17],simpli:[61,17,33,41,67,87,23,38],point:[61,2,50,76,3,83,20,34,35,43,29,23,63,37,57],instanti:49,schedul:36,z_stream_end:9,leon:63,header:[48,2,68,50,3,54,6,55,62,30,75,34,7,80,10,44,63,58,17,83,82,42,16,57,61,4,64,85,46,37,87,28],provok:[49,26],hash_data:[87,7,37,52],linux:[56,2,32,7,42,34,72,9,70,11],batteri:10,mistak:20,backend:[0,48,2,85,25,50,51,3,53,26,4,54,19,22,28,29,30,77,49,75,76,86,34,8,7,79,35,36,57,63,58,39,80,60,82,43,16,17,61,18,64,45,71,46,21,6,87,84,55],duh:49,identif:[87,52],faithfulli:83,becom:[24,83,56,49,52,65,7,78,42,20],java:43,"_atom":20,stamp:50,territori:41,devic:[83,80,7,19,29,43,17,30],first_byte_timeout:[87,57],empti:[1,68,76,14,46,33],secret:[1,23,72,81,5,62,47,30,57],pcre_match_limit:57,synth:[66,6,35,7,75],wwrite:57,thread_pool_destroy_delai:[75,57],nonexist:61,strategi:[24,1,41,7],firm:49,invis:57,ram:57,fire:34,imag:[77,83,3,28,16],densiti:83,great:[10,1,78,19,72],fund:33,understand:[49,25,7,33,9,52,87,63,20,17],workspace_sess:57,station:47,tangenti:33,repetit:62,invit:65,trojan:1,look:[0,24,1,62,49,50,3,42,5,6,56,30,31,25,34,79,35,36,12,20,13,59,80,81,41,52,43,57,83,61,63,45,72,37,86,87,47],solid:57,straight:[41,38],"4084b":57,real2tim:46,batch:57,durat:[61,49,40,26,46,87,71,20,57],ramif:49,pace:57,respprotocol:50,"256m":72,smart:[3,38,52,16],behavior:[58,26],doubli:57,fun:[65,49],vmod_:61,everyon:[87,66,67,72],lingo:61,pack:20,subsect:[21,4],eur1:33,malloc:[61,50,45,53,77,72,9,87,29,57],larger:[3,85,33,62,23,57],pounc:83,hcritbit:[9,62],readi:[50,27,2,76],vacat:[32,84,49,62],workspace_cli:[61,75,57],rip:[65,42],revers:[31,1,2,57],rxreq:26,cento:[34,45,72,32,27],demot:56,seen:[51,60,40,7,5,9,52,12,20,78],"00z":20,rid:71,time_firstbyt:68,esi_bodybyt:50,shirt:20,minim:10,belong:[35,85],shorter:[15,57],anniversari:10,lengthi:46,grand:49,octal:30,higher:[6,85,57],x86:11,optic:33,imagin:[61,76,65,71,41,42],optim:[23,79,35,57],banter:38,unwarr:83,"1000x":31,alert:56,unintention:75,healthi:[75,46,36,87,43,58,30],moment:[24,61,36,62,43,38],temporari:[26,57],varnishreplai:[8,18],provabl:20,stack:[9,30,20,57,70],focal:83,recent:[40,11,33,30],expend:83,task:[86,83,25,50,40,71,77,33,52,43,30],equival:87,ampl:87,older:[57,27,35,20],entri:[51,60,54,8,9,79,67,87,63,37,57],parenthes:[87,67],joyent:56,person:[1,27,52],cheer:20,expens:[77,61],tast:[27,56],anybodi:78,ubuntu:[32,45,34,72,27,70],darn:47,explan:[61,25,52,9,62,38],burden:56,from:[0,24,1,74,2,85,49,68,50,51,3,42,14,4,54,19,22,27,28,73,62,29,30,31,58,75,76,32,7,67,78,9,79,35,36,10,11,57,12,20,38,86,77,59,65,80,60,40,82,52,43,16,17,83,61,47,18,63,48,45,71,46,33,6,87,23,55],uselessli:16,collabor:49,press:[31,78,79,59],shape:[20,49,74],pan_ic:[9,62],mob:83,regardless:87,pipesess:50,northern:12,poller:76,do_stream:87,fstack:57,bereqmethod:50,cut:49,"455ce847f0073c7ab3b1465f74507b75d3dc064c1e7de3b71e00de9092fdc89a":30,tablet:7,cup:27,libncurs:27,restructuredtext:[78,84,81],vcl_pipe:[87,6,44],flush_head:57,objcor:50,notifi:35,input:[18,50,76,40,71,52,87,57,37,30],subsequ:[0,50,1,6],app:[79,52],useless:[20,57],bin:[24,26],hashedg:57,subroutin:[69,19,6,67,80,87],obsolet:30,format:[47,59,68,50,60,3,14,57,46,8,78,82,87,10,30,20,17],big:[83,61,69,80,45,33,77,76,78,22,74,10,23,20,57],misconfigur:9,do_gunzip:[87,3,16],intuit:43,simple_list:57,wiser:33,bit:[74,49,50,3,70,16,5,27,62,76,7,9,79,35,10,11,63,83,41,52,43,57,61,23,65,33,47],characterist:29,formal:83,strstr:46,bereqprotocol:50,signal:[7,68,62,82,57],shortkei:31,resolv:[87,83,45,67],elaps:[82,60,59],collect:[31,49,25,64,33,46,78,85,62,47,20],api:[50,51,85,56,10,47,20],popular:[24,20,54],vcl_error:[50,75],interestingli:41,encount:[50,3,61,75],scare:23,gnnsdxsvdmvfympg:30,creation:[50,3,57],some:[1,2,25,65,42,26,71,19,22,27,70,30,77,49,75,86,72,34,7,9,35,36,10,12,20,38,81,15,41,52,43,57,56,83,61,62,63,64,45,5,37,33,23],back:[0,61,2,49,25,75,76,71,33,6,41,42,29,38,63,30],understood:83,litter:20,unspecifi:85,sampl:14,workspace_thread:57,mirror:86,sizeof:[61,56],surpris:33,"_bool":20,scale:[76,57,59,54],fifo:57,pet:33,chunksiz:57,per:[61,18,70,14,81,57,46,77,7,82,73,36,87,29,38,58,52,30],cli_resp:25,substitut:[24,76],retri:[0,75,50,46,6,87,57],larg:[33,83,57],slash:[7,57],init_funct:61,reproduc:[18,62],taglist:[82,60,85],cgi:[24,7],run:[1,74,2,25,39,50,69,3,56,53,26,16,72,27,70,29,30,31,49,86,34,8,9,79,80,10,44,63,38,13,59,14,85,60,81,57,41,42,43,17,61,47,62,45,71,33,82,87,23],lose:[49,52],agreement:33,legibl:[87,67],step:[87,32,27,20,70],logrecord:73,squeez:[62,52],prerequisit:[11,32],meantim:[61,42],crap:42,major:[83,25,80,65,41,74,57],subtract:40,mortgag:33,constraint:77,reappear:29,gibibyt:29,preclud:78,prove:[41,20,30],manag:[1,49,25,51,62,61,57,81,33,27,35,43,87,10,30,17],idl:57,preset:6,candi:17,wait_silo:57,loadabl:[75,57],fetch_chunks:57,uncach:[87,6,63,75],cygwin:11,yyyi:14,miracl:83,doubl:[61,65,85,77,87,57,30,38],plethora:9,graviti:20,within:[87,69,57,85,30],backend2:58,grydeland:[68,50,14,60,85,46,82,87],pastebin:38,tmpdir:26,frf91:7,contributor:[2,56],threads_fail:57,perl:[87,63,67],pcre:[87,27,85],occupi:57,inclus:[14,57],institut:56,spam:38,errno:62,megabyt:[45,57],fast:[31,49,76,62,41,52,29,57],custom:[33,41,75],systemcal:20,doubt:[62,38],includ:[24,1,49,50,51,3,26,16,6,27,67,70,29,30,31,76,7,9,35,69,17,20,80,60,82,57,61,85,33,87,23],suit:27,forward:[2,75,50,46,34,38,57],paren:87,datastructur:20,vienna:49,properli:[24,34,25],reorgan:56,fishi:46,kristian:[87,26],wno:57,server2:43,navig:14,link:[24,39,50,51,85,77,78,57,20,38],multilevel:10,newer:[27,35],atom:40,line:[1,68,50,69,53,85,28,62,30,75,8,9,79,51,10,38,14,80,15,82,42,57,61,45,71,33,87,23],mitig:[83,63],redpil:87,info:38,concaten:[87,61],utf:[75,57],consist:[83,2,51,80,14,85,9,41,52,30],munin:54,pageup:14,intim:10,pkg_add:27,contin:60,similar:[61,3,1,72,35,74,63],curv:20,derang:42,constant:[61,40],curs:14,bind:[1,9,14],palisad:12,parser:[50,3],lyx:78,composit:[24,80],repres:[76,83,26,75],"char":[61,52],incomplet:[0,82,60,59],webcach:63,chat:2,home:[33,23,63,40],journal:33,curl:46,gecko:7,bracket:[87,57],"200c":47,profil:59,titl:63,sequenti:61,redhat_transparent_hugepag:70,invalid:[87,5,75,35,71],proxi:[39,83,2,31,6,23],codec:7,transport:83,unadult:36,responsetim:[59,17],nice:[54,79,9,74,46],storage_hint:87,esi_deliv:9,"3f8":62,formatt:68,critbit:57,cs101:51,libtool:27,param:[61,81,15,71,30,57],pool_vbo:57,land:65,algorithm:[86,57,52],verden:[31,59,68,14,60,33,82,87,57],pool_vbc:57,orbit:12,scream:46,depth:57,dot:[87,57],acceptor_sleep_max:57,syncvsl:57,fresh:[65,35],marvel:63,scroll:79,pluggabl:29,code:[1,25,50,69,3,62,26,54,19,6,27,67,56,71,30,58,75,7,78,9,36,10,63,20,38,83,41,42,57,61,23,45,5,37,33,22,87,47],partial:30,edg:[24,57,12,80,16],leak:[23,25],queri:[59,68,75,60,85,82,46,8,7,9,79,87],gang:[31,59,68,60,14,33,82,87,38,57],amiss:34,privat:[8,33,61],ulimit:[9,70],wizard:[49,57],elsewher:[58,75],friendli:[83,63,33,12,35],send:[0,48,83,62,18,3,56,57,7,26,46,34,33,6,36,87,43,54,63,17],granular:[29,57],lower:[1,20,30],vcl_conf:61,gzip_memlevel:57,"256k":57,sens:[49,50,40,16,77,41,56,63,20],sent:[83,68,50,3,7,81,33,63,58,57],settl:40,nett:63,religi:47,unzip:87,rollback:[87,46],garden:65,reinterpret:78,retriev:[87,1,6,30],implicitli:87,relev:[68,9,27,62,43,30,20,38],tri:[2,25,49,75,16,42,57,38],magic:[3,30,61,41,16],complic:[3,63],perceiv:[33,20,49],geograph:10,fewer:[33,4],unquot:85,forsiden:63,"0x42cbe8":9,freed:[51,61],pleas:[24,61,2,49,46,69,3,79,45,57,16,54,9,27,67,62,87,43,38,63,30],malici:83,impli:60,smaller:[33,74,46],fortun:83,natur:[71,20,30],"0x0":46,crop:83,uniqu:[87,86,7,20,62],jump:[67,75,35,42],quickli:[83,22],parkinsson:12,video:7,detrim:57,download:[27,4],odd:[83,63],append:[68,51,75,45,82,10,30],compat:87,index:[50,31,49,52],"455c":30,rate:[24,33,79,10,63,57],resembl:49,"64k":57,multimedia:63,find:[25,51,3,52,26,72,27,73,31,76,9,63,37,38,83,41,42,43,57,61,45,71,86],access:[48,1,66,25,51,61,72,67,78,79,35,87,10,11,57,63,30],experiment:[29,53,57],garbag:[20,49],can:[0,24,1,74,2,85,25,50,65,3,42,53,26,4,54,5,6,27,58,70,29,71,30,31,49,75,76,66,72,77,78,9,79,35,36,10,11,57,12,37,38,86,59,14,81,80,60,40,15,7,41,52,43,16,69,17,56,83,61,62,63,48,45,19,20,33,87,23,67],tar:49,unmask:57,absolut:[61,49,50,40,63,57],usag:[83,59,68,60,82,35,10,63],http_req_siz:57,bodi:[24,83,75,50,26,46,6,87,57,17],srvr:23,let:[24,86,1,2,49,3,72,20,34,78,9,28,41,62,43,23,63,37,35],symlink:42,filedescriptor:[25,30],http_resp:25,max_esi_depth:57,vertic:[59,54],sinc:[1,2,49,50,51,3,75,76,33,34,9,63,20,86,41,52,43,57,61,12,65,85,21,87],convert:[85,81,46],convers:46,conceiv:[83,62,56],overseen:2,technolog:44,host:[68,3,14,19,67,74,30,34,7,79,35,80,63,37,59,60,82,52,43,57,83,45,46,86,87,47],later:[61,18,68,50,42,60,82,33,41,27,67,52,87,79,57,20,38],resurrect:62,earli:83,opinion:83,chang:[0,1,74,2,49,50,51,62,14,16,72,22,27,70,30,31,25,75,76,34,7,10,63,37,38,59,52,43,57,83,65,71,21,87],honor:[87,75],chanc:[83,51,3,61],control:[1,2,25,50,3,14,4,6,67,30,75,7,8,78,9,35,80,10,63,81,57,83,71,66,87,47],short_pan:57,firefox:63,claim:20,appli:[61,50,60,3,14,83,85,82,70,29,57,12,30],approxim:[29,58],foundat:[33,49],apt:27,"boolean":[87,40,85],deputi:12,vsl_space:57,beresp:[24,48,61,75,50,3,57,26,16,7,35,36,87,46,63,55],timesync:20,tailor:[7,40],fee:33,personel:25,max_connect:87,zip:50,commun:[2,49,25,50,60,80,53,7,33,82,56,20,38],frob:3,upgrad:[83,75,76,21,56,44],flat:10,maker:83,websit:[83,65,4,34,80,10,17],few:[83,1,2,5,71,77,33,67,62,10,57,38],latenc:7,usr:[31,86,9,27,45],nth:85,subrequest:85,thread_pool:57,expiri:50,chip:41,rick:63,sort:[49,25,60,40,46,33,79,35,74,12,17],comparison:[40,85,46,67,87,30,57],impress:83,stone:20,lookup:[61,49,75,50,3,16,6,35,52,87,63,37,57],trail:7,"transient":[51,53,15,80,29,57],insensit:[87,85],vclexamplehitmisshead:63,rare:62,iii:42,had:[61,2,76,83,85,33,41,62,10,12,20],fetcherror:50,account:[50,33,25,46],alik:65,field_num:59,scalabl:2,tunnel:83,cumbersom:63,poul:[74,2,49,68,50,52,14,26,16,56,31,25,84,76,78,12,20,59,60,40,41,42,57,83,23,65,33,82,87,47],obvious:[61,47,40,56],vcl_recv:[0,48,61,75,76,3,7,16,66,6,28,43,87,10,44,63,37,35],endian:20,bidirect:44,reqhead:[50,79,60,85,54],fetch:[2,49,75,50,3,86,57,4,22,19,6,35,36,87,30,17],aliv:[32,57,79,70,30,17],proof:83,vsm_space:57,bent:49,grace:[50,87,6,57,36],process:[0,24,1,2,25,68,50,51,3,53,26,16,5,6,62,30,9,79,35,69,10,57,12,38,39,59,14,60,81,82,54,17,61,71,33,87,23],lock:[1,51,61,8,20,57],sudo:27,tax:33,high:[83,62,80,7,36,33,72,4,78,9,70,63,20,52,57],benc:[0,79,1,63,54],tag:[24,59,50,60,85,46,82,79,57],vcl_:[87,67,75],tarbal:27,onlin:[87,63,27],crimin:[25,17],serial:61,weaken:16,delai:[50,83,14,71,57],insuffi:57,gcc:57,forese:83,guru:[9,6,80],tamper:16,vcl_miss:[3,6,7],six:33,timeout_idl:[75,57],subdirectori:[61,41],instead:[61,59,63,51,3,68,14,19,71,87,33,82,79,75,52,60,57,5,20,38],panic:[9,62,80,57,30],circular:29,fare:83,everywher:61,express:[68,71,28,29,30,75,78,8,7,35,63,59,60,61,40,82,43,83,85,87,84,67],attend:74,farm:83,watch:[77,65,63,74],men:[83,20],fcj8cnd5188:63,tier:56,hasher:57,physic:[76,65],villag:12,alloc:[61,51,83,70,29,57],denounc:33,essenti:[63,4],seriou:[29,33,83,57],sit:[0,83,33,20,49],robot:17,processor:[24,19,42],issu:[83,1,2,80,50,62,78,57,81,34,33,9,35,41,56,87,38,63,20,30],mainten:33,rfc3986:47,furious:62,fallback:[58,46],hipster:49,vml:33,least:[24,83,49,65,33,52,63,57],lingua:78,routin:[83,62],solv:[61,49,62,83,36,56],move:[65,75,50,45,14,7,22,17,57],pipe_if_loc:[87,67],sysconfig:[72,45],whilst:63,tcl:78,comma:[60,82,45,85,57],"0xb75096d0":35,bunch:63,perfect:[65,52],consensu:49,chosen:[19,47,12,83],youtub:63,brook:83,labor:10,suppli:[50,7,57],willing:3,infrastructur:[10,1],decai:57,purg:[1,75,80,71,4,66,6,35,7],therefor:[61,74,62,25,75,76,52,83,33,41,27,70,63,20,38],dag:[59,68,14,60,82,57],crash:[70,80,69,32,9,62,30],pure:[51,83,25,36],thread_queue_limit:57,hurrican:10,auto:30,spell:87,dai:[83,25,74,46,33,35,42,87,63,38],auth:[68,30],devel:27,mention:[1,49,3,7,11,47,12],log_info:[69,57],kiss:23,front:[31,49,77,35,63,57],ban_lurker_ag:57,thread_pool_timeout:57,wrangler:1,libvarnishapi:76,somewher:[43,49],trac:[63,83,2],anyth:[61,1,49,3,62,40,7,20,83,78,56,71,37,57],edit:[34,78,61,72,56],orderto:57,nocach:63,mode:[1,18,50,51,3,14,85,26,6,9,36,87,57,30],thread_pool_workspac:57,disregard:[24,87,63],cluster1:75,vsl_buffer:57,subset:[24,1,83],lie:49,cry:20,activit:42,dgst:30,intellig:38,"_catch_bug":62,chunk:[51,5,83,38],consum:[50,85],mar:9,"static":56,our:[31,83,2,49,56,40,7,33,9,27,28,41,52,43,57,86,38],shannon:52,out:[74,62,49,51,3,42,26,4,5,27,73,56,71,31,25,76,34,7,35,36,12,20,38,52,43,57,83,63,65,19,37,33,87],variabl:[24,61,68,3,40,46,78,87,20,30],antiqu:20,vcc:[8,78,61,25,71],overridden:26,incompet:83,influenc:[19,75,36],busyobj:57,defend:25,req:[0,48,49,50,3,26,16,28,30,75,7,35,36,10,44,63,58,52,43,57,61,71,46,37,66,87],vcl:[24,48,1,2,25,68,50,69,3,74,53,26,16,19,22,27,28,62,71,30,31,49,75,76,86,72,34,8,7,9,35,36,10,44,63,37,38,13,80,40,57,81,85,43,17,58,61,64,45,5,46,21,6,87,84,67],stdnoreturn:20,suitabl:[61,50,60,54,33,82],disappear:[83,49],hardwar:[83,23,42,70],stead:43,ref:[24,43],defens:[10,33],red:[34,45,72,32,27],statist:[25,51,80,14,54,8,73,76,60,10,57,63,20,17],clarifi:49,shut:33,insid:[51,33,63,49,57],parenthesi:85,ipod:85,unpars:50,hash_ignore_busi:87,york:74,dictionari:83,advisor:12,releas:[74,49,70,46,33,27,36,57,38],critbit_cooloff:57,complianc:83,http_req_hdr_len:57,unwant:63,could:[24,1,50,63,74,65,61,58,33,9,42,57,12,20,30],latest:[87,27,20],ask:[1,49,25,3,71,54,33,62,10,12,20,38],keep:[49,50,62,4,6,27,70,30,25,76,32,7,79,35,36,17,63,58,38,59,60,40,41,43,57,12,65,82,87],scari:63,length:[83,1,50,51,61,52,10,57,30],outsid:[77,69,7],pcre_exec:57,retain:0,timezon:38,thread_stats_r:57,softwar:[31,84,2,18,59,68,60,65,74,14,81,26,33,82,27,57,56,87,38,63,30],suffix:[29,57],frap:67,qualiti:[33,56],echo:[24,81,70],date:[24,61,68,50,76,83,36],wreturn:57,kerbero:83,facil:[83,10,1,20],underscor:[63,20],utc:[61,20],prioriti:46,forgeri:83,"long":[49,50,51,70,26,4,67,56,30,76,35,63,20,38,41,52,57,83,85,46,33,87],fair:9,unknown:[87,63],licens:[24,18,59,68,60,14,81,26,46,33,82,87,57,30],perfectli:[33,63,20],system:[1,62,25,51,42,45,78,46,19,27,70,29,11,71,63,57],wrapper:[1,20],attach:[87,61,57,56],attack:[1,53,25,52],sadli:83,multiprogram:20,privaci:83,scant:83,termin:[31,61,50,6,79,23,30,57],licenc:[18,59,68,60,14,81,26,46,82,30,57],man:[87,63,9,30,16],"final":[31,1,25,76,26,4,33,27,35,10],misunderstood:63,udp:83,shell:[9,57,47],rsh:83,joani:63,shall:20,crnl:57,nobodi:[61,25,49,83,33,36,57],haven:10,cli_common:30,datatyp:75,hitmiss:68,gethdr_:61,bloat:20,free_spac:87,bother:[61,12],"65k":63,structur:[61,62,33,85,78,41,52,87,29,20,57],charact:[83,59,50,62,14,85,54,67,52,87,30,63,57],collaps:46,sensit:[61,62,27,83,46],dubiou:57,"0x41f778":9,other:[24,1,74,85,25,68,51,3,62,53,16,19,6,27,67,56,77,49,75,76,33,34,78,9,79,35,36,10,11,63,20,38,65,80,60,83,41,52,43,54,57,61,45,5,58,21,87,23],sooner:52,webfold:34,"function":[61,1,74,2,85,75,42,40,57,4,6,8,22,52,87,46,63,20,30],counter:[50,51,14,54,77,76,6,73,43,10,57,17],favorit:[34,43,86],barf:[67,26,52],msec:57,clearli:[83,74],correspond:87,requrl:[50,60,85,54,79,63],have:[24,1,74,2,25,50,65,3,42,14,4,5,22,58,56,29,46,86,30,31,49,75,76,21,34,78,9,79,35,36,10,11,12,37,38,13,77,71,85,40,7,41,52,43,16,57,83,61,47,62,63,45,19,20,33,6,87,23],close:[31,25,50,76,56,85,6,33,9,70,57,30],need:[24,48,1,62,49,51,3,42,5,27,67,70,31,75,76,33,72,78,9,79,35,69,10,57,63,37,38,86,65,83,7,41,52,43,44,61,23,45,71,58,21,87,47],blix:[68,50,14,60,85,46,82,87],element:[61,85,20,49,57],border:[12,49],devicetyp:7,afraid:56,soak:57,min:59,rout:[43,83],"0x00":[87,67],sandbox:[1,57],mix:[83,20],builtin:[19,75,67,57],preced:[87,85,63,40,67],impur:33,which:[1,74,2,25,50,51,3,42,26,16,19,6,27,58,70,29,71,30,49,75,76,72,78,10,57,12,20,65,85,60,81,41,52,43,54,17,56,83,61,62,63,45,5,46,33,87,23,67],roug:1,vpn:1,ncsa:[8,17,68,57,10],singl:[61,25,68,62,14,71,26,85,33,35,43,87,10,63,20],cli_limit:57,lastst:30,unless:[82,1,71,68,3,45,61,15,16,78,6,57,29,10,23,63,58,38],allow:[24,83,1,2,85,25,68,3,62,61,82,4,22,66,9,35,36,87,10,57],tcp_keepalive_prob:[57,70],deploy:[29,83],quantifi:46,who:[83,1,76,65,33,66,41,74,38],oracl:[2,56],discov:[51,61],fragment:[24,29,50,57],jul:83,rush_expon:57,histogram:[8,54,59,17],segment:[10,9,79,57],why:[61,1,47,25,84,50,3,65,78,83,33,9,41,52,23,12,20],urg:83,url:[24,49,68,50,3,26,54,55,30,7,35,63,58,85,60,52,43,57,61,71,46,37,87,47,28],"32k":57,gather:68,frederick:83,uri:83,sandbeck:[26,57],face:62,pipe:[0,59,68,50,3,57,16,54,6,67,87,17,44],deni:66,determin:[61,3,85,87,63,57],north:74,occasion:38,"0x0a":30,fact:[25,42,33,80,29,20],malamud:47,priv_vcl:61,tape:47,text:[24,86,1,75,50,61,72,16,34,33,43,57,20,30],borderlin:83,verbos:[82,14,26],elif:87,connect:[0,83,1,25,50,51,85,71,81,5,6,79,76,87,43,57,30],bring:[33,12],thaumaturg:61,bedroom:65,utter:20,rough:13,trivial:[51,41,63,49],res_writeobj:9,redirect:[7,82,63,68],highest:[83,40],locat:[31,83,50,51,81,34,7,80,37],tire:62,timeout_ling:[75,57],should:[0,1,2,25,51,3,4,5,27,62,29,77,49,75,76,34,10,63,20,13,85,81,15,41,52,43,57,83,61,23,45,71,46,33,87,47],ixslvvxrgkjptxmc:30,"0x20":57,elseif:[24,87,7],local:[31,1,50,45,61,66,9,27,67,87,86],hope:[83,25,49,74,33,41,56,23,12],expkil:50,meant:20,explicitli:[50,43,75,71,57],obj2:49,contribut:[61,2],beat:83,approv:1,rush:[83,57],bear:[61,20,49],regularli:54,autos:57,jpg:[55,16],increas:[24,75,85,4,77,6,35,70,43,20,57],lucki:49,esi_xmlerror:50,enabl:[1,2,50,69,3,70,36,87,35,10,43,29,58,57],organ:[19,49,80],devast:33,stuff:[25,49,50,51,71,77,41,42,63],vcl_someth:69,integr:[10,83],partit:[1,45],contain:[24,31,61,50,14,3,32,45,85,57,46,67,48,35,80,87,23,20,30],grab:[49,38],shl:57,do_esi:[24,87,3,26],view:[51,83,14,17],conform:3,btw:42,legaci:63,modulo:57,vcl_pass:[3,6,7,75],unimport:49,frame:83,knowledg:33,ipng:47,shm:57,temporarili:7,danger:[1,20],mulhuijzen:2,statu:[83,85,49,68,50,76,75,71,81,7,6,35,87,10,63,30],error:[6,68,50,76,75,71,4,34,9,62,10,63,57],correctli:83,pattern:[76,83,42,63,38],boundari:[33,83,59],tcp_keepalive_intvl:[57,70],tend:[33,37,49,62],b00000:27,written:[2,68,50,62,14,26,16,5,67,74,30,79,63,20,59,60,81,82,57,61,18,12,85,46,33,87,47],unusu:40,crude:25,chemic:49,neither:[81,57,14,20,16],email:[33,62,83,49,38],midnight:33,bought:65,entic:3,kei:[1,2,59,68,52,14,33,6,36,87,10,37,57],vrt:61,reinforc:20,entis:83,entir:[83,49,65,14,33,41,62,87,20,57],otherwis:[1,51,81,26,16,7,6,62,43],crc32:57,disput:33,monitor:[10,54,85,80,51],doorwai:49,reqbodi:50,instant:[76,74],used_spac:87,plugin:[63,20,54],career:12,goal:49,mpg:30,ramp:[33,57],equal:[40,85],vtqe_prev:20,etc:[1,62,49,50,65,3,42,5,27,56,70,25,86,72,34,78,9,80,10,17,20,83,52,57,61,45,71,46,33],instanc:[1,49,68,50,51,3,14,67,56,30,25,76,8,10,20,59,60,40,81,82,57,83,61,71,87,47],admir:33,lru_interv:57,strftime:68,preprocessor:20,comment:[24,7,34,19,67,87,43,23],anti:57,unclear:83,toilet:65,wall:[33,12,20,57],last_us:75,arriv:[19,52],vcl_fini:6,walk:[76,35],vcl_synth:[87,7,6,75],ssl_clear:23,laugh:20,cli_run:62,"48k":57,rpm:27,quit:[38,49,65,56,14,5,40,22,33,9,79,35,52,43,67,30,63,20,78],slowli:79,tread:57,vtailq_insert_befor:20,addition:81,ban_dup:57,polka:67,rogier:2,cent:58,compon:[61,41,85,25],json:[24,14,80],besid:[33,79,62],treat:[85,71,57],querysort:46,varnishtop:[59,50,60,14,26,4,8,82,57,73,54,63,17],percentag:29,"31d":9,hat:[83,32,45,34,72,27],backendopen:50,both:[61,1,50,51,85,45,78,40,83,76,33,6,27,56,71,63,20,57],inbound:19,bulk:23,togeth:[24,61,85,16,86,43,37,30],"8001337af":62,overwhelmingli:33,present:[24,83,59,68,50,60,14,85,16,7,41,54,63,17],multi:[87,61],obj1:49,plain:[50,75,62],align:[75,57],shortliv:[29,15,57],defin:[82,1,59,49,75,60,45,61,26,58,6,86,41,35,76,87,43,63,20,57],decept:83,wild:7,kibibyt:29,backend_express:30,layer:[83,49,42],langaug:20,vapi:51,almost:[1,62,71,33,27,52,10,63,20,57],squid:[35,49],horribl:[76,27],site:[24,83,2,65,45,77,72,62,43,63],scanf:20,substanti:60,fiddl:[76,74],incom:[43,5,2,33],revis:31,myfoo:61,surprisingli:49,scienc:[20,49],outdat:35,ping_interv:57,welcom:[76,38,40,57,30],insight:49,parti:[65,74],cross:[33,38],member:61,python:[78,27,61],vmod_priv_free_f:61,constel:40,android:7,inc:33,incl:50,difficult:63,phk:[83,14,26,82,30,38],competit:83,eur27k:33,overal:[51,83],http:[24,48,1,2,49,68,50,3,53,4,54,19,27,28,73,62,30,31,58,75,7,72,34,8,78,9,79,35,80,10,44,63,37,85,40,57,52,43,16,17,83,61,84,18,45,71,46,87,47,55],hostnam:[87,63,37,46],logic:[87,29,75,67,36],upon:6,effect:[1,2,51,71,35,87,29,57],handi:61,beast:62,unchalleng:49,logfil:51,dealloc:51,dust:65,php:43,expand:29,wronli:71,off:[71,50,51,3,19,57,16,33,74,4,5,63,38],center:14,com:[24,45,7,35,87,43,30,63,38],vcl_real:61,well:[0,83,1,49,25,65,85,45,21,16,78,6,79,41,29,11,47,63,20],regsubal:[87,63],thought:[83,25,49,78,41,74,84,20,38],vsl_mask:57,exampl:[24,50,26,19,27,67,30,31,75,8,7,35,80,63,58,60,81,20,41,52,43,61,64,45,85,46,86,87,23],command:[31,1,80,45,62,53,71,15,81,8,5,9,35,51,10,57,63,30],english:63,piec:[61,52,65,33,43,10],usual:[0,61,47,2,83,34,9,27,35,62,38,63,30],sporad:[41,70],therebi:[35,4],http_gzip_support:[87,3,57,16],less:[83,2,70,85,33,74,37,38],compel:83,obtain:[81,57],esi_disable_xml_check:57,procesess:51,heavili:61,compar:[67,87,57,20,52],py3k:78,web:[24,31,1,2,49,25,39,52,83,62,16,34,79,28,36,43,4,63],rapid:57,amd64:62,bodylen:26,tight:43,appearantli:20,onward:57,sky:36,knew:[41,20,42],script:[24,1,25,42,61,26,7,78,27,70,10,30,17],add:[83,58,51,42,40,26,16,7,9,35,52,87,43,63,37,57],expr1:85,rtld_now:61,collis:52,kick:[7,57],gmt:[83,9,46],"16g":77,esi_ignore_other_el:57,sick:[87,43,33,36,30],webpag:33,log_local_addr:50,arguabl:83,realiz:65,five:[24,83,49,33,74,57],know:[1,49,50,51,3,56,5,23,27,74,30,7,79,63,13,41,57,61,84,45,71,47],unseen:14,thoughtlessli:57,password:62,recurs:57,insert:[50,87,3,46,16],unplan:[29,57],resid:29,like:[0,24,1,74,2,25,51,3,62,16,5,27,58,56,30,31,49,76,86,72,34,7,79,35,36,10,57,12,20,65,40,15,41,52,43,17,83,61,63,45,71,37,33,87,47,67],success:[74,6,27,57],incred:49,profound:49,c1x:20,necessari:[61,75,65,45,41,70,57,30],martin:[68,50,14,60,85,46,82,87],workthread:[50,57],decis:[10,1,12,71],backlog:38,"80013801e":62,exceed:6,didn:[24,3,41,20,47],shutdown:[29,57],captur:[63,62],twitter:74,"0x8006b8d84":62,bogohead:50,self:[57,42],vsa:61,vsc:51,"export":[51,61],shabbi:74,flush:[3,68,82,57],proper:75,guarante:[51,61,23,20,52],peter:12,vsl:[59,68,50,51,75,60,85,82,46,8,9,79,57],vsm:[25,59,68,51,14,8,82,60,57],librari:[61,46,10,23,63,20],tmp:[29,23,26,62],nokia:56,trust:[1,42,3,25,78],competitor:42,rtld_local:61,lead:[29,20],truss:[9,62],avoid:[83,61,55,76,3,52,7,78,35,36,87,57,38],suckaddr:61,bereqacct:50,estim:83,leav:[83,71,26,9,41,52,20],ipv4:[83,18,50,76,45,71,47,57],happend:12,eso:33,duplic:35,kiddi:17,esi:[24,84,49,75,50,3,80,85,26,16,6,74,87,10,4,57],bereqhead:50,has_j:63,deprec:[87,41],facilit:20,paper:[33,74],vhost:[81,46],headerninja:63,toggl:14,offset:[51,52],handedli:20,microsecond:[10,2,68],simpler:63,about:[1,74,2,49,39,50,51,3,42,53,16,5,27,56,77,75,76,34,78,80,10,57,12,20,38,13,83,41,52,43,54,17,61,23,62,63,65,33,47],misbehav:[80,16,19,9,36,43,63],actual:[49,62,5,74,29,34,25,77,79,35,10,17,63,20,38,81,41,42,57,83,33,87],socket:[1,47,80,49,50,56,53,61,81,9,70,87,10,23,57],linger:[33,57],column:[79,14],vcl_hit:[87,6,36],uplex:38,fear:[83,20],carrier:78,thread_pool_add_delai:[75,57],segovia:20,emperor:12,disabl:[83,1,59,68,60,75,14,71,16,82,35,70,87,57],compil:[61,25,75,32,71,57,5,27,42,87,10,17,20,30],getaddrinfo:46,own:[61,1,75,3,45,40,85,83,33,67,52,10,23,86,20,57],necessit:22,vcl_call:50,thread_pool_min:57,lenght:30,automat:[83,62,75,50,36,71,46,52,87,10,57],dataset:[29,54],warranti:61,automak:27,guard:25,merk:63,smarto:[2,56],pitfal:[63,4],pointless:38,automag:17,contruct:[48,6],nuke:57,val:26,pictur:[10,61,80],transfer:[50,87],support:[2,49,68,51,3,70,16,56,32,35,44,63,38,39,83,42,43,4,57,61,18,64,46,23],rotat:[29,82,68],regsub:[87,61,63,67,7],debian:[32,45,34,72,27,70,57],"12k":57,vax:41,much:[56,83,1,74,49,25,51,52,71,57,16,76,33,22,79,67,70,23,63,20,38],"var":[9,81],trickeri:[8,51],deliveri:[31,50,51,3,85,71,16,6,23,57],alexa:74,subscrib:[10,78,51,25,38],weight:58,yeah:47,admonish:83,acceptor_sleep_incr:57,gain:[83,57],grate:33,inlin:[1,49,75,69,61,19,80,10,30,57],eat:57,count:[61,50,85,1,54,67,87,35],succe:71,made:[83,1,49,75,65,21,71,33,52,87,20],wise:[78,23,83],krypto:23,tab:30,whether:[24,2,68,6,79,87,63],shrunk:42,murphi:10,wife:10,smooth:83,flip:79,troubl:[9,83,25,50,32,71,41,62,38],asynchron:36,record:[59,68,50,51,60,85,54,82,62,10,57],below:[61,3,71,62,29,63,57],limit:[1,59,50,65,56,60,40,57,85,77,82,10,29,17,63,20,30],monument:12,lvl:85,problem:[56,83,61,62,49,50,43,52,65,33,42,78,9,36,29,57,20,38],ikllqv:26,beresphead:50,epel:27,sockaddr:47,ddd00e1:31,dual:83,"25k":57,"int":[87,61,46,20,40],mask:[50,71,57],dure:[24,1,50,3,83,57,6,41,87,10,23,17],pid:[68,82,57],twist:[83,52],implement:[24,61,58,49,75,76,3,64,83,57,16,41,42,87,23,20,44],some_nam:71,ing:7,pit:49,girl:74,probabl:[24,39,61,58,49,50,63,74,83,46,34,86,9,52,29,23,12,20,57],mutual:33,quot:[87,85,30],syslog_cli_traff:[1,57],boot:20,detail:[13,47,59,18,49,31,60,81,68,14,7,26,16,33,82,57,73,87,10,46,30],virtual:[43,19,83,80],expr2:85,avg_100:14,bool:[61,71,40,87,46,57],special:[83,61,75,3,7,20,78,67,87,63,58,17],rememb:[61,75,76,3,62,47,63,57],behold:37,stat:[76,51,14,57],xxx:[0,79,1,63,54],openoffic:78,confignam:30,troub:38,"class":[51,78,7,46],june:49,humbl:83,stai:35,multithread:61,outsourc:1,overfund:33,sphinx:[78,84,27],nogroup:57,reliabl:70,rule:[61,63,20,25,40],emerg:[71,49],auxiliari:57,elsif:[87,43,63],yell:33,invari:[33,52],sincer:49},objtypes:{},titles:["actions","Security first","The fundamentals of web proxy caching with Varnish","How GZIP, and GZIP+ESI works in Varnish","Varnish and Website Performance","Peculiarities","Built in subroutines","Device detection","The Varnish Reference Manual","Troubleshooting Varnish","The Big Varnish Picture","Prerequisites","What were they thinking ?","Now what?","varnishstat","Parameters","Compression","Varnish Glossary","varnishreplay","VCL - Varnish Configuration Language","The Tools We Work With","What's new in Varnish 4.0","Changes in Varnish 4","Why no SSL ?","Content composition with Edge Side Includes","Security barriers in Varnish","varnishtest","Installing Varnish","Manipulating request headers in VCL","Storage backends","Varnish CLI","Varnish Administrator Documentation","Varnish Installation","Raking in the dough on Free and Open Source Software","Starting Varnish","Purging and banning","Misbehaving servers","Hashing","Getting help","The Varnish Tutorial","VCL Expressions","A persistent message","Did you call them <em>autocrap</em> tools ?","Backend servers","Implementing websocket support","Important command line arguments","vmod_std","IPv6 Suckage","Request and response VCL objects","What SPDY did to my summer vacation","VSL","VSM: Shared Memory Logging and Statistics","Varnish Does Not Hash","Starting and running Varnish","Statistics","Altering the backend response","Picking platforms","varnishd","vmod_directors","varnishhist","varnishtop","VMOD - Varnish Modules","Reporting bugs","Achieving a high hitrate","VCL Examples","Wanton destruction for the greater good","ACLs","VCL Syntax","varnishncsa","Using inline C to extend Varnish","Platform specific notes","CLI - bossing Varnish around","Put Varnish on port 80","Reporting and statistics","Thoughts on the eve of Varnish 3.0","Upgrading to Varnish 4","What do you mean by 'backend' ?","Sizing your cache","Why Sphinx and reStructuredText ?","Logging in Varnish","The Varnish Users Guide","varnishadm","varnishlog","Why HTTP/2.0 does not seem interesting","Poul-Hennings random outbursts","Varnish VSL Query Expressions","Backend servers","VCL"],objnames:{},filenames:["users-guide/vcl-actions","users-guide/run_security","tutorial/introduction","phk/gzip","users-guide/performance","tutorial/peculiarities","users-guide/vcl-built-in-subs","users-guide/devicedetection","reference/index","users-guide/troubleshooting","users-guide/intro","installation/prerequisites","phk/thoughts","tutorial/now_what","reference/varnishstat","users-guide/params","users-guide/compression","glossary/index","reference/varnishreplay","users-guide/vcl","phk/thetoolsweworkwith","whats-new/index","whats-new/changes","phk/ssl","users-guide/esi","phk/barriers","reference/varnishtest","installation/install","users-guide/vcl-example-manipulating-headers","users-guide/storage-backends","reference/varnish-cli","index","installation/index","phk/dough","tutorial/starting_varnish","users-guide/purging","users-guide/vcl-grace","users-guide/vcl-hashing","installation/help","tutorial/index","phk/vcl_expr","phk/persistent","phk/autocrap","users-guide/vcl-backends","users-guide/vcl-example-websockets","users-guide/command-line","reference/vmod_std.generated","phk/ipv6suckage","users-guide/vcl-variables","phk/spdy","reference/vsl","reference/vsm","phk/varnish_does_not_hash","users-guide/running","users-guide/operation-statistics","users-guide/vcl-example-manipulating-responses","phk/platforms","reference/varnishd","reference/vmod_directors.generated","reference/varnishhist","reference/varnishtop","reference/vmod","installation/bugs","users-guide/increasing-your-hitrate","users-guide/vcl-examples","phk/wanton_destruction","users-guide/vcl-example-acls","users-guide/vcl-syntax","reference/varnishncsa","users-guide/vcl-inline-c","installation/platformnotes","users-guide/run_cli","tutorial/putting_varnish_on_port_80","users-guide/report","phk/three-zero","whats-new/upgrading","phk/backends","users-guide/sizing-your-cache","phk/sphinx","users-guide/operation-logging","users-guide/index","reference/varnishadm","reference/varnishlog","phk/http20","phk/index","reference/vsl-query","tutorial/backend_servers","reference/vcl"]})
\ No newline at end of file
diff --git a/doc/sphinx/build/html/tutorial/backend_servers.html b/doc/sphinx/build/html/tutorial/backend_servers.html
index 67f61c0..f7ee485 100644
--- a/doc/sphinx/build/html/tutorial/backend_servers.html
+++ b/doc/sphinx/build/html/tutorial/backend_servers.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Backend servers &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Backend servers &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Tutorial" href="index.html" />
     <link rel="next" title="Peculiarities" href="peculiarities.html" />
     <link rel="prev" title="Put Varnish on port 80" href="putting_varnish_on_port_80.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="putting_varnish_on_port_80.html" title="Put Varnish on port 80"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Tutorial</a> &raquo;</li> 
       </ul>
     </div>  
@@ -138,7 +138,7 @@ pick one backend based on different algorithms.</p>
         <li class="right" >
           <a href="putting_varnish_on_port_80.html" title="Put Varnish on port 80"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Tutorial</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/tutorial/index.html b/doc/sphinx/build/html/tutorial/index.html
index 7815ec6..cdf15c7 100644
--- a/doc/sphinx/build/html/tutorial/index.html
+++ b/doc/sphinx/build/html/tutorial/index.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>The Varnish Tutorial &mdash; Varnish version 4.0.2 documentation</title>
+    <title>The Varnish Tutorial &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="next" title="The fundamentals of web proxy caching with Varnish" href="introduction.html" />
     <link rel="prev" title="Platform specific notes" href="../installation/platformnotes.html" /> 
   </head>
@@ -42,7 +42,7 @@
         <li class="right" >
           <a href="../installation/platformnotes.html" title="Platform specific notes"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>  
 
@@ -120,7 +120,7 @@ topic&quot; links on the right side of each page.</p>
         <li class="right" >
           <a href="../installation/platformnotes.html" title="Platform specific notes"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>
     <div class="footer">
diff --git a/doc/sphinx/build/html/tutorial/introduction.html b/doc/sphinx/build/html/tutorial/introduction.html
index b3688ea..336e30c 100644
--- a/doc/sphinx/build/html/tutorial/introduction.html
+++ b/doc/sphinx/build/html/tutorial/introduction.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>The fundamentals of web proxy caching with Varnish &mdash; Varnish version 4.0.2 documentation</title>
+    <title>The fundamentals of web proxy caching with Varnish &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Tutorial" href="index.html" />
     <link rel="next" title="Starting Varnish" href="starting_varnish.html" />
     <link rel="prev" title="The Varnish Tutorial" href="index.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="index.html" title="The Varnish Tutorial"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Tutorial</a> &raquo;</li> 
       </ul>
     </div>  
@@ -77,7 +77,7 @@ policies written in the Varnish Configuration Language (VCL). See
 <p>Varnish has a modern architecture and is written with performance
 in mind.  It is usually bound by the speed of the network, effectively
 turning performance into a non-issue. You get to focus on how your web
-application work and you can allow yourself, to some degree, to care
+applications work and you can allow yourself, to some degree, to care
 less about performance and scalability.</p>
 </div>
 <div class="section" id="flexibility">
@@ -100,7 +100,7 @@ like Oracle Solaris, OmniOS and SmartOS.</p>
 <div class="section" id="about-the-varnish-development-process">
 <h1>About the Varnish development process<a class="headerlink" href="#about-the-varnish-development-process" title="Permalink to this headline">¶</a></h1>
 <p>Varnish is a community driven project. The development is overseen by
-the Varnish Governing Board which currently consist of Poul-Henning Kamp
+the Varnish Governing Board which currently consists of Poul-Henning Kamp
 (Architect), Rogier Mulhuijzen (Fastly) and Lasse Karstensen (Varnish
 Software).</p>
 <p>Please see <a class="reference external" href="https://www.varnish-cache.org/trac/wiki/Contributing">https://www.varnish-cache.org/trac/wiki/Contributing</a> as a
@@ -109,12 +109,12 @@ starting point if you would like to contribute to Varnish.</p>
 <div class="section" id="getting-in-touch">
 <h1>Getting in touch<a class="headerlink" href="#getting-in-touch" title="Permalink to this headline">¶</a></h1>
 <p>You can get in touch with us through many channels. For real time chat
-you can reach us on IRC trough the server irc.linpro.net on the #varnish
+you can reach us on IRC through the server irc.linpro.net on the #varnish
 and #varnish-hacking channels.
-There are two mailing lists available. One for user questions and one
+There are two mailing lists available: one for user questions and one
 for development discussions. See <a class="reference external" href="https://www.varnish-cache.org/lists">https://www.varnish-cache.org/lists</a>
 for information and signup.  There is also a web forum on the same site.</p>
-<p>Now that you have a vague idea on what Varnish Cache is, let see if we
+<p>Now that you have a vague idea on what Varnish Cache is, let's see if we
 can get it up and running.</p>
 </div>
 
@@ -176,7 +176,7 @@ can get it up and running.</p>
         <li class="right" >
           <a href="index.html" title="The Varnish Tutorial"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Tutorial</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/tutorial/now_what.html b/doc/sphinx/build/html/tutorial/now_what.html
index 99b82f6..707231b 100644
--- a/doc/sphinx/build/html/tutorial/now_what.html
+++ b/doc/sphinx/build/html/tutorial/now_what.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Now what? &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Now what? &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Tutorial" href="index.html" />
     <link rel="next" title="The Varnish Users Guide" href="../users-guide/index.html" />
     <link rel="prev" title="Peculiarities" href="peculiarities.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="peculiarities.html" title="Peculiarities"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Tutorial</a> &raquo;</li> 
       </ul>
     </div>  
@@ -108,7 +108,7 @@ Varnish in more detail.</p>
         <li class="right" >
           <a href="peculiarities.html" title="Peculiarities"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Tutorial</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/tutorial/peculiarities.html b/doc/sphinx/build/html/tutorial/peculiarities.html
index 639b43b..5faddfc 100644
--- a/doc/sphinx/build/html/tutorial/peculiarities.html
+++ b/doc/sphinx/build/html/tutorial/peculiarities.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Peculiarities &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Peculiarities &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Tutorial" href="index.html" />
     <link rel="next" title="Now what?" href="now_what.html" />
     <link rel="prev" title="Backend servers" href="backend_servers.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="backend_servers.html" title="Backend servers"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Tutorial</a> &raquo;</li> 
       </ul>
     </div>  
@@ -143,7 +143,7 @@ information. You can have a look at the logstream with the command
         <li class="right" >
           <a href="backend_servers.html" title="Backend servers"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Tutorial</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/tutorial/putting_varnish_on_port_80.html b/doc/sphinx/build/html/tutorial/putting_varnish_on_port_80.html
index a6573ae..908b0bd 100644
--- a/doc/sphinx/build/html/tutorial/putting_varnish_on_port_80.html
+++ b/doc/sphinx/build/html/tutorial/putting_varnish_on_port_80.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Put Varnish on port 80 &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Put Varnish on port 80 &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Tutorial" href="index.html" />
     <link rel="next" title="Backend servers" href="backend_servers.html" />
     <link rel="prev" title="Starting Varnish" href="starting_varnish.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="starting_varnish.html" title="Starting Varnish"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Tutorial</a> &raquo;</li> 
       </ul>
     </div>  
@@ -147,7 +147,7 @@ some text that looks like this:</p>
         <li class="right" >
           <a href="starting_varnish.html" title="Starting Varnish"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Tutorial</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/tutorial/starting_varnish.html b/doc/sphinx/build/html/tutorial/starting_varnish.html
index 4030bf8..be61080 100644
--- a/doc/sphinx/build/html/tutorial/starting_varnish.html
+++ b/doc/sphinx/build/html/tutorial/starting_varnish.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Starting Varnish &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Starting Varnish &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Tutorial" href="index.html" />
     <link rel="next" title="Put Varnish on port 80" href="putting_varnish_on_port_80.html" />
     <link rel="prev" title="The fundamentals of web proxy caching with Varnish" href="introduction.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="introduction.html" title="The fundamentals of web proxy caching with Varnish"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Tutorial</a> &raquo;</li> 
       </ul>
     </div>  
@@ -151,7 +151,7 @@ usually serving up <a class="reference external" href="http://www.varnish-cache.
         <li class="right" >
           <a href="introduction.html" title="The fundamentals of web proxy caching with Varnish"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Tutorial</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/users-guide/command-line.html b/doc/sphinx/build/html/users-guide/command-line.html
index ce7764b..a351827 100644
--- a/doc/sphinx/build/html/users-guide/command-line.html
+++ b/doc/sphinx/build/html/users-guide/command-line.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Important command line arguments &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Important command line arguments &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Starting and running Varnish" href="running.html" />
     <link rel="next" title="CLI - bossing Varnish around" href="run_cli.html" />
     <link rel="prev" title="Security first" href="run_security.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="run_security.html" title="Security first"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="running.html" accesskey="U">Starting and running Varnish</a> &raquo;</li> 
       </ul>
@@ -178,7 +178,7 @@ privileges.</p>
         <li class="right" >
           <a href="run_security.html" title="Security first"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="running.html" >Starting and running Varnish</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/compression.html b/doc/sphinx/build/html/users-guide/compression.html
index 8ad5665..d56b594 100644
--- a/doc/sphinx/build/html/users-guide/compression.html
+++ b/doc/sphinx/build/html/users-guide/compression.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Compression &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Compression &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Varnish and Website Performance" href="performance.html" />
     <link rel="next" title="Content composition with Edge Side Includes" href="esi.html" />
     <link rel="prev" title="Purging and banning" href="purging.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="purging.html" title="Purging and banning"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="performance.html" accesskey="U">Varnish and Website Performance</a> &raquo;</li> 
       </ul>
@@ -203,7 +203,7 @@ about how the implementation works.</p>
         <li class="right" >
           <a href="purging.html" title="Purging and banning"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="performance.html" >Varnish and Website Performance</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/devicedetection.html b/doc/sphinx/build/html/users-guide/devicedetection.html
index 9765363..e54bb20 100644
--- a/doc/sphinx/build/html/users-guide/devicedetection.html
+++ b/doc/sphinx/build/html/users-guide/devicedetection.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Device detection &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Device detection &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="VCL - Varnish Configuration Language" href="vcl.html" />
     <link rel="next" title="Reporting and statistics" href="report.html" />
     <link rel="prev" title="Implementing websocket support" href="vcl-example-websockets.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vcl-example-websockets.html" title="Implementing websocket support"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" accesskey="U">VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
@@ -339,7 +339,7 @@ sub vcl_synth {
         <li class="right" >
           <a href="vcl-example-websockets.html" title="Implementing websocket support"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/esi.html b/doc/sphinx/build/html/users-guide/esi.html
index 9d2787a..1ea05a7 100644
--- a/doc/sphinx/build/html/users-guide/esi.html
+++ b/doc/sphinx/build/html/users-guide/esi.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Content composition with Edge Side Includes &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Content composition with Edge Side Includes &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Users Guide" href="index.html" />
     <link rel="next" title="Troubleshooting Varnish" href="troubleshooting.html" />
     <link rel="prev" title="Compression" href="compression.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="compression.html" title="Compression"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Users Guide</a> &raquo;</li> 
       </ul>
     </div>  
@@ -188,7 +188,7 @@ the 'esi_syntax' parameter (see ref:<cite>ref-varnishd</cite>).</p>
         <li class="right" >
           <a href="compression.html" title="Compression"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/users-guide/increasing-your-hitrate.html b/doc/sphinx/build/html/users-guide/increasing-your-hitrate.html
index 9faa82e..0d304af 100644
--- a/doc/sphinx/build/html/users-guide/increasing-your-hitrate.html
+++ b/doc/sphinx/build/html/users-guide/increasing-your-hitrate.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Achieving a high hitrate &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Achieving a high hitrate &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Varnish and Website Performance" href="performance.html" />
     <link rel="next" title="Purging and banning" href="purging.html" />
     <link rel="prev" title="Varnish and Website Performance" href="performance.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="performance.html" title="Varnish and Website Performance"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="performance.html" accesskey="U">Varnish and Website Performance</a> &raquo;</li> 
       </ul>
@@ -73,17 +73,16 @@ client-side tool makes sense. Here are the ones we commonly use.</p>
 <div class="section" id="tool-varnishtop">
 <h2>Tool: varnishtop<a class="headerlink" href="#tool-varnishtop" title="Permalink to this headline">¶</a></h2>
 <p>You can use varnishtop to identify what URLs are hitting the backend
-the most. <tt class="docutils literal"><span class="pre">varnishtop</span> <span class="pre">-i</span> <span class="pre">txurl</span></tt> is an essential command, showing
-you the top <cite>txurl</cite> requests Varnish is sending to the backend. You
-can see some other examples of <cite>varnishtop</cite> usage in
-<a class="reference internal" href="operation-statistics.html#users-guide-statistics"><em>Statistics</em></a>.</p>
+the most. <tt class="docutils literal"><span class="pre">varnishtop</span> <span class="pre">-i</span> <span class="pre">BereqURL</span></tt> is an essential command, showing
+you the top requests Varnish is sending to the backend. You can see some
+other examples of <cite>varnishtop</cite> usage in <a class="reference internal" href="operation-statistics.html#users-guide-statistics"><em>Statistics</em></a>.</p>
 </div>
 <div class="section" id="tool-varnishlog">
 <h2>Tool: varnishlog<a class="headerlink" href="#tool-varnishlog" title="Permalink to this headline">¶</a></h2>
 <p>When you have identified an URL which is frequently sent to the
 backend you can use <cite>varnishlog</cite> to have a look at the request.
-<tt class="docutils literal"><span class="pre">varnishlog</span> <span class="pre">-c</span> <span class="pre">-m</span> <span class="pre">'RxURL:^/foo/bar</span></tt> will show you the requests
-coming from the client ('-c') matching <cite>/foo/bar</cite>.</p>
+<tt class="docutils literal"><span class="pre">varnishlog</span> <span class="pre">-q</span> <span class="pre">'ReqURL</span> <span class="pre">~</span> <span class="pre">&quot;^/foo/bar&quot;'</span></tt> will show you the requests
+coming from the client matching <cite>/foo/bar</cite>.</p>
 <p>For more information on how <cite>varnishlog</cite> works please see
 <a class="reference internal" href="operation-logging.html#users-guide-logging"><em>Logging in Varnish</em></a> or man <a class="reference internal" href="../reference/varnishlog.html#ref-varnishlog"><em>varnishlog</em></a>.</p>
 <p>For extended diagnostics headers, see
@@ -252,7 +251,8 @@ Cache-Control: public, max-age=600</pre>
 <div class="section" id="age">
 <h2>Age<a class="headerlink" href="#age" title="Permalink to this headline">¶</a></h2>
 <p>Varnish adds an 'Age' header to indicate how long the object has been
-kept inside Varnish. You can grep out 'Age' from <cite>varnishlog</cite> with <tt class="docutils literal"><span class="pre">varnishlog</span> <span class="pre">-i</span> <span class="pre">TxHeader</span> <span class="pre">-I</span> <span class="pre">^Age</span></tt>.</p>
+kept inside Varnish. You can grep out 'Age' from <cite>varnishlog</cite> with
+<tt class="docutils literal"><span class="pre">varnishlog</span> <span class="pre">-I</span> <span class="pre">RespHeader:^Age</span></tt>.</p>
 </div>
 <div class="section" id="pragma">
 <h2>Pragma<a class="headerlink" href="#pragma" title="Permalink to this headline">¶</a></h2>
@@ -336,8 +336,8 @@ Varnish to cache another version.</p>
 <p>To achieve a high hitrate whilst using Vary is there therefore
 crucial to normalize the headers the backends varies on. Remember,
 just a difference in casing can force different cache entries.</p>
-<p>The following VCL code will normalize the 'Accept-Language' headers,
-to one of either &quot;en&quot;, &quot;de&quot; or &quot;fr&quot;:</p>
+<p>The following VCL code will normalize the 'Accept-Language' header to
+either &quot;en&quot;, &quot;de&quot; or &quot;fr&quot;, in this order of precedence:</p>
 <div class="highlight-python"><pre>if (req.http.Accept-Language) {
     if (req.http.Accept-Language ~ "en") {
         set req.http.Accept-Language = "en";
@@ -352,8 +352,6 @@ to one of either &quot;en&quot;, &quot;de&quot; or &quot;fr&quot;:</p>
     }
 }</pre>
 </div>
-<p>The code sets the 'Accept-Encoding' header from the client to either
-gzip, deflate with a preference for gzip.</p>
 <div class="section" id="vary-parse-errors">
 <h2>Vary parse errors<a class="headerlink" href="#vary-parse-errors" title="Permalink to this headline">¶</a></h2>
 <p>Varnish will return a &quot;503 internal server error&quot; page when it fails
@@ -450,7 +448,7 @@ above code as a template.</p>
         <li class="right" >
           <a href="performance.html" title="Varnish and Website Performance"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="performance.html" >Varnish and Website Performance</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/index.html b/doc/sphinx/build/html/users-guide/index.html
index 1655f0e..aad254f 100644
--- a/doc/sphinx/build/html/users-guide/index.html
+++ b/doc/sphinx/build/html/users-guide/index.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>The Varnish Users Guide &mdash; Varnish version 4.0.2 documentation</title>
+    <title>The Varnish Users Guide &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="next" title="The Big Varnish Picture" href="intro.html" />
     <link rel="prev" title="Now what?" href="../tutorial/now_what.html" /> 
   </head>
@@ -42,7 +42,7 @@
         <li class="right" >
           <a href="../tutorial/now_what.html" title="Now what?"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>  
 
@@ -98,7 +98,7 @@ from a transactional level to aggregating statistics.</p>
 <li class="toctree-l2"><a class="reference internal" href="vcl-backends.html#health-checks">Health checks</a></li>
 <li class="toctree-l2"><a class="reference internal" href="vcl-hashing.html">Hashing</a></li>
 <li class="toctree-l2"><a class="reference internal" href="vcl-grace.html">Misbehaving servers</a></li>
-<li class="toctree-l2"><a class="reference internal" href="vcl-inline-c.html">Using In-line C to extend Varnish</a></li>
+<li class="toctree-l2"><a class="reference internal" href="vcl-inline-c.html">Using inline C to extend Varnish</a></li>
 <li class="toctree-l2"><a class="reference internal" href="vcl-examples.html">VCL Examples</a></li>
 <li class="toctree-l2"><a class="reference internal" href="devicedetection.html">Device detection</a></li>
 </ul>
@@ -180,7 +180,7 @@ from a transactional level to aggregating statistics.</p>
         <li class="right" >
           <a href="../tutorial/now_what.html" title="Now what?"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>
     <div class="footer">
diff --git a/doc/sphinx/build/html/users-guide/intro.html b/doc/sphinx/build/html/users-guide/intro.html
index e15d24b..800d7ae 100644
--- a/doc/sphinx/build/html/users-guide/intro.html
+++ b/doc/sphinx/build/html/users-guide/intro.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>The Big Varnish Picture &mdash; Varnish version 4.0.2 documentation</title>
+    <title>The Big Varnish Picture &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Users Guide" href="index.html" />
     <link rel="next" title="Starting and running Varnish" href="running.html" />
     <link rel="prev" title="The Varnish Users Guide" href="index.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="index.html" title="The Varnish Users Guide"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Users Guide</a> &raquo;</li> 
       </ul>
     </div>  
@@ -184,7 +184,7 @@ wife had prepared a intimate evening to celebrate your anniversary.</p>
         <li class="right" >
           <a href="index.html" title="The Varnish Users Guide"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/users-guide/operation-logging.html b/doc/sphinx/build/html/users-guide/operation-logging.html
index 2da59c2..1e7f234 100644
--- a/doc/sphinx/build/html/users-guide/operation-logging.html
+++ b/doc/sphinx/build/html/users-guide/operation-logging.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Logging in Varnish &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Logging in Varnish &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Reporting and statistics" href="report.html" />
     <link rel="next" title="Statistics" href="operation-statistics.html" />
     <link rel="prev" title="Reporting and statistics" href="report.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="report.html" title="Reporting and statistics"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="report.html" accesskey="U">Reporting and statistics</a> &raquo;</li> 
       </ul>
@@ -69,11 +69,11 @@ logs to disk they will be overwritten.</p>
 is logging. <cite>varnishlog</cite> gives you the raw logs, everything that is
 written to the logs. There are other clients that can access the logs as well, we'll show you
 these later.</p>
-<p>In the terminal window you started Varnish now type <tt class="docutils literal"><span class="pre">varnishlog</span></tt> and
-press enter.</p>
+<p>In the terminal window you started Varnish now type <tt class="docutils literal"><span class="pre">varnishlog</span> <span class="pre">-g</span> <span class="pre">raw</span></tt>
+and press enter.</p>
 <p>You'll see lines like these scrolling slowly by.:</p>
-<div class="highlight-python"><pre>0 CLI          - Rd ping
-0 CLI          - Wr 200 PONG 1273698726 1.0</pre>
+<div class="highlight-python"><pre>0 CLI            - Rd ping
+0 CLI            - Wr 200 19 PONG 1273698726 1.0</pre>
 </div>
 <p>These is the Varnish master process checking up on the caching process
 to see that everything is OK.</p>
@@ -81,23 +81,22 @@ to see that everything is OK.</p>
 app.
 .. XXX:Doesn't this require a setup of a running varnishd and a web application being cached? benc</p>
 <p>You'll see lines like these.:</p>
-<div class="highlight-python"><pre>11 SessionOpen  c 127.0.0.1 58912 0.0.0.0:8080
-11 ReqStart     c 127.0.0.1 58912 595005213
-11 RxRequest    c GET
-11 RxURL        c /
-11 RxProtocol   c HTTP/1.1
-11 RxHeader     c Host: localhost:8080
-11 RxHeader     c Connection: keep-alive</pre>
+<div class="highlight-python"><pre>11 SessOpen       c 127.0.0.1 58912 :8080 0.0.0.0 8080 1273698726.933590 14
+11 ReqStart       c 127.0.0.1 58912
+11 ReqMethod      c GET
+11 ReqURL         c /
+11 ReqProtocol    c HTTP/1.1
+11 ReqHeader      c Host: localhost:8080
+11 ReqHeader      c Connection: keep-alive</pre>
 </div>
 <p>The first column is an arbitrary number, it identifies the
-session. Lines with the same number are coming from the same session
-and are being handled by the same thread. The second column is the
-<em>tag</em> of the log message. All log entries are tagged with a tag
-indicating what sort of activity is being logged. Tags starting with
-'Rx' indicate Varnish is receiving data and 'Tx' indicates sending data.</p>
-<p>The third column tell us whether this is is data coming or going to
-the client ('c') or to/from the backend ('b'). The forth column is the
-data being logged.</p>
+transaction. Lines with the same number are coming from the same
+transaction. The second column is the <em>tag</em> of the log message. All
+log entries are tagged with a tag indicating what sort of activity is
+being logged.</p>
+<p>The third column tell us whether this is is data coming from or going
+to the client ('c'), or the backend ('b'). The forth column is the data
+being logged.</p>
 <p>Now, you can filter quite a bit with <cite>varnishlog</cite>. The basic options we think you
 want to know are:</p>
 <dl class="docutils">
@@ -106,9 +105,10 @@ want to know are:</p>
 servers. This will be useful when we want to optimize cache hit rates.</dd>
 <dt>'-c'</dt>
 <dd>Same as '-b' but for client side traffic.</dd>
-<dt>'-m <a class="reference external" href="tag:regex">tag:regex</a>'</dt>
-<dd>Only list transactions where the tag matches a regular expression. If
-it matches you will get the whole transaction.</dd>
+<dt>'-g request'</dt>
+<dd>Group transactions by request.</dd>
+<dt>'-q query'</dt>
+<dd>Only list transactions matching this query.</dd>
 </dl>
 <p>For more information on this topic please see <a class="reference internal" href="../reference/varnishlog.html#ref-varnishlog"><em>varnishlog</em></a>.</p>
 </div>
@@ -159,7 +159,7 @@ it matches you will get the whole transaction.</dd>
         <li class="right" >
           <a href="report.html" title="Reporting and statistics"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="report.html" >Reporting and statistics</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/operation-statistics.html b/doc/sphinx/build/html/users-guide/operation-statistics.html
index 5a8fe69..645045e 100644
--- a/doc/sphinx/build/html/users-guide/operation-statistics.html
+++ b/doc/sphinx/build/html/users-guide/operation-statistics.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Statistics &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Statistics &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Reporting and statistics" href="report.html" />
     <link rel="next" title="Varnish and Website Performance" href="performance.html" />
     <link rel="prev" title="Logging in Varnish" href="operation-logging.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="operation-logging.html" title="Logging in Varnish"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="report.html" accesskey="U">Reporting and statistics</a> &raquo;</li> 
       </ul>
@@ -64,11 +64,10 @@ continuously updated list of the most commonly occurring log entries.</p>
 <p>With suitable filtering using the -I, -i, -X and -x options, it can be
 used to display a ranking of requested documents, clients, user
 agents, or any other information which is recorded in the log.</p>
-<p><tt class="docutils literal"><span class="pre">varnishtop</span> <span class="pre">-i</span> <span class="pre">rxurl</span></tt> will show you what URLs are being asked for
-by the client. <tt class="docutils literal"><span class="pre">varnishtop</span> <span class="pre">-i</span> <span class="pre">txurl</span></tt> will show you what your backend
-is being asked the most. <tt class="docutils literal"><span class="pre">varnishtop</span> <span class="pre">-i</span> <span class="pre">RxHeader</span> <span class="pre">-I</span>
-<span class="pre">Accept-Encoding</span></tt> will show the most popular Accept-Encoding header
-the client are sending you.</p>
+<p><tt class="docutils literal"><span class="pre">varnishtop</span> <span class="pre">-i</span> <span class="pre">ReqURL</span></tt> will show you what URLs are being asked for by
+the client. <tt class="docutils literal"><span class="pre">varnishtop</span> <span class="pre">-i</span> <span class="pre">BereqURL</span></tt> will show you what your backend
+is being asked the most. <tt class="docutils literal"><span class="pre">varnishtop</span> <span class="pre">-I</span> <span class="pre">ReqHeader:Accept-Encoding</span></tt> will
+show the most popular Accept-Encoding header the client are sending you.</p>
 <p>For more information please see <a class="reference internal" href="../reference/varnishtop.html#ref-varnishtop"><em>varnishtop</em></a>.</p>
 </div>
 <div class="section" id="varnishhist">
@@ -153,7 +152,7 @@ the Varnish source code.</p>
         <li class="right" >
           <a href="operation-logging.html" title="Logging in Varnish"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="report.html" >Reporting and statistics</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/params.html b/doc/sphinx/build/html/users-guide/params.html
index 5559cb3..5e33d98 100644
--- a/doc/sphinx/build/html/users-guide/params.html
+++ b/doc/sphinx/build/html/users-guide/params.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Parameters &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Parameters &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Starting and running Varnish" href="running.html" />
     <link rel="next" title="Sizing your cache" href="sizing-your-cache.html" />
     <link rel="prev" title="Storage backends" href="storage-backends.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="storage-backends.html" title="Storage backends"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="running.html" accesskey="U">Starting and running Varnish</a> &raquo;</li> 
       </ul>
@@ -123,7 +123,7 @@ shortlived                  10.000000 [s]
         <li class="right" >
           <a href="storage-backends.html" title="Storage backends"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="running.html" >Starting and running Varnish</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/performance.html b/doc/sphinx/build/html/users-guide/performance.html
index f6278a6..b54d383 100644
--- a/doc/sphinx/build/html/users-guide/performance.html
+++ b/doc/sphinx/build/html/users-guide/performance.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Varnish and Website Performance &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Varnish and Website Performance &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Users Guide" href="index.html" />
     <link rel="next" title="Achieving a high hitrate" href="increasing-your-hitrate.html" />
     <link rel="prev" title="Statistics" href="operation-statistics.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="operation-statistics.html" title="Statistics"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Users Guide</a> &raquo;</li> 
       </ul>
     </div>  
@@ -159,7 +159,7 @@ thereby increasing the performance of your website.</p>
         <li class="right" >
           <a href="operation-statistics.html" title="Statistics"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/users-guide/purging.html b/doc/sphinx/build/html/users-guide/purging.html
index 820600f..6ad0416 100644
--- a/doc/sphinx/build/html/users-guide/purging.html
+++ b/doc/sphinx/build/html/users-guide/purging.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Purging and banning &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Purging and banning &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Varnish and Website Performance" href="performance.html" />
     <link rel="next" title="Compression" href="compression.html" />
     <link rel="prev" title="Achieving a high hitrate" href="increasing-your-hitrate.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="increasing-your-hitrate.html" title="Achieving a high hitrate"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="performance.html" accesskey="U">Varnish and Website Performance</a> &raquo;</li> 
       </ul>
@@ -114,7 +114,7 @@ prevent new content from entering the cache or being served.</p>
 <p>Support for bans is built into Varnish and available in the CLI
 interface. To ban every png object belonging on example.com, issue
 the following command:</p>
-<div class="highlight-python"><pre>ban req.http.host == "example.com" &amp;&amp; req.url ~ "\.png$"</pre>
+<div class="highlight-python"><pre>ban req.http.host == "example.com" &amp;&amp; req.url ~ "\\.png$"</pre>
 </div>
 <p>Quite powerful, really.</p>
 <p>Bans are checked when we hit an object in the cache, but before we
@@ -248,7 +248,7 @@ some other means.</p>
         <li class="right" >
           <a href="increasing-your-hitrate.html" title="Achieving a high hitrate"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="performance.html" >Varnish and Website Performance</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/report.html b/doc/sphinx/build/html/users-guide/report.html
index 422ba10..0639287 100644
--- a/doc/sphinx/build/html/users-guide/report.html
+++ b/doc/sphinx/build/html/users-guide/report.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Reporting and statistics &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Reporting and statistics &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Users Guide" href="index.html" />
     <link rel="next" title="Logging in Varnish" href="operation-logging.html" />
     <link rel="prev" title="Device detection" href="devicedetection.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="devicedetection.html" title="Device detection"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Users Guide</a> &raquo;</li> 
       </ul>
     </div>  
@@ -117,7 +117,7 @@ summary statistics counters.</p>
         <li class="right" >
           <a href="devicedetection.html" title="Device detection"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/users-guide/run_cli.html b/doc/sphinx/build/html/users-guide/run_cli.html
index 442470a..f6c07a8 100644
--- a/doc/sphinx/build/html/users-guide/run_cli.html
+++ b/doc/sphinx/build/html/users-guide/run_cli.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>CLI - bossing Varnish around &mdash; Varnish version 4.0.2 documentation</title>
+    <title>CLI - bossing Varnish around &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Starting and running Varnish" href="running.html" />
     <link rel="next" title="Storage backends" href="storage-backends.html" />
     <link rel="prev" title="Important command line arguments" href="command-line.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="command-line.html" title="Important command line arguments"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="running.html" accesskey="U">Starting and running Varnish</a> &raquo;</li> 
       </ul>
@@ -246,7 +246,7 @@ restart it, but you can disable that with the 'auto_restart' parameter.</p>
         <li class="right" >
           <a href="command-line.html" title="Important command line arguments"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="running.html" >Starting and running Varnish</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/run_security.html b/doc/sphinx/build/html/users-guide/run_security.html
index a936d57..0af8694 100644
--- a/doc/sphinx/build/html/users-guide/run_security.html
+++ b/doc/sphinx/build/html/users-guide/run_security.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Security first &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Security first &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Starting and running Varnish" href="running.html" />
     <link rel="next" title="Important command line arguments" href="command-line.html" />
     <link rel="prev" title="Starting and running Varnish" href="running.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="running.html" title="Starting and running Varnish"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="running.html" accesskey="U">Starting and running Varnish</a> &raquo;</li> 
       </ul>
@@ -296,7 +296,7 @@ IP numbers/nets using VCL's <a class="reference internal" href="vcl-syntax.html#
         <li class="right" >
           <a href="running.html" title="Starting and running Varnish"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="running.html" >Starting and running Varnish</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/running.html b/doc/sphinx/build/html/users-guide/running.html
index 7698e66..60b89d1 100644
--- a/doc/sphinx/build/html/users-guide/running.html
+++ b/doc/sphinx/build/html/users-guide/running.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Starting and running Varnish &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Starting and running Varnish &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Users Guide" href="index.html" />
     <link rel="next" title="Security first" href="run_security.html" />
     <link rel="prev" title="The Big Varnish Picture" href="intro.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="intro.html" title="The Big Varnish Picture"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Users Guide</a> &raquo;</li> 
       </ul>
     </div>  
@@ -138,7 +138,7 @@ securing and protecting Varnish against attacks.</p>
         <li class="right" >
           <a href="intro.html" title="The Big Varnish Picture"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/users-guide/sizing-your-cache.html b/doc/sphinx/build/html/users-guide/sizing-your-cache.html
index d797c8e..c92dedf 100644
--- a/doc/sphinx/build/html/users-guide/sizing-your-cache.html
+++ b/doc/sphinx/build/html/users-guide/sizing-your-cache.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Sizing your cache &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Sizing your cache &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Starting and running Varnish" href="running.html" />
     <link rel="next" title="VCL - Varnish Configuration Language" href="vcl.html" />
     <link rel="prev" title="Parameters" href="params.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="params.html" title="Parameters"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="running.html" accesskey="U">Starting and running Varnish</a> &raquo;</li> 
       </ul>
@@ -125,7 +125,7 @@ in your cache the overhead might be significant.</p>
         <li class="right" >
           <a href="params.html" title="Parameters"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="running.html" >Starting and running Varnish</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/storage-backends.html b/doc/sphinx/build/html/users-guide/storage-backends.html
index 15fc8c3..87ceb91 100644
--- a/doc/sphinx/build/html/users-guide/storage-backends.html
+++ b/doc/sphinx/build/html/users-guide/storage-backends.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Storage backends &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Storage backends &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="Starting and running Varnish" href="running.html" />
     <link rel="next" title="Parameters" href="params.html" />
     <link rel="prev" title="CLI - bossing Varnish around" href="run_cli.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="run_cli.html" title="CLI - bossing Varnish around"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="running.html" accesskey="U">Starting and running Varnish</a> &raquo;</li> 
       </ul>
@@ -218,7 +218,7 @@ parameter 'shortlived'.</p>
         <li class="right" >
           <a href="run_cli.html" title="CLI - bossing Varnish around"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="running.html" >Starting and running Varnish</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/troubleshooting.html b/doc/sphinx/build/html/users-guide/troubleshooting.html
index 0dc6936..9cb426a 100644
--- a/doc/sphinx/build/html/users-guide/troubleshooting.html
+++ b/doc/sphinx/build/html/users-guide/troubleshooting.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Troubleshooting Varnish &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Troubleshooting Varnish &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Users Guide" href="index.html" />
     <link rel="next" title="The Varnish Reference Manual" href="../reference/index.html" />
     <link rel="prev" title="Content composition with Edge Side Includes" href="esi.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="esi.html" title="Content composition with Edge Side Includes"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Users Guide</a> &raquo;</li> 
       </ul>
     </div>  
@@ -144,15 +144,16 @@ to get a stack trace of the thread that caused the segfault.</p>
 give you a clue. Since <cite>varnishlog</cite> logs a lot of data it might be hard
 to track the entries down. You can set <cite>varnishlog</cite> to log all your 503
 errors by issuing the following command:</p>
-<div class="highlight-python"><pre>$ varnishlog -c -m TxStatus:503</pre>
+<div class="highlight-python"><pre>$ varnishlog -q 'RespStatus == 503' -g request</pre>
 </div>
 <p>If the error happened just a short time ago the transaction might still
 be in the shared memory log segment. To get <cite>varnishlog</cite> to process the
 whole shared memory log just add the '-d' parameter:</p>
-<div class="highlight-python"><pre>$ varnishlog -d -c -m TxStatus:503</pre>
+<div class="highlight-python"><pre>$ varnishlog -d -q 'RespStatus == 503' -g request</pre>
 </div>
-<p>Please see the <cite>varnishlog</cite> man page for elaborations on further
-filtering capabilities and explanation of the various options.</p>
+<p>Please see the <cite>vsl-query</cite> and <cite>varnishlog</cite> man pages for elaborations
+on further filtering capabilities and explanation of the various
+options.</p>
 </div>
 <div class="section" id="varnish-doesn-t-cache">
 <h2>Varnish doesn't cache<a class="headerlink" href="#varnish-doesn-t-cache" title="Permalink to this headline">¶</a></h2>
@@ -218,7 +219,7 @@ filtering capabilities and explanation of the various options.</p>
         <li class="right" >
           <a href="esi.html" title="Content composition with Edge Side Includes"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/users-guide/vcl-actions.html b/doc/sphinx/build/html/users-guide/vcl-actions.html
index 37dc1e8..481609a 100644
--- a/doc/sphinx/build/html/users-guide/vcl-actions.html
+++ b/doc/sphinx/build/html/users-guide/vcl-actions.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>actions &mdash; Varnish version 4.0.2 documentation</title>
+    <title>actions &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="VCL - Varnish Configuration Language" href="vcl.html" />
     <link rel="next" title="Backend servers" href="vcl-backends.html" />
     <link rel="prev" title="Request and response VCL objects" href="vcl-variables.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vcl-variables.html" title="Request and response VCL objects"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" accesskey="U">VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
@@ -133,7 +133,7 @@ that the backend delivered.</dd>
         <li class="right" >
           <a href="vcl-variables.html" title="Request and response VCL objects"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/vcl-backends.html b/doc/sphinx/build/html/users-guide/vcl-backends.html
index 5a0ea96..acf7c97 100644
--- a/doc/sphinx/build/html/users-guide/vcl-backends.html
+++ b/doc/sphinx/build/html/users-guide/vcl-backends.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Backend servers &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Backend servers &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="VCL - Varnish Configuration Language" href="vcl.html" />
     <link rel="next" title="Hashing" href="vcl-hashing.html" />
     <link rel="prev" title="actions" href="vcl-actions.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vcl-actions.html" title="actions"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" accesskey="U">VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
@@ -288,7 +288,7 @@ please see ref:<cite>reference-vcl-director</cite>.</p>
         <li class="right" >
           <a href="vcl-actions.html" title="actions"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/vcl-built-in-subs.html b/doc/sphinx/build/html/users-guide/vcl-built-in-subs.html
index 2ac29b8..7fac74c 100644
--- a/doc/sphinx/build/html/users-guide/vcl-built-in-subs.html
+++ b/doc/sphinx/build/html/users-guide/vcl-built-in-subs.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Built in subroutines &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Built in subroutines &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="VCL - Varnish Configuration Language" href="vcl.html" />
     <link rel="next" title="Request and response VCL objects" href="vcl-variables.html" />
     <link rel="prev" title="VCL Syntax" href="vcl-syntax.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vcl-syntax.html" title="VCL Syntax"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" accesskey="U">VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
@@ -54,38 +54,42 @@
         <div class="bodywrapper">
           <div class="body">
             
-  <span class="target" id="vcl-built-in-subs"></span><div class="section" id="built-in-subroutines">
-<h1>Built in subroutines<a class="headerlink" href="#built-in-subroutines" title="Permalink to this headline">¶</a></h1>
+  <div class="section" id="built-in-subroutines">
+<span id="vcl-built-in-subs"></span><h1>Built in subroutines<a class="headerlink" href="#built-in-subroutines" title="Permalink to this headline">¶</a></h1>
+<p>Various built-in subroutines are called during processing of client-
+and backend requests as well as upon <tt class="docutils literal"><span class="pre">vcl.load</span></tt> and <tt class="docutils literal"><span class="pre">vcl.discard</span></tt>.</p>
+<div class="section" id="client-side">
+<h2>client side<a class="headerlink" href="#client-side" title="Permalink to this headline">¶</a></h2>
 <div class="section" id="vcl-recv">
-<h2>vcl_recv<a class="headerlink" href="#vcl-recv" title="Permalink to this headline">¶</a></h2>
+<span id="id1"></span><h3>vcl_recv<a class="headerlink" href="#vcl-recv" title="Permalink to this headline">¶</a></h3>
 <p>Called at the beginning of a request, after the complete request has
-been received and parsed. Its purpose is to decide whether or not to
-serve the request, how to do it, and, if applicable, which backend to
-use.</p>
-<p>It is also used to modify the request, something you'll probably find
-yourself doing frequently.</p>
+been received and parsed, after a <cite>restart</cite> or as the result of an ESI
+include.</p>
+<p>Its purpose is to decide whether or not to serve the request, possibly
+modify it and decide on how to process it further. A backend hint may
+be set as a default for the backend processing side.</p>
 <p>The <cite>vcl_recv</cite> subroutine may terminate with calling <tt class="docutils literal"><span class="pre">return()</span></tt> on one
 of the following keywords:</p>
 <blockquote>
 <div><dl class="docutils">
-<dt>synth(status code, reason)</dt>
-<dd>Return a synthetic object with the specified status code to the
-client and abandon the request.</dd>
-<dt>pass</dt>
-<dd>Switch to pass mode. Control will eventually pass to vcl_pass.</dd>
-<dt>pipe</dt>
-<dd>Switch to pipe mode. Control will eventually pass to vcl_pipe.</dd>
-<dt>hash</dt>
+<dt><tt class="docutils literal"><span class="pre">hash</span></tt></dt>
 <dd>Continue processing the object as a potential candidate for
-caching. Passes the control over to vcl_hash.</dd>
-<dt>purge</dt>
+caching. Passes the control over to <a class="reference internal" href="#vcl-hash"><em>vcl_hash</em></a>.</dd>
+<dt><tt class="docutils literal"><span class="pre">pass</span></tt></dt>
+<dd>Switch to pass mode. Control will eventually pass to <a class="reference internal" href="#vcl-pass"><em>vcl_pass</em></a>.</dd>
+<dt><tt class="docutils literal"><span class="pre">pipe</span></tt></dt>
+<dd>Switch to pipe mode. Control will eventually pass to <a class="reference internal" href="#vcl-pipe"><em>vcl_pipe</em></a>.</dd>
+<dt><tt class="docutils literal"><span class="pre">synth(status</span> <span class="pre">code,</span> <span class="pre">reason)</span></tt></dt>
+<dd>Transition to <a class="reference internal" href="#vcl-synth"><em>vcl_synth</em></a> with <tt class="docutils literal"><span class="pre">resp.status</span></tt> and
+<tt class="docutils literal"><span class="pre">resp.reason</span></tt> being preset to the arguments of <tt class="docutils literal"><span class="pre">synth()</span></tt>.</dd>
+<dt><tt class="docutils literal"><span class="pre">purge</span></tt></dt>
 <dd>Purge the object and it's variants. Control passes through
 vcl_hash to vcl_purge.</dd>
 </dl>
 </div></blockquote>
 </div>
 <div class="section" id="vcl-pipe">
-<h2>vcl_pipe<a class="headerlink" href="#vcl-pipe" title="Permalink to this headline">¶</a></h2>
+<span id="id2"></span><h3>vcl_pipe<a class="headerlink" href="#vcl-pipe" title="Permalink to this headline">¶</a></h3>
 <p>Called upon entering pipe mode. In this mode, the request is passed on
 to the backend, and any further data from both the client and backend
 is passed on unaltered until either end closes the
@@ -96,15 +100,16 @@ other VCL subroutine will ever get called after <cite>vcl_pipe</cite>.</p>
 of the following keywords:</p>
 <blockquote>
 <div><dl class="docutils">
-<dt>synth(status code, reason)</dt>
-<dd>Return the specified status code to the client and abandon the request.</dd>
-<dt>pipe</dt>
+<dt><tt class="docutils literal"><span class="pre">pipe</span></tt></dt>
 <dd>Proceed with pipe mode.</dd>
+<dt><tt class="docutils literal"><span class="pre">synth(status</span> <span class="pre">code,</span> <span class="pre">reason)</span></tt></dt>
+<dd>Transition to <a class="reference internal" href="#vcl-synth"><em>vcl_synth</em></a> with <tt class="docutils literal"><span class="pre">resp.status</span></tt> and
+<tt class="docutils literal"><span class="pre">resp.reason</span></tt> being preset to the arguments of <tt class="docutils literal"><span class="pre">synth()</span></tt>.</dd>
 </dl>
 </div></blockquote>
 </div>
 <div class="section" id="vcl-pass">
-<h2>vcl_pass<a class="headerlink" href="#vcl-pass" title="Permalink to this headline">¶</a></h2>
+<span id="id3"></span><h3>vcl_pass<a class="headerlink" href="#vcl-pass" title="Permalink to this headline">¶</a></h3>
 <p>Called upon entering pass mode. In this mode, the request is passed
 on to the backend, and the backend's response is passed on to the
 client, but is not entered into the cache. Subsequent requests
@@ -113,181 +118,245 @@ submitted over the same client connection are handled normally.</p>
 of the following keywords:</p>
 <blockquote>
 <div><dl class="docutils">
-<dt>synth(status code, reason)</dt>
-<dd>Return the specified status code to the client and abandon the request.</dd>
-<dt>pass</dt>
-<dd>Proceed with pass mode.</dd>
-<dt>restart</dt>
+<dt><tt class="docutils literal"><span class="pre">fetch</span></tt></dt>
+<dd>Proceed with pass mode - initiate a backend request.</dd>
+<dt><tt class="docutils literal"><span class="pre">restart</span></tt></dt>
 <dd>Restart the transaction. Increases the restart counter. If the number
 of restarts is higher than <em>max_restarts</em> Varnish emits a guru meditation
 error.</dd>
+<dt><tt class="docutils literal"><span class="pre">synth(status</span> <span class="pre">code,</span> <span class="pre">reason)</span></tt></dt>
+<dd>Transition to <a class="reference internal" href="#vcl-synth"><em>vcl_synth</em></a> with <tt class="docutils literal"><span class="pre">resp.status</span></tt> and
+<tt class="docutils literal"><span class="pre">resp.reason</span></tt> being preset to the arguments of <tt class="docutils literal"><span class="pre">synth()</span></tt>.</dd>
 </dl>
 </div></blockquote>
 </div>
 <div class="section" id="vcl-hit">
-<h2>vcl_hit<a class="headerlink" href="#vcl-hit" title="Permalink to this headline">¶</a></h2>
-<p>Called when a cache lookup is successful.</p>
-<p>The <cite>vcl_hit</cite> subroutine may terminate with calling <tt class="docutils literal"><span class="pre">return()</span></tt> with one of the following keywords:</p>
+<span id="id4"></span><h3>vcl_hit<a class="headerlink" href="#vcl-hit" title="Permalink to this headline">¶</a></h3>
+<p>Called when a cache lookup is successful. The object being hit may be
+stale: It can have a zero or negative <cite>ttl</cite> with only <cite>grace</cite> or
+<cite>keep</cite> time left.</p>
+<p>The <cite>vcl_hit</cite> subroutine may terminate with calling <tt class="docutils literal"><span class="pre">return()</span></tt>
+with one of the following keywords:</p>
 <blockquote>
 <div><dl class="docutils">
-<dt>restart</dt>
+<dt><tt class="docutils literal"><span class="pre">deliver</span></tt></dt>
+<dd>Deliver the object. If it is stale, a background fetch to refresh
+it is triggered.</dd>
+<dt><tt class="docutils literal"><span class="pre">fetch</span></tt></dt>
+<dd>Synchronously refresh the object from the backend despite the
+cache hit. Control will eventually pass to <a class="reference internal" href="#vcl-miss"><em>vcl_miss</em></a>.</dd>
+<dt><tt class="docutils literal"><span class="pre">pass</span></tt></dt>
+<dd>Switch to pass mode. Control will eventually pass to <a class="reference internal" href="#vcl-pass"><em>vcl_pass</em></a>.</dd>
+<dt><tt class="docutils literal"><span class="pre">restart</span></tt></dt>
 <dd>Restart the transaction. Increases the restart counter. If the number
 of restarts is higher than <em>max_restarts</em> Varnish emits a guru meditation
 error.</dd>
-<dt>deliver</dt>
-<dd>Deliver the object. Control passes to <cite>vcl_deliver</cite>.</dd>
-<dt>synth(status code, reason)</dt>
-<dd>Return the specified status code to the client and abandon the request.</dd>
+<dt><tt class="docutils literal"><span class="pre">synth(status</span> <span class="pre">code,</span> <span class="pre">reason)</span></tt></dt>
+<dd>Transition to <a class="reference internal" href="#vcl-synth"><em>vcl_synth</em></a> with <tt class="docutils literal"><span class="pre">resp.status</span></tt> and
+<tt class="docutils literal"><span class="pre">resp.reason</span></tt> being preset to the arguments of <tt class="docutils literal"><span class="pre">synth()</span></tt>.</dd>
 </dl>
 </div></blockquote>
 </div>
 <div class="section" id="vcl-miss">
-<h2>vcl_miss<a class="headerlink" href="#vcl-miss" title="Permalink to this headline">¶</a></h2>
+<span id="id5"></span><h3>vcl_miss<a class="headerlink" href="#vcl-miss" title="Permalink to this headline">¶</a></h3>
 <p>Called after a cache lookup if the requested document was not found in
-the cache. Its purpose is to decide whether or not to attempt to
-retrieve the document from the backend, and which backend to use.</p>
+the cache or if <a class="reference internal" href="#vcl-hit"><em>vcl_hit</em></a> returned <tt class="docutils literal"><span class="pre">fetch</span></tt>.</p>
+<p>Its purpose is to decide whether or not to attempt to retrieve the
+document from the backend. A backend hint may be set as a default for
+the backend processing side.</p>
 <p>The <cite>vcl_miss</cite> subroutine may terminate with calling <tt class="docutils literal"><span class="pre">return()</span></tt> with one
 of the following keywords:</p>
 <blockquote>
 <div><dl class="docutils">
-<dt>synth(status code, reason)</dt>
-<dd>Return the specified status code to the client and abandon the request.</dd>
-<dt>pass</dt>
-<dd>Switch to pass mode. Control will eventually pass to <cite>vcl_pass</cite>.</dd>
-<dt>fetch</dt>
+<dt><tt class="docutils literal"><span class="pre">fetch</span></tt></dt>
 <dd>Retrieve the requested object from the backend. Control will
 eventually pass to <cite>vcl_backend_fetch</cite>.</dd>
-<dt>restart</dt>
+<dt><tt class="docutils literal"><span class="pre">pass</span></tt></dt>
+<dd>Switch to pass mode. Control will eventually pass to <a class="reference internal" href="#vcl-pass"><em>vcl_pass</em></a>.</dd>
+<dt><tt class="docutils literal"><span class="pre">restart</span></tt></dt>
 <dd>Restart the transaction. Increases the restart counter. If the number
 of restarts is higher than <em>max_restarts</em> Varnish emits a guru meditation
 error.</dd>
+<dt><tt class="docutils literal"><span class="pre">synth(status</span> <span class="pre">code,</span> <span class="pre">reason)</span></tt></dt>
+<dd>Transition to <a class="reference internal" href="#vcl-synth"><em>vcl_synth</em></a> with <tt class="docutils literal"><span class="pre">resp.status</span></tt> and
+<tt class="docutils literal"><span class="pre">resp.reason</span></tt> being preset to the arguments of <tt class="docutils literal"><span class="pre">synth()</span></tt>.</dd>
 </dl>
 </div></blockquote>
 </div>
 <div class="section" id="vcl-hash">
-<h2>vcl_hash<a class="headerlink" href="#vcl-hash" title="Permalink to this headline">¶</a></h2>
+<span id="id6"></span><h3>vcl_hash<a class="headerlink" href="#vcl-hash" title="Permalink to this headline">¶</a></h3>
 <p>Called after <cite>vcl_recv</cite> to create a hash value for the request. This is
 used as a key to look up the object in Varnish.</p>
-<p>The <cite>vcl_hash</cite> subroutine may terminate with calling <tt class="docutils literal"><span class="pre">return()</span></tt> with one
-of the following keywords:</p>
+<p>The <cite>vcl_hash</cite> subroutine may only terminate with calling <tt class="docutils literal"><span class="pre">return(lookup)</span></tt>:</p>
 <blockquote>
 <div><dl class="docutils">
-<dt>lookup</dt>
-<dd>Look up the object in cache. Control passes to vcl_miss, vcl_hit
-or vcl_purge.</dd>
+<dt><tt class="docutils literal"><span class="pre">lookup</span></tt></dt>
+<dd>Look up the object in cache.
+Control passes to <a class="reference internal" href="#vcl-purge"><em>vcl_purge</em></a> when coming from a <tt class="docutils literal"><span class="pre">purge</span></tt>
+return in <cite>vcl_recv</cite>.
+Otherwise control passes to <a class="reference internal" href="#vcl-hit"><em>vcl_hit</em></a>, <a class="reference internal" href="#vcl-miss"><em>vcl_miss</em></a> or
+<a class="reference internal" href="#vcl-pass"><em>vcl_pass</em></a> if the cache lookup result was a hit, a miss or hit
+on a hit-for-pass object (object with <tt class="docutils literal"><span class="pre">obj.uncacheable</span> <span class="pre">==</span>
+<span class="pre">true</span></tt>), respectively.</dd>
 </dl>
 </div></blockquote>
 </div>
 <div class="section" id="vcl-purge">
-<h2>vcl_purge<a class="headerlink" href="#vcl-purge" title="Permalink to this headline">¶</a></h2>
+<span id="id7"></span><h3>vcl_purge<a class="headerlink" href="#vcl-purge" title="Permalink to this headline">¶</a></h3>
 <p>Called after the purge has been executed and all its variants have been evited.</p>
 <p>The <cite>vcl_purge</cite> subroutine may terminate with calling <tt class="docutils literal"><span class="pre">return()</span></tt> with one
 of the following keywords:</p>
 <blockquote>
 <div><dl class="docutils">
-<dt>synth</dt>
-<dd>Produce a response.</dd>
-<dt>restart</dt>
+<dt><tt class="docutils literal"><span class="pre">restart</span></tt></dt>
 <dd>Restart the transaction. Increases the restart counter. If the number
 of restarts is higher than <em>max_restarts</em> Varnish emits a guru meditation
 error.</dd>
+<dt><tt class="docutils literal"><span class="pre">synth(status</span> <span class="pre">code,</span> <span class="pre">reason)</span></tt></dt>
+<dd>Transition to <a class="reference internal" href="#vcl-synth"><em>vcl_synth</em></a> with <tt class="docutils literal"><span class="pre">resp.status</span></tt> and
+<tt class="docutils literal"><span class="pre">resp.reason</span></tt> being preset to the arguments of <tt class="docutils literal"><span class="pre">synth()</span></tt>.</dd>
 </dl>
 </div></blockquote>
 </div>
 <div class="section" id="vcl-deliver">
-<h2>vcl_deliver<a class="headerlink" href="#vcl-deliver" title="Permalink to this headline">¶</a></h2>
-<p>Called before a cached object is delivered to the client.</p>
+<span id="id8"></span><h3>vcl_deliver<a class="headerlink" href="#vcl-deliver" title="Permalink to this headline">¶</a></h3>
+<p>Called before any object except a <cite>vcl_synth</cite> result is delivered to the client.</p>
 <p>The <cite>vcl_deliver</cite> subroutine may terminate with calling <tt class="docutils literal"><span class="pre">return()</span></tt> with one
 of the following keywords:</p>
 <blockquote>
 <div><dl class="docutils">
-<dt>deliver</dt>
+<dt><tt class="docutils literal"><span class="pre">deliver</span></tt></dt>
 <dd>Deliver the object to the client.</dd>
-<dt>restart</dt>
+<dt><tt class="docutils literal"><span class="pre">restart</span></tt></dt>
+<dd>Restart the transaction. Increases the restart counter. If the number
+of restarts is higher than <em>max_restarts</em> Varnish emits a guru meditation
+error.</dd>
+<dt><tt class="docutils literal"><span class="pre">synth(status</span> <span class="pre">code,</span> <span class="pre">reason)</span></tt></dt>
+<dd>Transition to <a class="reference internal" href="#vcl-synth"><em>vcl_synth</em></a> with <tt class="docutils literal"><span class="pre">resp.status</span></tt> and
+<tt class="docutils literal"><span class="pre">resp.reason</span></tt> being preset to the arguments of <tt class="docutils literal"><span class="pre">synth()</span></tt>.</dd>
+</dl>
+</div></blockquote>
+</div>
+<div class="section" id="vcl-synth">
+<span id="id9"></span><h3>vcl_synth<a class="headerlink" href="#vcl-synth" title="Permalink to this headline">¶</a></h3>
+<p>Called to deliver a synthetic object. A synthetic object is generated
+in VCL, not fetched from the backend. Its body may be contructed using
+the <tt class="docutils literal"><span class="pre">synthetic()</span></tt> function.</p>
+<p>A <cite>vcl_synth</cite> defined object never enters the cache, contrary to a
+<a class="reference internal" href="#vcl-backend-error"><em>vcl_backend_error</em></a> defined object, which may end up in cache.</p>
+<p>The subroutine may terminate with calling <tt class="docutils literal"><span class="pre">return()</span></tt> with one of the
+following keywords:</p>
+<blockquote>
+<div><dl class="docutils">
+<dt><tt class="docutils literal"><span class="pre">deliver</span></tt></dt>
+<dd>Directly deliver the object defined by <cite>vcl_synth</cite> to the
+client without calling <cite>vcl_deliver</cite>.</dd>
+<dt><tt class="docutils literal"><span class="pre">restart</span></tt></dt>
 <dd>Restart the transaction. Increases the restart counter. If the number
 of restarts is higher than <em>max_restarts</em> Varnish emits a guru meditation
 error.</dd>
 </dl>
 </div></blockquote>
 </div>
+</div>
+<div class="section" id="backend-side">
+<h2>Backend Side<a class="headerlink" href="#backend-side" title="Permalink to this headline">¶</a></h2>
 <div class="section" id="vcl-backend-fetch">
-<h2>vcl_backend_fetch<a class="headerlink" href="#vcl-backend-fetch" title="Permalink to this headline">¶</a></h2>
+<span id="id10"></span><h3>vcl_backend_fetch<a class="headerlink" href="#vcl-backend-fetch" title="Permalink to this headline">¶</a></h3>
 <p>Called before sending the backend request. In this subroutine you
 typically alter the request before it gets to the backend.</p>
 <p>The <cite>vcl_backend_fetch</cite> subroutine may terminate with calling
 <tt class="docutils literal"><span class="pre">return()</span></tt> with one of the following keywords:</p>
 <blockquote>
 <div><dl class="docutils">
-<dt>fetch</dt>
+<dt><tt class="docutils literal"><span class="pre">fetch</span></tt></dt>
 <dd>Fetch the object from the backend.</dd>
-<dt>abandon</dt>
-<dd>Abandon the backend request and generates an error.</dd>
+<dt><tt class="docutils literal"><span class="pre">abandon</span></tt></dt>
+<dd>Abandon the backend request. Unless the backend request was a
+background fetch, control is passed to <a class="reference internal" href="#vcl-synth"><em>vcl_synth</em></a> on the
+client side with <tt class="docutils literal"><span class="pre">resp.status</span></tt> preset to 503.</dd>
 </dl>
 </div></blockquote>
 </div>
 <div class="section" id="vcl-backend-response">
-<h2>vcl_backend_response<a class="headerlink" href="#vcl-backend-response" title="Permalink to this headline">¶</a></h2>
-<p>Called after the response headers has been successfully retrieved from
+<span id="id11"></span><h3>vcl_backend_response<a class="headerlink" href="#vcl-backend-response" title="Permalink to this headline">¶</a></h3>
+<p>Called after the response headers have been successfully retrieved from
 the backend.</p>
 <p>The <cite>vcl_backend_response</cite> subroutine may terminate with calling
 <tt class="docutils literal"><span class="pre">return()</span></tt> with one of the following keywords:</p>
 <blockquote>
 <div><dl class="docutils">
-<dt>deliver</dt>
-<dd>Possibly insert the object into the cache, then deliver it to the
-Control will eventually pass to <cite>vcl_deliver</cite>.</dd>
-<dt>abandon</dt>
-<dd>Abandon the backend request and generates an error.</dd>
-<dt>retry</dt>
+<dt><tt class="docutils literal"><span class="pre">deliver</span></tt></dt>
+<dd>For a 304 response, create an updated cache object.
+Otherwise, fetch the object body from the backend and initiate
+delivery to any waiting client requests, possibly in parallel
+(streaming).</dd>
+<dt><tt class="docutils literal"><span class="pre">abandon</span></tt></dt>
+<dd>Abandon the backend request. Unless the backend request was a
+background fetch, control is passed to <a class="reference internal" href="#vcl-synth"><em>vcl_synth</em></a> on the
+client side with <tt class="docutils literal"><span class="pre">resp.status</span></tt> preset to 503.</dd>
+<dt><tt class="docutils literal"><span class="pre">retry</span></tt></dt>
 <dd>Retry the backend transaction. Increases the <cite>retries</cite> counter.
-If the number of retries is higher than <em>max_retries</em> Varnish
-emits a guru meditation error.</dd>
+If the number of retries is higher than <em>max_retries</em>,
+control will be passed to <a class="reference internal" href="#vcl-backend-error"><em>vcl_backend_error</em></a>.</dd>
 </dl>
 </div></blockquote>
 </div>
 <div class="section" id="vcl-backend-error">
-<h2>vcl_backend_error<a class="headerlink" href="#vcl-backend-error" title="Permalink to this headline">¶</a></h2>
-<p>This subroutine is called if we fail the backend fetch.</p>
+<span id="id12"></span><h3>vcl_backend_error<a class="headerlink" href="#vcl-backend-error" title="Permalink to this headline">¶</a></h3>
+<p>This subroutine is called if we fail the backend fetch or if
+<em>max_retries</em> has been exceeded.</p>
+<p>A synthetic object is generated in VCL, whose body may be contructed
+using the <tt class="docutils literal"><span class="pre">synthetic()</span></tt> function.</p>
 <p>The <cite>vcl_backend_error</cite> subroutine may terminate with calling <tt class="docutils literal"><span class="pre">return()</span></tt>
 with one of the following keywords:</p>
 <blockquote>
 <div><dl class="docutils">
-<dt>deliver</dt>
-<dd>Deliver the error.</dd>
-<dt>retry</dt>
-<dd>Retry the backend transaction. Increases the <cite>retries</cite> counter. If
-the number of retries is higher than <em>max_retries</em> Varnish emits a
-guru meditation error.</dd>
+<dt><tt class="docutils literal"><span class="pre">deliver</span></tt></dt>
+<dd>Deliver and possibly cache the object defined in
+<cite>vcl_backend_error</cite> <strong>as if it was fetched from the backend</strong>, also
+referred to as a &quot;backend synth&quot;.</dd>
+<dt><tt class="docutils literal"><span class="pre">retry</span></tt></dt>
+<dd>Retry the backend transaction. Increases the <cite>retries</cite> counter.
+If the number of retries is higher than <em>max_retries</em>,
+<a class="reference internal" href="#vcl-synth"><em>vcl_synth</em></a> on the client side is called with <tt class="docutils literal"><span class="pre">resp.status</span></tt>
+preset to 503.</dd>
 </dl>
 </div></blockquote>
 </div>
+</div>
+<div class="section" id="vcl-load-vcl-discard">
+<h2>vcl.load / vcl.discard<a class="headerlink" href="#vcl-load-vcl-discard" title="Permalink to this headline">¶</a></h2>
 <div class="section" id="vcl-init">
-<h2>vcl_init<a class="headerlink" href="#vcl-init" title="Permalink to this headline">¶</a></h2>
+<span id="id13"></span><h3>vcl_init<a class="headerlink" href="#vcl-init" title="Permalink to this headline">¶</a></h3>
 <p>Called when VCL is loaded, before any requests pass through it.
 Typically used to initialize VMODs.</p>
 <p>The <cite>vcl_init</cite> subroutine may terminate with calling <tt class="docutils literal"><span class="pre">return()</span></tt>
 with one of the following keywords:</p>
 <blockquote>
 <div><dl class="docutils">
-<dt>ok</dt>
+<dt><tt class="docutils literal"><span class="pre">ok</span></tt></dt>
 <dd>Normal return, VCL continues loading.</dd>
+<dt><tt class="docutils literal"><span class="pre">fail</span></tt></dt>
+<dd>Abort loading of this VCL.</dd>
 </dl>
 </div></blockquote>
 </div>
 <div class="section" id="vcl-fini">
-<h2>vcl_fini<a class="headerlink" href="#vcl-fini" title="Permalink to this headline">¶</a></h2>
+<span id="id14"></span><h3>vcl_fini<a class="headerlink" href="#vcl-fini" title="Permalink to this headline">¶</a></h3>
 <p>Called when VCL is discarded only after all requests have exited the VCL.
 Typically used to clean up VMODs.</p>
 <p>The <cite>vcl_fini</cite> subroutine may terminate with calling <tt class="docutils literal"><span class="pre">return()</span></tt>
 with one of the following keywords:</p>
 <blockquote>
 <div><dl class="docutils">
-<dt>ok</dt>
+<dt><tt class="docutils literal"><span class="pre">ok</span></tt></dt>
 <dd>Normal return, VCL will be discarded.</dd>
 </dl>
 </div></blockquote>
 </div>
 </div>
+</div>
 
 
           </div>
@@ -298,6 +367,7 @@ with one of the following keywords:</p>
   <h3><a href="../index.html">Table Of Contents</a></h3>
   <ul>
 <li><a class="reference internal" href="#">Built in subroutines</a><ul>
+<li><a class="reference internal" href="#client-side">client side</a><ul>
 <li><a class="reference internal" href="#vcl-recv">vcl_recv</a></li>
 <li><a class="reference internal" href="#vcl-pipe">vcl_pipe</a></li>
 <li><a class="reference internal" href="#vcl-pass">vcl_pass</a></li>
@@ -306,14 +376,23 @@ with one of the following keywords:</p>
 <li><a class="reference internal" href="#vcl-hash">vcl_hash</a></li>
 <li><a class="reference internal" href="#vcl-purge">vcl_purge</a></li>
 <li><a class="reference internal" href="#vcl-deliver">vcl_deliver</a></li>
+<li><a class="reference internal" href="#vcl-synth">vcl_synth</a></li>
+</ul>
+</li>
+<li><a class="reference internal" href="#backend-side">Backend Side</a><ul>
 <li><a class="reference internal" href="#vcl-backend-fetch">vcl_backend_fetch</a></li>
 <li><a class="reference internal" href="#vcl-backend-response">vcl_backend_response</a></li>
 <li><a class="reference internal" href="#vcl-backend-error">vcl_backend_error</a></li>
+</ul>
+</li>
+<li><a class="reference internal" href="#vcl-load-vcl-discard">vcl.load / vcl.discard</a><ul>
 <li><a class="reference internal" href="#vcl-init">vcl_init</a></li>
 <li><a class="reference internal" href="#vcl-fini">vcl_fini</a></li>
 </ul>
 </li>
 </ul>
+</li>
+</ul>
 
   <h4>Previous topic</h4>
   <p class="topless"><a href="vcl-syntax.html"
@@ -355,7 +434,7 @@ with one of the following keywords:</p>
         <li class="right" >
           <a href="vcl-syntax.html" title="VCL Syntax"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/vcl-example-acls.html b/doc/sphinx/build/html/users-guide/vcl-example-acls.html
index bd4b812..be00e64 100644
--- a/doc/sphinx/build/html/users-guide/vcl-example-acls.html
+++ b/doc/sphinx/build/html/users-guide/vcl-example-acls.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>ACLs &mdash; Varnish version 4.0.2 documentation</title>
+    <title>ACLs &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="VCL Examples" href="vcl-examples.html" />
     <link rel="next" title="Implementing websocket support" href="vcl-example-websockets.html" />
     <link rel="prev" title="Altering the backend response" href="vcl-example-manipulating-responses.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vcl-example-manipulating-responses.html" title="Altering the backend response"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li>
           <li><a href="vcl-examples.html" accesskey="U">VCL Examples</a> &raquo;</li> 
@@ -124,7 +124,7 @@ sub vcl_recv {
         <li class="right" >
           <a href="vcl-example-manipulating-responses.html" title="Altering the backend response"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li>
           <li><a href="vcl-examples.html" >VCL Examples</a> &raquo;</li> 
diff --git a/doc/sphinx/build/html/users-guide/vcl-example-manipulating-headers.html b/doc/sphinx/build/html/users-guide/vcl-example-manipulating-headers.html
index 4f4c480..8c5b515 100644
--- a/doc/sphinx/build/html/users-guide/vcl-example-manipulating-headers.html
+++ b/doc/sphinx/build/html/users-guide/vcl-example-manipulating-headers.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Manipulating request headers in VCL &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Manipulating request headers in VCL &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="VCL Examples" href="vcl-examples.html" />
     <link rel="next" title="Altering the backend response" href="vcl-example-manipulating-responses.html" />
     <link rel="prev" title="VCL Examples" href="vcl-examples.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vcl-examples.html" title="VCL Examples"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li>
           <li><a href="vcl-examples.html" accesskey="U">VCL Examples</a> &raquo;</li> 
@@ -118,7 +118,7 @@ it matches the Cookie: header of the request is unset (deleted).</p>
         <li class="right" >
           <a href="vcl-examples.html" title="VCL Examples"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li>
           <li><a href="vcl-examples.html" >VCL Examples</a> &raquo;</li> 
diff --git a/doc/sphinx/build/html/users-guide/vcl-example-manipulating-responses.html b/doc/sphinx/build/html/users-guide/vcl-example-manipulating-responses.html
index b2c8c45..28f10de 100644
--- a/doc/sphinx/build/html/users-guide/vcl-example-manipulating-responses.html
+++ b/doc/sphinx/build/html/users-guide/vcl-example-manipulating-responses.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Altering the backend response &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Altering the backend response &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="VCL Examples" href="vcl-examples.html" />
     <link rel="next" title="ACLs" href="vcl-example-acls.html" />
     <link rel="prev" title="Manipulating request headers in VCL" href="vcl-example-manipulating-headers.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vcl-example-manipulating-headers.html" title="Manipulating request headers in VCL"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li>
           <li><a href="vcl-examples.html" accesskey="U">VCL Examples</a> &raquo;</li> 
@@ -116,7 +116,7 @@ object to be created. See <a class="reference internal" href="vcl-actions.html#u
         <li class="right" >
           <a href="vcl-example-manipulating-headers.html" title="Manipulating request headers in VCL"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li>
           <li><a href="vcl-examples.html" >VCL Examples</a> &raquo;</li> 
diff --git a/doc/sphinx/build/html/users-guide/vcl-example-websockets.html b/doc/sphinx/build/html/users-guide/vcl-example-websockets.html
index bb910fe..888816c 100644
--- a/doc/sphinx/build/html/users-guide/vcl-example-websockets.html
+++ b/doc/sphinx/build/html/users-guide/vcl-example-websockets.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Implementing websocket support &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Implementing websocket support &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="VCL Examples" href="vcl-examples.html" />
     <link rel="next" title="Device detection" href="devicedetection.html" />
     <link rel="prev" title="ACLs" href="vcl-example-acls.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vcl-example-acls.html" title="ACLs"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li>
           <li><a href="vcl-examples.html" accesskey="U">VCL Examples</a> &raquo;</li> 
@@ -119,7 +119,7 @@ sub vcl_recv {
         <li class="right" >
           <a href="vcl-example-acls.html" title="ACLs"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li>
           <li><a href="vcl-examples.html" >VCL Examples</a> &raquo;</li> 
diff --git a/doc/sphinx/build/html/users-guide/vcl-examples.html b/doc/sphinx/build/html/users-guide/vcl-examples.html
index c60645d..9363b07 100644
--- a/doc/sphinx/build/html/users-guide/vcl-examples.html
+++ b/doc/sphinx/build/html/users-guide/vcl-examples.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>VCL Examples &mdash; Varnish version 4.0.2 documentation</title>
+    <title>VCL Examples &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,10 +25,10 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="VCL - Varnish Configuration Language" href="vcl.html" />
     <link rel="next" title="Manipulating request headers in VCL" href="vcl-example-manipulating-headers.html" />
-    <link rel="prev" title="Using In-line C to extend Varnish" href="vcl-inline-c.html" /> 
+    <link rel="prev" title="Using inline C to extend Varnish" href="vcl-inline-c.html" /> 
   </head>
   <body>
     <div class="related">
@@ -41,9 +41,9 @@
           <a href="vcl-example-manipulating-headers.html" title="Manipulating request headers in VCL"
              accesskey="N">next</a> |</li>
         <li class="right" >
-          <a href="vcl-inline-c.html" title="Using In-line C to extend Varnish"
+          <a href="vcl-inline-c.html" title="Using inline C to extend Varnish"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" accesskey="U">VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
@@ -76,7 +76,7 @@ capabilities of the VCL language.</p>
         <div class="sphinxsidebarwrapper">
   <h4>Previous topic</h4>
   <p class="topless"><a href="vcl-inline-c.html"
-                        title="previous chapter">Using In-line C to extend Varnish</a></p>
+                        title="previous chapter">Using inline C to extend Varnish</a></p>
   <h4>Next topic</h4>
   <p class="topless"><a href="vcl-example-manipulating-headers.html"
                         title="next chapter">Manipulating request headers in VCL</a></p>
@@ -112,9 +112,9 @@ capabilities of the VCL language.</p>
           <a href="vcl-example-manipulating-headers.html" title="Manipulating request headers in VCL"
              >next</a> |</li>
         <li class="right" >
-          <a href="vcl-inline-c.html" title="Using In-line C to extend Varnish"
+          <a href="vcl-inline-c.html" title="Using inline C to extend Varnish"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/vcl-grace.html b/doc/sphinx/build/html/users-guide/vcl-grace.html
index 1a8e752..32fbefc 100644
--- a/doc/sphinx/build/html/users-guide/vcl-grace.html
+++ b/doc/sphinx/build/html/users-guide/vcl-grace.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Misbehaving servers &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Misbehaving servers &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,9 +25,9 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="VCL - Varnish Configuration Language" href="vcl.html" />
-    <link rel="next" title="Using In-line C to extend Varnish" href="vcl-inline-c.html" />
+    <link rel="next" title="Using inline C to extend Varnish" href="vcl-inline-c.html" />
     <link rel="prev" title="Hashing" href="vcl-hashing.html" /> 
   </head>
   <body>
@@ -38,12 +38,12 @@
           <a href="../genindex.html" title="General Index"
              accesskey="I">index</a></li>
         <li class="right" >
-          <a href="vcl-inline-c.html" title="Using In-line C to extend Varnish"
+          <a href="vcl-inline-c.html" title="Using inline C to extend Varnish"
              accesskey="N">next</a> |</li>
         <li class="right" >
           <a href="vcl-hashing.html" title="Hashing"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" accesskey="U">VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
@@ -138,7 +138,7 @@ second if-clause with something like this::</p>
                         title="previous chapter">Hashing</a></p>
   <h4>Next topic</h4>
   <p class="topless"><a href="vcl-inline-c.html"
-                        title="next chapter">Using In-line C to extend Varnish</a></p>
+                        title="next chapter">Using inline C to extend Varnish</a></p>
   <h3>This Page</h3>
   <ul class="this-page-menu">
     <li><a href="../_sources/users-guide/vcl-grace.txt"
@@ -168,12 +168,12 @@ second if-clause with something like this::</p>
           <a href="../genindex.html" title="General Index"
              >index</a></li>
         <li class="right" >
-          <a href="vcl-inline-c.html" title="Using In-line C to extend Varnish"
+          <a href="vcl-inline-c.html" title="Using inline C to extend Varnish"
              >next</a> |</li>
         <li class="right" >
           <a href="vcl-hashing.html" title="Hashing"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/vcl-hashing.html b/doc/sphinx/build/html/users-guide/vcl-hashing.html
index 246e561..5cf59a1 100644
--- a/doc/sphinx/build/html/users-guide/vcl-hashing.html
+++ b/doc/sphinx/build/html/users-guide/vcl-hashing.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Hashing &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Hashing &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="VCL - Varnish Configuration Language" href="vcl.html" />
     <link rel="next" title="Misbehaving servers" href="vcl-grace.html" />
     <link rel="prev" title="Backend servers" href="vcl-backends.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vcl-backends.html" title="Backend servers"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" accesskey="U">VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
@@ -142,7 +142,7 @@ up returning data based on more or less random inputs.</p>
         <li class="right" >
           <a href="vcl-backends.html" title="Backend servers"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/vcl-inline-c.html b/doc/sphinx/build/html/users-guide/vcl-inline-c.html
index 2f77638..17ea230 100644
--- a/doc/sphinx/build/html/users-guide/vcl-inline-c.html
+++ b/doc/sphinx/build/html/users-guide/vcl-inline-c.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Using In-line C to extend Varnish &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Using inline C to extend Varnish &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="VCL - Varnish Configuration Language" href="vcl.html" />
     <link rel="next" title="VCL Examples" href="vcl-examples.html" />
     <link rel="prev" title="Misbehaving servers" href="vcl-grace.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vcl-grace.html" title="Misbehaving servers"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" accesskey="U">VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
@@ -54,13 +54,13 @@
         <div class="bodywrapper">
           <div class="body">
             
-  <div class="section" id="using-in-line-c-to-extend-varnish">
-<h1>Using In-line C to extend Varnish<a class="headerlink" href="#using-in-line-c-to-extend-varnish" title="Permalink to this headline">¶</a></h1>
+  <div class="section" id="using-inline-c-to-extend-varnish">
+<h1>Using inline C to extend Varnish<a class="headerlink" href="#using-inline-c-to-extend-varnish" title="Permalink to this headline">¶</a></h1>
 <p>(Here there be dragons. Big and mean ones.)</p>
-<p>You can use <em>in-line C</em> to extend Varnish. Please note that you can
+<p>You can use <em>inline C</em> to extend Varnish. Please note that you can
 seriously mess up Varnish this way. The C code runs within the Varnish
 Cache process so if your code generates a segfault the cache will crash.</p>
-<p>One of the first uses of In-line C was logging to <cite>syslog</cite>.:</p>
+<p>One of the first uses of inline C was logging to <cite>syslog</cite>.:</p>
 <div class="highlight-python"><pre># The include statements must be outside the subroutines.
 C{
         #include &lt;syslog.h&gt;
@@ -72,6 +72,8 @@ sub vcl_something {
         }C
 }</pre>
 </div>
+<p>To use inline C you need to enable it with the <tt class="docutils literal"><span class="pre">vcc_allow_inline_c</span></tt>
+parameter.</p>
 </div>
 
 
@@ -120,7 +122,7 @@ sub vcl_something {
         <li class="right" >
           <a href="vcl-grace.html" title="Misbehaving servers"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/vcl-syntax.html b/doc/sphinx/build/html/users-guide/vcl-syntax.html
index b716d01..4b263f6 100644
--- a/doc/sphinx/build/html/users-guide/vcl-syntax.html
+++ b/doc/sphinx/build/html/users-guide/vcl-syntax.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>VCL Syntax &mdash; Varnish version 4.0.2 documentation</title>
+    <title>VCL Syntax &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="VCL - Varnish Configuration Language" href="vcl.html" />
     <link rel="next" title="Built in subroutines" href="vcl-built-in-subs.html" />
     <link rel="prev" title="VCL - Varnish Configuration Language" href="vcl.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vcl.html" title="VCL - Varnish Configuration Language"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" accesskey="U">VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
@@ -202,7 +202,7 @@ named <cite>vcl_*</cite>. Your own subroutines cannot start their name with <cit
         <li class="right" >
           <a href="vcl.html" title="VCL - Varnish Configuration Language"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/vcl-variables.html b/doc/sphinx/build/html/users-guide/vcl-variables.html
index ec84a78..b0dfb62 100644
--- a/doc/sphinx/build/html/users-guide/vcl-variables.html
+++ b/doc/sphinx/build/html/users-guide/vcl-variables.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Request and response VCL objects &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Request and response VCL objects &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="VCL - Varnish Configuration Language" href="vcl.html" />
     <link rel="next" title="actions" href="vcl-actions.html" />
     <link rel="prev" title="Built in subroutines" href="vcl-built-in-subs.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="vcl-built-in-subs.html" title="Built in subroutines"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" accesskey="U">VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
@@ -71,7 +71,7 @@ backend. It is based on the <cite>req</cite> object.</dd>
 <dt><em>beresp</em></dt>
 <dd>The backend response object. It contains the headers of the object
 coming from the backend. If you want to modify the response coming from the
-server you modify this object in <cite>vcl_backend_reponse</cite>.</dd>
+server you modify this object in <cite>vcl_backend_response</cite>.</dd>
 <dt><em>resp</em></dt>
 <dd>The HTTP response right before it is delivered to the client. It is
 typically modified in <cite>vcl_deliver</cite>.</dd>
@@ -126,7 +126,7 @@ typically modified in <cite>vcl_deliver</cite>.</dd>
         <li class="right" >
           <a href="vcl-built-in-subs.html" title="Built in subroutines"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li>
           <li><a href="vcl.html" >VCL - Varnish Configuration Language</a> &raquo;</li> 
       </ul>
diff --git a/doc/sphinx/build/html/users-guide/vcl.html b/doc/sphinx/build/html/users-guide/vcl.html
index 00fe71e..8148a76 100644
--- a/doc/sphinx/build/html/users-guide/vcl.html
+++ b/doc/sphinx/build/html/users-guide/vcl.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>VCL - Varnish Configuration Language &mdash; Varnish version 4.0.2 documentation</title>
+    <title>VCL - Varnish Configuration Language &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="The Varnish Users Guide" href="index.html" />
     <link rel="next" title="VCL Syntax" href="vcl-syntax.html" />
     <link rel="prev" title="Sizing your cache" href="sizing-your-cache.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="sizing-your-cache.html" title="Sizing your cache"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">The Varnish Users Guide</a> &raquo;</li> 
       </ul>
     </div>  
@@ -87,7 +87,7 @@ code commented out in the file <cite>builtin.vcl</cite> that ships with Varnish
 <li class="toctree-l1"><a class="reference internal" href="vcl-backends.html#health-checks">Health checks</a></li>
 <li class="toctree-l1"><a class="reference internal" href="vcl-hashing.html">Hashing</a></li>
 <li class="toctree-l1"><a class="reference internal" href="vcl-grace.html">Misbehaving servers</a></li>
-<li class="toctree-l1"><a class="reference internal" href="vcl-inline-c.html">Using In-line C to extend Varnish</a></li>
+<li class="toctree-l1"><a class="reference internal" href="vcl-inline-c.html">Using inline C to extend Varnish</a></li>
 <li class="toctree-l1"><a class="reference internal" href="vcl-examples.html">VCL Examples</a></li>
 <li class="toctree-l1"><a class="reference internal" href="devicedetection.html">Device detection</a></li>
 </ul>
@@ -140,7 +140,7 @@ code commented out in the file <cite>builtin.vcl</cite> that ships with Varnish
         <li class="right" >
           <a href="sizing-your-cache.html" title="Sizing your cache"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >The Varnish Users Guide</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/whats-new/changes.html b/doc/sphinx/build/html/whats-new/changes.html
index 6926212..6356205 100644
--- a/doc/sphinx/build/html/whats-new/changes.html
+++ b/doc/sphinx/build/html/whats-new/changes.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Changes in Varnish 4 &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Changes in Varnish 4 &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="What&#39;s new in Varnish 4.0" href="index.html" />
     <link rel="next" title="Upgrading to Varnish 4" href="upgrading.html" />
     <link rel="prev" title="What&#39;s new in Varnish 4.0" href="index.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="index.html" title="What&#39;s new in Varnish 4.0"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">What's new in Varnish 4.0</a> &raquo;</li> 
       </ul>
     </div>  
@@ -120,7 +120,7 @@ stale content quickly to the client.</p>
         <li class="right" >
           <a href="index.html" title="What&#39;s new in Varnish 4.0"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >What's new in Varnish 4.0</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/build/html/whats-new/index.html b/doc/sphinx/build/html/whats-new/index.html
index 16f3961..ffa426e 100644
--- a/doc/sphinx/build/html/whats-new/index.html
+++ b/doc/sphinx/build/html/whats-new/index.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>What&#39;s new in Varnish 4.0 &mdash; Varnish version 4.0.2 documentation</title>
+    <title>What&#39;s new in Varnish 4.0 &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="next" title="Changes in Varnish 4" href="changes.html" />
     <link rel="prev" title="Varnish VSL Query Expressions" href="../reference/vsl-query.html" /> 
   </head>
@@ -42,7 +42,7 @@
         <li class="right" >
           <a href="../reference/vsl-query.html" title="Varnish VSL Query Expressions"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>  
 
@@ -121,7 +121,7 @@ into consideration when upgrading.</p>
         <li class="right" >
           <a href="../reference/vsl-query.html" title="Varnish VSL Query Expressions"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li> 
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li> 
       </ul>
     </div>
     <div class="footer">
diff --git a/doc/sphinx/build/html/whats-new/upgrading.html b/doc/sphinx/build/html/whats-new/upgrading.html
index 85a7d1f..3469acb 100644
--- a/doc/sphinx/build/html/whats-new/upgrading.html
+++ b/doc/sphinx/build/html/whats-new/upgrading.html
@@ -8,7 +8,7 @@
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     
-    <title>Upgrading to Varnish 4 &mdash; Varnish version 4.0.2 documentation</title>
+    <title>Upgrading to Varnish 4 &mdash; Varnish version 4.0.3 documentation</title>
     
     <link rel="stylesheet" href="../_static/default.css" type="text/css" />
     <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
@@ -16,7 +16,7 @@
     <script type="text/javascript">
       var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
-        VERSION:     '4.0.2',
+        VERSION:     '4.0.3',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  true
@@ -25,7 +25,7 @@
     <script type="text/javascript" src="../_static/jquery.js"></script>
     <script type="text/javascript" src="../_static/underscore.js"></script>
     <script type="text/javascript" src="../_static/doctools.js"></script>
-    <link rel="top" title="Varnish version 4.0.2 documentation" href="../index.html" />
+    <link rel="top" title="Varnish version 4.0.3 documentation" href="../index.html" />
     <link rel="up" title="What&#39;s new in Varnish 4.0" href="index.html" />
     <link rel="next" title="Poul-Hennings random outbursts" href="../phk/index.html" />
     <link rel="prev" title="Changes in Varnish 4" href="changes.html" /> 
@@ -43,7 +43,7 @@
         <li class="right" >
           <a href="changes.html" title="Changes in Varnish 4"
              accesskey="P">previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" accesskey="U">What's new in Varnish 4.0</a> &raquo;</li> 
       </ul>
     </div>  
@@ -178,10 +178,7 @@ The <cite>purge;</cite> keyword has been retired.</p>
 </div>
 <div class="section" id="obj-is-now-read-only">
 <h3>obj is now read-only<a class="headerlink" href="#obj-is-now-read-only" title="Permalink to this headline">¶</a></h3>
-<p><cite>obj</cite> is now read-only. <cite>obj.hits</cite>, if enabled in VCL, now counts per
-objecthead, not per object. <cite>obj.last_use</cite> has been retired.</p>
-<p>Note that obj.hits may not be reset in some cases where bans are in use. See
-bug <a class="reference external" href="https://www.varnish-cache.org/trac/ticket/1492">1492</a> for details.</p>
+<p><cite>obj</cite> is now read-only.  <cite>obj.last_use</cite> has been retired.</p>
 </div>
 <div class="section" id="some-return-values-have-been-replaced">
 <h3>Some return values have been replaced<a class="headerlink" href="#some-return-values-have-been-replaced" title="Permalink to this headline">¶</a></h3>
@@ -213,12 +210,20 @@ to indicate uncacheable content from the backend.</p>
 <h3>The <cite>remove</cite> keyword is gone<a class="headerlink" href="#the-remove-keyword-is-gone" title="Permalink to this headline">¶</a></h3>
 <p>Replaced by <cite>unset</cite>.</p>
 </div>
+<div class="section" id="x-forwarded-for-is-now-set-before-vcl-recv">
+<h3>X-Forwarded-For is now set before vcl_recv<a class="headerlink" href="#x-forwarded-for-is-now-set-before-vcl-recv" title="Permalink to this headline">¶</a></h3>
+<p>In many cases, people unintentionally removed X-Forwarded-For when
+implementing their own vcl_recv. Therefore it has been moved to before
+vcl_recv, so if you don't want an IP added to it, you should remove it
+in vcl_recv.</p>
+</div>
 </div>
 <div class="section" id="changes-to-existing-parameters">
 <h2>Changes to existing parameters<a class="headerlink" href="#changes-to-existing-parameters" title="Permalink to this headline">¶</a></h2>
 <div class="section" id="session-linger">
 <h3>session_linger<a class="headerlink" href="#session-linger" title="Permalink to this headline">¶</a></h3>
-<p><cite>session_linger</cite> has been renamed to <cite>timeout_linger</cite>.</p>
+<p><cite>session_linger</cite> has been renamed to <cite>timeout_linger</cite> and it is in
+seconds now (previously was milliseconds).</p>
 </div>
 <div class="section" id="sess-timeout">
 <h3>sess_timeout<a class="headerlink" href="#sess-timeout" title="Permalink to this headline">¶</a></h3>
@@ -234,6 +239,15 @@ elsewhere in 4.0.</p>
 either <cite>workspace_backend</cite> and <cite>workspace_client</cite> based on where
 your VMOD is doing its work.</p>
 </div>
+<div class="section" id="thread-pool-purge-delay">
+<h3>thread_pool_purge_delay<a class="headerlink" href="#thread-pool-purge-delay" title="Permalink to this headline">¶</a></h3>
+<p><cite>thread_pool_purge_delay</cite> has been renamed to <cite>thread_pool_destroy_delay</cite>
+and it is in seconds now (previously was milliseconds).</p>
+</div>
+<div class="section" id="thread-pool-add-delay-and-thread-pool-fail-delay">
+<h3>thread_pool_add_delay and thread_pool_fail_delay<a class="headerlink" href="#thread-pool-add-delay-and-thread-pool-fail-delay" title="Permalink to this headline">¶</a></h3>
+<p>They are in seconds now (previously were milliseconds).</p>
+</div>
 </div>
 <div class="section" id="new-parameters-since-3-0">
 <h2>New parameters since 3.0<a class="headerlink" href="#new-parameters-since-3-0" title="Permalink to this headline">¶</a></h2>
@@ -285,12 +299,15 @@ query language.</p>
 <li><a class="reference internal" href="#backend-restarts-are-now-retry">Backend restarts are now retry</a></li>
 <li><a class="reference internal" href="#default-builtin-vcl-changes">default/builtin VCL changes</a></li>
 <li><a class="reference internal" href="#the-remove-keyword-is-gone">The <cite>remove</cite> keyword is gone</a></li>
+<li><a class="reference internal" href="#x-forwarded-for-is-now-set-before-vcl-recv">X-Forwarded-For is now set before vcl_recv</a></li>
 </ul>
 </li>
 <li><a class="reference internal" href="#changes-to-existing-parameters">Changes to existing parameters</a><ul>
 <li><a class="reference internal" href="#session-linger">session_linger</a></li>
 <li><a class="reference internal" href="#sess-timeout">sess_timeout</a></li>
 <li><a class="reference internal" href="#sess-workspace">sess_workspace</a></li>
+<li><a class="reference internal" href="#thread-pool-purge-delay">thread_pool_purge_delay</a></li>
+<li><a class="reference internal" href="#thread-pool-add-delay-and-thread-pool-fail-delay">thread_pool_add_delay and thread_pool_fail_delay</a></li>
 </ul>
 </li>
 <li><a class="reference internal" href="#new-parameters-since-3-0">New parameters since 3.0</a><ul>
@@ -345,7 +362,7 @@ query language.</p>
         <li class="right" >
           <a href="changes.html" title="Changes in Varnish 4"
              >previous</a> |</li>
-        <li><a href="../index.html">Varnish version 4.0.2 documentation</a> &raquo;</li>
+        <li><a href="../index.html">Varnish version 4.0.3 documentation</a> &raquo;</li>
           <li><a href="index.html" >What's new in Varnish 4.0</a> &raquo;</li> 
       </ul>
     </div>
diff --git a/doc/sphinx/conf.py b/doc/sphinx/conf.py
index bb1fc79..39e61db 100644
--- a/doc/sphinx/conf.py
+++ b/doc/sphinx/conf.py
@@ -45,9 +45,9 @@ copyright = u'2010-2014, Varnish Software AS'
 # built documents.
 #
 # The short X.Y version.
-version = '4.0.2'
+version = '4.0.3'
 # The full version, including alpha/beta/rc tags.
-release = '4.0.2'
+release = '4.0.3'
 
 # The language for content autogenerated by Sphinx. Refer to documentation
 # for a list of supported languages.
@@ -130,7 +130,7 @@ html_theme_options = {
 
 # The name for this set of Sphinx documents.  If None, it defaults to
 # "<project> v<release> documentation".
-html_title = "Varnish version 4.0.2 documentation"
+html_title = "Varnish version 4.0.3 documentation"
 
 # A shorter title for the navigation bar.  Default is the same as html_title.
 #html_short_title = None
diff --git a/doc/sphinx/include/varnishhist_options.rst b/doc/sphinx/include/varnishhist_options.rst
index f3b4ac3..c007621 100644
--- a/doc/sphinx/include/varnishhist_options.rst
+++ b/doc/sphinx/include/varnishhist_options.rst
@@ -32,7 +32,7 @@
 
 -P <size|responsetime|tag:field_num:min:max>
 
-	Either specify "size" or "responstime" profile or create a new one. Define the tag we'll look for, and the field number of the value we are interested in. min and max are the boundaries of the graph (these are power of tens).
+	Either specify "size" or "responsetime" profile or create a new one. Define the tag we'll look for, and the field number of the value we are interested in. min and max are the boundaries of the graph (these are power of tens).
 
 -q query
 
diff --git a/doc/sphinx/include/varnishlog_options.rst b/doc/sphinx/include/varnishlog_options.rst
index 56ae626..eea5fc7 100644
--- a/doc/sphinx/include/varnishlog_options.rst
+++ b/doc/sphinx/include/varnishlog_options.rst
@@ -40,16 +40,16 @@
 	
 	If a tag include option is the first of any tag selection options, all tags are first marked excluded.
 
--k num
-
-	Process this number of matching log transactions before exiting.
-
 -I <[taglist:]regex>
 
 	Include by regex matching. Output only records matching taglist and regular expression. Applies to any tag if taglist is absent.
 	
 	If a tag include option is the first of any tag selection options, all tags are first marked excluded.
 
+-k num
+
+	Process this number of matching log transactions before exiting.
+
 -L limit
 
 	Sets the upper limit of incomplete transactions kept before the oldest transaction is force completed. A warning record is synthesized when this happens. This setting keeps an upper bound on the memory usage of running queries. Defaults to 1000 transactions.
diff --git a/doc/sphinx/include/varnishlog_synopsis.rst b/doc/sphinx/include/varnishlog_synopsis.rst
index 1e6a841..384331f 100644
--- a/doc/sphinx/include/varnishlog_synopsis.rst
+++ b/doc/sphinx/include/varnishlog_synopsis.rst
@@ -1 +1 @@
-.. |synopsis| replace::  [-a] [-b] [-B] [-c] [-C] [-d] [-D] [-g <session|request|vxid|raw>] [-h] [-i taglist] [-k num] [-I <[taglist:]regex>] [-L limit] [-n name] [-N filename] [-P file] [-q query] [-r filename] [-T seconds] [-v] [-V] [-w filename] [-x taglist] [-X <[taglist:]regex>]
+.. |synopsis| replace::  [-a] [-b] [-B] [-c] [-C] [-d] [-D] [-g <session|request|vxid|raw>] [-h] [-i taglist] [-I <[taglist:]regex>] [-k num] [-L limit] [-n name] [-N filename] [-P file] [-q query] [-r filename] [-T seconds] [-v] [-V] [-w filename] [-x taglist] [-X <[taglist:]regex>]
diff --git a/doc/sphinx/include/vcl_var.rst b/doc/sphinx/include/vcl_var.rst
index 71ab346..ee8c1b8 100644
--- a/doc/sphinx/include/vcl_var.rst
+++ b/doc/sphinx/include/vcl_var.rst
@@ -113,9 +113,10 @@ bereq.uncacheable
 
 	Readable from: backend
 
-	Writable from: backend
-
 	
+	Indicates whether this request is uncacheable due
+	to a pass in the client side or a hit on an existing
+	uncacheable object (aka hit-for-pass).
 	
 
 bereq.url
@@ -263,6 +264,13 @@ beresp.keep
 	Writable from: vcl_backend_response, vcl_backend_error
 
 	
+	Set to a period to enable conditional backend requests.
+	
+	The keep time is cache lifetime in addition to the ttl.
+	
+	Objects with ttl expired but with keep time left may be used
+	to issue conditional (If-Modified-Since / If-None-Match)
+	requests to the backend to refresh them.
 	
 
 beresp.proto
@@ -336,6 +344,13 @@ beresp.uncacheable
 	Writable from: vcl_backend_response, vcl_backend_error
 
 	
+	Inherited from bereq.uncacheable, see there.
+	
+	Setting this variable makes the object uncacheable, which may
+	get stored as a hit-for-pass object in the cache.
+	
+	Clearing the variable has no effect and will log the warning
+	"Ignoring attempt to reset beresp.uncacheable".
 	
 
 client
@@ -388,7 +403,7 @@ obj.grace
 	Readable from: vcl_hit
 
 	
-	The object's grace period in seconds.
+	The object's remaining grace period in seconds.
 	
 
 obj.hits
@@ -398,12 +413,8 @@ obj.hits
 	Readable from: vcl_hit, vcl_deliver
 
 	
-	The count of cache-hits on this hash-key since it was
-	last instantiated.  This counts cache-hits across all
-	Vary:-ants on this hash-key.
-	The counter will only be reset to zero if/when all objects
-	with this hash-key have disappeared from cache.
-	NB: obj.hits == 0 does *not* indicate a cache miss.
+	The count of cache-hits on this object. A value of 0 indicates a
+	cache miss.
 	
 
 obj.http.
@@ -423,6 +434,7 @@ obj.keep
 	Readable from: vcl_hit
 
 	
+	The object's remaining keep period in seconds.
 	
 
 obj.proto
@@ -469,9 +481,10 @@ obj.uncacheable
 
 	Type: BOOL
 
-	Readable from: vcl_hit
+	Readable from: vcl_deliver
 
 	
+	Whether the object is uncacheable (pass or hit-for-pass).
 	
 
 req
diff --git a/doc/sphinx/index.rst b/doc/sphinx/index.rst
index b87a1a6..1adb5fe 100644
--- a/doc/sphinx/index.rst
+++ b/doc/sphinx/index.rst
@@ -32,7 +32,7 @@ Conventions used in this manual include:
   http://www.varnish-cache.org/
     A hyperlink.
 
-Longer listings like example command output and VCL will look like this::
+Longer listings like example command output and VCL look like this::
 
     $ /opt/varnish/sbin/varnishd -V
     varnishd (varnish-4.0.0-tp1 revision ddd00e1)
diff --git a/doc/sphinx/phk/dough.rst b/doc/sphinx/phk/dough.rst
index 3e71fe6..65b53f8 100644
--- a/doc/sphinx/phk/dough.rst
+++ b/doc/sphinx/phk/dough.rst
@@ -42,7 +42,7 @@ But in 2004 crowd-funding was not yet "in", and I had to figure
 out how to do it myself.
 
 My parents brought me up to think that finances is a private matter
-but I concluded that the only way you could ask strangers to trow
+but I concluded that the only way you could ask strangers to throw
 money at you, would be to run an open book, where they could see
 what happened to them, so I did open books.
 
diff --git a/doc/sphinx/phk/persistent.rst b/doc/sphinx/phk/persistent.rst
index 33af07c..6c1d29c 100644
--- a/doc/sphinx/phk/persistent.rst
+++ b/doc/sphinx/phk/persistent.rst
@@ -41,7 +41,7 @@ all the banned objects.
 With persistent storage, we not only have to store the still live
 bans with the cached objects, and keep the two painfully in sync,
 so the bans gets revived with the objects, we also have to worry
-about missing bans duing the downtime, since those might ban objects
+about missing bans during the downtime, since those might ban objects
 we will recover on startup.
 
 Ouch:  Straight into database/filesystem consistency territory.
diff --git a/doc/sphinx/reference/index.rst b/doc/sphinx/reference/index.rst
index 32458a6..b59beb5 100644
--- a/doc/sphinx/reference/index.rst
+++ b/doc/sphinx/reference/index.rst
@@ -15,7 +15,6 @@ The Varnish Reference Manual
 	varnishlog.rst
 	varnishncsa.rst
 	varnishreplay.rst
-	varnishsizes.rst
 	varnishstat.rst
 	varnishtest.rst
 	varnishtop.rst
diff --git a/doc/sphinx/reference/varnish-cli.rst b/doc/sphinx/reference/varnish-cli.rst
index 2e17c2e..7f419ff 100644
--- a/doc/sphinx/reference/varnish-cli.rst
+++ b/doc/sphinx/reference/varnish-cli.rst
@@ -128,11 +128,12 @@ panic.clear
 storage.list
   List storage devices
 
-backend.list
-  List all backends
+backend.list [<backend_expression>]
+  List backends.
 
-backend.set_health matcher state
-  Set health status on a backend
+backend.set_health <backend_expression> <state>
+  Set health status on the backends.
+  State is any of auto, healthy or sick values.
 
 ban <field> <operator> <arg> [&& <field> <oper> <arg>]...
   All objects where the all the conditions match will be marked obsolete.
@@ -140,6 +141,13 @@ ban <field> <operator> <arg> [&& <field> <oper> <arg>]...
 ban.list
   List the active bans.
 
+Backend Expression
+------------------
+
+A backend expression can be a backend name or a combination of backend
+name, IP address and port in "name(IP address:port)" format. All fields
+are optional. If no exact matching backend is found, partial matching
+will be attempted based on the provided name, IP address and port fields.
 
 Ban Expressions
 ---------------
diff --git a/doc/sphinx/reference/varnishlog.rst b/doc/sphinx/reference/varnishlog.rst
index 54247fd..15a1446 100644
--- a/doc/sphinx/reference/varnishlog.rst
+++ b/doc/sphinx/reference/varnishlog.rst
@@ -12,7 +12,7 @@ SYNOPSIS
 ========
 
 .. include:: ../include/varnishlog_synopsis.rst
-varnishlog |synopsis| <query expression>
+varnishlog |synopsis|
 
 OPTIONS
 =======
diff --git a/doc/sphinx/reference/varnishstat.rst b/doc/sphinx/reference/varnishstat.rst
index 8940d80..b8b5ef8 100644
--- a/doc/sphinx/reference/varnishstat.rst
+++ b/doc/sphinx/reference/varnishstat.rst
@@ -65,7 +65,7 @@ CURSES MODE
 ===========
 
 When neither -1, -j or -x options are given, the application starts up
-in curses mode. This shows a continously updated view of the counter
+in curses mode. This shows a continuously updated view of the counter
 values, along with their description.
 
 The top area shows process uptime information.
@@ -119,17 +119,17 @@ The following keys control the interactive display:
 <PAGEDOWN> or <SPACE>
 	Navigate the counter list one page down.
 
+<d>
+	Toggle between showing and hiding unseen counters. Unseen
+	counters are those that has been zero for the entire runtime
+	of varnishstat. Defaults to hide unseen counters.
+
 <g>
 	Go to the top of the counter list.
 
 <G>
 	Go to the bottom of the counter list.
 
-<d>
-	Toggle between showing and hiding unseen counters. Unseen
-	counters are those that has been zero for the entire runtime
-	of varnishstat. Defaults to hide unseen counters.
-
 <v>
 	Cycle through the verbosity levels. Defaults to only showing
 	informational counters.
@@ -145,11 +145,17 @@ XML Output
 
 When using the -x option, the output is::
 
-  <stat>
-    <name>FIELD NAME</name>
-    <value>FIELD VALUE</value>
-    <description>FIELD DESCRIPTION</description>
-  </stat>
+  <varnishstat timestamp="YYYY-MM-DDTHH:mm:SS">
+    <stat>
+      <type>FIELD TYPE</type>
+      <ident>FIELD IDENT</ident>
+      <name>FIELD NAME</name>
+      <value>FIELD VALUE</value>
+      <flag>FIELD FORMAT</flag>
+      <description>FIELD DESCRIPTION</description>
+    </stat>
+    [..]
+  </varnishstat>
 
 JSON OUTPUT
 ===========
@@ -158,24 +164,15 @@ With -j the output format is::
 
   {
     "timestamp": "YYYY-MM-DDTHH:mm:SS",
-    "client_conn": {
-	"value": 0, "flag": "a",
-	"description": "Client connections accepted"
-    },
-    "client_drop": {
-	"value": 0, "flag": "a",
-	"description": "Connection dropped, no sess/wrk"
-    },
-    "LCK.backend.creat": {
-	"type": "LCK", "ident": "backend", "value": 1,
-	"flag": "a", "description": "Created locks"
-    },
+    "FIELD NAME": {"type": "FIELD TYPE", "ident": "FIELD IDENT", "value": FIELD VALUE, "flag": "FIELD FORMAT", "description": "FIELD DESCRIPTION"},
     [..]
   }
 
-Timestamp is the time when the report was generated by varnishstat.
+Type and ident are optional.  Timestamp is the time when the report was
+generated by varnishstat.
 
-Repeated output with -1, -x or -j will have a single empty line (\\n) between each block of output.
+Repeated output with -1, -x or -j will have a single empty line (\\n)
+between each block of output.
 
 
 SEE ALSO
diff --git a/doc/sphinx/reference/vcl.rst b/doc/sphinx/reference/vcl.rst
index 90ac019..a621e4f 100644
--- a/doc/sphinx/reference/vcl.rst
+++ b/doc/sphinx/reference/vcl.rst
@@ -166,6 +166,21 @@ Example::
         std.log("foo");
     }
 
+Comments
+--------
+
+Single lines of VCL can be commented out using // or #. Multi-line blocks can
+be commented out with \/\* block \/\*.
+
+Example::
+
+    sub vcl_recv {
+        // Single line of out-commented VCL.
+        # Another way of commenting out a single line.
+        /*
+            Multi-line block of commented-out VCL.
+        */
+    }
 
 
 Backend definition
diff --git a/doc/sphinx/reference/vmod.rst b/doc/sphinx/reference/vmod.rst
index 5ad685f..c4d741b 100644
--- a/doc/sphinx/reference/vmod.rst
+++ b/doc/sphinx/reference/vmod.rst
@@ -273,7 +273,7 @@ malloc would look like this::
 	if (priv->priv == NULL) {
 		priv->priv = calloc(sizeof(struct myfoo), 1);
 		AN(priv->priv);
-		priv->priv = free;	/* free(3) */
+		priv->free = free;	/* free(3) */
 		mystate = priv->priv;
 		mystate->foo = 21;
 		...
diff --git a/doc/sphinx/reference/vmod_directors.generated.rst b/doc/sphinx/reference/vmod_directors.generated.rst
index 410cdbc..8b7e6c8 100644
--- a/doc/sphinx/reference/vmod_directors.generated.rst
+++ b/doc/sphinx/reference/vmod_directors.generated.rst
@@ -63,10 +63,6 @@ CONTENTS
 * :ref:`obj_random`
 * :ref:`func_random.add_backend`
 * :ref:`func_random.backend`
-* :ref:`obj_rev_dns`
-* :ref:`func_rev_dns.backend`
-* :ref:`func_rev_dns.set_backend`
-* :ref:`func_rev_dns.set_max_dns_ttl`
 * :ref:`obj_round_robin`
 * :ref:`func_round_robin.add_backend`
 * :ref:`func_round_robin.backend`
@@ -260,66 +256,3 @@ Description
 Example
 	set req.backend_hint = vdir.backend(req.http.cookie);  # pick a backend based on the cookie header from the client
 
-
-.. _obj_rev_dns:
-
-Object rev_dns
-==============
-
-
-Description
-	Create a Rev DNS backend director.
-
-	The Rev DNS director resolves the address of its only backend dynamically.
-	If multiple addresses are returned, it will act as a round_robin director
-	between all of them (if they are healthy).
-	The TTL of the DNS result is respected.
-
-Example
-	new vdir = directors.rev_dns();
-
-.. _func_rev_dns.set_max_dns_ttl:
-
-VOID rev_dns.set_max_dns_ttl(DURATION)
---------------------------------------
-
-Prototype
-	VOID rev_dns.set_max_dns_ttl(DURATION)
-
-Description
-	Set the maximum TTL of the DNS query result.
-
-	By default, the maximum TTL is one hour.
-
-Example
-	vdir.set_max_dns_ttl(10s);
-
-.. _func_rev_dns.set_backend:
-
-BOOL rev_dns.set_backend(BACKEND)
----------------------------------
-
-Prototype
-	BOOL rev_dns.set_backend(BACKEND)
-
-Description
-	Set the backend whose address is resolved by the director.
-
-	The backend must have the 'preresolve_dns' parameter set to 1.
-
-Example
-	vdir.set_backend(backend);
-
-
-.. _func_rev_dns.backend:
-
-BACKEND rev_dns.backend()
--------------------------
-
-Prototype
-	BACKEND rev_dns.backend()
-
-Description
-	Pick a backend from the director.
-Example
-	set req.backend_hint = vdir.backend();
diff --git a/doc/sphinx/reference/vmod_std.generated.rst b/doc/sphinx/reference/vmod_std.generated.rst
index 9ade690..6df1069 100644
--- a/doc/sphinx/reference/vmod_std.generated.rst
+++ b/doc/sphinx/reference/vmod_std.generated.rst
@@ -37,6 +37,7 @@ they return the second argument, which must have the given TYPE.
 CONTENTS
 ========
 
+* :ref:`func_cache_req_body`
 * :ref:`func_collect`
 * :ref:`func_duration`
 * :ref:`func_fileread`
@@ -53,6 +54,7 @@ CONTENTS
 * :ref:`func_set_ip_tos`
 * :ref:`func_strstr`
 * :ref:`func_syslog`
+* :ref:`func_time`
 * :ref:`func_time2integer`
 * :ref:`func_time2real`
 * :ref:`func_timestamp`
@@ -65,10 +67,10 @@ STRING toupper(STRING_LIST)
 ---------------------------
 
 Prototype
-	STRING toupper(STRING_LIST)
+	STRING toupper(STRING_LIST s)
 
 Description
-	Converts the string *s* to upper case.
+	Converts the string *s* to uppercase.
 Example
 	set beresp.http.x-scream = std.toupper("yes!");
 
@@ -78,10 +80,10 @@ STRING tolower(STRING_LIST)
 ---------------------------
 
 Prototype
-	STRING tolower(STRING_LIST)
+	STRING tolower(STRING_LIST s)
 
 Description
-	Converts the string *s* to lower case.
+	Converts the string *s* to lowercase.
 Example
 	set beresp.http.x-nice = std.tolower("VerY");
 
@@ -91,11 +93,11 @@ VOID set_ip_tos(INT)
 --------------------
 
 Prototype
-	VOID set_ip_tos(INT)
+	VOID set_ip_tos(INT tos)
 
 Description
-	Sets the Type-of-Service flag for the current session. Please
-	note that the TOS flag is not removed by the end of the
+	Sets the IP type-of-service (TOS) field for the current session to *tos*.
+	Please note that the TOS field is not removed by the end of the
 	request so probably want to set it on every request should you
 	utilize it.
 Example
@@ -109,10 +111,10 @@ REAL random(REAL, REAL)
 -----------------------
 
 Prototype
-	REAL random(REAL, REAL)
+	REAL random(REAL lo, REAL hi)
 
 Description
-	Returns a random REAL number between *a* and *b*.
+	Returns a random real number between *lo* and *hi*.
 Example
 	set beresp.http.x-random-number = std.random(1, 100);
 
@@ -122,10 +124,10 @@ VOID log(STRING_LIST)
 ---------------------
 
 Prototype
-	VOID log(STRING_LIST)
+	VOID log(STRING_LIST s)
 
 Description
-	Logs *string* to the shared memory log, using VSL tag *SLT_VCL_Log*.
+	Logs the string *s* to the shared memory log, using VSL tag *SLT_VCL_Log*.
 Example
 	std.log("Something fishy is going on with the vhost " + req.host);
 
@@ -135,10 +137,10 @@ VOID syslog(INT, STRING_LIST)
 -----------------------------
 
 Prototype
-	VOID syslog(INT, STRING_LIST)
+	VOID syslog(INT priority, STRING_LIST s)
 
 Description
-	Logs *string* to syslog marked with *priority*.  See your
+	Logs the string *s* to syslog marked with *priority*.  See your
 	system's syslog.h file for the legal values of *priority*.
 Example
 	std.syslog(8 + 1, "Something is wrong");
@@ -165,12 +167,13 @@ VOID collect(HEADER)
 --------------------
 
 Prototype
-	VOID collect(HEADER)
+	VOID collect(HEADER hdr)
 
 Description
-	Collapses the header, joining the headers into one.
+	Collapses the header *hdr*, joining them into one.
 Example
 	std.collect(req.http.cookie);
+
 	This will collapse several Cookie: headers into one, long
 	cookie header.
 
@@ -180,12 +183,12 @@ DURATION duration(STRING, DURATION)
 -----------------------------------
 
 Prototype
-	DURATION duration(STRING, DURATION)
+	DURATION duration(STRING s, DURATION fallback)
 
 Description
 	Converts the string *s* to seconds. *s* must be quantified
 	with ms (milliseconds), s (seconds), m (minutes), h (hours),
-	d (days), w (weeks) or y (years) units. If *s* fails to parse,
+	d (days), w (weeks) or y (years) units. If conversion fails,
 	*fallback* will be returned.
 Example
 	set beresp.ttl = std.duration("1w", 3600s);
@@ -196,13 +199,15 @@ INT integer(STRING, INT)
 ------------------------
 
 Prototype
-	INT integer(STRING, INT)
+	INT integer(STRING s, INT fallback)
 
 Description
-	Converts the string *s* to an integer.  If *s* fails to parse,
+	Converts the string *s* to an integer.	If conversion fails,
 	*fallback* will be returned.
 Example
-	if (std.integer(beresp.http.x-foo, 0) > 5) { ... }
+	| if (std.integer(beresp.http.x-foo, 0) > 5) {
+	| 	...
+	| }
 
 .. _func_ip:
 
@@ -210,14 +215,16 @@ IP ip(STRING, IP)
 -----------------
 
 Prototype
-	IP ip(STRING, IP)
+	IP ip(STRING s, IP fallback)
 
 Description
-	Converts string *s* to the first IP number returned by
+	Converts the string *s* to the first IP number returned by
 	the system library function getaddrinfo(3).  If conversion
 	fails, *fallback* will be returned.
 Example
-	if (std.ip(req.http.X-forwarded-for, "0.0.0.0") ~ my_acl) { ... }
+	| if (std.ip(req.http.X-forwarded-for, "0.0.0.0") ~ my_acl) {
+	| 	...
+	| }
 
 .. _func_real:
 
@@ -225,10 +232,10 @@ REAL real(STRING, REAL)
 -----------------------
 
 Prototype
-	REAL real(STRING, REAL)
+	REAL real(STRING s, REAL fallback)
 
 Description
-	Converts the string *s* to a real.  If *s* fails to parse,
+	Converts the string *s* to a real.  If conversion fails,
 	*fallback* will be returned.
 Example
 	set req.http.x-real = std.real(req.http.x-foo, 0.0);
@@ -239,7 +246,7 @@ TIME real2time(REAL)
 --------------------
 
 Prototype
-	TIME real2time(REAL)
+	TIME real2time(REAL r)
 
 Description
 	Converts the real *r* to a time.
@@ -252,7 +259,7 @@ INT time2integer(TIME)
 ----------------------
 
 Prototype
-	INT time2integer(TIME)
+	INT time2integer(TIME t)
 
 Description
 	Converts the time *t* to a integer.
@@ -265,7 +272,7 @@ REAL time2real(TIME)
 --------------------
 
 Prototype
-	REAL time2real(TIME)
+	REAL time2real(TIME t)
 
 Description
 	Converts the time *t* to a real.
@@ -278,10 +285,10 @@ BOOL healthy(BACKEND)
 ---------------------
 
 Prototype
-	BOOL healthy(BACKEND)
+	BOOL healthy(BACKEND be)
 
 Description
-	Returns true if the backend is healthy.
+	Returns `true` if the backend *be* is healthy.
 
 .. _func_port:
 
@@ -289,10 +296,10 @@ INT port(IP)
 ------------
 
 Prototype
-	INT port(IP)
+	INT port(IP ip)
 
 Description
-	Returns the port number of an IP address.
+	Returns the port number of the IP address *ip*.
 
 .. _func_rollback:
 
@@ -300,10 +307,10 @@ VOID rollback(HTTP)
 -------------------
 
 Prototype
-	VOID rollback(HTTP)
+	VOID rollback(HTTP h)
 
 Description
-	Restore *h* HTTP headers to their original state.
+	Restores the *h* HTTP headers to their original state.
 Example
 	std.rollback(bereq);
 
@@ -313,13 +320,13 @@ VOID timestamp(STRING)
 ----------------------
 
 Prototype
-	VOID timestamp(STRING)
+	VOID timestamp(STRING s)
 
 Description
-	Introduces a timestamp in the log with the current time. Uses
-	the argument as the timespamp label. This is useful to time
-	the execution of lengthy VCL procedures, and makes the
-	timestamps inserted automatically by Varnish more accurate.
+	Introduces a timestamp in the log with the current time, using
+	the string *s* as the label. This is useful to time the execution
+	of lengthy VCL procedures, and makes the timestamps inserted
+	automatically by Varnish more accurate.
 Example
 	std.timestamp("curl-request");
 
@@ -332,10 +339,27 @@ Prototype
 	STRING querysort(STRING)
 
 Description
-        Sorts the querystring for cache normalization purposes.
+	Sorts the query string for cache normalization purposes.
 Example
         set req.url = std.querysort(req.url);
 
+.. _func_cache_req_body:
+
+VOID cache_req_body(BYTES)
+--------------------------
+
+Prototype
+	VOID cache_req_body(BYTES size)
+
+Description
+	Cache the req.body if it is smaller than *size*.
+
+	Caching the req.body makes it possible to retry pass
+	operations (POST, PUT).
+Example
+	std.cache_req_body(1KB);
+
+	This will cache the req.body if its size is smaller than 1KB.
 
 .. _func_strstr:
 
@@ -343,20 +367,42 @@ STRING strstr(STRING, STRING)
 -----------------------------
 
 Prototype
-	STRING strstr(STRING, STRING)
+	STRING strstr(STRING s1, STRING s2)
 
 Description
-	Returns the substring if the second string is a substring of the first
-	string. Note that the comparison is case sensitive. You can
-	use the tolower function on both strings if you want case
-	insensitivity.
-
-        If there is no match a NULL pointer is returned which would
-        evaluate to false in an if-test.
+	Returns the first occurrence of the string *s2* in the string
+	*s1*, or an empty string if not found.
 
+	Note that the comparison is case sensitive.
 Example
-	if (std.strstr(req.url, req.http.x-restrict))
+	| if (std.strstr(req.url, req.http.x-restrict)) {
+	| 	...
+	| }
+
+.. _func_time:
+
+TIME time(STRING, TIME)
+-----------------------
+
+Prototype
+	TIME time(STRING s, TIME fallback)
 
+Description
+	Converts the string *s* to a time.  If conversion fails,
+	*fallback* will be returned.
+
+	Supported formats:
+
+	| "Sun, 06 Nov 1994 08:49:37 GMT"
+	| "Sunday, 06-Nov-94 08:49:37 GMT"
+	| "Sun Nov  6 08:49:37 1994"
+	| "1994-11-06T08:49:37"
+	| "784111777.00"
+	| "784111777"
+Example
+	| if (std.time(resp.http.last-modified, now) < now - 1w) {
+	| 	...
+	| }
 
 
 SEE ALSO
diff --git a/doc/sphinx/tutorial/introduction.rst b/doc/sphinx/tutorial/introduction.rst
index 330764f..cff7268 100644
--- a/doc/sphinx/tutorial/introduction.rst
+++ b/doc/sphinx/tutorial/introduction.rst
@@ -30,7 +30,7 @@ Performance
 Varnish has a modern architecture and is written with performance
 in mind.  It is usually bound by the speed of the network, effectively
 turning performance into a non-issue. You get to focus on how your web
-application work and you can allow yourself, to some degree, to care
+applications work and you can allow yourself, to some degree, to care
 less about performance and scalability.
 
 .. XXX:Not totally sure what the last sentence above means. benc
@@ -58,7 +58,7 @@ About the Varnish development process
 -------------------------------------
 
 Varnish is a community driven project. The development is overseen by
-the Varnish Governing Board which currently consist of Poul-Henning Kamp
+the Varnish Governing Board which currently consists of Poul-Henning Kamp
 (Architect), Rogier Mulhuijzen (Fastly) and Lasse Karstensen (Varnish
 Software).
 
@@ -69,13 +69,13 @@ Getting in touch
 ----------------
 
 You can get in touch with us through many channels. For real time chat
-you can reach us on IRC trough the server irc.linpro.net on the #varnish
+you can reach us on IRC through the server irc.linpro.net on the #varnish
 and #varnish-hacking channels.
-There are two mailing lists available. One for user questions and one
+There are two mailing lists available: one for user questions and one
 for development discussions. See https://www.varnish-cache.org/lists
 for information and signup.  There is also a web forum on the same site.
 
-Now that you have a vague idea on what Varnish Cache is, let see if we
+Now that you have a vague idea on what Varnish Cache is, let's see if we
 can get it up and running.
 
 .. XXX:The above three paragraphs are repetitive this is already handled in previous chapters. The only new information is Governing Board which could be moved to the introduction and the paragraphs scrapped. benc
diff --git a/doc/sphinx/users-guide/increasing-your-hitrate.rst b/doc/sphinx/users-guide/increasing-your-hitrate.rst
index 231e27b..be76f2b 100644
--- a/doc/sphinx/users-guide/increasing-your-hitrate.rst
+++ b/doc/sphinx/users-guide/increasing-your-hitrate.rst
@@ -24,10 +24,9 @@ Tool: varnishtop
 ~~~~~~~~~~~~~~~~
 
 You can use varnishtop to identify what URLs are hitting the backend
-the most. ``varnishtop -i txurl`` is an essential command, showing
-you the top `txurl` requests Varnish is sending to the backend. You
-can see some other examples of `varnishtop` usage in
-:ref:`users-guide-statistics`.
+the most. ``varnishtop -i BereqURL`` is an essential command, showing
+you the top requests Varnish is sending to the backend. You can see some
+other examples of `varnishtop` usage in :ref:`users-guide-statistics`.
 
 
 Tool: varnishlog
@@ -35,8 +34,8 @@ Tool: varnishlog
 
 When you have identified an URL which is frequently sent to the
 backend you can use `varnishlog` to have a look at the request.
-``varnishlog -c -m 'RxURL:^/foo/bar`` will show you the requests
-coming from the client ('-c') matching `/foo/bar`.
+``varnishlog -q 'ReqURL ~ "^/foo/bar"'`` will show you the requests
+coming from the client matching `/foo/bar`.
 
 For more information on how `varnishlog` works please see
 :ref:`users-guide-logging` or man :ref:`ref-varnishlog`.
@@ -241,7 +240,8 @@ Age
 ~~~
 
 Varnish adds an 'Age' header to indicate how long the object has been
-kept inside Varnish. You can grep out 'Age' from `varnishlog` with ``varnishlog -i TxHeader -I ^Age``.
+kept inside Varnish. You can grep out 'Age' from `varnishlog` with
+``varnishlog -I RespHeader:^Age``.
 
 Pragma
 ~~~~~~
@@ -343,8 +343,8 @@ To achieve a high hitrate whilst using Vary is there therefore
 crucial to normalize the headers the backends varies on. Remember,
 just a difference in casing can force different cache entries.
 
-The following VCL code will normalize the 'Accept-Language' headers,
-to one of either "en", "de" or "fr"::
+The following VCL code will normalize the 'Accept-Language' header to
+either "en", "de" or "fr", in this order of precedence::
 
     if (req.http.Accept-Language) {
         if (req.http.Accept-Language ~ "en") {
@@ -360,9 +360,6 @@ to one of either "en", "de" or "fr"::
         }
     }
 
-The code sets the 'Accept-Encoding' header from the client to either
-gzip, deflate with a preference for gzip.
-
 Vary parse errors
 ~~~~~~~~~~~~~~~~~
 
diff --git a/doc/sphinx/users-guide/operation-logging.rst b/doc/sphinx/users-guide/operation-logging.rst
index 4dfa40f..d3e715c 100644
--- a/doc/sphinx/users-guide/operation-logging.rst
+++ b/doc/sphinx/users-guide/operation-logging.rst
@@ -20,13 +20,13 @@ is logging. `varnishlog` gives you the raw logs, everything that is
 written to the logs. There are other clients that can access the logs as well, we'll show you
 these later.
 
-In the terminal window you started Varnish now type ``varnishlog`` and
-press enter.
+In the terminal window you started Varnish now type ``varnishlog -g raw``
+and press enter.
 
 You'll see lines like these scrolling slowly by.::
 
-    0 CLI          - Rd ping
-    0 CLI          - Wr 200 PONG 1273698726 1.0
+    0 CLI            - Rd ping
+    0 CLI            - Wr 200 19 PONG 1273698726 1.0
 
 These is the Varnish master process checking up on the caching process
 to see that everything is OK.
@@ -37,25 +37,24 @@ app.
 
 You'll see lines like these.::
 
-   11 SessionOpen  c 127.0.0.1 58912 0.0.0.0:8080
-   11 ReqStart     c 127.0.0.1 58912 595005213
-   11 RxRequest    c GET
-   11 RxURL        c /
-   11 RxProtocol   c HTTP/1.1
-   11 RxHeader     c Host: localhost:8080
-   11 RxHeader     c Connection: keep-alive
+   11 SessOpen       c 127.0.0.1 58912 :8080 0.0.0.0 8080 1273698726.933590 14
+   11 ReqStart       c 127.0.0.1 58912
+   11 ReqMethod      c GET
+   11 ReqURL         c /
+   11 ReqProtocol    c HTTP/1.1
+   11 ReqHeader      c Host: localhost:8080
+   11 ReqHeader      c Connection: keep-alive
 
 
 The first column is an arbitrary number, it identifies the
-session. Lines with the same number are coming from the same session
-and are being handled by the same thread. The second column is the
-*tag* of the log message. All log entries are tagged with a tag
-indicating what sort of activity is being logged. Tags starting with
-'Rx' indicate Varnish is receiving data and 'Tx' indicates sending data.
+transaction. Lines with the same number are coming from the same
+transaction. The second column is the *tag* of the log message. All
+log entries are tagged with a tag indicating what sort of activity is
+being logged.
 
-The third column tell us whether this is is data coming or going to
-the client ('c') or to/from the backend ('b'). The forth column is the
-data being logged.
+The third column tell us whether this is is data coming from or going
+to the client ('c'), or the backend ('b'). The forth column is the data
+being logged.
 
 Now, you can filter quite a bit with `varnishlog`. The basic options we think you
 want to know are:
@@ -67,9 +66,11 @@ want to know are:
 '-c'
  Same as '-b' but for client side traffic.
 
-'-m tag:regex'
- Only list transactions where the tag matches a regular expression. If
- it matches you will get the whole transaction.
+'-g request'
+ Group transactions by request.
+
+'-q query'
+ Only list transactions matching this query.
 
 .. XXX:Maybe a couple of sample commands here? benc
 
diff --git a/doc/sphinx/users-guide/operation-statistics.rst b/doc/sphinx/users-guide/operation-statistics.rst
index 788e600..de25bd8 100644
--- a/doc/sphinx/users-guide/operation-statistics.rst
+++ b/doc/sphinx/users-guide/operation-statistics.rst
@@ -18,11 +18,10 @@ With suitable filtering using the -I, -i, -X and -x options, it can be
 used to display a ranking of requested documents, clients, user
 agents, or any other information which is recorded in the log.
 
-``varnishtop -i rxurl`` will show you what URLs are being asked for
-by the client. ``varnishtop -i txurl`` will show you what your backend
-is being asked the most. ``varnishtop -i RxHeader -I
-Accept-Encoding`` will show the most popular Accept-Encoding header
-the client are sending you.
+``varnishtop -i ReqURL`` will show you what URLs are being asked for by
+the client. ``varnishtop -i BereqURL`` will show you what your backend
+is being asked the most. ``varnishtop -I ReqHeader:Accept-Encoding`` will
+show the most popular Accept-Encoding header the client are sending you.
 
 For more information please see :ref:`ref-varnishtop`.
 
diff --git a/doc/sphinx/users-guide/purging.rst b/doc/sphinx/users-guide/purging.rst
index 70fb415..43df304 100644
--- a/doc/sphinx/users-guide/purging.rst
+++ b/doc/sphinx/users-guide/purging.rst
@@ -73,7 +73,7 @@ Support for bans is built into Varnish and available in the CLI
 interface. To ban every png object belonging on example.com, issue
 the following command::
 
-  ban req.http.host == "example.com" && req.url ~ "\.png$"
+  ban req.http.host == "example.com" && req.url ~ "\\.png$"
 
 Quite powerful, really.
 
diff --git a/doc/sphinx/users-guide/troubleshooting.rst b/doc/sphinx/users-guide/troubleshooting.rst
index d05b9d6..4be7543 100644
--- a/doc/sphinx/users-guide/troubleshooting.rst
+++ b/doc/sphinx/users-guide/troubleshooting.rst
@@ -106,16 +106,17 @@ give you a clue. Since `varnishlog` logs a lot of data it might be hard
 to track the entries down. You can set `varnishlog` to log all your 503
 errors by issuing the following command::
 
-   $ varnishlog -c -m TxStatus:503
+   $ varnishlog -q 'RespStatus == 503' -g request
 
 If the error happened just a short time ago the transaction might still
 be in the shared memory log segment. To get `varnishlog` to process the
 whole shared memory log just add the '-d' parameter::
 
-   $ varnishlog -d -c -m TxStatus:503
+   $ varnishlog -d -q 'RespStatus == 503' -g request
 
-Please see the `varnishlog` man page for elaborations on further
-filtering capabilities and explanation of the various options.
+Please see the `vsl-query` and `varnishlog` man pages for elaborations
+on further filtering capabilities and explanation of the various
+options.
 
 
 Varnish doesn't cache
diff --git a/doc/sphinx/users-guide/vcl-built-in-subs.rst b/doc/sphinx/users-guide/vcl-built-in-subs.rst
index 9c9c690..7b38812 100644
--- a/doc/sphinx/users-guide/vcl-built-in-subs.rst
+++ b/doc/sphinx/users-guide/vcl-built-in-subs.rst
@@ -1,45 +1,52 @@
-
 .. _vcl-built-in-subs:
 
-.. XXX:This document needs substantional review.
+====================
+Built in subroutines
+====================
 
+Various built-in subroutines are called during processing of client-
+and backend requests as well as upon ``vcl.load`` and ``vcl.discard``.
 
-Built in subroutines
---------------------
+-----------
+client side
+-----------
 
+.. _vcl_recv:
 
 vcl_recv
 ~~~~~~~~
 
 Called at the beginning of a request, after the complete request has
-been received and parsed. Its purpose is to decide whether or not to
-serve the request, how to do it, and, if applicable, which backend to
-use.
+been received and parsed, after a `restart` or as the result of an ESI
+include.
 
-It is also used to modify the request, something you'll probably find
-yourself doing frequently. 
+Its purpose is to decide whether or not to serve the request, possibly
+modify it and decide on how to process it further. A backend hint may
+be set as a default for the backend processing side.
 
 The `vcl_recv` subroutine may terminate with calling ``return()`` on one
 of the following keywords:
 
-  synth(status code, reason)
-    Return a synthetic object with the specified status code to the
-    client and abandon the request.
+  ``hash``
+    Continue processing the object as a potential candidate for
+    caching. Passes the control over to :ref:`vcl_hash`.
 
-  pass
-    Switch to pass mode. Control will eventually pass to vcl_pass.
+  ``pass``
+    Switch to pass mode. Control will eventually pass to :ref:`vcl_pass`.
 
-  pipe
-    Switch to pipe mode. Control will eventually pass to vcl_pipe.
+  ``pipe``
+    Switch to pipe mode. Control will eventually pass to :ref:`vcl_pipe`.
 
-  hash
-    Continue processing the object as a potential candidate for
-    caching. Passes the control over to vcl_hash.
+  ``synth(status code, reason)``
+    Transition to :ref:`vcl_synth` with ``resp.status`` and
+    ``resp.reason`` being preset to the arguments of ``synth()``.
 
-  purge
-    Purge the object and it's variants. Control passes through 
+  ``purge``
+    Purge the object and it's variants. Control passes through
     vcl_hash to vcl_purge.
 
+.. _vcl_pipe:
+
 vcl_pipe
 ~~~~~~~~
 
@@ -53,12 +60,15 @@ other VCL subroutine will ever get called after `vcl_pipe`.
 The `vcl_pipe` subroutine may terminate with calling ``return()`` with one
 of the following keywords:
 
-  synth(status code, reason)
-    Return the specified status code to the client and abandon the request.
-
-  pipe
+  ``pipe``
     Proceed with pipe mode.
 
+  ``synth(status code, reason)``
+    Transition to :ref:`vcl_synth` with ``resp.status`` and
+    ``resp.reason`` being preset to the arguments of ``synth()``.
+
+.. _vcl_pass:
+
 vcl_pass
 ~~~~~~~~
 
@@ -70,63 +80,86 @@ submitted over the same client connection are handled normally.
 The `vcl_pass` subroutine may terminate with calling ``return()`` with one
 of the following keywords:
 
-  synth(status code, reason)
-    Return the specified status code to the client and abandon the request.
+  ``fetch``
+    Proceed with pass mode - initiate a backend request.
 
-  pass
-    Proceed with pass mode.
-
-  restart
+  ``restart``
     Restart the transaction. Increases the restart counter. If the number
     of restarts is higher than *max_restarts* Varnish emits a guru meditation
     error.
 
+  ``synth(status code, reason)``
+    Transition to :ref:`vcl_synth` with ``resp.status`` and
+    ``resp.reason`` being preset to the arguments of ``synth()``.
+
+.. _vcl_hit:
 
 vcl_hit
 ~~~~~~~
 
-Called when a cache lookup is successful. 
+Called when a cache lookup is successful. The object being hit may be
+stale: It can have a zero or negative `ttl` with only `grace` or
+`keep` time left.
 
-The `vcl_hit` subroutine may terminate with calling ``return()`` with one of the following keywords:
+The `vcl_hit` subroutine may terminate with calling ``return()``
+with one of the following keywords:
+
+  ``deliver``
+    Deliver the object. If it is stale, a background fetch to refresh
+    it is triggered.
+
+  ``fetch``
+    Synchronously refresh the object from the backend despite the
+    cache hit. Control will eventually pass to :ref:`vcl_miss`.
 
+  ``pass``
+    Switch to pass mode. Control will eventually pass to :ref:`vcl_pass`.
 
-  restart
+  ``restart``
     Restart the transaction. Increases the restart counter. If the number
     of restarts is higher than *max_restarts* Varnish emits a guru meditation
     error.
 
-  deliver
-    Deliver the object. Control passes to `vcl_deliver`.
+  ``synth(status code, reason)``
+    Transition to :ref:`vcl_synth` with ``resp.status`` and
+    ``resp.reason`` being preset to the arguments of ``synth()``.
 
-  synth(status code, reason)
-    Return the specified status code to the client and abandon the request.
+.. XXX: #1603 hit should not go to miss
 
+.. _vcl_miss:
 
 vcl_miss
 ~~~~~~~~
 
 Called after a cache lookup if the requested document was not found in
-the cache. Its purpose is to decide whether or not to attempt to
-retrieve the document from the backend, and which backend to use.
+the cache or if :ref:`vcl_hit` returned ``fetch``.
+
+Its purpose is to decide whether or not to attempt to retrieve the
+document from the backend. A backend hint may be set as a default for
+the backend processing side.
 
 The `vcl_miss` subroutine may terminate with calling ``return()`` with one
 of the following keywords:
 
-  synth(status code, reason)
-    Return the specified status code to the client and abandon the request.
-
-  pass
-    Switch to pass mode. Control will eventually pass to `vcl_pass`.
-
-  fetch
+  ``fetch``
     Retrieve the requested object from the backend. Control will
     eventually pass to `vcl_backend_fetch`.
 
-  restart
+  ``pass``
+    Switch to pass mode. Control will eventually pass to :ref:`vcl_pass`.
+
+  ``restart``
     Restart the transaction. Increases the restart counter. If the number
     of restarts is higher than *max_restarts* Varnish emits a guru meditation
     error.
 
+  ``synth(status code, reason)``
+    Transition to :ref:`vcl_synth` with ``resp.status`` and
+    ``resp.reason`` being preset to the arguments of ``synth()``.
+
+.. XXX: #1603 hit should not go to miss
+
+.. _vcl_hash:
 
 vcl_hash
 ~~~~~~~~
@@ -134,13 +167,18 @@ vcl_hash
 Called after `vcl_recv` to create a hash value for the request. This is
 used as a key to look up the object in Varnish.
 
-The `vcl_hash` subroutine may terminate with calling ``return()`` with one
-of the following keywords:
+The `vcl_hash` subroutine may only terminate with calling ``return(lookup)``:
 
-  lookup
-    Look up the object in cache. Control passes to vcl_miss, vcl_hit
-    or vcl_purge.
+  ``lookup``
+    Look up the object in cache.
+    Control passes to :ref:`vcl_purge` when coming from a ``purge``
+    return in `vcl_recv`.
+    Otherwise control passes to :ref:`vcl_hit`, :ref:`vcl_miss` or
+    :ref:`vcl_pass` if the cache lookup result was a hit, a miss or hit
+    on a hit-for-pass object (object with ``obj.uncacheable ==
+    true``), respectively.
 
+.. _vcl_purge:
 
 vcl_purge
 ~~~~~~~~~
@@ -150,31 +188,66 @@ Called after the purge has been executed and all its variants have been evited.
 The `vcl_purge` subroutine may terminate with calling ``return()`` with one
 of the following keywords:
 
-  synth
-    Produce a response.
-
-  restart
+  ``restart``
     Restart the transaction. Increases the restart counter. If the number
     of restarts is higher than *max_restarts* Varnish emits a guru meditation
     error.
 
+  ``synth(status code, reason)``
+    Transition to :ref:`vcl_synth` with ``resp.status`` and
+    ``resp.reason`` being preset to the arguments of ``synth()``.
+
+.. _vcl_deliver:
 
 vcl_deliver
 ~~~~~~~~~~~
 
-Called before a cached object is delivered to the client.
+Called before any object except a `vcl_synth` result is delivered to the client.
 
 The `vcl_deliver` subroutine may terminate with calling ``return()`` with one
 of the following keywords:
 
-  deliver
+  ``deliver``
     Deliver the object to the client.
 
-  restart
+  ``restart``
+    Restart the transaction. Increases the restart counter. If the number
+    of restarts is higher than *max_restarts* Varnish emits a guru meditation
+    error.
+
+  ``synth(status code, reason)``
+    Transition to :ref:`vcl_synth` with ``resp.status`` and
+    ``resp.reason`` being preset to the arguments of ``synth()``.
+
+.. _vcl_synth:
+
+vcl_synth
+~~~~~~~~~
+
+Called to deliver a synthetic object. A synthetic object is generated
+in VCL, not fetched from the backend. Its body may be contructed using
+the ``synthetic()`` function.
+
+A `vcl_synth` defined object never enters the cache, contrary to a
+:ref:`vcl_backend_error` defined object, which may end up in cache.
+
+The subroutine may terminate with calling ``return()`` with one of the
+following keywords:
+
+  ``deliver``
+    Directly deliver the object defined by `vcl_synth` to the
+    client without calling `vcl_deliver`.
+
+  ``restart``
     Restart the transaction. Increases the restart counter. If the number
     of restarts is higher than *max_restarts* Varnish emits a guru meditation
     error.
 
+------------
+Backend Side
+------------
+
+.. _vcl_backend_fetch:
 
 vcl_backend_fetch
 ~~~~~~~~~~~~~~~~~
@@ -185,50 +258,71 @@ typically alter the request before it gets to the backend.
 The `vcl_backend_fetch` subroutine may terminate with calling
 ``return()`` with one of the following keywords:
 
-  fetch
+  ``fetch``
     Fetch the object from the backend.
 
-  abandon
-    Abandon the backend request and generates an error.
+  ``abandon``
+    Abandon the backend request. Unless the backend request was a
+    background fetch, control is passed to :ref:`vcl_synth` on the
+    client side with ``resp.status`` preset to 503.
 
+.. _vcl_backend_response:
 
 vcl_backend_response
 ~~~~~~~~~~~~~~~~~~~~
 
-Called after the response headers has been successfully retrieved from
+Called after the response headers have been successfully retrieved from
 the backend.
 
 The `vcl_backend_response` subroutine may terminate with calling
 ``return()`` with one of the following keywords:
 
-  deliver
-    Possibly insert the object into the cache, then deliver it to the
-    Control will eventually pass to `vcl_deliver`.
+  ``deliver``
+    For a 304 response, create an updated cache object.
+    Otherwise, fetch the object body from the backend and initiate
+    delivery to any waiting client requests, possibly in parallel
+    (streaming).
 
-  abandon
-    Abandon the backend request and generates an error.
+  ``abandon``
+    Abandon the backend request. Unless the backend request was a
+    background fetch, control is passed to :ref:`vcl_synth` on the
+    client side with ``resp.status`` preset to 503.
 
-  retry
+  ``retry``
     Retry the backend transaction. Increases the `retries` counter.
-    If the number of retries is higher than *max_retries* Varnish
-    emits a guru meditation error.
+    If the number of retries is higher than *max_retries*,
+    control will be passed to :ref:`vcl_backend_error`.
+
+.. _vcl_backend_error:
 
 vcl_backend_error
 ~~~~~~~~~~~~~~~~~
 
-This subroutine is called if we fail the backend fetch. 
+This subroutine is called if we fail the backend fetch or if
+*max_retries* has been exceeded.
+
+A synthetic object is generated in VCL, whose body may be contructed
+using the ``synthetic()`` function.
 
 The `vcl_backend_error` subroutine may terminate with calling ``return()``
 with one of the following keywords:
 
-  deliver
-    Deliver the error.
+  ``deliver``
+    Deliver and possibly cache the object defined in
+    `vcl_backend_error` **as if it was fetched from the backend**, also
+    referred to as a "backend synth".
 
-  retry
-    Retry the backend transaction. Increases the `retries` counter. If
-    the number of retries is higher than *max_retries* Varnish emits a
-    guru meditation error.
+  ``retry``
+    Retry the backend transaction. Increases the `retries` counter.
+    If the number of retries is higher than *max_retries*,
+    :ref:`vcl_synth` on the client side is called with ``resp.status``
+    preset to 503.
 
+----------------------
+vcl.load / vcl.discard
+----------------------
+
+.. _vcl_init:
 
 vcl_init
 ~~~~~~~~
@@ -239,9 +333,13 @@ Typically used to initialize VMODs.
 The `vcl_init` subroutine may terminate with calling ``return()``
 with one of the following keywords:
 
-  ok
+  ``ok``
     Normal return, VCL continues loading.
 
+  ``fail``
+    Abort loading of this VCL.
+
+.. _vcl_fini:
 
 vcl_fini
 ~~~~~~~~
@@ -252,5 +350,5 @@ Typically used to clean up VMODs.
 The `vcl_fini` subroutine may terminate with calling ``return()``
 with one of the following keywords:
 
-  ok
+  ``ok``
     Normal return, VCL will be discarded.
diff --git a/doc/sphinx/users-guide/vcl-inline-c.rst b/doc/sphinx/users-guide/vcl-inline-c.rst
index 5cc0ead..e0d0998 100644
--- a/doc/sphinx/users-guide/vcl-inline-c.rst
+++ b/doc/sphinx/users-guide/vcl-inline-c.rst
@@ -1,16 +1,16 @@
 
 
 
-Using In-line C to extend Varnish
+Using inline C to extend Varnish
 ---------------------------------
 
 (Here there be dragons. Big and mean ones.)
 
-You can use *in-line C* to extend Varnish. Please note that you can
+You can use *inline C* to extend Varnish. Please note that you can
 seriously mess up Varnish this way. The C code runs within the Varnish
 Cache process so if your code generates a segfault the cache will crash.
 
-One of the first uses of In-line C was logging to `syslog`.::
+One of the first uses of inline C was logging to `syslog`.::
 
         # The include statements must be outside the subroutines.
         C{
@@ -22,3 +22,7 @@ One of the first uses of In-line C was logging to `syslog`.::
                         syslog(LOG_INFO, "Something happened at VCL line XX.");
                 }C
         }
+
+To use inline C you need to enable it with the ``vcc_allow_inline_c``
+parameter.
+
diff --git a/doc/sphinx/users-guide/vcl-variables.rst b/doc/sphinx/users-guide/vcl-variables.rst
index 644c046..70862e5 100644
--- a/doc/sphinx/users-guide/vcl-variables.rst
+++ b/doc/sphinx/users-guide/vcl-variables.rst
@@ -22,7 +22,7 @@ objects can be accessed and manipulated using VCL.
 *beresp*
  The backend response object. It contains the headers of the object
  coming from the backend. If you want to modify the response coming from the
- server you modify this object in `vcl_backend_reponse`.
+ server you modify this object in `vcl_backend_response`.
 
 *resp*
  The HTTP response right before it is delivered to the client. It is
diff --git a/doc/sphinx/whats-new/upgrading.rst b/doc/sphinx/whats-new/upgrading.rst
index cb36b08..0e5b800 100644
--- a/doc/sphinx/whats-new/upgrading.rst
+++ b/doc/sphinx/whats-new/upgrading.rst
@@ -67,7 +67,7 @@ vcl_error is now vcl_backend_error
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 To make a distinction between internally generated errors and
-VCL synthetic responses, `vcl_backend_error` will be called when 
+VCL synthetic responses, `vcl_backend_error` will be called when
 varnish encounters an error when trying to fetch an object.
 
 error() is now synth()
@@ -145,14 +145,7 @@ The `purge;` keyword has been retired.
 obj is now read-only
 ~~~~~~~~~~~~~~~~~~~~
 
-`obj` is now read-only. `obj.hits`, if enabled in VCL, now counts per
-objecthead, not per object. `obj.last_use` has been retired.
-
-Note that obj.hits may not be reset in some cases where bans are in use. See
-bug 1492_ for details.
-
-.. _1492: https://www.varnish-cache.org/trac/ticket/1492
-
+`obj` is now read-only.  `obj.last_use` has been retired.
 
 Some return values have been replaced
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
@@ -192,13 +185,22 @@ The `remove` keyword is gone
 Replaced by `unset`.
 
 
+X-Forwarded-For is now set before vcl_recv
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+In many cases, people unintentionally removed X-Forwarded-For when
+implementing their own vcl_recv. Therefore it has been moved to before
+vcl_recv, so if you don't want an IP added to it, you should remove it
+in vcl_recv.
+
 
 Changes to existing parameters
 ==============================
 
 session_linger
 ~~~~~~~~~~~~~~
-`session_linger` has been renamed to `timeout_linger`.
+`session_linger` has been renamed to `timeout_linger` and it is in
+seconds now (previously was milliseconds).
 
 sess_timeout
 ~~~~~~~~~~~~
@@ -217,6 +219,14 @@ If you are using a lot of VMODs,  you may need to increase
 either `workspace_backend` and `workspace_client` based on where
 your VMOD is doing its work.
 
+thread_pool_purge_delay
+~~~~~~~~~~~~~~~~~~~~~~~
+`thread_pool_purge_delay` has been renamed to `thread_pool_destroy_delay`
+and it is in seconds now (previously was milliseconds).
+
+thread_pool_add_delay and thread_pool_fail_delay
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+They are in seconds now (previously were milliseconds).
 
 New parameters since 3.0
 ========================
diff --git a/etc/example.vcl b/etc/example.vcl
index a2987bb..eefdd9c 100644
--- a/etc/example.vcl
+++ b/etc/example.vcl
@@ -20,14 +20,14 @@ backend default {
 
 sub vcl_recv {
     # Happens before we check if we have this in cache already.
-    # 
+    #
     # Typically you clean up the request here, removing cookies you don't need,
     # rewriting the request, etc.
 }
 
 sub vcl_backend_response {
     # Happens after we have read the response headers from the backend.
-    # 
+    #
     # Here you clean the response headers, removing silly Set-Cookie headers
     # and other mistakes your backend does.
 }
@@ -35,6 +35,6 @@ sub vcl_backend_response {
 sub vcl_deliver {
     # Happens when we have all the pieces we need, and are about to send the
     # response to the client.
-    # 
+    #
     # You can do accounting or modifying the final object here.
 }
diff --git a/include/Makefile.am b/include/Makefile.am
index 96d9663..b7487d6 100644
--- a/include/Makefile.am
+++ b/include/Makefile.am
@@ -37,6 +37,24 @@ nobase_pkginclude_HEADERS = \
 	vapi/vapi_options.h \
 	vcli.h
 
+# Headers for use with vmods
+nobase_pkginclude_HEADERS += \
+	miniobj.h \
+	vas.h \
+	vav.h \
+	vbm.h \
+	vcl.h \
+	vcs.h \
+	vmod_abi.h \
+	vqueue.h \
+	vre.h \
+	vdef.h \
+	vrt.h \
+	vrt_obj.h \
+	vsa.h \
+	vsb.h \
+	vsha256.h
+
 # Private headers
 nobase_noinst_HEADERS = \
 	binary_heap.h \
@@ -68,25 +86,6 @@ nobase_noinst_HEADERS = \
 	vut.h \
 	vut_options.h
 
-# Headers for use with vmods
-pkgdataincludedir = $(pkgdatadir)/include
-nobase_pkgdatainclude_HEADERS = \
-	miniobj.h \
-	vas.h \
-	vav.h \
-	vbm.h \
-	vcl.h \
-	vcs.h \
-	vmod_abi.h \
-	vqueue.h \
-	vre.h \
-	vdef.h \
-	vrt.h \
-	vrt_obj.h \
-	vsa.h \
-	vsb.h \
-	vsha256.h
-
 tbl/vrt_stv_var.h tbl/vcl_returns.h tbl/vcc_types.h vcl.h vrt_obj.h: $(top_srcdir)/lib/libvcc/generate.py $(top_srcdir)/include/vrt.h
 	mkdir -p tbl
 	@PYTHON@ $(top_srcdir)/lib/libvcc/generate.py $(top_srcdir) $(top_builddir)
diff --git a/include/tbl/debug_bits.h b/include/tbl/debug_bits.h
index 59bc64e..81d5e38 100644
--- a/include/tbl/debug_bits.h
+++ b/include/tbl/debug_bits.h
@@ -38,3 +38,4 @@ DEBUG_BIT(HASHEDGE,		hashedge,	"Edge cases in Hash")
 DEBUG_BIT(VCLREL,		vclrel,		"Rapid VCL release")
 DEBUG_BIT(LURKER,		lurker,		"VSL Ban lurker")
 DEBUG_BIT(ESI_CHOP,		esi_chop,	"Chop ESI fetch to bits")
+DEBUG_BIT(FLUSH_HEAD,		flush_head,	"Flush after http1 head")
diff --git a/include/tbl/http_headers.h b/include/tbl/http_headers.h
index 26443ca..53cd8fe 100644
--- a/include/tbl/http_headers.h
+++ b/include/tbl/http_headers.h
@@ -29,72 +29,89 @@
  * Argument list:
  * ---------------------------------------
  * a	Http header name
- * b	session field name
+ * b	enum name
  * c	Supress header in filter ops
  *
  * see [RFC2616 13.5.1 End-to-end and Hop-by-hop Headers]
  *
  */
 
+
 /*lint -save -e525 -e539 */
 
 #ifndef HTTPH_R_PASS
-#define HTTPH_R_PASS	(1 << 0)	/* Request (c->b) in pass mode */
+#define HTTPH_R_PASS	(1 << 0   )	/* Request (c->b) in pass mode */
 #define HTTPH_R_FETCH	(1 << 1)	/* Request (c->b) for fetch */
 #define HTTPH_A_INS	(1 << 2)	/* Response (b->o) for insert */
 #endif
 
-HTTPH("Keep-Alive",		H_Keep_Alive,		HTTPH_R_PASS | HTTPH_R_FETCH		  )	/* RFC2068 */
-HTTPH("Accept",			H_Accept,		0					  )	/* RFC2616 14.1 */
-HTTPH("Accept-Charset",		H_Accept_Charset,	0					  )	/* RFC2616 14.2 */
-HTTPH("Accept-Encoding",	H_Accept_Encoding,	0					  )	/* RFC2616 14.3 */
-HTTPH("Accept-Language",	H_Accept_Language,	0					  )	/* RFC2616 14.4 */
-HTTPH("Accept-Ranges",		H_Accept_Ranges,		       HTTPH_R_FETCH | HTTPH_A_INS)	/* RFC2616 14.5 */
-HTTPH("Age",			H_Age,						       HTTPH_A_INS)	/* RFC2616 14.6 */
-HTTPH("Allow",			H_Allow,		0					  )	/* RFC2616 14.7 */
-HTTPH("Authorization",		H_Authorization,	0					  )	/* RFC2616 14.8 */
-HTTPH("Cache-Control",		H_Cache_Control,		       HTTPH_R_FETCH		  )	/* RFC2616 14.9 */
-HTTPH("Connection",		H_Connection,		HTTPH_R_PASS | HTTPH_R_FETCH | HTTPH_A_INS)	/* RFC2616 14.10 */
-HTTPH("Content-Encoding",	H_Content_Encoding,	0					  )	/* RFC2616 14.11 */
-HTTPH("Content-Language",	H_Content_Language,	0					  )	/* RFC2616 14.12 */
-HTTPH("Content-Length",		H_Content_Length,		       HTTPH_R_FETCH | HTTPH_A_INS)	/* RFC2616 14.13 */
-HTTPH("Content-Location",	H_Content_Location,	0					  )	/* RFC2616 14.14 */
-HTTPH("Content-MD5",		H_Content_MD5,		0					  )	/* RFC2616 14.15 */
-HTTPH("Content-Range",		H_Content_Range,		       HTTPH_R_FETCH | HTTPH_A_INS)	/* RFC2616 14.16 */
-HTTPH("Content-Type",		H_Content_Type,		0					  )	/* RFC2616 14.17 */
-HTTPH("Cookie",			H_Cookie,		0					  )	/* RFC6265 4.2 */
-HTTPH("Date",			H_Date,			0					  )	/* RFC2616 14.18 */
-HTTPH("ETag",			H_ETag,			0					  )	/* RFC2616 14.19 */
-HTTPH("Expect",			H_Expect,		0					  )	/* RFC2616 14.20 */
-HTTPH("Expires",		H_Expires,		0					  )	/* RFC2616 14.21 */
-HTTPH("From",			H_From,			0					  )	/* RFC2616 14.22 */
-HTTPH("Host",			H_Host,			0					  )	/* RFC2616 14.23 */
-HTTPH("HTTP2-Settings",		H_HTTP2_Settings,	HTTPH_R_PASS | HTTPH_R_FETCH | HTTPH_A_INS)	/* draft-ietf-httpbis-http2-12.txt */
-HTTPH("If-Match",		H_If_Match,			       HTTPH_R_FETCH		  )	/* RFC2616 14.24 */
-HTTPH("If-Modified-Since",	H_If_Modified_Since,		       HTTPH_R_FETCH		  )	/* RFC2616 14.25 */
-HTTPH("If-None-Match",		H_If_None_Match,		       HTTPH_R_FETCH		  )	/* RFC2616 14.26 */
-HTTPH("If-Range",		H_If_Range,			       HTTPH_R_FETCH		  )	/* RFC2616 14.27 */
-HTTPH("If-Unmodified-Since",	H_If_Unmodifed_Since,		       HTTPH_R_FETCH		  )	/* RFC2616 14.28 */
-HTTPH("Last-Modified",		H_Last_Modified,	0					  )	/* RFC2616 14.29 */
-HTTPH("Location",		H_Location,		0					  )	/* RFC2616 14.30 */
-HTTPH("Max-Forwards",		H_Max_Forwards,		0					  )	/* RFC2616 14.31 */
-HTTPH("Pragma",			H_Pragma,		0					  )	/* RFC2616 14.32 */
-HTTPH("Proxy-Authenticate",	H_Proxy_Authenticate,		       HTTPH_R_FETCH | HTTPH_A_INS)	/* RFC2616 14.33 */
-HTTPH("Proxy-Authorization",	H_Proxy_Authorization,		       HTTPH_R_FETCH | HTTPH_A_INS)	/* RFC2616 14.34 */
-HTTPH("Range",			H_Range,			       HTTPH_R_FETCH | HTTPH_A_INS)	/* RFC2616 14.35 */
-HTTPH("Referer",		H_Referer,		0					  )	/* RFC2616 14.36 */
-HTTPH("Retry-After",		H_Retry_After,		0					  )	/* RFC2616 14.37 */
-HTTPH("Server",			H_Server,		0					  )	/* RFC2616 14.38 */
-HTTPH("Set-Cookie",		H_Set_Cookie,		0					  )	/* RFC6265 4.1 */
-HTTPH("TE",			H_TE,			HTTPH_R_PASS | HTTPH_R_FETCH | HTTPH_A_INS)	/* RFC2616 14.39 */
-HTTPH("Trailer",		H_Trailer,		HTTPH_R_PASS | HTTPH_R_FETCH | HTTPH_A_INS)	/* RFC2616 14.40 */
-HTTPH("Transfer-Encoding",	H_Transfer_Encoding,	HTTPH_R_PASS | HTTPH_R_FETCH | HTTPH_A_INS)	/* RFC2616 14.41 */
-HTTPH("Upgrade",		H_Upgrade,		HTTPH_R_PASS | HTTPH_R_FETCH | HTTPH_A_INS)	/* RFC2616 14.42 */
-HTTPH("User-Agent",		H_User_Agent,		0					  )	/* RFC2616 14.43 */
-HTTPH("Vary",			H_Vary,			0					  )	/* RFC2616 14.44 */
-HTTPH("Via",			H_Via,			0					  )	/* RFC2616 14.45 */
-HTTPH("Warning",		H_Warning,		0					  )	/* RFC2616 14.46 */
-HTTPH("WWW-Authenticate",	H_WWW_Authenticate,	0					  )	/* RFC2616 14.47 */
-HTTPH("X-Forwarded-For",	H_X_Forwarded_For,	0					  )	/* Not RFC */
+/* Shorthand for this file only, to keep table narrow */
+
+#if defined(P) || defined(F) || defined(I) || defined(H)
+#error "Macro overloading"  // Trust but verify
+#endif
+
+#define P HTTPH_R_PASS
+#define F HTTPH_R_FETCH
+#define I HTTPH_A_INS
+#define H(s,e,f) HTTPH(s, e, f)
+
+H("Keep-Alive",		H_Keep_Alive,		P|F  )	// 2068
+H("Accept",		H_Accept,		0    )	// 2616 14.1
+H("Accept-Charset",	H_Accept_Charset,	0    )	// 2616 14.2
+H("Accept-Encoding",	H_Accept_Encoding,	0    )	// 2616 14.3
+H("Accept-Language",	H_Accept_Language,	0    )	// 2616 14.4
+H("Accept-Ranges",	H_Accept_Ranges,	  F|I)	// 2616 14.5
+H("Age",		H_Age,			    I)	// 2616 14.6
+H("Allow",		H_Allow,		0    )	// 2616 14.7
+H("Authorization",	H_Authorization,	0    )	// 2616 14.8
+H("Cache-Control",	H_Cache_Control,	  F  )	// 2616 14.9
+H("Connection",		H_Connection,		P|F|I)	// 2616 14.10
+H("Content-Encoding",	H_Content_Encoding,	0    )	// 2616 14.11
+H("Content-Language",	H_Content_Language,	0    )	// 2616 14.12
+H("Content-Length",	H_Content_Length,	  F  )	// 2616 14.13
+H("Content-Location",	H_Content_Location,	0    )	// 2616 14.14
+H("Content-MD5",	H_Content_MD5,		0    )	// 2616 14.15
+H("Content-Range",	H_Content_Range,	  F|I)	// 2616 14.16
+H("Content-Type",	H_Content_Type,		0    )	// 2616 14.17
+H("Cookie",		H_Cookie,		0    )	// 6265 4.2
+H("Date",		H_Date,			0    )	// 2616 14.18
+H("ETag",		H_ETag,			0    )	// 2616 14.19
+H("Expect",		H_Expect,		0    )	// 2616 14.20
+H("Expires",		H_Expires,		0    )	// 2616 14.21
+H("From",		H_From,			0    )	// 2616 14.22
+H("Host",		H_Host,			0    )	// 2616 14.23
+H("HTTP2-Settings",	H_HTTP2_Settings,	P|F|I)	// httpbis-http2-16.txt
+H("If-Match",		H_If_Match,		  F  )	// 2616 14.24
+H("If-Modified-Since",	H_If_Modified_Since,	  F  )	// 2616 14.25
+H("If-None-Match",	H_If_None_Match,	  F  )	// 2616 14.26
+H("If-Range",		H_If_Range,		  F  )	// 2616 14.27
+H("If-Unmodified-Since",H_If_Unmodifed_Since,	  F  )	// 2616 14.28
+H("Last-Modified",	H_Last_Modified,	0    )	// 2616 14.29
+H("Location",		H_Location,		0    )	// 2616 14.30
+H("Max-Forwards",	H_Max_Forwards,		0    )	// 2616 14.31
+H("Pragma",		H_Pragma,		0    )	// 2616 14.32
+H("Proxy-Authenticate",	H_Proxy_Authenticate,	  F|I)	// 2616 14.33
+H("Proxy-Authorization",H_Proxy_Authorization,	  F|I)	// 2616 14.34
+H("Range",		H_Range,		  F|I)	// 2616 14.35
+H("Referer",		H_Referer,		0    )	// 2616 14.36
+H("Retry-After",	H_Retry_After,		0    )	// 2616 14.37
+H("Server",		H_Server,		0    )	// 2616 14.38
+H("Set-Cookie",		H_Set_Cookie,		0    )	// 6265 4.1
+H("TE",			H_TE,			P|F|I)	// 2616 14.39
+H("Trailer",		H_Trailer,		P|F|I)	// 2616 14.40
+H("Transfer-Encoding",	H_Transfer_Encoding,	P|F|I)	// 2616 14.41
+H("Upgrade",		H_Upgrade,		P|F|I)	// 2616 14.42
+H("User-Agent",		H_User_Agent,		0    )	// 2616 14.43
+H("Vary",		H_Vary,			0    )	// 2616 14.44
+H("Via",		H_Via,			0    )	// 2616 14.45
+H("Warning",		H_Warning,		0    )	// 2616 14.46
+H("WWW-Authenticate",	H_WWW_Authenticate,	0    )	// 2616 14.47
+H("X-Forwarded-For",	H_X_Forwarded_For,	0    )	// No RFC
+
+#undef P
+#undef F
+#undef I
+#undef H
 
 /*lint -restore */
diff --git a/include/tbl/locks.h b/include/tbl/locks.h
index 3996a36..1a01782 100644
--- a/include/tbl/locks.h
+++ b/include/tbl/locks.h
@@ -54,5 +54,4 @@ LOCK(busyobj)
 LOCK(mempool)
 LOCK(vxid)
 LOCK(pipestat)
-LOCK(cache_backends)
 /*lint -restore */
diff --git a/include/tbl/sess_close.h b/include/tbl/sess_close.h
index 5b77eba..351cc58 100644
--- a/include/tbl/sess_close.h
+++ b/include/tbl/sess_close.h
@@ -29,18 +29,19 @@
 
 /*lint -save -e525 -e539 */
 
-SESS_CLOSE(REM_CLOSE,	"Client Closed")
-SESS_CLOSE(REQ_CLOSE,	"Client requested close")
-SESS_CLOSE(REQ_HTTP10,	"Proto < HTTP/1.1")
-SESS_CLOSE(RX_BODY,	"Failure receiving req.body")
-SESS_CLOSE(RX_JUNK,	"Received junk data")
-SESS_CLOSE(RX_OVERFLOW,	"Received buffer overflow")
-SESS_CLOSE(RX_TIMEOUT,	"Receive timeout")
-SESS_CLOSE(TX_PIPE,	"Piped transaction")
-SESS_CLOSE(TX_ERROR,	"Error transaction")
-SESS_CLOSE(TX_EOF,	"EOF transmission")
-SESS_CLOSE(RESP_CLOSE,	"Backend/VCL requested close")
-SESS_CLOSE(OVERLOAD,	"Out of some resource")
+SESS_CLOSE(REM_CLOSE,		"Client Closed")
+SESS_CLOSE(REQ_CLOSE,		"Client requested close")
+SESS_CLOSE(REQ_HTTP10,		"Proto < HTTP/1.1")
+SESS_CLOSE(RX_BAD,		"Received bad request")
+SESS_CLOSE(RX_BODY,		"Failure receiving req.body")
+SESS_CLOSE(RX_JUNK,		"Received junk data")
+SESS_CLOSE(RX_OVERFLOW,		"Received buffer overflow")
+SESS_CLOSE(RX_TIMEOUT,		"Receive timeout")
+SESS_CLOSE(TX_PIPE,		"Piped transaction")
+SESS_CLOSE(TX_ERROR,		"Error transaction")
+SESS_CLOSE(TX_EOF,		"EOF transmission")
+SESS_CLOSE(RESP_CLOSE,		"Backend/VCL requested close")
+SESS_CLOSE(OVERLOAD,		"Out of some resource")
 SESS_CLOSE(SESS_PIPE_OVERFLOW,	"Session pipe overflow")
 
 /*lint -restore */
diff --git a/include/tbl/vsc_f_main.h b/include/tbl/vsc_f_main.h
index 845fbcb..02e051c 100644
--- a/include/tbl/vsc_f_main.h
+++ b/include/tbl/vsc_f_main.h
@@ -38,7 +38,7 @@
  *				'c' - Counter, never decreases.
  *				'g' - Gauge, goes up and down
  *				'i' - Integer (deprecated, use 'g')
- *    e - Explantion:	Short explanation of field (for screen use)
+ *    e - Explanation:	Short explanation of field (for screen use)
  *    d - Description:	Long explanation of field (for doc use)
  *
  * Please describe Gauge variables as "Number of..." to indicate that
@@ -63,7 +63,7 @@
 
 VSC_F(uptime,			uint64_t, 0, 'a', info,
     "Child process uptime",
-	""
+	"How long the child process has been running."
 )
 
 
@@ -73,7 +73,7 @@ VSC_F(uptime,			uint64_t, 0, 'a', info,
 
 VSC_F(sess_conn,		uint64_t, 1, 'c', info,
     "Sessions accepted",
-	"Count of sessions succesfully accepted"
+	"Count of sessions successfully accepted"
 )
 
 VSC_F(sess_drop,		uint64_t, 1, 'c', info,
@@ -85,7 +85,7 @@ VSC_F(sess_fail,		uint64_t, 1, 'c', info,
     "Session accept failures",
 	"Count of failures to accept TCP connection."
 	"  Either the client changed its mind, or the kernel ran out of"
-	" some resource like filedescriptors."
+	" some resource like file descriptors."
 )
 
 VSC_F(sess_pipe_overflow,	uint64_t, 1, 'c', info,
@@ -108,7 +108,7 @@ VSC_F(client_req_411,		uint64_t, 1, 'a', info,
 
 VSC_F(client_req_413,		uint64_t, 1, 'a', info,
     "Client requests received, subject to 413 errors",
-	"413 means that HTTP headers execeeded length or count limits."
+	"413 means that HTTP headers exceeded length or count limits."
 )
 
 VSC_F(client_req_417,		uint64_t, 1, 'a', info,
@@ -117,8 +117,8 @@ VSC_F(client_req_417,		uint64_t, 1, 'a', info,
 )
 
 VSC_F(client_req,		uint64_t, 1, 'a', info,
-    "Good Client requests received",
-	""
+    "Good client requests received",
+	"The count of parseable client requests seen."
 )
 
 /*---------------------------------------------------------------------*/
@@ -150,7 +150,8 @@ VSC_F(cache_miss,		uint64_t, 1, 'a', info,
 
 VSC_F(backend_conn,		uint64_t, 0, 'a', info,
     "Backend conn. success",
-	""
+	"How many backend connections have successfully been"
+	" established."
 )
 
 VSC_F(backend_unhealthy,	uint64_t, 0, 'a', info,
@@ -236,8 +237,12 @@ VSC_F(fetch_304,		uint64_t, 1, 'c', info,
 	"beresp with no body because of 304 response."
 )
 VSC_F(fetch_failed,		uint64_t, 1, 'c', info,
-    "Fetch body failed",
-	"beresp body fetch failed."
+    "Fetch failed (all causes)",
+	"beresp fetch failed."
+)
+VSC_F(fetch_no_thread,		uint64_t, 1, 'c', info,
+    "Fetch failed (no thread)",
+	"beresp fetch failed, no thread available."
 )
 
 /*---------------------------------------------------------------------
@@ -248,21 +253,22 @@ VSC_F(fetch_failed,		uint64_t, 1, 'c', info,
 
 VSC_F(pools,			uint64_t, 0, 'g', info,
     "Number of thread pools",
-	"Number of thread pools.  See also param wthread_pools."
+	"Number of thread pools.  See also parameter thread_pools."
 	"  NB: Presently pools cannot be removed once created."
 )
 
 VSC_F(threads,			uint64_t, 0, 'g', info,
     "Total number of threads",
 	"Number of threads in all pools."
-	"  See also params thread_pools, thread_pool_min & thread_pool_max."
+	"  See also parameters thread_pools, thread_pool_min and"
+	" thread_pool_max."
 )
 
 VSC_F(threads_limited,		uint64_t, 0, 'c', info,
     "Threads hit max",
 	"Number of times more threads were needed, but limit was reached"
 	" in a thread pool."
-	"  See also param thread_pool_max."
+	"  See also parameter thread_pool_max."
 )
 
 VSC_F(threads_created,		uint64_t, 0, 'c', info,
@@ -279,19 +285,19 @@ VSC_F(threads_failed,		uint64_t, 0, 'c', info,
     "Thread creation failed",
 	"Number of times creating a thread failed."
 	"  See VSL::Debug for diagnostics."
-	"  See also param thread_fail_delay."
+	"  See also parameter thread_fail_delay."
 )
 
 VSC_F(thread_queue_len,		uint64_t, 0, 'g', info,
     "Length of session queue",
 	"Length of session queue waiting for threads."
 	"  NB: Only updates once per second."
-	"  See also param queue_max."
+	"  See also parameter queue_max."
 )
 
 VSC_F(busy_sleep,		uint64_t, 1, 'c', info,
     "Number of requests sent to sleep on busy objhdr",
-	"Number of requests sent to sleep without a worker threads because"
+	"Number of requests sent to sleep without a worker thread because"
 	" they found a busy object."
 )
 
@@ -304,55 +310,56 @@ VSC_F(busy_wakeup,		uint64_t, 1, 'c', info,
 VSC_F(sess_queued,		uint64_t, 0, 'c', info,
     "Sessions queued for thread",
 	"Number of times session was queued waiting for a thread."
-	"  See also param queue_max."
+	"  See also parameter queue_max."
 )
 
 VSC_F(sess_dropped,		uint64_t, 0, 'c', info,
     "Sessions dropped for thread",
 	"Number of times session was dropped because the queue were too"
-	" long already."
-	"  See also param queue_max."
+	" long already. See also parameter queue_max."
 )
 
 /*---------------------------------------------------------------------*/
 
 VSC_F(n_object,			uint64_t, 1, 'i', info,
-    "N struct object",
-	""
+    "object structs made",
+        "Number of object structs made"
 )
 VSC_F(n_vampireobject,		uint64_t, 1, 'i', diag,
-    "N unresurrected objects",
-	""
+    "unresurrected objects",
+	"Number of unresurrected objects"
 )
 VSC_F(n_objectcore,		uint64_t, 1, 'i', info,
-    "N struct objectcore",
-	""
+    "objectcore structs made",
+       "Number of objectcore structs made"
 )
 VSC_F(n_objecthead,		uint64_t, 1, 'i', info,
-    "N struct objecthead",
-	""
+    "objecthead structs made",
+        "Number of objecthead structs made"
 )
 VSC_F(n_waitinglist,		uint64_t, 1, 'i', debug,
-    "N struct waitinglist",
-	""
+    "waitinglist structs made",
+        "Number of waitinglist structs made"
 )
 
 VSC_F(n_backend,		uint64_t, 0, 'i', info,
-    "N backends",
-	""
+    "Number of backends",
+	"Number of backends known to us."
 )
 
 VSC_F(n_expired,		uint64_t, 0, 'i', info,
-    "N expired objects",
-	""
+    "Number of expired objects",
+	"Number of objects that expired from cache"
+	" because of old age."
 )
 VSC_F(n_lru_nuked,		uint64_t, 0, 'i', info,
-    "N LRU nuked objects",
-	""
+    "Number of LRU nuked objects",
+	"How many objects have been forcefully evicted"
+	" from storage to make room for a new object."
 )
 VSC_F(n_lru_moved,		uint64_t, 0, 'i', diag,
-    "N LRU moved objects",
-	""
+    "Number of LRU moved objects",
+        "Number of move operations done on the LRU list."
 )
 
 VSC_F(losthdr,			uint64_t, 0, 'a', info,
@@ -361,27 +368,27 @@ VSC_F(losthdr,			uint64_t, 0, 'a', info,
 )
 
 VSC_F(s_sess,			uint64_t, 1, 'a', info,
-    "Total Sessions",
+    "Total sessions seen",
 	""
 )
 VSC_F(s_req,			uint64_t, 1, 'a', info,
-    "Total Requests",
+    "Total requests seen",
 	""
 )
 VSC_F(s_pipe,			uint64_t, 1, 'a', info,
-    "Total pipe",
+    "Total pipe sessions seen",
 	""
 )
 VSC_F(s_pass,			uint64_t, 1, 'a', info,
-    "Total pass",
+    "Total pass-ed requests seen",
 	""
 )
 VSC_F(s_fetch,			uint64_t, 1, 'a', info,
-    "Total fetch",
+    "Total backend fetches initiated",
 	""
 )
 VSC_F(s_synth,			uint64_t, 1, 'a', info,
-    "Total synth",
+    "Total synthethic responses made",
 	""
 )
 VSC_F(s_req_hdrbytes,		uint64_t, 1, 'a', info,
@@ -397,7 +404,7 @@ VSC_F(s_resp_hdrbytes,		uint64_t, 1, 'a', info,
 	"Total response header bytes transmitted"
 )
 VSC_F(s_resp_bodybytes,		uint64_t, 1, 'a', info,
-    "Reponse body bytes",
+    "Response body bytes",
 	"Total response body bytes transmitted"
 )
 VSC_F(s_pipe_hdrbytes,		uint64_t, 0, 'a', info,
@@ -488,15 +495,15 @@ VSC_F(backend_req,		uint64_t, 0, 'a', info,
 /*--------------------------------------------------------------------*/
 
 VSC_F(n_vcl,			uint64_t, 0, 'a', info,
-    "N vcl total",
+    "Number of loaded VCLs in total",
 	""
 )
 VSC_F(n_vcl_avail,		uint64_t, 0, 'a', diag,
-    "N vcl available",
+    "Number of VCLs available",
 	""
 )
 VSC_F(n_vcl_discard,		uint64_t, 0, 'a', diag,
-    "N vcl discarded",
+    "Number of discarded VCLs",
 	""
 )
 
@@ -584,11 +591,11 @@ VSC_F(bans_persisted_fragmentation,	uint64_t, 0, 'g', diag,
 /*--------------------------------------------------------------------*/
 
 VSC_F(n_purges,			uint64_t, 0, 'i', info,
-    "Number of purge operations",
+    "Number of purge operations executed",
 	""
 )
 VSC_F(n_obj_purged,		uint64_t, 0, 'i', info,
-    "number of purged objects",
+    "Number of purged objects",
 	""
 )
 
diff --git a/include/tbl/vsc_fields.h b/include/tbl/vsc_fields.h
index 64e63a3..1864a83 100644
--- a/include/tbl/vsc_fields.h
+++ b/include/tbl/vsc_fields.h
@@ -39,7 +39,7 @@
  *				'g' - Gauge, goes up and down
  *				'i' - Integer (deprecated, use 'g')
  *    v - Verbosity:	Counter verbosity level (see vsc_levels.h)
- *    e - Explantion:	Short explanation of field (for screen use)
+ *    e - Explanation:	Short explanation of field (for screen use)
  *    d - Description:	Long explanation of field (for doc use)
  *
  * Please describe Gauge variables as "Number of..." to indicate that
diff --git a/include/tbl/vsl_tags.h b/include/tbl/vsl_tags.h
index 18b93f8..0cb0612 100644
--- a/include/tbl/vsl_tags.h
+++ b/include/tbl/vsl_tags.h
@@ -197,12 +197,12 @@ SLTM(TTL, 0, "TTL set on object",
 	"A TTL record is emitted whenever the ttl, grace or keep"
 	" values for an object is set.\n\n"
 	"The format is::\n\n"
-	"\t%s %d %d %d %d %d [ %d %u %u ]\n"
-	"\t|  |  |  |  |  |    |  |  |\n"
-	"\t|  |  |  |  |  |    |  |  +- Max-Age from Cache-Control header\n"
-	"\t|  |  |  |  |  |    |  +---- Expires header\n"
-	"\t|  |  |  |  |  |    +------- Date header\n"
-	"\t|  |  |  |  |  +------------ Age (incl Age: header value)\n"
+	"\t%s %d %d %d %d [ %d %d %u %u ]\n"
+	"\t|  |  |  |  |    |  |  |  |\n"
+	"\t|  |  |  |  |    |  |  |  +- Max-Age from Cache-Control header\n"
+	"\t|  |  |  |  |    |  |  +---- Expires header\n"
+	"\t|  |  |  |  |    |  +------- Date header\n"
+	"\t|  |  |  |  |    +---------- Age (incl Age: header value)\n"
 	"\t|  |  |  |  +--------------- Reference time for TTL\n"
 	"\t|  |  |  +------------------ Keep\n"
 	"\t|  |  +--------------------- Grace\n"
@@ -211,12 +211,8 @@ SLTM(TTL, 0, "TTL set on object",
 	"\n"
 	"The last four fields are only present in \"RFC\" headers.\n\n"
 	"Examples::\n\n"
-	"\tRFC 19 -1 -1 1312966109 4 0 0 23\n"
-	"\tVCL 10 -1 -1 1312966109 4\n"
-	"\tVCL 7 -1 -1 1312966111 6\n"
-	"\tVCL 7 120 -1 1312966111 6\n"
-	"\tVCL 7 120 3600 1312966111 6\n"
-	"\tVCL 12 120 3600 1312966113 8\n"
+	"\tRFC 60 -1 -1 1312966109 1312966109 1312966109 0 60\n"
+	"\tVCL 120 10 0 1312966111\n"
 	"\n"
 )
 
diff --git a/include/vcl.h b/include/vcl.h
index 28a8f7b..771c58a 100644
--- a/include/vcl.h
+++ b/include/vcl.h
@@ -5,6 +5,7 @@
  */
 
 struct vrt_ctx;
+#define VRT_CTX const struct vrt_ctx *ctx
 struct req;
 struct busyobj;
 struct ws;
@@ -13,7 +14,7 @@ struct worker;
 
 typedef int vcl_init_f(struct cli *);
 typedef void vcl_fini_f(struct cli *);
-typedef int vcl_func_f(const struct vrt_ctx *ctx);
+typedef int vcl_func_f(VRT_CTX);
 
 /* VCL Methods */
 #define VCL_MET_RECV			(1U << 1)
diff --git a/include/vcli.h b/include/vcli.h
index f6b75da..e6762f0 100644
--- a/include/vcli.h
+++ b/include/vcli.h
@@ -97,7 +97,7 @@
 
 #define CLI_VCL_SHOW							\
 	"vcl.show",							\
-	"vcl.show <configname>",					\
+	"vcl.show [-v] <configname>",					\
 	"\tDisplay the source code for the specified configuration.",	\
 	1, 2
 
@@ -122,7 +122,7 @@
 #define CLI_SERVER_STOP							\
 	"stop",								\
 	"stop",								\
-	"\tStop the Varnish cache process",				\
+	"\tStop the Varnish cache process.",				\
 	0, 0
 
 #define CLI_SERVER_START						\
@@ -133,20 +133,20 @@
 
 #define CLI_PING							\
 	"ping",								\
-	"ping [timestamp]",						\
-	"\tKeep connection alive",					\
+	"ping [<timestamp>]",						\
+	"\tKeep connection alive.",					\
 	0, 1
 
 #define CLI_HELP							\
 	"help",								\
-	"help [command]",						\
-	"\tShow command/protocol help",					\
+	"help [<command>]",						\
+	"\tShow command/protocol help.",				\
 	0, 1
 
 #define CLI_QUIT							\
 	"quit",								\
 	"quit",								\
-	"\tClose connection",						\
+	"\tClose connection.",						\
 	0, 0
 
 #define CLI_SERVER_STATUS						\
@@ -163,7 +163,7 @@
 
 #define CLI_AUTH							\
 	"auth",								\
-	"auth response",						\
+	"auth <response>",						\
 	"\tAuthenticate.",						\
 	1, 1
 
diff --git a/include/vcs_version.h b/include/vcs_version.h
index 2cc89b2..d70984d 100644
--- a/include/vcs_version.h
+++ b/include/vcs_version.h
@@ -1,11 +1,11 @@
-/* bfe7cd1 */
+/* b8c4a34 */
 /*
  * NB:  This file is machine generated, DO NOT EDIT!
  *
  * Run make to regenerate
  *
  */
-/* bfe7cd1 */
+/* b8c4a34 */
 
-#define VCS_Version "bfe7cd1"
+#define VCS_Version "b8c4a34"
 #define VCS_Branch "HEAD"
diff --git a/include/vmod_abi.h b/include/vmod_abi.h
index f82c94a..2286f8a 100644
--- a/include/vmod_abi.h
+++ b/include/vmod_abi.h
@@ -1 +1 @@
-#define VMOD_ABI_Version "Varnish 4.0.2 bfe7cd1"
+#define VMOD_ABI_Version "Varnish 4.0.3 b8c4a34"
diff --git a/include/vrt.h b/include/vrt.h
index b294344..e7939aa 100644
--- a/include/vrt.h
+++ b/include/vrt.h
@@ -105,6 +105,8 @@ struct vrt_ctx {
 	double				now;
 };
 
+#define VRT_CTX		const struct vrt_ctx *ctx
+
 /***********************************************************************/
 
 struct vmod_data {
@@ -155,7 +157,6 @@ struct vrt_backend {
 	const char			*vcl_name;
 	const char			*ipv4_addr;
 	const char			*ipv6_addr;
-    const char			*host;
 	const char			*port;
 
 	const struct suckaddr		*ipv4_suckaddr;
@@ -187,51 +188,45 @@ struct vrt_ref {
 /* ACL related */
 #define VRT_ACL_MAXADDR		16	/* max(IPv4, IPv6) */
 
-void VRT_acl_log(const struct vrt_ctx *, const char *msg);
+void VRT_acl_log(VRT_CTX, const char *msg);
 
 /* req related */
 
-int VRT_CacheReqBody(const struct vrt_ctx *, long long maxsize);
+int VRT_CacheReqBody(VRT_CTX, long long maxsize);
 
 /* Regexp related */
 void VRT_re_init(void **, const char *);
 void VRT_re_fini(void *);
-int VRT_re_match(const struct vrt_ctx *, const char *, void *re);
-const char *VRT_regsub(const struct vrt_ctx *, int all, const char *,
-    void *, const char *);
+int VRT_re_match(VRT_CTX, const char *, void *re);
+const char *VRT_regsub(VRT_CTX, int all, const char *, void *, const char *);
 
-void VRT_ban_string(const struct vrt_ctx *, const char *);
-void VRT_purge(const struct vrt_ctx *, double ttl, double grace, double keep);
+void VRT_ban_string(VRT_CTX, const char *);
+void VRT_purge(VRT_CTX, double ttl, double grace, double keep);
 
-void VRT_count(const struct vrt_ctx *, unsigned);
+void VRT_count(VRT_CTX, unsigned);
 int VRT_rewrite(const char *, const char *);
-void VRT_error(const struct vrt_ctx *, unsigned, const char *);
+void VRT_error(VRT_CTX, unsigned, const char *);
 int VRT_switch_config(const char *);
 
-char *VRT_GetHdr(const struct vrt_ctx *, const struct gethdr_s *);
-void VRT_SetHdr(const struct vrt_ctx *, const struct gethdr_s *,
-    const char *, ...);
-void VRT_handling(const struct vrt_ctx *, unsigned hand);
+char *VRT_GetHdr(VRT_CTX, const struct gethdr_s *);
+void VRT_SetHdr(VRT_CTX, const struct gethdr_s *, const char *, ...);
+void VRT_handling(VRT_CTX, unsigned hand);
 
-void VRT_hashdata(const struct vrt_ctx *, const char *str, ...);
+void VRT_hashdata(VRT_CTX, const char *str, ...);
 
 /* Simple stuff */
 int VRT_strcmp(const char *s1, const char *s2);
 void VRT_memmove(void *dst, const void *src, unsigned len);
 
-void VRT_Rollback(const struct vrt_ctx *, const struct http *);
+void VRT_Rollback(VRT_CTX, const struct http *);
 
 /* Synthetic pages */
-void VRT_synth_page(const struct vrt_ctx *, const char *, ...);
+void VRT_synth_page(VRT_CTX, const char *, ...);
 
 /* Backend related */
 void VRT_init_dir(struct cli *, struct director **, int idx, const void *priv);
 void VRT_fini_dir(struct cli *, struct director *);
 
-/* RevSW: get the VCL backend from a simple director */
-const struct vrt_backend *
-VRT_get_backend(struct cli *, struct director *);
-
 /* Suckaddr related */
 int VRT_VSA_GetPtr(const struct suckaddr *sua, const unsigned char ** dst);
 
@@ -257,10 +252,10 @@ int VRT_Stv(const char *nm);
 
 /* Convert things to string */
 
-char *VRT_IP_string(const struct vrt_ctx *, VCL_IP);
-char *VRT_INT_string(const struct vrt_ctx *, VCL_INT);
-char *VRT_REAL_string(const struct vrt_ctx *, VCL_REAL);
-char *VRT_TIME_string(const struct vrt_ctx *, VCL_TIME);
+char *VRT_IP_string(VRT_CTX, VCL_IP);
+char *VRT_INT_string(VRT_CTX, VCL_INT);
+char *VRT_REAL_string(VRT_CTX, VCL_REAL);
+char *VRT_TIME_string(VRT_CTX, VCL_TIME);
 const char *VRT_BOOL_string(VCL_BOOL);
 const char *VRT_BACKEND_string(VCL_BACKEND);
-const char *VRT_CollectString(const struct vrt_ctx *, const char *p, ...);
+const char *VRT_CollectString(VRT_CTX, const char *p, ...);
diff --git a/include/vrt_obj.h b/include/vrt_obj.h
index b9b4344..cf0caf4 100644
--- a/include/vrt_obj.h
+++ b/include/vrt_obj.h
@@ -4,156 +4,155 @@
  * Edit and run generate.py instead
  */
 
-VCL_HTTP VRT_r_bereq(const struct vrt_ctx *);
+VCL_HTTP VRT_r_bereq(VRT_CTX);
 
-VCL_BACKEND VRT_r_bereq_backend(const struct vrt_ctx *);
-void VRT_l_bereq_backend(const struct vrt_ctx *, VCL_BACKEND);
+VCL_BACKEND VRT_r_bereq_backend(VRT_CTX);
+void VRT_l_bereq_backend(VRT_CTX, VCL_BACKEND);
 
-VCL_DURATION VRT_r_bereq_between_bytes_timeout(const struct vrt_ctx *);
-void VRT_l_bereq_between_bytes_timeout(const struct vrt_ctx *, VCL_DURATION);
+VCL_DURATION VRT_r_bereq_between_bytes_timeout(VRT_CTX);
+void VRT_l_bereq_between_bytes_timeout(VRT_CTX, VCL_DURATION);
 
-VCL_DURATION VRT_r_bereq_connect_timeout(const struct vrt_ctx *);
-void VRT_l_bereq_connect_timeout(const struct vrt_ctx *, VCL_DURATION);
+VCL_DURATION VRT_r_bereq_connect_timeout(VRT_CTX);
+void VRT_l_bereq_connect_timeout(VRT_CTX, VCL_DURATION);
 
-VCL_DURATION VRT_r_bereq_first_byte_timeout(const struct vrt_ctx *);
-void VRT_l_bereq_first_byte_timeout(const struct vrt_ctx *, VCL_DURATION);
+VCL_DURATION VRT_r_bereq_first_byte_timeout(VRT_CTX);
+void VRT_l_bereq_first_byte_timeout(VRT_CTX, VCL_DURATION);
 
 
-VCL_STRING VRT_r_bereq_method(const struct vrt_ctx *);
-void VRT_l_bereq_method(const struct vrt_ctx *, const char *, ...);
+VCL_STRING VRT_r_bereq_method(VRT_CTX);
+void VRT_l_bereq_method(VRT_CTX, const char *, ...);
 
-VCL_STRING VRT_r_bereq_proto(const struct vrt_ctx *);
-void VRT_l_bereq_proto(const struct vrt_ctx *, const char *, ...);
+VCL_STRING VRT_r_bereq_proto(VRT_CTX);
+void VRT_l_bereq_proto(VRT_CTX, const char *, ...);
 
-VCL_INT VRT_r_bereq_retries(const struct vrt_ctx *);
+VCL_INT VRT_r_bereq_retries(VRT_CTX);
 
-VCL_BOOL VRT_r_bereq_uncacheable(const struct vrt_ctx *);
-void VRT_l_bereq_uncacheable(const struct vrt_ctx *, VCL_BOOL);
+VCL_BOOL VRT_r_bereq_uncacheable(VRT_CTX);
 
-VCL_STRING VRT_r_bereq_url(const struct vrt_ctx *);
-void VRT_l_bereq_url(const struct vrt_ctx *, const char *, ...);
+VCL_STRING VRT_r_bereq_url(VRT_CTX);
+void VRT_l_bereq_url(VRT_CTX, const char *, ...);
 
-VCL_STRING VRT_r_bereq_xid(const struct vrt_ctx *);
+VCL_STRING VRT_r_bereq_xid(VRT_CTX);
 
-VCL_HTTP VRT_r_beresp(const struct vrt_ctx *);
+VCL_HTTP VRT_r_beresp(VRT_CTX);
 
-VCL_IP VRT_r_beresp_backend_ip(const struct vrt_ctx *);
+VCL_IP VRT_r_beresp_backend_ip(VRT_CTX);
 
-VCL_STRING VRT_r_beresp_backend_name(const struct vrt_ctx *);
+VCL_STRING VRT_r_beresp_backend_name(VRT_CTX);
 
-VCL_BOOL VRT_r_beresp_do_esi(const struct vrt_ctx *);
-void VRT_l_beresp_do_esi(const struct vrt_ctx *, VCL_BOOL);
+VCL_BOOL VRT_r_beresp_do_esi(VRT_CTX);
+void VRT_l_beresp_do_esi(VRT_CTX, VCL_BOOL);
 
-VCL_BOOL VRT_r_beresp_do_gunzip(const struct vrt_ctx *);
-void VRT_l_beresp_do_gunzip(const struct vrt_ctx *, VCL_BOOL);
+VCL_BOOL VRT_r_beresp_do_gunzip(VRT_CTX);
+void VRT_l_beresp_do_gunzip(VRT_CTX, VCL_BOOL);
 
-VCL_BOOL VRT_r_beresp_do_gzip(const struct vrt_ctx *);
-void VRT_l_beresp_do_gzip(const struct vrt_ctx *, VCL_BOOL);
+VCL_BOOL VRT_r_beresp_do_gzip(VRT_CTX);
+void VRT_l_beresp_do_gzip(VRT_CTX, VCL_BOOL);
 
-VCL_BOOL VRT_r_beresp_do_stream(const struct vrt_ctx *);
-void VRT_l_beresp_do_stream(const struct vrt_ctx *, VCL_BOOL);
+VCL_BOOL VRT_r_beresp_do_stream(VRT_CTX);
+void VRT_l_beresp_do_stream(VRT_CTX, VCL_BOOL);
 
-VCL_DURATION VRT_r_beresp_grace(const struct vrt_ctx *);
-void VRT_l_beresp_grace(const struct vrt_ctx *, VCL_DURATION);
+VCL_DURATION VRT_r_beresp_grace(VRT_CTX);
+void VRT_l_beresp_grace(VRT_CTX, VCL_DURATION);
 
 
-VCL_DURATION VRT_r_beresp_keep(const struct vrt_ctx *);
-void VRT_l_beresp_keep(const struct vrt_ctx *, VCL_DURATION);
+VCL_DURATION VRT_r_beresp_keep(VRT_CTX);
+void VRT_l_beresp_keep(VRT_CTX, VCL_DURATION);
 
-VCL_STRING VRT_r_beresp_proto(const struct vrt_ctx *);
-void VRT_l_beresp_proto(const struct vrt_ctx *, const char *, ...);
+VCL_STRING VRT_r_beresp_proto(VRT_CTX);
+void VRT_l_beresp_proto(VRT_CTX, const char *, ...);
 
-VCL_STRING VRT_r_beresp_reason(const struct vrt_ctx *);
-void VRT_l_beresp_reason(const struct vrt_ctx *, const char *, ...);
+VCL_STRING VRT_r_beresp_reason(VRT_CTX);
+void VRT_l_beresp_reason(VRT_CTX, const char *, ...);
 
-VCL_INT VRT_r_beresp_status(const struct vrt_ctx *);
-void VRT_l_beresp_status(const struct vrt_ctx *, VCL_INT);
+VCL_INT VRT_r_beresp_status(VRT_CTX);
+void VRT_l_beresp_status(VRT_CTX, VCL_INT);
 
-VCL_STRING VRT_r_beresp_storage_hint(const struct vrt_ctx *);
-void VRT_l_beresp_storage_hint(const struct vrt_ctx *, const char *, ...);
+VCL_STRING VRT_r_beresp_storage_hint(VRT_CTX);
+void VRT_l_beresp_storage_hint(VRT_CTX, const char *, ...);
 
-VCL_DURATION VRT_r_beresp_ttl(const struct vrt_ctx *);
-void VRT_l_beresp_ttl(const struct vrt_ctx *, VCL_DURATION);
+VCL_DURATION VRT_r_beresp_ttl(VRT_CTX);
+void VRT_l_beresp_ttl(VRT_CTX, VCL_DURATION);
 
-VCL_BOOL VRT_r_beresp_uncacheable(const struct vrt_ctx *);
-void VRT_l_beresp_uncacheable(const struct vrt_ctx *, VCL_BOOL);
+VCL_BOOL VRT_r_beresp_uncacheable(VRT_CTX);
+void VRT_l_beresp_uncacheable(VRT_CTX, VCL_BOOL);
 
-VCL_STRING VRT_r_client_identity(const struct vrt_ctx *);
-void VRT_l_client_identity(const struct vrt_ctx *, const char *, ...);
+VCL_STRING VRT_r_client_identity(VRT_CTX);
+void VRT_l_client_identity(VRT_CTX, const char *, ...);
 
-VCL_IP VRT_r_client_ip(const struct vrt_ctx *);
+VCL_IP VRT_r_client_ip(VRT_CTX);
 
-VCL_TIME VRT_r_now(const struct vrt_ctx *);
+VCL_TIME VRT_r_now(VRT_CTX);
 
-VCL_DURATION VRT_r_obj_grace(const struct vrt_ctx *);
+VCL_DURATION VRT_r_obj_grace(VRT_CTX);
 
-VCL_INT VRT_r_obj_hits(const struct vrt_ctx *);
+VCL_INT VRT_r_obj_hits(VRT_CTX);
 
 
-VCL_DURATION VRT_r_obj_keep(const struct vrt_ctx *);
+VCL_DURATION VRT_r_obj_keep(VRT_CTX);
 
-VCL_STRING VRT_r_obj_proto(const struct vrt_ctx *);
+VCL_STRING VRT_r_obj_proto(VRT_CTX);
 
-VCL_STRING VRT_r_obj_reason(const struct vrt_ctx *);
+VCL_STRING VRT_r_obj_reason(VRT_CTX);
 
-VCL_INT VRT_r_obj_status(const struct vrt_ctx *);
+VCL_INT VRT_r_obj_status(VRT_CTX);
 
-VCL_DURATION VRT_r_obj_ttl(const struct vrt_ctx *);
+VCL_DURATION VRT_r_obj_ttl(VRT_CTX);
 
-VCL_BOOL VRT_r_obj_uncacheable(const struct vrt_ctx *);
+VCL_BOOL VRT_r_obj_uncacheable(VRT_CTX);
 
-VCL_HTTP VRT_r_req(const struct vrt_ctx *);
+VCL_HTTP VRT_r_req(VRT_CTX);
 
-VCL_BACKEND VRT_r_req_backend_hint(const struct vrt_ctx *);
-void VRT_l_req_backend_hint(const struct vrt_ctx *, VCL_BACKEND);
+VCL_BACKEND VRT_r_req_backend_hint(VRT_CTX);
+void VRT_l_req_backend_hint(VRT_CTX, VCL_BACKEND);
 
-VCL_BOOL VRT_r_req_can_gzip(const struct vrt_ctx *);
+VCL_BOOL VRT_r_req_can_gzip(VRT_CTX);
 
-VCL_BOOL VRT_r_req_esi(const struct vrt_ctx *);
-void VRT_l_req_esi(const struct vrt_ctx *, VCL_BOOL);
+VCL_BOOL VRT_r_req_esi(VRT_CTX);
+void VRT_l_req_esi(VRT_CTX, VCL_BOOL);
 
-VCL_INT VRT_r_req_esi_level(const struct vrt_ctx *);
+VCL_INT VRT_r_req_esi_level(VRT_CTX);
 
-VCL_BOOL VRT_r_req_hash_always_miss(const struct vrt_ctx *);
-void VRT_l_req_hash_always_miss(const struct vrt_ctx *, VCL_BOOL);
+VCL_BOOL VRT_r_req_hash_always_miss(VRT_CTX);
+void VRT_l_req_hash_always_miss(VRT_CTX, VCL_BOOL);
 
-VCL_BOOL VRT_r_req_hash_ignore_busy(const struct vrt_ctx *);
-void VRT_l_req_hash_ignore_busy(const struct vrt_ctx *, VCL_BOOL);
+VCL_BOOL VRT_r_req_hash_ignore_busy(VRT_CTX);
+void VRT_l_req_hash_ignore_busy(VRT_CTX, VCL_BOOL);
 
 
-VCL_STRING VRT_r_req_method(const struct vrt_ctx *);
-void VRT_l_req_method(const struct vrt_ctx *, const char *, ...);
+VCL_STRING VRT_r_req_method(VRT_CTX);
+void VRT_l_req_method(VRT_CTX, const char *, ...);
 
-VCL_STRING VRT_r_req_proto(const struct vrt_ctx *);
-void VRT_l_req_proto(const struct vrt_ctx *, const char *, ...);
+VCL_STRING VRT_r_req_proto(VRT_CTX);
+void VRT_l_req_proto(VRT_CTX, const char *, ...);
 
-VCL_INT VRT_r_req_restarts(const struct vrt_ctx *);
+VCL_INT VRT_r_req_restarts(VRT_CTX);
 
-VCL_DURATION VRT_r_req_ttl(const struct vrt_ctx *);
-void VRT_l_req_ttl(const struct vrt_ctx *, VCL_DURATION);
+VCL_DURATION VRT_r_req_ttl(VRT_CTX);
+void VRT_l_req_ttl(VRT_CTX, VCL_DURATION);
 
-VCL_STRING VRT_r_req_url(const struct vrt_ctx *);
-void VRT_l_req_url(const struct vrt_ctx *, const char *, ...);
+VCL_STRING VRT_r_req_url(VRT_CTX);
+void VRT_l_req_url(VRT_CTX, const char *, ...);
 
-VCL_STRING VRT_r_req_xid(const struct vrt_ctx *);
+VCL_STRING VRT_r_req_xid(VRT_CTX);
 
-VCL_HTTP VRT_r_resp(const struct vrt_ctx *);
+VCL_HTTP VRT_r_resp(VRT_CTX);
 
 
-VCL_STRING VRT_r_resp_proto(const struct vrt_ctx *);
-void VRT_l_resp_proto(const struct vrt_ctx *, const char *, ...);
+VCL_STRING VRT_r_resp_proto(VRT_CTX);
+void VRT_l_resp_proto(VRT_CTX, const char *, ...);
 
-VCL_STRING VRT_r_resp_reason(const struct vrt_ctx *);
-void VRT_l_resp_reason(const struct vrt_ctx *, const char *, ...);
+VCL_STRING VRT_r_resp_reason(VRT_CTX);
+void VRT_l_resp_reason(VRT_CTX, const char *, ...);
 
-VCL_INT VRT_r_resp_status(const struct vrt_ctx *);
-void VRT_l_resp_status(const struct vrt_ctx *, VCL_INT);
+VCL_INT VRT_r_resp_status(VRT_CTX);
+void VRT_l_resp_status(VRT_CTX, VCL_INT);
 
-VCL_STRING VRT_r_server_hostname(const struct vrt_ctx *);
+VCL_STRING VRT_r_server_hostname(VRT_CTX);
 
-VCL_STRING VRT_r_server_identity(const struct vrt_ctx *);
+VCL_STRING VRT_r_server_identity(VRT_CTX);
 
-VCL_IP VRT_r_server_ip(const struct vrt_ctx *);
+VCL_IP VRT_r_server_ip(VRT_CTX);
 
 double VRT_Stv_free_space(const char *);
 double VRT_Stv_used_space(const char *);
diff --git a/lib/libvarnish/vtim.c b/lib/libvarnish/vtim.c
index 50033c2..3a3ad7e 100644
--- a/lib/libvarnish/vtim.c
+++ b/lib/libvarnish/vtim.c
@@ -115,7 +115,8 @@ static const char *fmts[] = {
 	"%a, %d %b %Y %T GMT",	/* RFC 822 & RFC 1123 */
 	"%A, %d-%b-%y %T GMT",	/* RFC 850 */
 	"%a %b %d %T %Y",	/* ANSI-C asctime() */
-	"%F %T",		/* ISO 8601 */
+	"%F %T",		/* ISO 8601 (incorrect, only in 4.0) */
+	"%FT%T",		/* ISO 8601 */
 	NULL
 };
 
diff --git a/lib/libvarnishapi/vsl-tags.rst b/lib/libvarnishapi/vsl-tags.rst
index 9c53fd0..e85801a 100644
--- a/lib/libvarnishapi/vsl-tags.rst
+++ b/lib/libvarnishapi/vsl-tags.rst
@@ -499,12 +499,12 @@ TTL - TTL set on object
 	
 	The format is::
 	
-		%s %d %d %d %d %d [ %d %u %u ]
-		|  |  |  |  |  |    |  |  |
-		|  |  |  |  |  |    |  |  +- Max-Age from Cache-Control header
-		|  |  |  |  |  |    |  +---- Expires header
-		|  |  |  |  |  |    +------- Date header
-		|  |  |  |  |  +------------ Age (incl Age: header value)
+		%s %d %d %d %d [ %d %d %u %u ]
+		|  |  |  |  |    |  |  |  |
+		|  |  |  |  |    |  |  |  +- Max-Age from Cache-Control header
+		|  |  |  |  |    |  |  +---- Expires header
+		|  |  |  |  |    |  +------- Date header
+		|  |  |  |  |    +---------- Age (incl Age: header value)
 		|  |  |  |  +--------------- Reference time for TTL
 		|  |  |  +------------------ Keep
 		|  |  +--------------------- Grace
@@ -515,12 +515,8 @@ TTL - TTL set on object
 	
 	Examples::
 	
-		RFC 19 -1 -1 1312966109 4 0 0 23
-		VCL 10 -1 -1 1312966109 4
-		VCL 7 -1 -1 1312966111 6
-		VCL 7 120 -1 1312966111 6
-		VCL 7 120 3600 1312966111 6
-		VCL 12 120 3600 1312966113 8
+		RFC 60 -1 -1 1312966109 1312966109 1312966109 0 60
+		VCL 120 10 0 1312966111
 	
 
 
diff --git a/lib/libvcc/generate.py b/lib/libvcc/generate.py
index 9af3420..884fe3d 100755
--- a/lib/libvcc/generate.py
+++ b/lib/libvcc/generate.py
@@ -359,7 +359,10 @@ sp_variables = [
 	('bereq.uncacheable',
 		'BOOL',
 		( 'backend', ),
-		( 'backend', ), """
+		( ), """
+		Indicates whether this request is uncacheable due
+		to a pass in the client side or a hit on an existing
+		uncacheable object (aka hit-for-pass).
 		"""
 	),
 	('bereq.connect_timeout',
@@ -461,6 +464,13 @@ sp_variables = [
 		'BOOL',
 		( 'backend_response', 'backend_error'),
 		( 'backend_response', 'backend_error'), """
+		Inherited from bereq.uncacheable, see there.
+
+		Setting this variable makes the object uncacheable, which may
+		get stored as a hit-for-pass object in the cache.
+
+		Clearing the variable has no effect and will log the warning
+		"Ignoring attempt to reset beresp.uncacheable".
 		"""
 	),
 	('beresp.ttl',
@@ -482,6 +492,13 @@ sp_variables = [
 		'DURATION',
 		( 'backend_response', 'backend_error'),
 		( 'backend_response', 'backend_error'), """
+		Set to a period to enable conditional backend requests.
+
+		The keep time is cache lifetime in addition to the ttl.
+
+		Objects with ttl expired but with keep time left may be used
+		to issue conditional (If-Modified-Since / If-None-Match)
+		requests to the backend to refresh them.
 		"""
 	),
 	('beresp.backend.name',
@@ -531,13 +548,9 @@ sp_variables = [
 		'INT',
 		( 'hit', 'deliver',),
 		( ), """
-		The count of cache-hits on this hash-key since it was
-		last instantiated.  This counts cache-hits across all
-		Vary:-ants on this hash-key.
-		The counter will only be reset to zero if/when all objects
-		with this hash-key have disappeared from cache.
-		NB: obj.hits == 0 does *not* indicate a cache miss.
-		"""
+                The count of cache-hits on this object. A value of 0 indicates a
+		cache miss.
+                """
 	),
 	('obj.http.',
 		'HEADER',
@@ -557,19 +570,21 @@ sp_variables = [
 		'DURATION',
 		( 'hit', ),
 		( ), """
-		The object's grace period in seconds.
+		The object's remaining grace period in seconds.
 		"""
 	),
 	('obj.keep',
 		'DURATION',
 		( 'hit', ),
 		( ), """
+		The object's remaining keep period in seconds.
 		"""
 	),
 	('obj.uncacheable',
 		'BOOL',
-		( 'hit', ),
+		( 'deliver', ),
 		( ), """
+		Whether the object is uncacheable (pass or hit-for-pass).
 		"""
 	),
 	('resp',
@@ -900,6 +915,7 @@ file_header(fo)
 
 fo.write("""
 struct vrt_ctx;
+#define VRT_CTX const struct vrt_ctx *ctx
 struct req;
 struct busyobj;
 struct ws;
@@ -908,7 +924,7 @@ struct worker;
 
 typedef int vcl_init_f(struct cli *);
 typedef void vcl_fini_f(struct cli *);
-typedef int vcl_func_f(const struct vrt_ctx *ctx);
+typedef int vcl_func_f(VRT_CTX);
 """)
 
 def tbl40(a, b):
@@ -1042,7 +1058,7 @@ def one_var(nm, spec):
 		fo.write('\t    "VRT_r_%s(ctx)",\n' % cnam)
 		if nm == i[0]:
 			fh.write("VCL_" + typ +
-			    " VRT_r_%s(const struct vrt_ctx *);\n" % cnam )
+			    " VRT_r_%s(VRT_CTX);\n" % cnam )
 	restrict(fo, spec[2])
 
 	if len(spec[3]) == 0:
@@ -1055,7 +1071,7 @@ def one_var(nm, spec):
 		fo.write('\t    "VRT_l_%s(ctx, ",\n' % cnam)
 		if nm == i[0]:
 			fh.write(
-			    "void VRT_l_%s(const struct vrt_ctx *, " % cnam)
+			    "void VRT_l_%s(VRT_CTX, " % cnam)
 			if typ != "STRING":
 				fh.write("VCL_" + typ + ");\n")
 			else:
diff --git a/lib/libvcc/vcc_acl.c b/lib/libvcc/vcc_acl.c
index 997ae3c..72dd304 100644
--- a/lib/libvcc/vcc_acl.c
+++ b/lib/libvcc/vcc_acl.c
@@ -354,7 +354,7 @@ vcc_acl_emit(struct vcc *tl, const char *acln, int anon)
 
 	Fh(tl, 0, "\nstatic int\n");
 	Fh(tl, 0,
-	    "match_acl_%s_%s(const struct vrt_ctx *ctx, const VCL_IP p)\n",
+	    "match_acl_%s_%s(VRT_CTX, const VCL_IP p)\n",
 	    anon ? "anon" : "named", acln);
 	Fh(tl, 0, "{\n");
 	Fh(tl, 0, "\tconst unsigned char *a;\n");
diff --git a/lib/libvcc/vcc_backend.c b/lib/libvcc/vcc_backend.c
index 45e6f15..7c079a9 100644
--- a/lib/libvcc/vcc_backend.c
+++ b/lib/libvcc/vcc_backend.c
@@ -44,51 +44,37 @@
  */
 
 static void
-Emit_Sockaddr(struct vcc *tl, const struct token *t_host, const char *port,
-              unsigned resolve)
+Emit_Sockaddr(struct vcc *tl, const struct token *t_host, const char *port)
 {
 	const char *ipv4, *ipv4a, *ipv6, *ipv6a, *pa;
 	const char *err;
 	char *hop, *pop;
 
-    AN(t_host->dec);
-
-    err = VSS_parse(t_host->dec, &hop, &pop);
-    if (err != NULL) {
-        VSB_printf(tl->sb,
-            "Backend host '%.*s': %s\n", PF(t_host), err);
-        vcc_ErrWhere(tl, t_host);
-        return;
-    }
-
-    if (resolve) {
-        Resolve_Sockaddr(tl,
-            hop != NULL ? hop : t_host->dec,
-            pop != NULL ? pop : port,
-            &ipv4, &ipv4a, &ipv6, &ipv6a, &pa, 2, t_host, "Backend host");
-        ERRCHK(tl);
-        if (ipv4 != NULL) {
-            Fb(tl, 0, "\t.ipv4_suckaddr = (const struct suckaddr *)%s,\n",
-                ipv4);
-            Fb(tl, 0, "\t.ipv4_addr = \"%s\",\n", ipv4a);
-        }
-        if (ipv6 != NULL) {
-            Fb(tl, 0, "\t.ipv6_suckaddr = (const struct suckaddr *)%s,\n",
-                ipv6);
-            Fb(tl, 0, "\t.ipv6_addr = \"%s\",\n", ipv6a);
-        }
-        Fb(tl, 0, "\t.port = \"%s\",\n", pa);
-    }
-    else {
-        /* RevSW: Use an invalid IPv4 sockaddress (we need a non-zero
-           ipv4_suckaddr in rev_dns).
-           However, save the host and port for later resolution. */
-        Emit_Invalid_Sockaddr(tl);
-        Fb(tl, 0, "\t.ipv4_suckaddr = (const struct suckaddr *)(const void*)sockaddr_invalid4,\n");
-        Fb(tl, 0, "\t.ipv6_suckaddr = (const struct suckaddr *)(const void*)sockaddr_invalid6,\n");
-        Fb(tl, 0, "\t.host = \"%s\",\n", hop != NULL ? hop : t_host->dec);
-        Fb(tl, 0, "\t.port = \"%s\",\n", pop != NULL ? pop : port);
-    }
+	AN(t_host->dec);
+
+	err = VSS_parse(t_host->dec, &hop, &pop);
+	if (err != NULL) {
+		VSB_printf(tl->sb,
+		    "Backend host '%.*s': %s\n", PF(t_host), err);
+		vcc_ErrWhere(tl, t_host);
+		return;
+	}
+	Resolve_Sockaddr(tl,
+	    hop != NULL ? hop : t_host->dec,
+	    pop != NULL ? pop : port,
+	    &ipv4, &ipv4a, &ipv6, &ipv6a, &pa, 2, t_host, "Backend host");
+	ERRCHK(tl);
+	if (ipv4 != NULL) {
+		Fb(tl, 0, "\t.ipv4_suckaddr = (const struct suckaddr *)%s,\n",
+		    ipv4);
+		Fb(tl, 0, "\t.ipv4_addr = \"%s\",\n", ipv4a);
+	}
+	if (ipv6 != NULL) {
+		Fb(tl, 0, "\t.ipv6_suckaddr = (const struct suckaddr *)%s,\n",
+		    ipv6);
+		Fb(tl, 0, "\t.ipv6_addr = \"%s\",\n", ipv6a);
+	}
+	Fb(tl, 0, "\t.port = \"%s\",\n", pa);
 }
 
 /*--------------------------------------------------------------------
@@ -294,7 +280,6 @@ vcc_ParseHostDef(struct vcc *tl, const struct token *t_be)
 	unsigned u;
 	double t;
 	char vgcname[MAX_BACKEND_NAME + 8];
-    unsigned resolve_host = 1;
 
 	sprintf(vgcname, "_%.*s", PF(t_be));
 
@@ -309,7 +294,6 @@ vcc_ParseHostDef(struct vcc *tl, const struct token *t_be)
 	    "?between_bytes_timeout",
 	    "?probe",
 	    "?max_connections",
-        "?preresolve_dns",
 	    NULL);
 
 	SkipToken(tl, '{');
@@ -397,28 +381,23 @@ vcc_ParseHostDef(struct vcc *tl, const struct token *t_be)
 			VSB_printf(tl->sb, " at\n");
 			vcc_ErrWhere(tl, tl->t);
 			return;
-        } else if (vcc_IdIs(t_field, "preresolve_dns")) {
-            // RevSW: dynamic DNS resolution instead of compiled-in
-            u = vcc_UintVal(tl);
-            ERRCHK(tl);
-            SkipToken(tl, ';');
-            resolve_host = u;
 		} else {
 			ErrInternal(tl);
 			return;
 		}
+
 	}
 
 	vcc_FieldsOk(tl, fs);
 	ERRCHK(tl);
 
 	/* Check that the hostname makes sense */
-    assert(t_host != NULL);
-    if (t_port != NULL)
-        Emit_Sockaddr(tl, t_host, t_port->dec, resolve_host);
-    else
-        Emit_Sockaddr(tl, t_host, "80", resolve_host);
-    ERRCHK(tl);
+	assert(t_host != NULL);
+	if (t_port != NULL)
+		Emit_Sockaddr(tl, t_host, t_port->dec);
+	else
+		Emit_Sockaddr(tl, t_host, "80");
+	ERRCHK(tl);
 
 	ExpectErr(tl, '}');
 
diff --git a/lib/libvcc/vcc_compile.c b/lib/libvcc/vcc_compile.c
index 4077c1c..5a47390 100644
--- a/lib/libvcc/vcc_compile.c
+++ b/lib/libvcc/vcc_compile.c
@@ -211,6 +211,7 @@ EncString(struct vsb *sb, const char *b, const char *e, int mode)
 	VSB_cat(sb, "\"");
 	for (; b < e; b++) {
 		switch (*b) {
+		case '?':	// Trigraphs
 		case '\\':
 		case '"':
 			VSB_printf(sb, "\\%c", *b);
@@ -670,11 +671,11 @@ vcc_CompileSource(const struct vcc *tl0, struct vsb *sb, struct source *sp)
 	for (i = 1; i < VCL_MET_MAX; i++) {
 		Fh(tl, 1, "\nint __match_proto__(vcl_func_f)\n");
 		Fh(tl, 1,
-		    "VGC_function_%s(const struct vrt_ctx *ctx);\n",
+		    "VGC_function_%s(VRT_CTX);\n",
 		    method_tab[i].name);
 		Fc(tl, 1, "\nint __match_proto__(vcl_func_f)\n");
 		Fc(tl, 1,
-		    "VGC_function_%s(const struct vrt_ctx *ctx)\n",
+		    "VGC_function_%s(VRT_CTX)\n",
 		    method_tab[i].name);
 		AZ(VSB_finish(tl->fm[i]));
 		Fc(tl, 1, "{\n");
diff --git a/lib/libvcc/vcc_compile.h b/lib/libvcc/vcc_compile.h
index 0e466c6..128916b 100644
--- a/lib/libvcc/vcc_compile.h
+++ b/lib/libvcc/vcc_compile.h
@@ -201,7 +201,6 @@ struct vcc {
 	struct token		*t_defaultdir;
 
 	unsigned		unique;
-    unsigned        emitted_invalid_sockaddr;    /* RevSW: invalid IPv4 addr for rev_dns */
 
 	unsigned		err_unref;
 	unsigned		allow_inline_c;
@@ -235,7 +234,7 @@ void vcc_Acl_Hack(struct vcc *tl, char *b);
 int vcc_ParseAction(struct vcc *tl);
 
 /* vcc_backend.c */
-#define MAX_BACKEND_NAME	128
+#define MAX_BACKEND_NAME	64
 struct fld_spec;
 
 void vcc_ParseProbe(struct vcc *tl);
@@ -297,7 +296,6 @@ void Resolve_Sockaddr(struct vcc *tl, const char *host, const char *port, \
     const char **ipv4, const char **ipv4_ascii, const char **ipv6, \
     const char **ipv6_ascii, const char **p_ascii, int maxips,
     const struct token *t_err, const char *errid);
-void Emit_Invalid_Sockaddr(struct vcc *tl);
 
 /* vcc_symb.c */
 struct symbol *VCC_AddSymbolStr(struct vcc *tl, const char *name, enum symkind);
diff --git a/lib/libvcc/vcc_expr.c b/lib/libvcc/vcc_expr.c
index 657e0d2..f18b39c 100644
--- a/lib/libvcc/vcc_expr.c
+++ b/lib/libvcc/vcc_expr.c
@@ -668,10 +668,11 @@ vcc_Eval_SymFunc(struct vcc *tl, struct expr **e, const struct symbol *sym)
 static void
 vcc_expr4(struct vcc *tl, struct expr **e, enum var_type fmt)
 {
-	struct expr *e1, *e2, *e3;
+	struct expr *e1, *e2;
 	const char *ip;
 	const struct symbol *sym;
 	double d;
+	int i;
 
 	*e = NULL;
 	if (tl->t->tok == '(') {
@@ -683,28 +684,7 @@ vcc_expr4(struct vcc *tl, struct expr **e, enum var_type fmt)
 		return;
 	}
 	switch(tl->t->tok) {
-    case ID:
-        /* RevSW: add support for 'if(expr, expr_if_true, expr_if_false)' */
-        if (vcc_IdIs(tl->t, "if")) {
-            SkipToken(tl, ID);
-            SkipToken(tl, '(');
-            vcc_expr0(tl, &e1, BOOL);
-            ERRCHK(tl);
-
-            SkipToken(tl, ',');
-            e2 = NULL;
-            vcc_expr0(tl, &e2, fmt);
-            ERRCHK(tl);
-            SkipToken(tl, ',');
-            e3 = NULL;
-            vcc_expr0(tl, &e3, fmt);
-            SkipToken(tl, ')');
-
-            e2 = vcc_expr_edit(fmt, "(\v1) : (\v2)", e2, e3);
-            *e = vcc_expr_edit(fmt, "((\v1) ? \v2)", e1, e2);
-            return;
-        }
-
+	case ID:
 		/*
 		 * XXX: what if var and func/proc had same name ?
 		 * XXX: look for SYM_VAR first for consistency ?
@@ -786,9 +766,15 @@ vcc_expr4(struct vcc *tl, struct expr **e, enum var_type fmt)
 		} else if (fmt == REAL) {
 			e1 = vcc_mk_expr(REAL, "%f", vcc_DoubleVal(tl));
 			ERRCHK(tl);
-		} else {
+		} else if (fmt == INT) {
 			e1 = vcc_mk_expr(INT, "%.*s", PF(tl->t));
 			vcc_NextToken(tl);
+		} else {
+			vcc_NumVal(tl, &d, &i);
+			if (i)
+				e1 = vcc_mk_expr(REAL, "%f", d);
+			else
+				e1 = vcc_mk_expr(INT, "%ld", (long)d);
 		}
 		e1->constant = EXPR_CONST;
 		*e = e1;
@@ -1005,6 +991,7 @@ static const struct cmps {
 	NUM_REL(DURATION),
 	NUM_REL(BYTES),
 	NUM_REL(REAL),
+	NUM_REL(TIME),
 
 	{STRING,	T_EQ,	"!VRT_strcmp(\v1, \v2)" },
 	{STRING,	T_NEQ,	"VRT_strcmp(\v1, \v2)" },
diff --git a/lib/libvcc/vcc_fixed_token.c b/lib/libvcc/vcc_fixed_token.c
index b3295a5..6be2f03 100644
--- a/lib/libvcc/vcc_fixed_token.c
+++ b/lib/libvcc/vcc_fixed_token.c
@@ -129,13 +129,13 @@ vcl_output_lang_h(struct vsb *sb)
 	VSB_cat(sb, "/* ---===### include/vcl.h ###===--- */\n\n");
 	VSB_cat(sb, "/*\n * NB:  This file is machine generated, DO "
 	    "NOT EDIT!\n *\n * Edit and run generate.py instead\n"
-	    " */\n\nstruct vrt_ctx;\nstruct req;\nstruct busyobj;\n"
-	    "struct ws;\nstruct cli;\nstruct worker;\n\ntypedef int vcl_init_"
-	    "f(struct cli *);\ntypedef void vcl_fini_f(struct cli *);\n"
-	    "typedef int vcl_func_f(const struct vrt_ctx *ctx);\n"
-	    "\n/* VCL Methods */\n#define VCL_MET_RECV\t\t\t(1U << 1)\n"
-	    "#define VCL_MET_PIPE\t\t\t(1U << 2)\n#define VCL_MET_PASS\t"
-	    "\t\t(1U << 3)\n#define VCL_MET_HASH\t\t\t(1U << 4)\n"
+	    " */\n\nstruct vrt_ctx;\n#define VRT_CTX const struct vrt_ctx "
+	    "*ctx\nstruct req;\nstruct busyobj;\nstruct ws;\nstruct cli;\n"
+	    "struct worker;\n\ntypedef int vcl_init_f(struct cli *);\n"
+	    "typedef void vcl_fini_f(struct cli *);\ntypedef int vcl_func_f(V"
+	    "RT_CTX);\n\n/* VCL Methods */\n#define VCL_MET_RECV\t\t\t(1U "
+	    "<< 1)\n#define VCL_MET_PIPE\t\t\t(1U << 2)\n#define VCL_MET_PASS"
+	    "\t\t\t(1U << 3)\n#define VCL_MET_HASH\t\t\t(1U << 4)\n"
 	    "#define VCL_MET_PURGE\t\t\t(1U << 5)\n#define VCL_MET_MISS\t"
 	    "\t\t(1U << 6)\n#define VCL_MET_HIT\t\t\t(1U << 7)\n"
 	    "#define VCL_MET_DELIVER\t\t\t(1U << 8)\n#define VCL_MET_SYNTH\t"
@@ -230,11 +230,12 @@ vcl_output_lang_h(struct vsb *sb)
 	    "\tstruct http\t\t\t*http_req;\n\tstruct http\t\t\t*http_obj;\n"
 	    "\tstruct http\t\t\t*http_resp;\n\n\tstruct busyobj\t\t\t*bo;\n"
 	    "\tstruct http\t\t\t*http_bereq;\n\tstruct http\t\t\t*http_beresp"
-	    ";\n\n\tdouble\t\t\t\tnow;\n};\n\n/******************************"
-	    "*****************************************/\n\nstruct vmod_data "
-	    "{\n\t/* The version/id fields must be first, they protect "
-	    "the rest */\n\tunsigned\t\t\tvrt_major;\n\tunsigned\t\t\tvrt_min"
-	    "or;\n\tconst char\t\t\t*file_id;\n\n\tconst char\t\t\t*name;\n"
+	    ";\n\n\tdouble\t\t\t\tnow;\n};\n\n#define VRT_CTX\t\tconst "
+	    "struct vrt_ctx *ctx\n\n/****************************************"
+	    "*******************************/\n\nstruct vmod_data {\n"
+	    "\t/* The version/id fields must be first, they protect the "
+	    "rest */\n\tunsigned\t\t\tvrt_major;\n\tunsigned\t\t\tvrt_minor;\n"
+	    "\tconst char\t\t\t*file_id;\n\n\tconst char\t\t\t*name;\n"
 	    "\tconst void\t\t\t*func;\n\tint\t\t\t\tfunc_len;\n"
 	    "\tconst char\t\t\t*proto;\n\tconst char\t\t\t* const *spec;\n"
 	    "\tconst char\t\t\t*abi;\n};\n\n/********************************"
@@ -251,63 +252,54 @@ vcl_output_lang_h(struct vsb *sb)
 	    "\n/*\n * A backend is a host+port somewhere on the network\n"
 	    " */\nstruct vrt_backend {\n\tconst char\t\t\t*vcl_name;\n"
 	    "\tconst char\t\t\t*ipv4_addr;\n\tconst char\t\t\t*ipv6_addr;\n"
-	    "    const char\t\t\t*host;\n\tconst char\t\t\t*port;\n"
-	    "\n\tconst struct suckaddr\t\t*ipv4_suckaddr;\n\tconst struct "
-	    "suckaddr\t\t*ipv6_suckaddr;\n\n\tconst char\t\t\t*hosthdr;\n"
-	    "\n\tdouble\t\t\t\tconnect_timeout;\n\tdouble\t\t\t\tfirst_byte_t"
-	    "imeout;\n\tdouble\t\t\t\tbetween_bytes_timeout;\n"
-	    "\tunsigned\t\t\tmax_connections;\n\tconst struct vrt_backend_pro"
-	    "be\t*probe;\n};\n\n/*\n * other stuff.\n * XXX: document when "
-	    "bored\n */\n\nstruct vrt_ref {\n\tunsigned\tsource;\n"
-	    "\tunsigned\toffset;\n\tunsigned\tline;\n\tunsigned\tpos;\n"
-	    "\tunsigned\tcount;\n\tconst char\t*token;\n};\n\n"
-	    "/* ACL related */\n#define VRT_ACL_MAXADDR\t\t16\t/* max(IPv4, "
-	    "IPv6) */\n\nvoid VRT_acl_log(const struct vrt_ctx *, const "
-	    "char *msg);\n\n/* req related */\n\nint VRT_CacheReqBody(const "
-	    "struct vrt_ctx *, long long maxsize);\n\n/* Regexp related "
-	    "*/\nvoid VRT_re_init(void **, const char *);\nvoid VRT_re_fini(v"
-	    "oid *);\nint VRT_re_match(const struct vrt_ctx *, const char "
-	    "*, void *re);\nconst char *VRT_regsub(const struct vrt_ctx "
-	    "*, int all, const char *,\n    void *, const char *);\n"
-	    "\nvoid VRT_ban_string(const struct vrt_ctx *, const char *);\n"
-	    "void VRT_purge(const struct vrt_ctx *, double ttl, double "
-	    "grace, double keep);\n\nvoid VRT_count(const struct vrt_ctx "
-	    "*, unsigned);\nint VRT_rewrite(const char *, const char *);\n"
-	    "void VRT_error(const struct vrt_ctx *, unsigned, const char "
-	    "*);\nint VRT_switch_config(const char *);\n\nchar *VRT_GetHdr(co"
-	    "nst struct vrt_ctx *, const struct gethdr_s *);\n"
-	    "void VRT_SetHdr(const struct vrt_ctx *, const struct gethdr_s "
-	    "*,\n    const char *, ...);\nvoid VRT_handling(const struct "
-	    "vrt_ctx *, unsigned hand);\n\nvoid VRT_hashdata(const struct "
-	    "vrt_ctx *, const char *str, ...);\n\n/* Simple stuff */\n"
-	    "int VRT_strcmp(const char *s1, const char *s2);\n"
-	    "void VRT_memmove(void *dst, const void *src, unsigned len);\n"
-	    "\nvoid VRT_Rollback(const struct vrt_ctx *, const struct http "
-	    "*);\n\n/* Synthetic pages */\nvoid VRT_synth_page(const struct "
-	    "vrt_ctx *, const char *, ...);\n\n/* Backend related */\n"
-	    "void VRT_init_dir(struct cli *, struct director **, int idx, "
-	    "const void *priv);\nvoid VRT_fini_dir(struct cli *, struct "
-	    "director *);\n\n/* RevSW: get the VCL backend from a simple "
-	    "director */\nconst struct vrt_backend *\nVRT_get_backend(struct "
-	    "cli *, struct director *);\n\n/* Suckaddr related */\n"
-	    "int VRT_VSA_GetPtr(const struct suckaddr *sua, const unsigned "
-	    "char ** dst);\n\n/* VMOD/Modules related */\nint VRT_Vmod_Init(v"
-	    "oid **hdl, void *ptr, int len, const char *nm,\n    const "
-	    "char *path, const char *file_id, struct cli *cli);\n"
-	    "void VRT_Vmod_Fini(void **hdl);\n\nstruct vmod_priv;\n"
-	    "typedef void vmod_priv_free_f(void *);\nstruct vmod_priv {\n"
-	    "\tvoid\t\t\t*priv;\n\tint\t\t\tlen;\n\tvmod_priv_free_f\t*free;\n"
-	    "};\n\ntypedef int vmod_init_f(struct vmod_priv *,  const struct "
-	    "VCL_conf *);\n\nvoid VRT_priv_fini(const struct vmod_priv "
-	    "*p);\n\n/* Stevedore related functions */\nint VRT_Stv(const "
-	    "char *nm);\n\n/* Convert things to string */\n\nchar *VRT_IP_str"
-	    "ing(const struct vrt_ctx *, VCL_IP);\nchar *VRT_INT_string(const"
-	    " struct vrt_ctx *, VCL_INT);\nchar *VRT_REAL_string(const "
-	    "struct vrt_ctx *, VCL_REAL);\nchar *VRT_TIME_string(const "
-	    "struct vrt_ctx *, VCL_TIME);\nconst char *VRT_BOOL_string(VCL_BO"
-	    "OL);\nconst char *VRT_BACKEND_string(VCL_BACKEND);\n"
-	    "const char *VRT_CollectString(const struct vrt_ctx *, const "
-	    "char *p, ...);\n"
+	    "\tconst char\t\t\t*port;\n\n\tconst struct suckaddr\t\t*ipv4_suc"
+	    "kaddr;\n\tconst struct suckaddr\t\t*ipv6_suckaddr;\n"
+	    "\n\tconst char\t\t\t*hosthdr;\n\n\tdouble\t\t\t\tconnect_timeout"
+	    ";\n\tdouble\t\t\t\tfirst_byte_timeout;\n\tdouble\t\t\t\tbetween_"
+	    "bytes_timeout;\n\tunsigned\t\t\tmax_connections;\n"
+	    "\tconst struct vrt_backend_probe\t*probe;\n};\n\n"
+	    "/*\n * other stuff.\n * XXX: document when bored\n"
+	    " */\n\nstruct vrt_ref {\n\tunsigned\tsource;\n\tunsigned\toffset"
+	    ";\n\tunsigned\tline;\n\tunsigned\tpos;\n\tunsigned\tcount;\n"
+	    "\tconst char\t*token;\n};\n\n/* ACL related */\n#define VRT_ACL_"
+	    "MAXADDR\t\t16\t/* max(IPv4, IPv6) */\n\nvoid VRT_acl_log(VRT_CTX"
+	    ", const char *msg);\n\n/* req related */\n\nint VRT_CacheReqBody"
+	    "(VRT_CTX, long long maxsize);\n\n/* Regexp related */\n"
+	    "void VRT_re_init(void **, const char *);\nvoid VRT_re_fini(void "
+	    "*);\nint VRT_re_match(VRT_CTX, const char *, void *re);\n"
+	    "const char *VRT_regsub(VRT_CTX, int all, const char *, void "
+	    "*, const char *);\n\nvoid VRT_ban_string(VRT_CTX, const char "
+	    "*);\nvoid VRT_purge(VRT_CTX, double ttl, double grace, double "
+	    "keep);\n\nvoid VRT_count(VRT_CTX, unsigned);\nint VRT_rewrite(co"
+	    "nst char *, const char *);\nvoid VRT_error(VRT_CTX, unsigned, "
+	    "const char *);\nint VRT_switch_config(const char *);\n"
+	    "\nchar *VRT_GetHdr(VRT_CTX, const struct gethdr_s *);\n"
+	    "void VRT_SetHdr(VRT_CTX, const struct gethdr_s *, const char "
+	    "*, ...);\nvoid VRT_handling(VRT_CTX, unsigned hand);\n"
+	    "\nvoid VRT_hashdata(VRT_CTX, const char *str, ...);\n"
+	    "\n/* Simple stuff */\nint VRT_strcmp(const char *s1, const "
+	    "char *s2);\nvoid VRT_memmove(void *dst, const void *src, unsigne"
+	    "d len);\n\nvoid VRT_Rollback(VRT_CTX, const struct http *);\n"
+	    "\n/* Synthetic pages */\nvoid VRT_synth_page(VRT_CTX, const "
+	    "char *, ...);\n\n/* Backend related */\nvoid VRT_init_dir(struct"
+	    " cli *, struct director **, int idx, const void *priv);\n"
+	    "void VRT_fini_dir(struct cli *, struct director *);\n"
+	    "\n/* Suckaddr related */\nint VRT_VSA_GetPtr(const struct "
+	    "suckaddr *sua, const unsigned char ** dst);\n\n/* VMOD/Modules "
+	    "related */\nint VRT_Vmod_Init(void **hdl, void *ptr, int len, "
+	    "const char *nm,\n    const char *path, const char *file_id, "
+	    "struct cli *cli);\nvoid VRT_Vmod_Fini(void **hdl);\n"
+	    "\nstruct vmod_priv;\ntypedef void vmod_priv_free_f(void *);\n"
+	    "struct vmod_priv {\n\tvoid\t\t\t*priv;\n\tint\t\t\tlen;\n"
+	    "\tvmod_priv_free_f\t*free;\n};\n\ntypedef int vmod_init_f(struct"
+	    " vmod_priv *,  const struct VCL_conf *);\n\nvoid VRT_priv_fini(c"
+	    "onst struct vmod_priv *p);\n\n/* Stevedore related functions "
+	    "*/\nint VRT_Stv(const char *nm);\n\n/* Convert things to string "
+	    "*/\n\nchar *VRT_IP_string(VRT_CTX, VCL_IP);\nchar *VRT_INT_strin"
+	    "g(VRT_CTX, VCL_INT);\nchar *VRT_REAL_string(VRT_CTX, VCL_REAL);\n"
+	    "char *VRT_TIME_string(VRT_CTX, VCL_TIME);\nconst char *VRT_BOOL_"
+	    "string(VCL_BOOL);\nconst char *VRT_BACKEND_string(VCL_BACKEND);\n"
+	    "const char *VRT_CollectString(VRT_CTX, const char *p, ...);\n"
 	);
 	VSB_cat(sb, "\n");
 
@@ -316,98 +308,75 @@ vcl_output_lang_h(struct vsb *sb)
 	VSB_cat(sb, "/* ---===### include/vrt_obj.h ###===--- */\n\n");
 	VSB_cat(sb, "/*\n * NB:  This file is machine generated, DO "
 	    "NOT EDIT!\n *\n * Edit and run generate.py instead\n"
-	    " */\n\nVCL_HTTP VRT_r_bereq(const struct vrt_ctx *);\n"
-	    "\nVCL_BACKEND VRT_r_bereq_backend(const struct vrt_ctx *);\n"
-	    "void VRT_l_bereq_backend(const struct vrt_ctx *, VCL_BACKEND);\n"
-	    "\nVCL_DURATION VRT_r_bereq_between_bytes_timeout(const struct "
-	    "vrt_ctx *);\nvoid VRT_l_bereq_between_bytes_timeout(const "
-	    "struct vrt_ctx *, VCL_DURATION);\n\nVCL_DURATION VRT_r_bereq_con"
-	    "nect_timeout(const struct vrt_ctx *);\nvoid VRT_l_bereq_connect_"
-	    "timeout(const struct vrt_ctx *, VCL_DURATION);\n\n"
-	    "VCL_DURATION VRT_r_bereq_first_byte_timeout(const struct vrt_ctx"
-	    " *);\nvoid VRT_l_bereq_first_byte_timeout(const struct vrt_ctx "
-	    "*, VCL_DURATION);\n\n\nVCL_STRING VRT_r_bereq_method(const "
-	    "struct vrt_ctx *);\nvoid VRT_l_bereq_method(const struct vrt_ctx"
-	    " *, const char *, ...);\n\nVCL_STRING VRT_r_bereq_proto(const "
-	    "struct vrt_ctx *);\nvoid VRT_l_bereq_proto(const struct vrt_ctx "
-	    "*, const char *, ...);\n\nVCL_INT VRT_r_bereq_retries(const "
-	    "struct vrt_ctx *);\n\nVCL_BOOL VRT_r_bereq_uncacheable(const "
-	    "struct vrt_ctx *);\nvoid VRT_l_bereq_uncacheable(const struct "
-	    "vrt_ctx *, VCL_BOOL);\n\nVCL_STRING VRT_r_bereq_url(const "
-	    "struct vrt_ctx *);\nvoid VRT_l_bereq_url(const struct vrt_ctx "
-	    "*, const char *, ...);\n\nVCL_STRING VRT_r_bereq_xid(const "
-	    "struct vrt_ctx *);\n\nVCL_HTTP VRT_r_beresp(const struct vrt_ctx"
-	    " *);\n\nVCL_IP VRT_r_beresp_backend_ip(const struct vrt_ctx "
-	    "*);\n\nVCL_STRING VRT_r_beresp_backend_name(const struct vrt_ctx"
-	    " *);\n\nVCL_BOOL VRT_r_beresp_do_esi(const struct vrt_ctx "
-	    "*);\nvoid VRT_l_beresp_do_esi(const struct vrt_ctx *, VCL_BOOL);"
-	    "\n\nVCL_BOOL VRT_r_beresp_do_gunzip(const struct vrt_ctx *);\n"
-	    "void VRT_l_beresp_do_gunzip(const struct vrt_ctx *, VCL_BOOL);\n"
-	    "\nVCL_BOOL VRT_r_beresp_do_gzip(const struct vrt_ctx *);\n"
-	    "void VRT_l_beresp_do_gzip(const struct vrt_ctx *, VCL_BOOL);\n"
-	    "\nVCL_BOOL VRT_r_beresp_do_stream(const struct vrt_ctx *);\n"
-	    "void VRT_l_beresp_do_stream(const struct vrt_ctx *, VCL_BOOL);\n"
-	    "\nVCL_DURATION VRT_r_beresp_grace(const struct vrt_ctx *);\n"
-	    "void VRT_l_beresp_grace(const struct vrt_ctx *, VCL_DURATION);\n"
-	    "\n\nVCL_DURATION VRT_r_beresp_keep(const struct vrt_ctx *);\n"
-	    "void VRT_l_beresp_keep(const struct vrt_ctx *, VCL_DURATION);\n"
-	    "\nVCL_STRING VRT_r_beresp_proto(const struct vrt_ctx *);\n"
-	    "void VRT_l_beresp_proto(const struct vrt_ctx *, const char "
-	    "*, ...);\n\nVCL_STRING VRT_r_beresp_reason(const struct vrt_ctx "
-	    "*);\nvoid VRT_l_beresp_reason(const struct vrt_ctx *, const "
-	    "char *, ...);\n\nVCL_INT VRT_r_beresp_status(const struct "
-	    "vrt_ctx *);\nvoid VRT_l_beresp_status(const struct vrt_ctx "
-	    "*, VCL_INT);\n\nVCL_STRING VRT_r_beresp_storage_hint(const "
-	    "struct vrt_ctx *);\nvoid VRT_l_beresp_storage_hint(const struct "
-	    "vrt_ctx *, const char *, ...);\n\nVCL_DURATION VRT_r_beresp_ttl("
-	    "const struct vrt_ctx *);\nvoid VRT_l_beresp_ttl(const struct "
-	    "vrt_ctx *, VCL_DURATION);\n\nVCL_BOOL VRT_r_beresp_uncacheable(c"
-	    "onst struct vrt_ctx *);\nvoid VRT_l_beresp_uncacheable(const "
-	    "struct vrt_ctx *, VCL_BOOL);\n\nVCL_STRING VRT_r_client_identity"
-	    "(const struct vrt_ctx *);\nvoid VRT_l_client_identity(const "
-	    "struct vrt_ctx *, const char *, ...);\n\nVCL_IP VRT_r_client_ip("
-	    "const struct vrt_ctx *);\n\nVCL_TIME VRT_r_now(const struct "
-	    "vrt_ctx *);\n\nVCL_DURATION VRT_r_obj_grace(const struct vrt_ctx"
-	    " *);\n\nVCL_INT VRT_r_obj_hits(const struct vrt_ctx *);\n"
-	    "\n\nVCL_DURATION VRT_r_obj_keep(const struct vrt_ctx *);\n"
-	    "\nVCL_STRING VRT_r_obj_proto(const struct vrt_ctx *);\n"
-	    "\nVCL_STRING VRT_r_obj_reason(const struct vrt_ctx *);\n"
-	    "\nVCL_INT VRT_r_obj_status(const struct vrt_ctx *);\n"
-	    "\nVCL_DURATION VRT_r_obj_ttl(const struct vrt_ctx *);\n"
-	    "\nVCL_BOOL VRT_r_obj_uncacheable(const struct vrt_ctx *);\n"
-	    "\nVCL_HTTP VRT_r_req(const struct vrt_ctx *);\n\n"
-	    "VCL_BACKEND VRT_r_req_backend_hint(const struct vrt_ctx *);\n"
-	    "void VRT_l_req_backend_hint(const struct vrt_ctx *, VCL_BACKEND)"
-	    ";\n\nVCL_BOOL VRT_r_req_can_gzip(const struct vrt_ctx *);\n"
-	    "\nVCL_BOOL VRT_r_req_esi(const struct vrt_ctx *);\n"
-	    "void VRT_l_req_esi(const struct vrt_ctx *, VCL_BOOL);\n"
-	    "\nVCL_INT VRT_r_req_esi_level(const struct vrt_ctx *);\n"
-	    "\nVCL_BOOL VRT_r_req_hash_always_miss(const struct vrt_ctx "
-	    "*);\nvoid VRT_l_req_hash_always_miss(const struct vrt_ctx "
-	    "*, VCL_BOOL);\n\nVCL_BOOL VRT_r_req_hash_ignore_busy(const "
-	    "struct vrt_ctx *);\nvoid VRT_l_req_hash_ignore_busy(const "
-	    "struct vrt_ctx *, VCL_BOOL);\n\n\nVCL_STRING VRT_r_req_method(co"
-	    "nst struct vrt_ctx *);\nvoid VRT_l_req_method(const struct "
-	    "vrt_ctx *, const char *, ...);\n\nVCL_STRING VRT_r_req_proto(con"
-	    "st struct vrt_ctx *);\nvoid VRT_l_req_proto(const struct vrt_ctx"
-	    " *, const char *, ...);\n\nVCL_INT VRT_r_req_restarts(const "
-	    "struct vrt_ctx *);\n\nVCL_DURATION VRT_r_req_ttl(const struct "
-	    "vrt_ctx *);\nvoid VRT_l_req_ttl(const struct vrt_ctx *, VCL_DURA"
-	    "TION);\n\nVCL_STRING VRT_r_req_url(const struct vrt_ctx *);\n"
-	    "void VRT_l_req_url(const struct vrt_ctx *, const char *, ...);\n"
-	    "\nVCL_STRING VRT_r_req_xid(const struct vrt_ctx *);\n"
-	    "\nVCL_HTTP VRT_r_resp(const struct vrt_ctx *);\n\n"
-	    "\nVCL_STRING VRT_r_resp_proto(const struct vrt_ctx *);\n"
-	    "void VRT_l_resp_proto(const struct vrt_ctx *, const char *, "
-	    "...);\n\nVCL_STRING VRT_r_resp_reason(const struct vrt_ctx "
-	    "*);\nvoid VRT_l_resp_reason(const struct vrt_ctx *, const "
-	    "char *, ...);\n\nVCL_INT VRT_r_resp_status(const struct vrt_ctx "
-	    "*);\nvoid VRT_l_resp_status(const struct vrt_ctx *, VCL_INT);\n"
-	    "\nVCL_STRING VRT_r_server_hostname(const struct vrt_ctx *);\n"
-	    "\nVCL_STRING VRT_r_server_identity(const struct vrt_ctx *);\n"
-	    "\nVCL_IP VRT_r_server_ip(const struct vrt_ctx *);\n"
-	    "\ndouble VRT_Stv_free_space(const char *);\ndouble VRT_Stv_used_"
-	    "space(const char *);\nunsigned VRT_Stv_happy(const char *);\n"
+	    " */\n\nVCL_HTTP VRT_r_bereq(VRT_CTX);\n\nVCL_BACKEND VRT_r_bereq"
+	    "_backend(VRT_CTX);\nvoid VRT_l_bereq_backend(VRT_CTX, VCL_BACKEN"
+	    "D);\n\nVCL_DURATION VRT_r_bereq_between_bytes_timeout(VRT_CTX);\n"
+	    "void VRT_l_bereq_between_bytes_timeout(VRT_CTX, VCL_DURATION);\n"
+	    "\nVCL_DURATION VRT_r_bereq_connect_timeout(VRT_CTX);\n"
+	    "void VRT_l_bereq_connect_timeout(VRT_CTX, VCL_DURATION);\n"
+	    "\nVCL_DURATION VRT_r_bereq_first_byte_timeout(VRT_CTX);\n"
+	    "void VRT_l_bereq_first_byte_timeout(VRT_CTX, VCL_DURATION);\n"
+	    "\n\nVCL_STRING VRT_r_bereq_method(VRT_CTX);\nvoid VRT_l_bereq_me"
+	    "thod(VRT_CTX, const char *, ...);\n\nVCL_STRING VRT_r_bereq_prot"
+	    "o(VRT_CTX);\nvoid VRT_l_bereq_proto(VRT_CTX, const char *, "
+	    "...);\n\nVCL_INT VRT_r_bereq_retries(VRT_CTX);\n\n"
+	    "VCL_BOOL VRT_r_bereq_uncacheable(VRT_CTX);\n\nVCL_STRING VRT_r_b"
+	    "ereq_url(VRT_CTX);\nvoid VRT_l_bereq_url(VRT_CTX, const char "
+	    "*, ...);\n\nVCL_STRING VRT_r_bereq_xid(VRT_CTX);\n"
+	    "\nVCL_HTTP VRT_r_beresp(VRT_CTX);\n\nVCL_IP VRT_r_beresp_backend"
+	    "_ip(VRT_CTX);\n\nVCL_STRING VRT_r_beresp_backend_name(VRT_CTX);\n"
+	    "\nVCL_BOOL VRT_r_beresp_do_esi(VRT_CTX);\nvoid VRT_l_beresp_do_e"
+	    "si(VRT_CTX, VCL_BOOL);\n\nVCL_BOOL VRT_r_beresp_do_gunzip(VRT_CT"
+	    "X);\nvoid VRT_l_beresp_do_gunzip(VRT_CTX, VCL_BOOL);\n"
+	    "\nVCL_BOOL VRT_r_beresp_do_gzip(VRT_CTX);\nvoid VRT_l_beresp_do_"
+	    "gzip(VRT_CTX, VCL_BOOL);\n\nVCL_BOOL VRT_r_beresp_do_stream(VRT_"
+	    "CTX);\nvoid VRT_l_beresp_do_stream(VRT_CTX, VCL_BOOL);\n"
+	    "\nVCL_DURATION VRT_r_beresp_grace(VRT_CTX);\nvoid VRT_l_beresp_g"
+	    "race(VRT_CTX, VCL_DURATION);\n\n\nVCL_DURATION VRT_r_beresp_keep"
+	    "(VRT_CTX);\nvoid VRT_l_beresp_keep(VRT_CTX, VCL_DURATION);\n"
+	    "\nVCL_STRING VRT_r_beresp_proto(VRT_CTX);\nvoid VRT_l_beresp_pro"
+	    "to(VRT_CTX, const char *, ...);\n\nVCL_STRING VRT_r_beresp_reaso"
+	    "n(VRT_CTX);\nvoid VRT_l_beresp_reason(VRT_CTX, const char "
+	    "*, ...);\n\nVCL_INT VRT_r_beresp_status(VRT_CTX);\n"
+	    "void VRT_l_beresp_status(VRT_CTX, VCL_INT);\n\nVCL_STRING "
+	    "VRT_r_beresp_storage_hint(VRT_CTX);\nvoid VRT_l_beresp_storage_h"
+	    "int(VRT_CTX, const char *, ...);\n\nVCL_DURATION VRT_r_beresp_tt"
+	    "l(VRT_CTX);\nvoid VRT_l_beresp_ttl(VRT_CTX, VCL_DURATION);\n"
+	    "\nVCL_BOOL VRT_r_beresp_uncacheable(VRT_CTX);\nvoid VRT_l_beresp"
+	    "_uncacheable(VRT_CTX, VCL_BOOL);\n\nVCL_STRING VRT_r_client_iden"
+	    "tity(VRT_CTX);\nvoid VRT_l_client_identity(VRT_CTX, const "
+	    "char *, ...);\n\nVCL_IP VRT_r_client_ip(VRT_CTX);\n"
+	    "\nVCL_TIME VRT_r_now(VRT_CTX);\n\nVCL_DURATION VRT_r_obj_grace(V"
+	    "RT_CTX);\n\nVCL_INT VRT_r_obj_hits(VRT_CTX);\n\n\n"
+	    "VCL_DURATION VRT_r_obj_keep(VRT_CTX);\n\nVCL_STRING VRT_r_obj_pr"
+	    "oto(VRT_CTX);\n\nVCL_STRING VRT_r_obj_reason(VRT_CTX);\n"
+	    "\nVCL_INT VRT_r_obj_status(VRT_CTX);\n\nVCL_DURATION VRT_r_obj_t"
+	    "tl(VRT_CTX);\n\nVCL_BOOL VRT_r_obj_uncacheable(VRT_CTX);\n"
+	    "\nVCL_HTTP VRT_r_req(VRT_CTX);\n\nVCL_BACKEND VRT_r_req_backend_"
+	    "hint(VRT_CTX);\nvoid VRT_l_req_backend_hint(VRT_CTX, VCL_BACKEND"
+	    ");\n\nVCL_BOOL VRT_r_req_can_gzip(VRT_CTX);\n\nVCL_BOOL VRT_r_re"
+	    "q_esi(VRT_CTX);\nvoid VRT_l_req_esi(VRT_CTX, VCL_BOOL);\n"
+	    "\nVCL_INT VRT_r_req_esi_level(VRT_CTX);\n\nVCL_BOOL VRT_r_req_ha"
+	    "sh_always_miss(VRT_CTX);\nvoid VRT_l_req_hash_always_miss(VRT_CT"
+	    "X, VCL_BOOL);\n\nVCL_BOOL VRT_r_req_hash_ignore_busy(VRT_CTX);\n"
+	    "void VRT_l_req_hash_ignore_busy(VRT_CTX, VCL_BOOL);\n"
+	    "\n\nVCL_STRING VRT_r_req_method(VRT_CTX);\nvoid VRT_l_req_method"
+	    "(VRT_CTX, const char *, ...);\n\nVCL_STRING VRT_r_req_proto(VRT_"
+	    "CTX);\nvoid VRT_l_req_proto(VRT_CTX, const char *, ...);\n"
+	    "\nVCL_INT VRT_r_req_restarts(VRT_CTX);\n\nVCL_DURATION VRT_r_req"
+	    "_ttl(VRT_CTX);\nvoid VRT_l_req_ttl(VRT_CTX, VCL_DURATION);\n"
+	    "\nVCL_STRING VRT_r_req_url(VRT_CTX);\nvoid VRT_l_req_url(VRT_CTX"
+	    ", const char *, ...);\n\nVCL_STRING VRT_r_req_xid(VRT_CTX);\n"
+	    "\nVCL_HTTP VRT_r_resp(VRT_CTX);\n\n\nVCL_STRING VRT_r_resp_proto"
+	    "(VRT_CTX);\nvoid VRT_l_resp_proto(VRT_CTX, const char *, ...);\n"
+	    "\nVCL_STRING VRT_r_resp_reason(VRT_CTX);\nvoid VRT_l_resp_reason"
+	    "(VRT_CTX, const char *, ...);\n\nVCL_INT VRT_r_resp_status(VRT_C"
+	    "TX);\nvoid VRT_l_resp_status(VRT_CTX, VCL_INT);\n"
+	    "\nVCL_STRING VRT_r_server_hostname(VRT_CTX);\n\nVCL_STRING "
+	    "VRT_r_server_identity(VRT_CTX);\n\nVCL_IP VRT_r_server_ip(VRT_CT"
+	    "X);\n\ndouble VRT_Stv_free_space(const char *);\n"
+	    "double VRT_Stv_used_space(const char *);\nunsigned VRT_Stv_happy"
+	    "(const char *);\n"
 	);
 	VSB_cat(sb, "\n");
 
diff --git a/lib/libvcc/vcc_obj.c b/lib/libvcc/vcc_obj.c
index 7424166..76041f5 100644
--- a/lib/libvcc/vcc_obj.c
+++ b/lib/libvcc/vcc_obj.c
@@ -85,9 +85,8 @@ const struct var vcc_vars[] = {
 	    "VRT_r_bereq_uncacheable(ctx)",
 		VCL_MET_BACKEND_ERROR | VCL_MET_BACKEND_FETCH
 		 | VCL_MET_BACKEND_RESPONSE,
-	    "VRT_l_bereq_uncacheable(ctx, ",
-		VCL_MET_BACKEND_ERROR | VCL_MET_BACKEND_FETCH
-		 | VCL_MET_BACKEND_RESPONSE,
+	    NULL,	/* No writes allowed */
+		0,
 	},
 	{ "bereq.url", STRING, 9,
 	    "VRT_r_bereq_url(ctx)",
@@ -278,7 +277,7 @@ const struct var vcc_vars[] = {
 	},
 	{ "obj.uncacheable", BOOL, 15,
 	    "VRT_r_obj_uncacheable(ctx)",
-		VCL_MET_HIT,
+		VCL_MET_DELIVER,
 	    NULL,	/* No writes allowed */
 		0,
 	},
diff --git a/lib/libvcc/vcc_parse.c b/lib/libvcc/vcc_parse.c
index dab1131..e235090 100644
--- a/lib/libvcc/vcc_parse.c
+++ b/lib/libvcc/vcc_parse.c
@@ -251,9 +251,9 @@ vcc_ParseFunction(struct vcc *tl)
 		}
 		tl->curproc = vcc_AddProc(tl, tl->t);
 		Fh(tl, 0, "int VGC_function_%.*s "
-		    "(const struct vrt_ctx *ctx);\n", PF(tl->t));
+		    "(VRT_CTX);\n", PF(tl->t));
 		Fc(tl, 1, "\nint __match_proto__(vcl_func_t)\n");
-		Fc(tl, 1, "VGC_function_%.*s(const struct vrt_ctx *ctx)\n",
+		Fc(tl, 1, "VGC_function_%.*s(VRT_CTX)\n",
 		    PF(tl->t));
 	}
 	vcc_NextToken(tl);
@@ -338,7 +338,7 @@ vcc_Parse(struct vcc *tl)
 {
 	struct toplev *tp;
 
-	if (!vcc_IdIs(tl->t, "vcl")) {
+	if (tl->t->tok != ID || !vcc_IdIs(tl->t, "vcl")) {
 		VSB_printf(tl->sb,
 		    "VCL version declaration missing\n"
 		    "Update your VCL to Version 4 syntax, and add\n"
diff --git a/lib/libvcc/vcc_utils.c b/lib/libvcc/vcc_utils.c
index 5cd1d06..bfcc2d5 100644
--- a/lib/libvcc/vcc_utils.c
+++ b/lib/libvcc/vcc_utils.c
@@ -262,48 +262,3 @@ Resolve_Sockaddr(struct vcc *tl,
 		vcc_ErrWhere(tl, t_err);
 	}
 }
-
-void Emit_Invalid_Sockaddr(struct vcc *tl)
-{
-	const int sz = sizeof(unsigned long long);
-	const unsigned n = (vsa_suckaddr_len + sz - 1) / sz;
-	unsigned len;
-    unsigned long long b[n];
-    struct suckaddr *sua;
-    struct sockaddr_in sin;
-    struct sockaddr_in6 sin6;
-
-    if (tl->emitted_invalid_sockaddr)
-        return;
-
-    memset(&sin, 0, sizeof(sin));
-    sin.sin_family = AF_INET;
-
-    sua = VSA_Malloc(&sin, sizeof(sin));
-    AN(sua);
-    memcpy(b, sua, vsa_suckaddr_len);
-    free(sua);
-    Fh(tl, 0, "static const unsigned long long");
-    Fh(tl, 0, " sockaddr_invalid4[%d] = {\n", n);
-    for (len = 0; len < n; len++)
-        Fh(tl, 0, "%s    0x%0*llxLL",
-            len ? ",\n" : "", sz * 2, b[len]);
-    Fh(tl, 0, "\n};\n");
-
-    memset(&sin6, 0, sizeof(sin6));
-    sin6.sin6_family = AF_INET6;
-
-    sua = VSA_Malloc(&sin6, sizeof(sin6));
-    AN(sua);
-    memcpy(b, sua, vsa_suckaddr_len);
-    free(sua);
-	Fh(tl, 0, "static const unsigned long long");
-	Fh(tl, 0, " sockaddr_invalid6[%d] = {\n", n);
-    for (len = 0; len < n; len++)
-        Fh(tl, 0, "%s    0x%0*llxLL",
-            len ? ",\n" : "", sz * 2, b[len]);
-    Fh(tl, 0, "\n};\n");
-
-	tl->emitted_invalid_sockaddr = 1;
-}
-
diff --git a/lib/libvcc/vmodtool.py b/lib/libvcc/vmodtool.py
index 2861b40..0fcf148 100755
--- a/lib/libvcc/vmodtool.py
+++ b/lib/libvcc/vmodtool.py
@@ -104,7 +104,7 @@ def lwrap(s, w=72):
 #######################################################################
 
 def is_c_name(s):
-	return None != re.match("^[a-z][a-z0-9_]*$", s)
+	return None != re.match("^[a-zA-Z][a-zA-Z0-9_]*$", s)
 
 
 class ParseError(Exception):
@@ -358,7 +358,7 @@ class Func(object):
 		s = ctypes[self.retval] + " vmod_" + self.cnam + "("
 		p = ""
 		if not fini:
-			s += "const struct vrt_ctx *"
+			s += "VRT_CTX"
 			p = ", "
 		if self.pfx != None:
 			s += p + self.pfx
@@ -366,8 +366,6 @@ class Func(object):
 		for a in self.al:
 			s += p + ctypes[a.typ]
 			p = ", "
-			if a.nam != None:
-				s += " " + a.nam
 		s += ");"
 		return s
 
@@ -377,7 +375,7 @@ class Func(object):
 		s += " td_" + modname + "_" + self.cnam + "("
 		p = ""
 		if not fini:
-			s += "const struct vrt_ctx *"
+			s += "VRT_CTX"
 			p = ", "
 		if self.pfx != None:
 			s += p + self.pfx
@@ -647,8 +645,8 @@ def parse_func(tl, rt_type=None, pobj=None):
 		t = tl.get_token()
 		if is_c_name(t.str):
 			al[-1].nam = t.str
-			t = None
-		elif t.str == ",":
+			t = tl.get_token()
+		if t.str == ",":
 			t = None
 		elif t.str == ")":
 			break
@@ -861,7 +859,6 @@ def runmain(inputvcc, outputname="vcc_if"):
 	write_c_file_warning(fc)
 	write_c_file_warning(fh)
 
-	fh.write('struct vrt_ctx;\n')
 	fh.write('struct VCL_conf;\n')
 	fh.write('struct vmod_priv;\n')
 	fh.write("\n")
diff --git a/lib/libvmod_debug/vmod_debug.c b/lib/libvmod_debug/vmod_debug.c
index b952f64..76e5a5f 100644
--- a/lib/libvmod_debug/vmod_debug.c
+++ b/lib/libvmod_debug/vmod_debug.c
@@ -37,7 +37,7 @@
 #include "vcc_if.h"
 
 VCL_VOID __match_proto__(td_debug_panic)
-vmod_panic(const struct vrt_ctx *ctx, const char *str, ...)
+vmod_panic(VRT_CTX, const char *str, ...)
 {
 	va_list ap;
 	const char *b;
@@ -50,7 +50,7 @@ vmod_panic(const struct vrt_ctx *ctx, const char *str, ...)
 }
 
 VCL_STRING __match_proto__(td_debug_author)
-vmod_author(const struct vrt_ctx *ctx, VCL_ENUM id)
+vmod_author(VRT_CTX, VCL_ENUM id)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -76,7 +76,7 @@ init_function(struct vmod_priv *priv, const struct VCL_conf *cfg)
 }
 
 VCL_VOID __match_proto__(td_debug_test_priv_call)
-vmod_test_priv_call(const struct vrt_ctx *ctx, struct vmod_priv *priv)
+vmod_test_priv_call(VRT_CTX, struct vmod_priv *priv)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -89,7 +89,7 @@ vmod_test_priv_call(const struct vrt_ctx *ctx, struct vmod_priv *priv)
 }
 
 VCL_VOID __match_proto__(td_debug_test_priv_vcl)
-vmod_test_priv_vcl(const struct vrt_ctx *ctx, struct vmod_priv *priv)
+vmod_test_priv_vcl(VRT_CTX, struct vmod_priv *priv)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -97,7 +97,7 @@ vmod_test_priv_vcl(const struct vrt_ctx *ctx, struct vmod_priv *priv)
 }
 
 VCL_BLOB
-vmod_str2blob(const struct vrt_ctx *ctx, VCL_STRING s)
+vmod_str2blob(VRT_CTX, VCL_STRING s)
 {
 	struct vmod_priv *p;
 
@@ -111,7 +111,7 @@ vmod_str2blob(const struct vrt_ctx *ctx, VCL_STRING s)
 }
 
 VCL_STRING
-vmod_blob2hex(const struct vrt_ctx *ctx, VCL_BLOB b)
+vmod_blob2hex(VRT_CTX, VCL_BLOB b)
 {
 	char *s, *p;
 	uint8_t *q;
@@ -131,7 +131,7 @@ vmod_blob2hex(const struct vrt_ctx *ctx, VCL_BLOB b)
 }
 
 VCL_BACKEND
-vmod_no_backend(const struct vrt_ctx *ctx)
+vmod_no_backend(VRT_CTX)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -139,7 +139,7 @@ vmod_no_backend(const struct vrt_ctx *ctx)
 }
 
 VCL_VOID __match_proto__(td_debug_rot52)
-vmod_rot52(const struct vrt_ctx *ctx, VCL_HTTP hp)
+vmod_rot52(VRT_CTX, VCL_HTTP hp)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
diff --git a/lib/libvmod_debug/vmod_debug_obj.c b/lib/libvmod_debug/vmod_debug_obj.c
index ad24578..91dfa0d 100644
--- a/lib/libvmod_debug/vmod_debug_obj.c
+++ b/lib/libvmod_debug/vmod_debug_obj.c
@@ -42,7 +42,7 @@ struct vmod_debug_obj {
 };
 
 VCL_VOID
-vmod_obj__init(const struct vrt_ctx *ctx, struct vmod_debug_obj **op,
+vmod_obj__init(VRT_CTX, struct vmod_debug_obj **op,
     const char *vcl_name, VCL_STRING s)
 {
 	struct vmod_debug_obj *o;
@@ -70,7 +70,7 @@ vmod_obj__fini(struct vmod_debug_obj **op)
 }
 
 VCL_VOID __match_proto__()
-vmod_obj_enum(const struct vrt_ctx *ctx, struct vmod_debug_obj *o, VCL_ENUM e)
+vmod_obj_enum(VRT_CTX, struct vmod_debug_obj *o, VCL_ENUM e)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -79,7 +79,7 @@ vmod_obj_enum(const struct vrt_ctx *ctx, struct vmod_debug_obj *o, VCL_ENUM e)
 }
 
 VCL_STRING __match_proto__()
-vmod_obj_foo(const struct vrt_ctx *ctx, struct vmod_debug_obj *o, VCL_STRING s)
+vmod_obj_foo(VRT_CTX, struct vmod_debug_obj *o, VCL_STRING s)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -90,7 +90,7 @@ vmod_obj_foo(const struct vrt_ctx *ctx, struct vmod_debug_obj *o, VCL_STRING s)
 }
 
 VCL_TIME __match_proto__()
-vmod_obj_date(const struct vrt_ctx *ctx, struct vmod_debug_obj *o)
+vmod_obj_date(VRT_CTX, struct vmod_debug_obj *o)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
diff --git a/lib/libvmod_directors/Makefile.am b/lib/libvmod_directors/Makefile.am
index cb239bf..64b72a8 100644
--- a/lib/libvmod_directors/Makefile.am
+++ b/lib/libvmod_directors/Makefile.am
@@ -20,15 +20,14 @@ libvmod_directors_la_SOURCES = \
 	fall_back.c \
 	hash.c \
 	random.c \
-	round_robin.c \
-	rev_dns.c
+	round_robin.c
 
 nodist_libvmod_directors_la_SOURCES = \
 	vcc_if.c \
 	vcc_if.h
 
 # BUILT_SOURCES is only a hack and dependency tracking does not help for the first build
-vdir.lo fall_back.lo hash.lo random.lo round_robin.lo rev_dns.lo: vcc_if.h
+vdir.lo fall_back.lo hash.lo random.lo round_robin.lo: vcc_if.h
 
 vcc_if.c vcc_if.h vmod_directors.rst vmod_directors.man.rst: $(vmodtool) $(vmod_srcdir)/vmod.vcc
 	@PYTHON@ $(vmodtool) $(vmodtoolargs) $(vmod_srcdir)/vmod.vcc
diff --git a/lib/libvmod_directors/fall_back.c b/lib/libvmod_directors/fall_back.c
index edec2af..3552116 100644
--- a/lib/libvmod_directors/fall_back.c
+++ b/lib/libvmod_directors/fall_back.c
@@ -75,7 +75,7 @@ vmod_rr_getfd(const struct director *dir, struct busyobj *bo)
 }
 
 VCL_VOID __match_proto__()
-vmod_fallback__init(const struct vrt_ctx *ctx,
+vmod_fallback__init(VRT_CTX,
     struct vmod_directors_fallback **rrp, const char *vcl_name)
 {
 	struct vmod_directors_fallback *rr;
@@ -102,7 +102,7 @@ vmod_fallback__fini(struct vmod_directors_fallback **rrp)
 }
 
 VCL_VOID __match_proto__()
-vmod_fallback_add_backend(const struct vrt_ctx *ctx,
+vmod_fallback_add_backend(VRT_CTX,
     struct vmod_directors_fallback *rr, VCL_BACKEND be)
 {
 
@@ -112,7 +112,7 @@ vmod_fallback_add_backend(const struct vrt_ctx *ctx,
 }
 
 VCL_BACKEND __match_proto__()
-vmod_fallback_backend(const struct vrt_ctx *ctx,
+vmod_fallback_backend(VRT_CTX,
     struct vmod_directors_fallback *rr)
 {
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
diff --git a/lib/libvmod_directors/hash.c b/lib/libvmod_directors/hash.c
index 090039f..6ff2a77 100644
--- a/lib/libvmod_directors/hash.c
+++ b/lib/libvmod_directors/hash.c
@@ -52,7 +52,7 @@ struct vmod_directors_hash {
 };
 
 VCL_VOID __match_proto__()
-vmod_hash__init(const struct vrt_ctx *ctx, struct vmod_directors_hash **rrp,
+vmod_hash__init(VRT_CTX, struct vmod_directors_hash **rrp,
     const char *vcl_name)
 {
 	struct vmod_directors_hash *rr;
@@ -82,7 +82,7 @@ vmod_hash__fini(struct vmod_directors_hash **rrp)
 }
 
 VCL_VOID __match_proto__()
-vmod_hash_add_backend(const struct vrt_ctx *ctx,
+vmod_hash_add_backend(VRT_CTX,
     struct vmod_directors_hash *rr, VCL_BACKEND be, double w)
 {
 
@@ -93,7 +93,7 @@ vmod_hash_add_backend(const struct vrt_ctx *ctx,
 }
 
 VCL_BACKEND __match_proto__()
-vmod_hash_backend(const struct vrt_ctx *ctx, struct vmod_directors_hash *rr,
+vmod_hash_backend(VRT_CTX, struct vmod_directors_hash *rr,
     const char *arg, ...)
 {
 	struct SHA256Context sha_ctx;
diff --git a/lib/libvmod_directors/random.c b/lib/libvmod_directors/random.c
index 8ae36a7..91a281e 100644
--- a/lib/libvmod_directors/random.c
+++ b/lib/libvmod_directors/random.c
@@ -46,7 +46,6 @@ struct vmod_directors_random {
 #define VMOD_DIRECTORS_RANDOM_MAGIC		0x4732d092
 	struct vdir				*vd;
 	unsigned				n_backend;
-	struct vbitmap				*vbm;
 };
 
 static unsigned __match_proto__(vdi_healthy)
@@ -75,7 +74,7 @@ vmod_rr_getfd(const struct director *dir, struct busyobj *bo)
 }
 
 VCL_VOID __match_proto__()
-vmod_random__init(const struct vrt_ctx *ctx, struct vmod_directors_random **rrp,
+vmod_random__init(VRT_CTX, struct vmod_directors_random **rrp,
     const char *vcl_name)
 {
 	struct vmod_directors_random *rr;
@@ -85,8 +84,6 @@ vmod_random__init(const struct vrt_ctx *ctx, struct vmod_directors_random **rrp,
 	AZ(*rrp);
 	ALLOC_OBJ(rr, VMOD_DIRECTORS_RANDOM_MAGIC);
 	AN(rr);
-	rr->vbm = vbit_init(8);
-	AN(rr->vbm);
 	*rrp = rr;
 	vdir_new(&rr->vd, vcl_name, vmod_rr_healthy, vmod_rr_getfd, rr);
 }
@@ -100,12 +97,11 @@ vmod_random__fini(struct vmod_directors_random **rrp)
 	*rrp = NULL;
 	CHECK_OBJ_NOTNULL(rr, VMOD_DIRECTORS_RANDOM_MAGIC);
 	vdir_delete(&rr->vd);
-	vbit_destroy(rr->vbm);
 	FREE_OBJ(rr);
 }
 
 VCL_VOID __match_proto__()
-vmod_random_add_backend(const struct vrt_ctx *ctx,
+vmod_random_add_backend(VRT_CTX,
     struct vmod_directors_random *rr, VCL_BACKEND be, double w)
 {
 
@@ -116,7 +112,7 @@ vmod_random_add_backend(const struct vrt_ctx *ctx,
 }
 
 VCL_BACKEND __match_proto__()
-vmod_random_backend(const struct vrt_ctx *ctx, struct vmod_directors_random *rr)
+vmod_random_backend(VRT_CTX, struct vmod_directors_random *rr)
 {
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
 	CHECK_OBJ_NOTNULL(rr, VMOD_DIRECTORS_RANDOM_MAGIC);
diff --git a/lib/libvmod_directors/round_robin.c b/lib/libvmod_directors/round_robin.c
index 629bbbf..89e588b 100644
--- a/lib/libvmod_directors/round_robin.c
+++ b/lib/libvmod_directors/round_robin.c
@@ -78,7 +78,7 @@ vmod_rr_getfd(const struct director *dir, struct busyobj *bo)
 }
 
 VCL_VOID __match_proto__()
-vmod_round_robin__init(const struct vrt_ctx *ctx,
+vmod_round_robin__init(VRT_CTX,
     struct vmod_directors_round_robin **rrp, const char *vcl_name)
 {
 	struct vmod_directors_round_robin *rr;
@@ -105,7 +105,7 @@ vmod_round_robin__fini(struct vmod_directors_round_robin **rrp)
 }
 
 VCL_VOID __match_proto__()
-vmod_round_robin_add_backend(const struct vrt_ctx *ctx,
+vmod_round_robin_add_backend(VRT_CTX,
     struct vmod_directors_round_robin *rr, VCL_BACKEND be)
 {
 
@@ -115,7 +115,7 @@ vmod_round_robin_add_backend(const struct vrt_ctx *ctx,
 }
 
 VCL_BACKEND __match_proto__()
-vmod_round_robin_backend(const struct vrt_ctx *ctx,
+vmod_round_robin_backend(VRT_CTX,
     struct vmod_directors_round_robin *rr)
 {
 
diff --git a/lib/libvmod_directors/vmod.vcc b/lib/libvmod_directors/vmod.vcc
index be2c4f9..bbfa0eb 100644
--- a/lib/libvmod_directors/vmod.vcc
+++ b/lib/libvmod_directors/vmod.vcc
@@ -183,44 +183,3 @@ Description
 Example
 	set req.backend_hint = vdir.backend(req.http.cookie);  # pick a backend based on the cookie header from the client
 
-
-$Object rev_dns()
-
-Description
-	Create a Rev DNS backend director.
-
-	The Rev DNS director resolves the address of its only backend dynamically.
-	If multiple addresses are returned, it will act as a round_robin director
-	between all of them (if they are healthy).
-	The TTL of the DNS result is respected.
-
-Example
-	new vdir = directors.rev_dns();
-
-$Method VOID .set_max_dns_ttl(DURATION)
-
-Description
-	Set the maximum TTL of the DNS query result.
-
-	By default, the maximum TTL is one hour.
-
-Example
-	vdir.set_max_dns_ttl(10s);
-
-$Method BOOL .set_backend(BACKEND)
-
-Description
-	Set the backend whose address is resolved by the director.
-
-	The backend must have the 'preresolve_dns' parameter set to 1.
-
-Example
-	vdir.set_backend(backend);
-
-
-$Method BACKEND .backend()
-
-Description
-	Pick a backend from the director.
-Example
-	set req.backend_hint = vdir.backend();
diff --git a/lib/libvmod_std/vmod.vcc b/lib/libvmod_std/vmod.vcc
index b15a603..1bc92d6 100644
--- a/lib/libvmod_std/vmod.vcc
+++ b/lib/libvmod_std/vmod.vcc
@@ -41,25 +41,25 @@ which all have the form::
 These functions attempt to convert STRING to the TYPE, and if that fails,
 they return the second argument, which must have the given TYPE.
 
-$Function STRING toupper(STRING_LIST)
+$Function STRING toupper(STRING_LIST s)
 
 Description
-	Converts the string *s* to upper case.
+	Converts the string *s* to uppercase.
 Example
 	set beresp.http.x-scream = std.toupper("yes!");
 
-$Function STRING tolower(STRING_LIST)
+$Function STRING tolower(STRING_LIST s)
 
 Description
-	Converts the string *s* to lower case.
+	Converts the string *s* to lowercase.
 Example
 	set beresp.http.x-nice = std.tolower("VerY");
 
-$Function VOID set_ip_tos(INT)
+$Function VOID set_ip_tos(INT tos)
 
 Description
-	Sets the Type-of-Service flag for the current session. Please
-	note that the TOS flag is not removed by the end of the
+	Sets the IP type-of-service (TOS) field for the current session to *tos*.
+	Please note that the TOS field is not removed by the end of the
 	request so probably want to set it on every request should you
 	utilize it.
 Example
@@ -67,24 +67,24 @@ Example
 	|    std.set_ip_tos(0x0);
 	| }
 
-$Function REAL random(REAL, REAL)
+$Function REAL random(REAL lo, REAL hi)
 
 Description
-	Returns a random REAL number between *a* and *b*.
+	Returns a random real number between *lo* and *hi*.
 Example
 	set beresp.http.x-random-number = std.random(1, 100);
 
-$Function VOID log(STRING_LIST)
+$Function VOID log(STRING_LIST s)
 
 Description
-	Logs *string* to the shared memory log, using VSL tag *SLT_VCL_Log*.
+	Logs the string *s* to the shared memory log, using VSL tag *SLT_VCL_Log*.
 Example
 	std.log("Something fishy is going on with the vhost " + req.host);
 
-$Function VOID syslog(INT, STRING_LIST)
+$Function VOID syslog(INT priority, STRING_LIST s)
 
 Description
-	Logs *string* to syslog marked with *priority*.  See your
+	Logs the string *s* to syslog marked with *priority*.  See your
 	system's syslog.h file for the legal values of *priority*.
 Example
 	std.syslog(8 + 1, "Something is wrong");
@@ -99,120 +99,152 @@ Description
 Example
 	set beresp.http.x-served-by = std.fileread("/etc/hostname");
 
-$Function VOID collect(HEADER)
+$Function VOID collect(HEADER hdr)
 
 Description
-	Collapses the header, joining the headers into one.
+	Collapses the header *hdr*, joining them into one.
 Example
 	std.collect(req.http.cookie);
+
 	This will collapse several Cookie: headers into one, long
 	cookie header.
 
-$Function DURATION duration(STRING, DURATION)
+$Function DURATION duration(STRING s, DURATION fallback)
 
 Description
 	Converts the string *s* to seconds. *s* must be quantified
 	with ms (milliseconds), s (seconds), m (minutes), h (hours),
-	d (days), w (weeks) or y (years) units. If *s* fails to parse,
+	d (days), w (weeks) or y (years) units. If conversion fails,
 	*fallback* will be returned.
 Example
 	set beresp.ttl = std.duration("1w", 3600s);
 
-$Function INT integer(STRING, INT)
+$Function INT integer(STRING s, INT fallback)
 
 Description
-	Converts the string *s* to an integer.  If *s* fails to parse,
+	Converts the string *s* to an integer.	If conversion fails,
 	*fallback* will be returned.
 Example
-	if (std.integer(beresp.http.x-foo, 0) > 5) { ... }
+	| if (std.integer(beresp.http.x-foo, 0) > 5) {
+	| 	...
+	| }
 
-$Function IP ip(STRING, IP)
+$Function IP ip(STRING s, IP fallback)
 
 Description
-	Converts string *s* to the first IP number returned by
+	Converts the string *s* to the first IP number returned by
 	the system library function getaddrinfo(3).  If conversion
 	fails, *fallback* will be returned.
 Example
-	if (std.ip(req.http.X-forwarded-for, "0.0.0.0") ~ my_acl) { ... }
+	| if (std.ip(req.http.X-forwarded-for, "0.0.0.0") ~ my_acl) {
+	| 	...
+	| }
 
-$Function REAL real(STRING, REAL)
+$Function REAL real(STRING s, REAL fallback)
 
 Description
-	Converts the string *s* to a real.  If *s* fails to parse,
+	Converts the string *s* to a real.  If conversion fails,
 	*fallback* will be returned.
 Example
 	set req.http.x-real = std.real(req.http.x-foo, 0.0);
 
-$Function TIME real2time(REAL)
+$Function TIME real2time(REAL r)
 
 Description
 	Converts the real *r* to a time.
 Example
 	set req.http.x-time = std.real2time(1140618699.00);
 
-$Function INT time2integer(TIME)
+$Function INT time2integer(TIME t)
 
 Description
 	Converts the time *t* to a integer.
 Example
 	set req.http.x-int = std.time2integer(now);
 
-$Function REAL time2real(TIME)
+$Function REAL time2real(TIME t)
 
 Description
 	Converts the time *t* to a real.
 Example
 	set req.http.x-real = std.time2real(now);
 
-$Function BOOL healthy(BACKEND)
+$Function BOOL healthy(BACKEND be)
 
 Description
-	Returns true if the backend is healthy.
+	Returns `true` if the backend *be* is healthy.
 
-$Function INT port(IP)
+$Function INT port(IP ip)
 
 Description
-	Returns the port number of an IP address.
+	Returns the port number of the IP address *ip*.
 
-$Function VOID rollback(HTTP)
+$Function VOID rollback(HTTP h)
 
 Description
-	Restore *h* HTTP headers to their original state.
+	Restores the *h* HTTP headers to their original state.
 Example
 	std.rollback(bereq);
 
-$Function VOID timestamp(STRING)
+$Function VOID timestamp(STRING s)
 
 Description
-	Introduces a timestamp in the log with the current time. Uses
-	the argument as the timespamp label. This is useful to time
-	the execution of lengthy VCL procedures, and makes the
-	timestamps inserted automatically by Varnish more accurate.
+	Introduces a timestamp in the log with the current time, using
+	the string *s* as the label. This is useful to time the execution
+	of lengthy VCL procedures, and makes the timestamps inserted
+	automatically by Varnish more accurate.
 Example
 	std.timestamp("curl-request");
 
 $Function STRING querysort(STRING)
 
 Description
-        Sorts the querystring for cache normalization purposes.
+	Sorts the query string for cache normalization purposes.
 Example
         set req.url = std.querysort(req.url);
 
+$Function VOID cache_req_body(BYTES size)
+
+Description
+	Cache the req.body if it is smaller than *size*.
+
+	Caching the req.body makes it possible to retry pass
+	operations (POST, PUT).
+Example
+	std.cache_req_body(1KB);
+
+	This will cache the req.body if its size is smaller than 1KB.
 
-$Function STRING strstr(STRING, STRING)
+$Function STRING strstr(STRING s1, STRING s2)
 
 Description
-	Returns the substring if the second string is a substring of the first
-	string. Note that the comparison is case sensitive. You can
-	use the tolower function on both strings if you want case
-	insensitivity.
-	
-        If there is no match a NULL pointer is returned which would
-        evaluate to false in an if-test.
+	Returns the first occurrence of the string *s2* in the string
+	*s1*, or an empty string if not found.
 
+	Note that the comparison is case sensitive.
 Example
-	if (std.strstr(req.url, req.http.x-restrict)) 
+	| if (std.strstr(req.url, req.http.x-restrict)) {
+	| 	...
+	| }
+
+$Function TIME time(STRING s, TIME fallback)
+
+Description
+	Converts the string *s* to a time.  If conversion fails,
+	*fallback* will be returned.
+
+	Supported formats:
 
+	| "Sun, 06 Nov 1994 08:49:37 GMT"
+	| "Sunday, 06-Nov-94 08:49:37 GMT"
+	| "Sun Nov  6 08:49:37 1994"
+	| "1994-11-06T08:49:37"
+	| "784111777.00"
+	| "784111777"
+Example
+	| if (std.time(resp.http.last-modified, now) < now - 1w) {
+	| 	...
+	| }
 
 
 SEE ALSO
diff --git a/lib/libvmod_std/vmod_std.c b/lib/libvmod_std/vmod_std.c
index fd2bbbc..63af0e6 100644
--- a/lib/libvmod_std/vmod_std.c
+++ b/lib/libvmod_std/vmod_std.c
@@ -49,7 +49,7 @@
 #include "vcc_if.h"
 
 VCL_VOID __match_proto__(td_std_set_ip_tos)
-vmod_set_ip_tos(const struct vrt_ctx *ctx, VCL_INT tos)
+vmod_set_ip_tos(VRT_CTX, VCL_INT tos)
 {
 	int itos = tos;
 
@@ -59,7 +59,7 @@ vmod_set_ip_tos(const struct vrt_ctx *ctx, VCL_INT tos)
 }
 
 static const char *
-vmod_updown(const struct vrt_ctx *ctx, int up, const char *s, va_list ap)
+vmod_updown(VRT_CTX, int up, const char *s, va_list ap)
 {
 	unsigned u;
 	char *b, *e;
@@ -95,7 +95,7 @@ vmod_updown(const struct vrt_ctx *ctx, int up, const char *s, va_list ap)
 }
 
 VCL_STRING __match_proto__(td_std_toupper)
-vmod_toupper(const struct vrt_ctx *ctx, const char *s, ...)
+vmod_toupper(VRT_CTX, const char *s, ...)
 {
 	const char *p;
 	va_list ap;
@@ -108,7 +108,7 @@ vmod_toupper(const struct vrt_ctx *ctx, const char *s, ...)
 }
 
 VCL_STRING __match_proto__(td_std_tolower)
-vmod_tolower(const struct vrt_ctx *ctx, const char *s, ...)
+vmod_tolower(VRT_CTX, const char *s, ...)
 {
 	const char *p;
 	va_list ap;
@@ -121,7 +121,7 @@ vmod_tolower(const struct vrt_ctx *ctx, const char *s, ...)
 }
 
 VCL_REAL __match_proto__(td_std_random)
-vmod_random(const struct vrt_ctx *ctx, VCL_REAL lo, VCL_REAL hi)
+vmod_random(VRT_CTX, VCL_REAL lo, VCL_REAL hi)
 {
 	double a;
 
@@ -133,7 +133,7 @@ vmod_random(const struct vrt_ctx *ctx, VCL_REAL lo, VCL_REAL hi)
 }
 
 VCL_VOID __match_proto__(td_std_log)
-vmod_log(const struct vrt_ctx *ctx, const char *fmt, ...)
+vmod_log(VRT_CTX, const char *fmt, ...)
 {
 	unsigned u;
 	va_list ap;
@@ -154,7 +154,7 @@ vmod_log(const struct vrt_ctx *ctx, const char *fmt, ...)
 }
 
 VCL_VOID __match_proto__(td_std_syslog)
-vmod_syslog(const struct vrt_ctx *ctx, VCL_INT fac, const char *fmt, ...)
+vmod_syslog(VRT_CTX, VCL_INT fac, const char *fmt, ...)
 {
 	unsigned u;
 	va_list ap;
@@ -172,7 +172,7 @@ vmod_syslog(const struct vrt_ctx *ctx, VCL_INT fac, const char *fmt, ...)
 }
 
 VCL_VOID __match_proto__(td_std_collect)
-vmod_collect(const struct vrt_ctx *ctx, VCL_HEADER hdr)
+vmod_collect(VRT_CTX, VCL_HEADER hdr)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -187,7 +187,7 @@ vmod_collect(const struct vrt_ctx *ctx, VCL_HEADER hdr)
 }
 
 VCL_BOOL __match_proto__(td_std_healthy)
-vmod_healthy(const struct vrt_ctx *ctx, VCL_BACKEND be)
+vmod_healthy(VRT_CTX, VCL_BACKEND be)
 {
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
 	if (be == NULL)
@@ -197,7 +197,7 @@ vmod_healthy(const struct vrt_ctx *ctx, VCL_BACKEND be)
 }
 
 VCL_INT __match_proto__(td_std_port)
-vmod_port(const struct vrt_ctx *ctx, VCL_IP ip)
+vmod_port(VRT_CTX, VCL_IP ip)
 {
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
 	if (ip == NULL)
@@ -206,13 +206,13 @@ vmod_port(const struct vrt_ctx *ctx, VCL_IP ip)
 }
 
 VCL_VOID __match_proto__(td_std_rollback)
-vmod_rollback(const struct vrt_ctx *ctx, VCL_HTTP hp)
+vmod_rollback(VRT_CTX, VCL_HTTP hp)
 {
 	VRT_Rollback(ctx, hp);
 }
 
 VCL_VOID __match_proto__(td_std_timestamp)
-vmod_timestamp(const struct vrt_ctx *ctx, VCL_STRING label)
+vmod_timestamp(VRT_CTX, VCL_STRING label)
 {
 
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
@@ -231,9 +231,8 @@ vmod_timestamp(const struct vrt_ctx *ctx, VCL_STRING label)
 	}
 }
 
-
 VCL_STRING __match_proto__(td_std_strstr)
-vmod_strstr(const struct vrt_ctx *ctx, VCL_STRING mstr, VCL_STRING msubstr)
+vmod_strstr(VRT_CTX, VCL_STRING mstr, VCL_STRING msubstr)
 {
         CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
 
@@ -242,3 +241,12 @@ vmod_strstr(const struct vrt_ctx *ctx, VCL_STRING mstr, VCL_STRING msubstr)
 	else
 		return(strstr(mstr, msubstr));
 }
+
+VCL_VOID __match_proto__(td_std_cache_req_body)
+vmod_cache_req_body(VRT_CTX, VCL_BYTES size)
+{
+	int result;
+	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
+	result = VRT_CacheReqBody(ctx, size);
+	VSLb(ctx->vsl, SLT_Debug,"VRT_CacheReqBody(%zu): %d", (size_t)size, result);
+}
diff --git a/lib/libvmod_std/vmod_std_conversions.c b/lib/libvmod_std/vmod_std_conversions.c
index cdcd3cb..298b7c4 100644
--- a/lib/libvmod_std/vmod_std_conversions.c
+++ b/lib/libvmod_std/vmod_std_conversions.c
@@ -41,10 +41,11 @@
 
 #include "vrt.h"
 #include "vsa.h"
+#include "vtim.h"
 #include "vcc_if.h"
 
 VCL_DURATION __match_proto__(td_std_duration)
-vmod_duration(const struct vrt_ctx *ctx, VCL_STRING p, VCL_DURATION d)
+vmod_duration(VRT_CTX, VCL_STRING p, VCL_DURATION d)
 {
 	char *e;
 	double r;
@@ -101,7 +102,7 @@ vmod_duration(const struct vrt_ctx *ctx, VCL_STRING p, VCL_DURATION d)
 }
 
 VCL_INT __match_proto__(td_std_integer)
-vmod_integer(const struct vrt_ctx *ctx, VCL_STRING p, VCL_INT i)
+vmod_integer(VRT_CTX, VCL_STRING p, VCL_INT i)
 {
 	char *e;
 	long r;
@@ -128,7 +129,7 @@ vmod_integer(const struct vrt_ctx *ctx, VCL_STRING p, VCL_INT i)
 }
 
 VCL_IP
-vmod_ip(const struct vrt_ctx *ctx, VCL_STRING s, VCL_IP d)
+vmod_ip(VRT_CTX, VCL_STRING s, VCL_IP d)
 {
 	struct addrinfo hints, *res0 = NULL;
 	const struct addrinfo *res;
@@ -167,7 +168,7 @@ vmod_ip(const struct vrt_ctx *ctx, VCL_STRING s, VCL_IP d)
 }
 
 VCL_REAL __match_proto__(td_std_real)
-vmod_real(const struct vrt_ctx *ctx, VCL_STRING p, VCL_REAL d)
+vmod_real(VRT_CTX, VCL_STRING p, VCL_REAL d)
 {
 	char *e;
 	double r;
@@ -197,7 +198,7 @@ vmod_real(const struct vrt_ctx *ctx, VCL_STRING p, VCL_REAL d)
 }
 
 VCL_TIME __match_proto__(td_std_real2time)
-vmod_real2time(const struct vrt_ctx *ctx, VCL_REAL r)
+vmod_real2time(VRT_CTX, VCL_REAL r)
 {
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
 
@@ -205,7 +206,7 @@ vmod_real2time(const struct vrt_ctx *ctx, VCL_REAL r)
 }
 
 VCL_INT __match_proto__(td_std_time2integer)
-vmod_time2integer(const struct vrt_ctx *ctx, VCL_TIME t)
+vmod_time2integer(VRT_CTX, VCL_TIME t)
 {
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
 
@@ -213,9 +214,24 @@ vmod_time2integer(const struct vrt_ctx *ctx, VCL_TIME t)
 }
 
 VCL_REAL __match_proto__(td_std_time2real)
-vmod_time2real(const struct vrt_ctx *ctx, VCL_TIME t)
+vmod_time2real(VRT_CTX, VCL_TIME t)
 {
 	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
 
 	return (t);
 }
+
+VCL_TIME __match_proto__(td_std_time)
+vmod_time(const struct vrt_ctx *ctx, VCL_STRING p, VCL_TIME d)
+{
+	double r;
+
+	CHECK_OBJ_NOTNULL(ctx, VRT_CTX_MAGIC);
+
+	if (p == NULL)
+		return (d);
+	r = VTIM_parse(p);
+	if (r)
+		return (r);
+	return (vmod_real(ctx, p, d));
+}
diff --git a/lib/libvmod_std/vmod_std_fileread.c b/lib/libvmod_std/vmod_std_fileread.c
index 4fce9a2..0e37268 100644
--- a/lib/libvmod_std/vmod_std_fileread.c
+++ b/lib/libvmod_std/vmod_std_fileread.c
@@ -83,7 +83,7 @@ free_frfile(void *ptr)
 }
 
 VCL_STRING __match_proto__(td_std_fileread)
-vmod_fileread(const struct vrt_ctx *ctx, struct vmod_priv *priv,
+vmod_fileread(VRT_CTX, struct vmod_priv *priv,
     VCL_STRING file_name)
 {
 	struct frfile *frf = NULL;
diff --git a/lib/libvmod_std/vmod_std_querysort.c b/lib/libvmod_std/vmod_std_querysort.c
index 8f7f93b..6f6a90b 100644
--- a/lib/libvmod_std/vmod_std_querysort.c
+++ b/lib/libvmod_std/vmod_std_querysort.c
@@ -50,7 +50,7 @@ compa(const void *a, const void *b)
 }
 
 VCL_STRING __match_proto__(td_std_querysort)
-vmod_querysort(const struct vrt_ctx *ctx, VCL_STRING url)
+vmod_querysort(VRT_CTX, VCL_STRING url)
 {
 	const char *cq, *cu;
 	char *p, *r;
diff --git a/man/Makefile.am b/man/Makefile.am
index c7dd1bf..d791d1f 100644
--- a/man/Makefile.am
+++ b/man/Makefile.am
@@ -86,8 +86,8 @@ varnishhist.1: \
 	$(top_srcdir)/doc/sphinx/include/varnishhist_synopsis.rst
 	${RST2MAN} $(RST2ANY_FLAGS) $(top_srcdir)/doc/sphinx/reference/varnishhist.rst $@
 
-vmod_std.3: $(top_srcdir)/lib/libvmod_std/vmod_std.man.rst
+vmod_std.3: $(top_builddir)/lib/libvmod_std/vmod_std.man.rst
 	${RST2MAN} $(RST2ANY_FLAGS) $? $@
 
-vmod_directors.3: $(top_srcdir)/lib/libvmod_directors/vmod_directors.man.rst
+vmod_directors.3: $(top_builddir)/lib/libvmod_directors/vmod_directors.man.rst
 	${RST2MAN} $(RST2ANY_FLAGS) $? $@
diff --git a/man/varnish-cli.7 b/man/varnish-cli.7
index 6d45785..3827e56 100644
--- a/man/varnish-cli.7
+++ b/man/varnish-cli.7
@@ -126,11 +126,12 @@ Clear the last panic, if any.
 .B storage.list
 List storage devices
 .TP
-.B backend.list
-List all backends
+.B backend.list [<backend_expression>]
+List backends.
 .TP
-.B backend.set_health matcher state
-Set health status on a backend
+.B backend.set_health <backend_expression> <state>
+Set health status on the backends.
+State is any of auto, healthy or sick values.
 .TP
 .B ban <field> <operator> <arg> [&& <field> <oper> <arg>]...
 All objects where the all the conditions match will be marked obsolete.
@@ -138,6 +139,12 @@ All objects where the all the conditions match will be marked obsolete.
 .B ban.list
 List the active bans.
 .UNINDENT
+.SS Backend Expression
+.sp
+A backend expression can be a backend name or a combination of backend
+name, IP address and port in "name(IP address:port)" format. All fields
+are optional. If no exact matching backend is found, partial matching
+will be attempted based on the provided name, IP address and port fields.
 .SS Ban Expressions
 .sp
 A ban expression consists of one or more conditions.  A condition
diff --git a/man/varnishstat.1 b/man/varnishstat.1
index 5e70730..fad0c4c 100644
--- a/man/varnishstat.1
+++ b/man/varnishstat.1
@@ -55,7 +55,7 @@ Displays the result as JSON.
 .SH CURSES MODE
 .sp
 When neither \-1, \-j or \-x options are given, the application starts up
-in curses mode. This shows a continously updated view of the counter
+in curses mode. This shows a continuously updated view of the counter
 values, along with their description.
 .sp
 The top area shows process uptime information.
@@ -108,17 +108,17 @@ Navigate the counter list one page up.
 .B <PAGEDOWN> or <SPACE>
 Navigate the counter list one page down.
 .TP
+.B <d>
+Toggle between showing and hiding unseen counters. Unseen
+counters are those that has been zero for the entire runtime
+of varnishstat. Defaults to hide unseen counters.
+.TP
 .B <g>
 Go to the top of the counter list.
 .TP
 .B <G>
 Go to the bottom of the counter list.
 .TP
-.B <d>
-Toggle between showing and hiding unseen counters. Unseen
-counters are those that has been zero for the entire runtime
-of varnishstat. Defaults to hide unseen counters.
-.TP
 .B <v>
 Cycle through the verbosity levels. Defaults to only showing
 informational counters.
@@ -135,11 +135,17 @@ When using the \-x option, the output is:
 .sp
 .nf
 .ft C
-<stat>
-  <name>FIELD NAME</name>
-  <value>FIELD VALUE</value>
-  <description>FIELD DESCRIPTION</description>
-</stat>
+<varnishstat timestamp="YYYY\-MM\-DDTHH:mm:SS">
+  <stat>
+    <type>FIELD TYPE</type>
+    <ident>FIELD IDENT</ident>
+    <name>FIELD NAME</name>
+    <value>FIELD VALUE</value>
+    <flag>FIELD FORMAT</flag>
+    <description>FIELD DESCRIPTION</description>
+  </stat>
+  [..]
+</varnishstat>
 .ft P
 .fi
 .SH JSON OUTPUT
@@ -150,26 +156,17 @@ With \-j the output format is:
 .ft C
 {
   "timestamp": "YYYY\-MM\-DDTHH:mm:SS",
-  "client_conn": {
-      "value": 0, "flag": "a",
-      "description": "Client connections accepted"
-  },
-  "client_drop": {
-      "value": 0, "flag": "a",
-      "description": "Connection dropped, no sess/wrk"
-  },
-  "LCK.backend.creat": {
-      "type": "LCK", "ident": "backend", "value": 1,
-      "flag": "a", "description": "Created locks"
-  },
+  "FIELD NAME": {"type": "FIELD TYPE", "ident": "FIELD IDENT", "value": FIELD VALUE, "flag": "FIELD FORMAT", "description": "FIELD DESCRIPTION"},
   [..]
 }
 .ft P
 .fi
 .sp
-Timestamp is the time when the report was generated by varnishstat.
+Type and ident are optional.  Timestamp is the time when the report was
+generated by varnishstat.
 .sp
-Repeated output with \-1, \-x or \-j will have a single empty line (\en) between each block of output.
+Repeated output with \-1, \-x or \-j will have a single empty line (\en)
+between each block of output.
 .SH SEE ALSO
 .INDENT 0.0
 .IP \(bu 2
diff --git a/man/vcl.7 b/man/vcl.7
index ac9fd9e..d16ba1b 100644
--- a/man/vcl.7
+++ b/man/vcl.7
@@ -166,6 +166,24 @@ sub vcl_recv {
 }
 .ft P
 .fi
+.SS Comments
+.sp
+Single lines of VCL can be commented out using // or #. Multi\-line blocks can
+be commented out with /* block /*.
+.sp
+Example:
+.sp
+.nf
+.ft C
+sub vcl_recv {
+    // Single line of out\-commented VCL.
+    # Another way of commenting out a single line.
+    /*
+        Multi\-line block of commented\-out VCL.
+    */
+}
+.ft P
+.fi
 .SS Backend definition
 .sp
 A backend declaration creates and initialises a named backend object. A
@@ -482,7 +500,9 @@ Type: BOOL
 .sp
 Readable from: backend
 .sp
-Writable from: backend
+Indicates whether this request is uncacheable due
+to a pass in the client side or a hit on an existing
+uncacheable object (aka hit\-for\-pass).
 .UNINDENT
 .UNINDENT
 .sp
@@ -639,6 +659,14 @@ Type: DURATION
 Readable from: vcl_backend_response, vcl_backend_error
 .sp
 Writable from: vcl_backend_response, vcl_backend_error
+.sp
+Set to a period to enable conditional backend requests.
+.sp
+The keep time is cache lifetime in addition to the ttl.
+.sp
+Objects with ttl expired but with keep time left may be used
+to issue conditional (If\-Modified\-Since / If\-None\-Match)
+requests to the backend to refresh them.
 .UNINDENT
 .UNINDENT
 .sp
@@ -717,6 +745,14 @@ Type: BOOL
 Readable from: vcl_backend_response, vcl_backend_error
 .sp
 Writable from: vcl_backend_response, vcl_backend_error
+.sp
+Inherited from bereq.uncacheable, see there.
+.sp
+Setting this variable makes the object uncacheable, which may
+get stored as a hit\-for\-pass object in the cache.
+.sp
+Clearing the variable has no effect and will log the warning
+"Ignoring attempt to reset beresp.uncacheable".
 .UNINDENT
 .UNINDENT
 .SS client
@@ -767,7 +803,7 @@ Type: DURATION
 .sp
 Readable from: vcl_hit
 .sp
-The object\(aqs grace period in seconds.
+The object\(aqs remaining grace period in seconds.
 .UNINDENT
 .UNINDENT
 .sp
@@ -778,12 +814,8 @@ Type: INT
 .sp
 Readable from: vcl_hit, vcl_deliver
 .sp
-The count of cache\-hits on this hash\-key since it was
-last instantiated.  This counts cache\-hits across all
-Vary:\-ants on this hash\-key.
-The counter will only be reset to zero if/when all objects
-with this hash\-key have disappeared from cache.
-NB: obj.hits == 0 does \fInot\fP indicate a cache miss.
+The count of cache\-hits on this object. A value of 0 indicates a
+cache miss.
 .UNINDENT
 .UNINDENT
 .sp
@@ -804,6 +836,8 @@ obj.keep
 Type: DURATION
 .sp
 Readable from: vcl_hit
+.sp
+The object\(aqs remaining keep period in seconds.
 .UNINDENT
 .UNINDENT
 .sp
@@ -856,7 +890,9 @@ obj.uncacheable
 .INDENT 3.5
 Type: BOOL
 .sp
-Readable from: vcl_hit
+Readable from: vcl_deliver
+.sp
+Whether the object is uncacheable (pass or hit\-for\-pass).
 .UNINDENT
 .UNINDENT
 .SS req
diff --git a/man/vsc2rst.c b/man/vsc2rst.c
index 96500bf..f25d2e1 100644
--- a/man/vsc2rst.c
+++ b/man/vsc2rst.c
@@ -55,11 +55,6 @@ int main(int argc, char **argv)
 	P("---------------------------------");
 	P("Varnish counter field definitions");
 	P("---------------------------------");
-
-	P(":Author: Tollef Fog Heen");
-	P(":Date:   2011-09-20");
-	P(":Version: 1.0");
-	P(":Manual section: 7");
 	P("");
 
 	P("COUNTER LEVELS");
diff --git a/redhat/find-provides b/redhat/find-provides
index 8c7dce5..2545e99 100755
--- a/redhat/find-provides
+++ b/redhat/find-provides
@@ -12,4 +12,9 @@ fi
 
 cd $(dirname $0)/..
 
-printf '#include "vmod_abi.h"\nVMOD_ABI_Version' | cpp - -Iinclude | sed '/^#/D;s/"//g;s/\([A-Z]\)/\L\1/g;s/[^a-z0-9.]/-/g;s/varnish/varnishabi/'
+printf '#include "vcs_version.h"\nVCS_Version\n' \
+        | cpp - -Iinclude | sed -e '/^"/!d' -e 's/\"//g' -e 's/^/varnishabi-strict-/'
+
+printf '#include "vrt.h"\nvarnishabi- VRT_MAJOR_VERSION . VRT_MINOR_VERSION\n' \
+	| cpp - -Iinclude \
+	| sed -e '/^varnishabi-/!d' -e 's/U//g' -e 's/ //g'
diff --git a/redhat/varnish.params b/redhat/varnish.params
index 636e975..27a14dd 100644
--- a/redhat/varnish.params
+++ b/redhat/varnish.params
@@ -1,35 +1,35 @@
 # Varnish environment configuration description. This was derived from
 # the old style sysconfig/defaults settings
 
-# Set this to 1 to make systemd reload try to switch vcl without restart. 
+# Set this to 1 to make systemd reload try to switch vcl without restart.
 RELOAD_VCL=1
 
 # Main configuration file. You probably want to change it.
-VARNISH_VCL_CONF=/etc/varnish/default.vcl 
+VARNISH_VCL_CONF=/etc/varnish/default.vcl
 
 # Default address and port to bind to. Blank address means all IPv4
 # and IPv6 interfaces, otherwise specify a host name, an IPv4 dotted
 # quad, or an IPv6 address in brackets.
 # VARNISH_LISTEN_ADDRESS=192.168.1.5
-VARNISH_LISTEN_PORT=6081                  
+VARNISH_LISTEN_PORT=6081
 
 # Admin interface listen address and port
-VARNISH_ADMIN_LISTEN_ADDRESS=127.0.0.1    
-VARNISH_ADMIN_LISTEN_PORT=6082            
+VARNISH_ADMIN_LISTEN_ADDRESS=127.0.0.1
+VARNISH_ADMIN_LISTEN_PORT=6082
 
 # Shared secret file for admin interface
-VARNISH_SECRET_FILE=/etc/varnish/secret   
+VARNISH_SECRET_FILE=/etc/varnish/secret
 
 # Backend storage specification, see Storage Types in the varnishd(5)
 # man page for details.
 VARNISH_STORAGE="file,/var/lib/varnish/varnish_storage.bin,1G"
 
 # Default TTL used when the backend does not specify one
-VARNISH_TTL=120                           
+VARNISH_TTL=120
 
 # User and group for the varnishd worker processes
-VARNISH_USER=varnish                      
-VARNISH_GROUP=varnish                     
+VARNISH_USER=varnish
+VARNISH_GROUP=varnish
 
 # Other options, see the man page varnishd(1)
 #DAEMON_OPTS="-p thread_pool_min=5 -p thread_pool_max=500 -p thread_pool_timeout=300"
diff --git a/redhat/varnish.service b/redhat/varnish.service
index 659dba2..a4f3355 100644
--- a/redhat/varnish.service
+++ b/redhat/varnish.service
@@ -27,6 +27,7 @@ EnvironmentFile=/etc/varnish/varnish.params
 Type=forking
 PIDFile=/var/run/varnish.pid
 PrivateTmp=true
+ExecStartPre=/usr/sbin/varnishd -C -f $VARNISH_VCL_CONF
 ExecStart=/usr/sbin/varnishd \
 	-P /var/run/varnish.pid \
 	-f $VARNISH_VCL_CONF \
diff --git a/redhat/varnish.spec b/redhat/varnish.spec
index 33f418d..0730497 100644
--- a/redhat/varnish.spec
+++ b/redhat/varnish.spec
@@ -1,15 +1,15 @@
-%define XXXv_rc rc1
+%define XXXv_rc rc3
 %define vd_rc %{?v_rc:-%{?v_rc}}
 %define    _use_internal_dependency_generator 0
 %define __find_provides %{_builddir}/varnish-%{version}%{?v_rc:-%{?v_rc}}/redhat/find-provides
 Summary: High-performance HTTP accelerator
 Name: varnish
-Version: 4.0.2
+Version: 4.0.3
 #Release: 0.20140328%{?v_rc}%{?dist}
 Release: 1%{?v_rc}%{?dist}
 License: BSD
 Group: System Environment/Daemons
-URL: http://www.varnish-cache.org/
+URL: https://www.varnish-cache.org/
 #Source0: http://repo.varnish-cache.org/source/%{name}-%{version}.tar.gz
 Source0: %{name}-%{version}%{?vd_rc}.tar.gz
 #Source0: %{name}-trunk.tar.gz
@@ -102,7 +102,9 @@ Documentation files for %name
 	export PCRE_LIBS="`pcre-config --libs`"
 %endif
 
-export CFLAGS="$CFLAGS -Wp,-D_FORTIFY_SOURCE=0"
+%if 0%{?rhel} == 6
+export CFLAGS="$CFLAGS -O2 -g -Wp,-D_FORTIFY_SOURCE=0"
+%endif
 
 # Remove "--disable static" if you want to build static libraries
 # jemalloc is not compatible with Red Hat's ppc64 RHEL kernel :-(
diff --git a/redhat/varnishlog.service b/redhat/varnishlog.service
index 1e3e274..c7a0193 100644
--- a/redhat/varnishlog.service
+++ b/redhat/varnishlog.service
@@ -1,6 +1,6 @@
 [Unit]
 Description=Varnish HTTP accelerator logging daemon
-After=network.target
+After=varnish.service
 
 [Service]
 Type=forking
diff --git a/redhat/varnishncsa.service b/redhat/varnishncsa.service
index df5f19f..e2ebdcd 100644
--- a/redhat/varnishncsa.service
+++ b/redhat/varnishncsa.service
@@ -1,6 +1,6 @@
 [Unit]
-Description=Varnish NCSA logging
-After=network.target
+Description=Varnish HTTP accelerator NCSA daemon
+After=varnish.service
 
 [Service]
 Type=forking
diff --git a/varnish.m4 b/varnish.m4
index 16e27c5..8339cb0 100644
--- a/varnish.m4
+++ b/varnish.m4
@@ -1,7 +1,7 @@
 # varnish.m4 - Macros to locate Varnish header files.            -*- Autoconf -*-
-# serial 1 (varnish-4.0)
+# serial 3 (varnish-4.0)
 
-# Copyright (c) 2013 Varnish Software AS
+# Copyright (c) 2013-2015 Varnish Software AS
 # All rights reserved.
 #
 # Author: Tollef Fog Heen <tfheen@varnish-software.com>
@@ -28,6 +28,11 @@
 # SUCH DAMAGE.
 #
 
+# For compatibility with autoconf < 2.63b
+m4_ifndef([AS_VAR_COPY],
+  [m4_define([AS_VAR_COPY],
+     [AS_LITERAL_IF([$1[]$2], [$1=$$2], [eval $1=\$$2])])]) 
+
 # VARNISH_VMOD_INCLUDE_DIR([])
 # ----------------------------
 
@@ -53,10 +58,9 @@ variable if you installed software in a non-standard prefix.])
 	fi
 ])
 
-VARNISH_PKG_GET_VAR([VMOD_INCLUDE_DIR], [vmodincludedir])
 VARNISH_PKG_GET_VAR([VAPI_INCLUDE_DIR], [pkgincludedir])
 _CPPFLAGS="$CPPFLAGS"
-VMOD_INCLUDES="-I$VMOD_INCLUDE_DIR -I$VAPI_INCLUDE_DIR"
+VMOD_INCLUDES="-I$VAPI_INCLUDE_DIR"
 CPPFLAGS="$VMOD_INCLUDES $CPPFLAGS"
 AC_CHECK_HEADERS([vsha256.h cache/cache.h])
 CPPFLAGS="$_CPPFLAGS"
diff --git a/varnishapi-uninstalled.pc.in b/varnishapi-uninstalled.pc.in
index 3a8f744..d252289 100644
--- a/varnishapi-uninstalled.pc.in
+++ b/varnishapi-uninstalled.pc.in
@@ -8,7 +8,6 @@ pkgincludedir=${includedir}/@PACKAGE@
 datarootdir=@datarootdir@
 datadir=@datadir@
 pkgdatadir=${datadir}/@PACKAGE@
-pkgdataincludedir=${pkgdatadir}/include
 vmoddir=${libdir}/@PACKAGE@/vmods
 builddir=@abs_top_builddir@
 srcdir=@abs_top_srcdir@
diff --git a/varnishapi.pc.in b/varnishapi.pc.in
index 059725e..b2a6e93 100644
--- a/varnishapi.pc.in
+++ b/varnishapi.pc.in
@@ -8,8 +8,6 @@ pkgincludedir=${includedir}/@PACKAGE@
 datarootdir=@datarootdir@
 datadir=@datadir@
 pkgdatadir=${datadir}/@PACKAGE@
-pkgdataincludedir=${pkgdatadir}/include
-vmodincludedir=${pkgdataincludedir}
 vmoddir=${libdir}/@PACKAGE@/vmods
 vmodtool=${pkgdatadir}/vmodtool.py
 
-- 
2.7.4

